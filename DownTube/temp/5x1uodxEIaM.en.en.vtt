WEBVTT
Kind: captions
Language: en

00:00:00.120 --> 00:00:01.949 align:start position:0%
 
hey<00:00:00.320><c> friends</c><00:00:00.880><c> so</c><00:00:01.160><c> today</c><00:00:01.439><c> we're</c><00:00:01.560><c> going</c><00:00:01.640><c> to</c><00:00:01.760><c> talk</c>

00:00:01.949 --> 00:00:01.959 align:start position:0%
hey friends so today we're going to talk
 

00:00:01.959 --> 00:00:04.309 align:start position:0%
hey friends so today we're going to talk
about<00:00:02.560><c> one</c><00:00:02.760><c> of</c><00:00:02.919><c> the</c><00:00:03.159><c> most</c><00:00:03.480><c> powerful</c><00:00:03.959><c> technique</c>

00:00:04.309 --> 00:00:04.319 align:start position:0%
about one of the most powerful technique
 

00:00:04.319 --> 00:00:07.070 align:start position:0%
about one of the most powerful technique
in<00:00:04.480><c> SQL</c><00:00:05.200><c> the</c><00:00:05.440><c> CTE</c><00:00:06.120><c> we're</c><00:00:06.279><c> going</c><00:00:06.399><c> to</c><00:00:06.560><c> learn</c>

00:00:07.070 --> 00:00:07.080 align:start position:0%
in SQL the CTE we're going to learn
 

00:00:07.080 --> 00:00:09.310 align:start position:0%
in SQL the CTE we're going to learn
everything<00:00:07.560><c> about</c><00:00:07.759><c> it</c><00:00:08.200><c> like</c><00:00:08.480><c> why</c><00:00:08.679><c> CTE</c><00:00:09.120><c> is</c>

00:00:09.310 --> 00:00:09.320 align:start position:0%
everything about it like why CTE is
 

00:00:09.320 --> 00:00:12.230 align:start position:0%
everything about it like why CTE is
important<00:00:10.120><c> the</c><00:00:10.440><c> different</c><00:00:10.800><c> types</c><00:00:11.080><c> of</c><00:00:11.240><c> CTE</c><00:00:12.120><c> and</c>

00:00:12.230 --> 00:00:12.240 align:start position:0%
important the different types of CTE and
 

00:00:12.240 --> 00:00:14.270 align:start position:0%
important the different types of CTE and
we're<00:00:12.360><c> going</c><00:00:12.440><c> to</c><00:00:12.559><c> learn</c><00:00:12.840><c> their</c><00:00:13.120><c> syntaxes</c><00:00:14.120><c> and</c>

00:00:14.270 --> 00:00:14.280 align:start position:0%
we're going to learn their syntaxes and
 

00:00:14.280 --> 00:00:15.789 align:start position:0%
we're going to learn their syntaxes and
we're<00:00:14.440><c> going</c><00:00:14.519><c> to</c><00:00:14.679><c> Deep</c><00:00:14.920><c> dive</c><00:00:15.200><c> into</c><00:00:15.519><c> many</c>

00:00:15.789 --> 00:00:15.799 align:start position:0%
we're going to Deep dive into many
 

00:00:15.799 --> 00:00:17.590 align:start position:0%
we're going to Deep dive into many
examples<00:00:16.640><c> and</c><00:00:16.760><c> not</c><00:00:16.960><c> only</c><00:00:17.240><c> that</c><00:00:17.400><c> we're</c><00:00:17.520><c> going</c>

00:00:17.590 --> 00:00:17.600 align:start position:0%
examples and not only that we're going
 

00:00:17.600 --> 00:00:21.150 align:start position:0%
examples and not only that we're going
to<00:00:17.720><c> learn</c><00:00:18.119><c> how</c><00:00:18.320><c> SQL</c><00:00:19.000><c> execute</c><00:00:19.560><c> the</c><00:00:19.760><c> CTE</c><00:00:20.600><c> step</c><00:00:20.880><c> by</c>

00:00:21.150 --> 00:00:21.160 align:start position:0%
to learn how SQL execute the CTE step by
 

00:00:21.160 --> 00:00:23.390 align:start position:0%
to learn how SQL execute the CTE step by
step<00:00:21.600><c> so</c><00:00:21.760><c> we</c><00:00:21.880><c> have</c><00:00:22.000><c> a</c><00:00:22.119><c> lot</c><00:00:22.240><c> of</c><00:00:22.359><c> things</c><00:00:22.560><c> to</c><00:00:22.760><c> cover</c>

00:00:23.390 --> 00:00:23.400 align:start position:0%
step so we have a lot of things to cover
 

00:00:23.400 --> 00:00:25.310 align:start position:0%
step so we have a lot of things to cover
let's<00:00:23.599><c> start</c><00:00:23.840><c> with</c><00:00:24.000><c> the</c><00:00:24.119><c> first</c><00:00:24.400><c> question</c><00:00:25.160><c> what</c>

00:00:25.310 --> 00:00:25.320 align:start position:0%
let's start with the first question what
 

00:00:25.320 --> 00:00:30.109 align:start position:0%
let's start with the first question what
is<00:00:25.519><c> CTE</c>

00:00:30.109 --> 00:00:30.119 align:start position:0%
 
 

00:00:30.119 --> 00:00:32.870 align:start position:0%
 
is<00:00:30.320><c> it</c><00:00:30.840><c> common</c><00:00:31.240><c> table</c><00:00:31.679><c> expression</c><00:00:32.439><c> is</c><00:00:32.680><c> a</c>

00:00:32.870 --> 00:00:32.880 align:start position:0%
is it common table expression is a
 

00:00:32.880 --> 00:00:35.069 align:start position:0%
is it common table expression is a
temporary<00:00:33.360><c> named</c><00:00:33.719><c> result</c><00:00:34.120><c> set</c><00:00:34.680><c> like</c><00:00:34.840><c> a</c>

00:00:35.069 --> 00:00:35.079 align:start position:0%
temporary named result set like a
 

00:00:35.079 --> 00:00:37.030 align:start position:0%
temporary named result set like a
virtual<00:00:35.600><c> table</c><00:00:36.040><c> that</c><00:00:36.239><c> could</c><00:00:36.399><c> be</c><00:00:36.559><c> used</c>

00:00:37.030 --> 00:00:37.040 align:start position:0%
virtual table that could be used
 

00:00:37.040 --> 00:00:39.630 align:start position:0%
virtual table that could be used
multiple<00:00:37.559><c> times</c><00:00:38.320><c> within</c><00:00:38.600><c> your</c><00:00:38.840><c> query</c><00:00:39.399><c> to</c>

00:00:39.630 --> 00:00:39.640 align:start position:0%
multiple times within your query to
 

00:00:39.640 --> 00:00:42.869 align:start position:0%
multiple times within your query to
simplify<00:00:40.280><c> and</c><00:00:40.520><c> organize</c><00:00:41.440><c> complex</c><00:00:41.920><c> query</c><00:00:42.559><c> so</c>

00:00:42.869 --> 00:00:42.879 align:start position:0%
simplify and organize complex query so
 

00:00:42.879 --> 00:00:44.830 align:start position:0%
simplify and organize complex query so
let's<00:00:43.480><c> understand</c><00:00:43.680><c> what</c><00:00:43.840><c> this</c><00:00:44.000><c> means</c><00:00:44.440><c> using</c>

00:00:44.830 --> 00:00:44.840 align:start position:0%
let's understand what this means using
 

00:00:44.840 --> 00:00:46.709 align:start position:0%
let's understand what this means using
the<00:00:44.960><c> following</c><00:00:45.320><c> sketch</c><00:00:45.840><c> so</c><00:00:46.120><c> we</c><00:00:46.280><c> have</c><00:00:46.440><c> our</c>

00:00:46.709 --> 00:00:46.719 align:start position:0%
the following sketch so we have our
 

00:00:46.719 --> 00:00:49.029 align:start position:0%
the following sketch so we have our
database<00:00:47.160><c> tables</c><00:00:47.760><c> like</c><00:00:47.960><c> orders</c><00:00:48.559><c> customers</c>

00:00:49.029 --> 00:00:49.039 align:start position:0%
database tables like orders customers
 

00:00:49.039 --> 00:00:51.350 align:start position:0%
database tables like orders customers
and<00:00:49.199><c> so</c><00:00:49.399><c> on</c><00:00:49.800><c> and</c><00:00:49.960><c> in</c><00:00:50.160><c> very</c><00:00:50.320><c> simple</c><00:00:50.600><c> scenario</c><00:00:51.160><c> we</c>

00:00:51.350 --> 00:00:51.360 align:start position:0%
and so on and in very simple scenario we
 

00:00:51.360 --> 00:00:54.270 align:start position:0%
and so on and in very simple scenario we
write<00:00:51.680><c> a</c><00:00:51.879><c> simple</c><00:00:52.239><c> SQL</c><00:00:53.039><c> in</c><00:00:53.160><c> order</c><00:00:53.480><c> to</c><00:00:53.640><c> query</c><00:00:54.039><c> and</c>

00:00:54.270 --> 00:00:54.280 align:start position:0%
write a simple SQL in order to query and
 

00:00:54.280 --> 00:00:56.510 align:start position:0%
write a simple SQL in order to query and
retrieve<00:00:54.719><c> the</c><00:00:54.920><c> data</c><00:00:55.199><c> from</c><00:00:55.359><c> the</c><00:00:55.520><c> database</c><00:00:56.359><c> and</c>

00:00:56.510 --> 00:00:56.520 align:start position:0%
retrieve the data from the database and
 

00:00:56.520 --> 00:00:58.069 align:start position:0%
retrieve the data from the database and
then<00:00:56.680><c> in</c><00:00:56.800><c> the</c><00:00:56.960><c> output</c><00:00:57.359><c> we</c><00:00:57.440><c> will</c><00:00:57.640><c> get</c><00:00:57.920><c> the</c>

00:00:58.069 --> 00:00:58.079 align:start position:0%
then in the output we will get the
 

00:00:58.079 --> 00:01:00.150 align:start position:0%
then in the output we will get the
results<00:00:58.440><c> of</c><00:00:58.559><c> the</c><00:00:58.680><c> query</c><00:00:59.199><c> so</c><00:00:59.480><c> this</c><00:00:59.600><c> is</c><00:01:00.000><c> the</c>

00:01:00.150 --> 00:01:00.160 align:start position:0%
results of the query so this is the
 

00:01:00.160 --> 00:01:02.389 align:start position:0%
results of the query so this is the
simplest<00:01:00.680><c> version</c><00:01:01.039><c> of</c><00:01:01.239><c> querying</c><00:01:01.680><c> data</c><00:01:02.199><c> now</c>

00:01:02.389 --> 00:01:02.399 align:start position:0%
simplest version of querying data now
 

00:01:02.399 --> 00:01:04.310 align:start position:0%
simplest version of querying data now
things<00:01:02.680><c> get</c><00:01:02.920><c> complicated</c><00:01:03.399><c> in</c><00:01:03.559><c> our</c><00:01:03.840><c> project</c>

00:01:04.310 --> 00:01:04.320 align:start position:0%
things get complicated in our project
 

00:01:04.320 --> 00:01:05.789 align:start position:0%
things get complicated in our project
and<00:01:04.519><c> we</c><00:01:04.680><c> could</c><00:01:04.920><c> have</c><00:01:05.119><c> the</c><00:01:05.320><c> following</c>

00:01:05.789 --> 00:01:05.799 align:start position:0%
and we could have the following
 

00:01:05.799 --> 00:01:08.070 align:start position:0%
and we could have the following
technique<00:01:06.240><c> in</c><00:01:06.439><c> our</c><00:01:06.799><c> query</c><00:01:07.360><c> so</c><00:01:07.479><c> we</c><00:01:07.600><c> still</c><00:01:07.799><c> have</c>

00:01:08.070 --> 00:01:08.080 align:start position:0%
technique in our query so we still have
 

00:01:08.080 --> 00:01:09.910 align:start position:0%
technique in our query so we still have
this<00:01:08.280><c> section</c><00:01:08.600><c> where</c><00:01:08.759><c> we</c><00:01:08.880><c> are</c><00:01:09.000><c> saying</c><00:01:09.439><c> select</c>

00:01:09.910 --> 00:01:09.920 align:start position:0%
this section where we are saying select
 

00:01:09.920 --> 00:01:12.870 align:start position:0%
this section where we are saying select
from<00:01:10.560><c> but</c><00:01:10.720><c> now</c><00:01:11.040><c> inside</c><00:01:11.479><c> our</c><00:01:11.840><c> query</c><00:01:12.520><c> we</c><00:01:12.680><c> can</c>

00:01:12.870 --> 00:01:12.880 align:start position:0%
from but now inside our query we can
 

00:01:12.880 --> 00:01:15.070 align:start position:0%
from but now inside our query we can
write<00:01:13.280><c> another</c><00:01:13.720><c> query</c><00:01:14.320><c> like</c><00:01:14.479><c> for</c><00:01:14.640><c> example</c>

00:01:15.070 --> 00:01:15.080 align:start position:0%
write another query like for example
 

00:01:15.080 --> 00:01:17.390 align:start position:0%
write another query like for example
select<00:01:15.600><c> from</c><00:01:16.080><c> where</c><00:01:16.600><c> which</c><00:01:16.720><c> is</c><00:01:16.960><c> completely</c>

00:01:17.390 --> 00:01:17.400 align:start position:0%
select from where which is completely
 

00:01:17.400 --> 00:01:19.390 align:start position:0%
select from where which is completely
nothing<00:01:17.680><c> to</c><00:01:17.799><c> do</c><00:01:18.000><c> with</c><00:01:18.159><c> the</c><00:01:18.320><c> first</c><00:01:18.680><c> query</c><00:01:19.280><c> and</c>

00:01:19.390 --> 00:01:19.400 align:start position:0%
nothing to do with the first query and
 

00:01:19.400 --> 00:01:21.390 align:start position:0%
nothing to do with the first query and
we<00:01:19.520><c> can</c><00:01:19.720><c> give</c><00:01:19.960><c> this</c><00:01:20.200><c> new</c><00:01:20.439><c> query</c><00:01:20.799><c> inside</c><00:01:21.119><c> our</c>

00:01:21.390 --> 00:01:21.400 align:start position:0%
we can give this new query inside our
 

00:01:21.400 --> 00:01:24.550 align:start position:0%
we can give this new query inside our
query<00:01:21.759><c> a</c><00:01:22.000><c> name</c><00:01:22.520><c> CTE</c><00:01:23.520><c> and</c><00:01:23.640><c> we</c><00:01:23.759><c> can</c><00:01:24.040><c> call</c><00:01:24.320><c> this</c>

00:01:24.550 --> 00:01:24.560 align:start position:0%
query a name CTE and we can call this
 

00:01:24.560 --> 00:01:27.390 align:start position:0%
query a name CTE and we can call this
query<00:01:25.040><c> a</c><00:01:25.280><c> CTE</c><00:01:25.960><c> query</c><00:01:26.560><c> Common</c><00:01:26.960><c> Table</c>

00:01:27.390 --> 00:01:27.400 align:start position:0%
query a CTE query Common Table
 

00:01:27.400 --> 00:01:29.749 align:start position:0%
query a CTE query Common Table
expression<00:01:28.240><c> and</c><00:01:28.400><c> the</c><00:01:28.560><c> first</c><00:01:28.840><c> query</c><00:01:29.280><c> outside</c>

00:01:29.749 --> 00:01:29.759 align:start position:0%
expression and the first query outside
 

00:01:29.759 --> 00:01:33.030 align:start position:0%
expression and the first query outside
the<00:01:29.920><c> this</c><00:01:30.040><c> CTE</c><00:01:30.880><c> we</c><00:01:31.079><c> call</c><00:01:31.280><c> it</c><00:01:31.560><c> a</c><00:01:31.759><c> main</c><00:01:32.119><c> query</c><00:01:32.880><c> now</c>

00:01:33.030 --> 00:01:33.040 align:start position:0%
the this CTE we call it a main query now
 

00:01:33.040 --> 00:01:34.990 align:start position:0%
the this CTE we call it a main query now
if<00:01:33.119><c> you</c><00:01:33.240><c> check</c><00:01:33.479><c> this</c><00:01:33.640><c> we</c><00:01:33.759><c> have</c><00:01:34.000><c> like</c><00:01:34.200><c> a</c><00:01:34.439><c> query</c>

00:01:34.990 --> 00:01:35.000 align:start position:0%
if you check this we have like a query
 

00:01:35.000 --> 00:01:37.190 align:start position:0%
if you check this we have like a query
inside<00:01:35.479><c> another</c><00:01:35.960><c> query</c><00:01:36.520><c> so</c><00:01:36.720><c> now</c><00:01:36.880><c> let's</c><00:01:37.040><c> see</c>

00:01:37.190 --> 00:01:37.200 align:start position:0%
inside another query so now let's see
 

00:01:37.200 --> 00:01:39.030 align:start position:0%
inside another query so now let's see
what<00:01:37.360><c> SQL</c><00:01:37.720><c> going</c><00:01:37.840><c> to</c><00:01:38.000><c> do</c><00:01:38.159><c> with</c><00:01:38.360><c> this</c><00:01:38.720><c> the</c><00:01:38.840><c> first</c>

00:01:39.030 --> 00:01:39.040 align:start position:0%
what SQL going to do with this the first
 

00:01:39.040 --> 00:01:41.030 align:start position:0%
what SQL going to do with this the first
thing<00:01:39.200><c> is</c><00:01:39.399><c> we</c><00:01:39.600><c> going</c><00:01:39.680><c> to</c><00:01:39.799><c> go</c><00:01:39.960><c> and</c><00:01:40.280><c> execute</c><00:01:40.880><c> the</c>

00:01:41.030 --> 00:01:41.040 align:start position:0%
thing is we going to go and execute the
 

00:01:41.040 --> 00:01:43.670 align:start position:0%
thing is we going to go and execute the
CTE<00:01:41.600><c> query</c><00:01:42.200><c> so</c><00:01:42.399><c> the</c><00:01:42.520><c> CTE</c><00:01:42.960><c> query</c><00:01:43.240><c> going</c><00:01:43.360><c> to</c><00:01:43.439><c> be</c>

00:01:43.670 --> 00:01:43.680 align:start position:0%
CTE query so the CTE query going to be
 

00:01:43.680 --> 00:01:45.510 align:start position:0%
CTE query so the CTE query going to be
executed<00:01:44.640><c> and</c><00:01:44.840><c> we're</c><00:01:45.000><c> going</c><00:01:45.119><c> to</c><00:01:45.240><c> go</c><00:01:45.360><c> and</c>

00:01:45.510 --> 00:01:45.520 align:start position:0%
executed and we're going to go and
 

00:01:45.520 --> 00:01:47.350 align:start position:0%
executed and we're going to go and
retrieve<00:01:46.000><c> few</c><00:01:46.280><c> informations</c><00:01:46.920><c> from</c><00:01:47.119><c> our</c>

00:01:47.350 --> 00:01:47.360 align:start position:0%
retrieve few informations from our
 

00:01:47.360 --> 00:01:49.469 align:start position:0%
retrieve few informations from our
database<00:01:47.799><c> tables</c><00:01:48.439><c> now</c><00:01:48.640><c> the</c><00:01:48.840><c> output</c><00:01:49.280><c> going</c><00:01:49.360><c> to</c>

00:01:49.469 --> 00:01:49.479 align:start position:0%
database tables now the output going to
 

00:01:49.479 --> 00:01:52.109 align:start position:0%
database tables now the output going to
be<00:01:49.680><c> available</c><00:01:50.320><c> only</c><00:01:50.719><c> in</c><00:01:50.880><c> the</c><00:01:51.079><c> query</c><00:01:51.840><c> and</c><00:01:52.000><c> the</c>

00:01:52.109 --> 00:01:52.119 align:start position:0%
be available only in the query and the
 

00:01:52.119 --> 00:01:54.149 align:start position:0%
be available only in the query and the
output<00:01:52.520><c> going</c><00:01:52.600><c> to</c><00:01:52.799><c> have</c><00:01:52.960><c> the</c><00:01:53.119><c> shape</c><00:01:53.439><c> of</c><00:01:53.680><c> like</c><00:01:53.960><c> a</c>

00:01:54.149 --> 00:01:54.159 align:start position:0%
output going to have the shape of like a
 

00:01:54.159 --> 00:01:56.350 align:start position:0%
output going to have the shape of like a
table<00:01:54.680><c> like</c><00:01:54.799><c> for</c><00:01:54.960><c> example</c><00:01:55.320><c> the</c><00:01:55.439><c> sales</c><00:01:56.000><c> so</c><00:01:56.159><c> now</c>

00:01:56.350 --> 00:01:56.360 align:start position:0%
table like for example the sales so now
 

00:01:56.360 --> 00:01:58.469 align:start position:0%
table like for example the sales so now
the<00:01:56.479><c> sales</c><00:01:56.799><c> table</c><00:01:57.159><c> and</c><00:01:57.280><c> the</c><00:01:57.399><c> orders</c><00:01:57.799><c> tables</c>

00:01:58.469 --> 00:01:58.479 align:start position:0%
the sales table and the orders tables
 

00:01:58.479 --> 00:02:00.789 align:start position:0%
the sales table and the orders tables
both<00:01:58.640><c> of</c><00:01:58.799><c> them</c><00:01:58.920><c> are</c><00:01:59.159><c> tables</c><00:02:00.039><c> but</c><00:02:00.280><c> one</c><00:02:00.560><c> is</c>

00:02:00.789 --> 00:02:00.799 align:start position:0%
both of them are tables but one is
 

00:02:00.799 --> 00:02:03.789 align:start position:0%
both of them are tables but one is
stored<00:02:01.360><c> in</c><00:02:01.520><c> the</c><00:02:01.880><c> database</c><00:02:02.880><c> and</c><00:02:03.079><c> the</c><00:02:03.280><c> other</c><00:02:03.560><c> one</c>

00:02:03.789 --> 00:02:03.799 align:start position:0%
stored in the database and the other one
 

00:02:03.799 --> 00:02:06.789 align:start position:0%
stored in the database and the other one
is<00:02:04.079><c> an</c><00:02:04.360><c> intermediate</c><00:02:05.360><c> virtual</c><00:02:05.920><c> table</c><00:02:06.439><c> so</c><00:02:06.600><c> now</c>

00:02:06.789 --> 00:02:06.799 align:start position:0%
is an intermediate virtual table so now
 

00:02:06.799 --> 00:02:08.949 align:start position:0%
is an intermediate virtual table so now
what<00:02:06.920><c> can</c><00:02:07.079><c> to</c><00:02:07.240><c> happen</c><00:02:08.000><c> in</c><00:02:08.119><c> the</c><00:02:08.200><c> main</c><00:02:08.520><c> query</c><00:02:08.840><c> we</c>

00:02:08.949 --> 00:02:08.959 align:start position:0%
what can to happen in the main query we
 

00:02:08.959 --> 00:02:11.190 align:start position:0%
what can to happen in the main query we
can<00:02:09.119><c> go</c><00:02:09.360><c> and</c><00:02:09.599><c> start</c><00:02:09.959><c> querying</c><00:02:10.560><c> the</c><00:02:10.759><c> sales</c>

00:02:11.190 --> 00:02:11.200 align:start position:0%
can go and start querying the sales
 

00:02:11.200 --> 00:02:14.270 align:start position:0%
can go and start querying the sales
table<00:02:11.840><c> the</c><00:02:12.080><c> result</c><00:02:12.440><c> from</c><00:02:12.640><c> the</c><00:02:12.760><c> CTE</c><00:02:13.680><c> as</c><00:02:14.000><c> any</c>

00:02:14.270 --> 00:02:14.280 align:start position:0%
table the result from the CTE as any
 

00:02:14.280 --> 00:02:16.470 align:start position:0%
table the result from the CTE as any
other<00:02:14.560><c> Nal</c><00:02:15.000><c> table</c><00:02:15.519><c> like</c><00:02:15.720><c> we</c><00:02:15.959><c> do</c><00:02:16.160><c> to</c><00:02:16.319><c> the</c>

00:02:16.470 --> 00:02:16.480 align:start position:0%
other Nal table like we do to the
 

00:02:16.480 --> 00:02:18.509 align:start position:0%
other Nal table like we do to the
database<00:02:16.920><c> tables</c><00:02:17.440><c> so</c><00:02:17.680><c> the</c><00:02:17.800><c> main</c><00:02:18.040><c> query</c><00:02:18.400><c> going</c>

00:02:18.509 --> 00:02:18.519 align:start position:0%
database tables so the main query going
 

00:02:18.519 --> 00:02:20.710 align:start position:0%
database tables so the main query going
to<00:02:18.680><c> go</c><00:02:18.879><c> and</c><00:02:19.120><c> retrieve</c><00:02:19.560><c> few</c><00:02:19.800><c> informations</c><00:02:20.560><c> and</c>

00:02:20.710 --> 00:02:20.720 align:start position:0%
to go and retrieve few informations and
 

00:02:20.720 --> 00:02:22.990 align:start position:0%
to go and retrieve few informations and
maybe<00:02:20.920><c> do</c><00:02:21.080><c> some</c><00:02:21.319><c> manipulations</c><00:02:22.319><c> on</c><00:02:22.519><c> top</c><00:02:22.800><c> of</c>

00:02:22.990 --> 00:02:23.000 align:start position:0%
maybe do some manipulations on top of
 

00:02:23.000 --> 00:02:25.550 align:start position:0%
maybe do some manipulations on top of
the<00:02:23.239><c> sales</c><00:02:23.920><c> table</c><00:02:24.360><c> or</c><00:02:24.519><c> let's</c><00:02:24.680><c> say</c><00:02:24.920><c> the</c><00:02:25.040><c> CTE</c>

00:02:25.550 --> 00:02:25.560 align:start position:0%
the sales table or let's say the CTE
 

00:02:25.560 --> 00:02:27.229 align:start position:0%
the sales table or let's say the CTE
results<00:02:26.040><c> and</c><00:02:26.120><c> of</c><00:02:26.239><c> course</c><00:02:26.480><c> the</c><00:02:26.560><c> main</c><00:02:26.800><c> query</c><00:02:27.120><c> as</c>

00:02:27.229 --> 00:02:27.239 align:start position:0%
results and of course the main query as
 

00:02:27.239 --> 00:02:28.990 align:start position:0%
results and of course the main query as
well<00:02:27.440><c> can</c><00:02:27.680><c> go</c><00:02:27.879><c> and</c><00:02:28.040><c> say</c><00:02:28.280><c> you</c><00:02:28.400><c> know</c><00:02:28.599><c> what</c><00:02:28.840><c> let's</c>

00:02:28.990 --> 00:02:29.000 align:start position:0%
well can go and say you know what let's
 

00:02:29.000 --> 00:02:30.350 align:start position:0%
well can go and say you know what let's
go<00:02:29.160><c> and</c><00:02:29.319><c> query</c><00:02:29.599><c> as</c><00:02:29.680><c> well</c>

00:02:30.350 --> 00:02:30.360 align:start position:0%
go and query as well
 

00:02:30.360 --> 00:02:32.790 align:start position:0%
go and query as well
few<00:02:30.680><c> tables</c><00:02:31.120><c> from</c><00:02:31.319><c> the</c><00:02:31.480><c> database</c><00:02:32.200><c> so</c><00:02:32.400><c> the</c><00:02:32.519><c> main</c>

00:02:32.790 --> 00:02:32.800 align:start position:0%
few tables from the database so the main
 

00:02:32.800 --> 00:02:35.470 align:start position:0%
few tables from the database so the main
query<00:02:33.120><c> has</c><00:02:33.319><c> two</c><00:02:33.519><c> sources</c><00:02:33.879><c> of</c><00:02:34.080><c> tables</c><00:02:35.000><c> either</c>

00:02:35.470 --> 00:02:35.480 align:start position:0%
query has two sources of tables either
 

00:02:35.480 --> 00:02:38.190 align:start position:0%
query has two sources of tables either
get<00:02:35.640><c> it</c><00:02:36.000><c> directly</c><00:02:36.440><c> from</c><00:02:36.599><c> the</c><00:02:36.800><c> database</c><00:02:37.599><c> or</c><00:02:38.000><c> get</c>

00:02:38.190 --> 00:02:38.200 align:start position:0%
get it directly from the database or get
 

00:02:38.200 --> 00:02:40.630 align:start position:0%
get it directly from the database or get
it<00:02:38.400><c> from</c><00:02:38.680><c> the</c><00:02:38.840><c> table</c><00:02:39.200><c> that</c><00:02:39.360><c> is</c><00:02:39.640><c> created</c><00:02:40.360><c> inside</c>

00:02:40.630 --> 00:02:40.640 align:start position:0%
it from the table that is created inside
 

00:02:40.640 --> 00:02:42.470 align:start position:0%
it from the table that is created inside
the<00:02:40.800><c> query</c><00:02:41.440><c> and</c><00:02:41.560><c> then</c><00:02:41.720><c> once</c><00:02:41.959><c> everything</c><00:02:42.319><c> is</c>

00:02:42.470 --> 00:02:42.480 align:start position:0%
the query and then once everything is
 

00:02:42.480 --> 00:02:45.149 align:start position:0%
the query and then once everything is
done<00:02:43.040><c> the</c><00:02:43.239><c> final</c><00:02:43.720><c> results</c><00:02:44.200><c> of</c><00:02:44.360><c> the</c><00:02:44.519><c> main</c><00:02:44.800><c> query</c>

00:02:45.149 --> 00:02:45.159 align:start position:0%
done the final results of the main query
 

00:02:45.159 --> 00:02:47.750 align:start position:0%
done the final results of the main query
going<00:02:45.280><c> to</c><00:02:45.400><c> be</c><00:02:45.959><c> presented</c><00:02:46.400><c> for</c><00:02:46.599><c> the</c><00:02:46.760><c> user</c><00:02:47.360><c> as</c><00:02:47.560><c> a</c>

00:02:47.750 --> 00:02:47.760 align:start position:0%
going to be presented for the user as a
 

00:02:47.760 --> 00:02:50.190 align:start position:0%
going to be presented for the user as a
final<00:02:48.200><c> result</c><00:02:48.840><c> so</c><00:02:49.080><c> as</c><00:02:49.159><c> you</c><00:02:49.239><c> can</c><00:02:49.400><c> see</c><00:02:49.599><c> the</c><00:02:49.720><c> CTE</c>

00:02:50.190 --> 00:02:50.200 align:start position:0%
final result so as you can see the CTE
 

00:02:50.200 --> 00:02:52.670 align:start position:0%
final result so as you can see the CTE
query<00:02:50.680><c> has</c><00:02:50.840><c> one</c><00:02:51.120><c> task</c><00:02:51.760><c> where</c><00:02:51.920><c> it</c><00:02:52.080><c> generates</c>

00:02:52.670 --> 00:02:52.680 align:start position:0%
query has one task where it generates
 

00:02:52.680 --> 00:02:55.990 align:start position:0%
query has one task where it generates
like<00:02:52.840><c> a</c><00:02:53.040><c> table</c><00:02:53.480><c> that</c><00:02:53.680><c> lives</c><00:02:54.280><c> inside</c><00:02:55.120><c> our</c><00:02:55.480><c> query</c>

00:02:55.990 --> 00:02:56.000 align:start position:0%
like a table that lives inside our query
 

00:02:56.000 --> 00:02:58.030 align:start position:0%
like a table that lives inside our query
and<00:02:56.159><c> we</c><00:02:56.239><c> can</c><00:02:56.400><c> go</c><00:02:56.560><c> and</c><00:02:56.720><c> use</c><00:02:56.920><c> it</c><00:02:57.120><c> as</c><00:02:57.239><c> we</c><00:02:57.400><c> want</c><00:02:57.879><c> so</c>

00:02:58.030 --> 00:02:58.040 align:start position:0%
and we can go and use it as we want so
 

00:02:58.040 --> 00:02:59.910 align:start position:0%
and we can go and use it as we want so
now<00:02:58.319><c> this</c><00:02:58.480><c> intermediate</c><00:02:59.159><c> table</c><00:02:59.519><c> that</c><00:02:59.640><c> is</c>

00:02:59.910 --> 00:02:59.920 align:start position:0%
now this intermediate table that is
 

00:02:59.920 --> 00:03:02.229 align:start position:0%
now this intermediate table that is
created<00:03:00.239><c> from</c><00:03:00.400><c> the</c><00:03:00.560><c> CTE</c><00:03:01.080><c> has</c><00:03:01.239><c> two</c><00:03:01.440><c> features</c>

00:03:02.229 --> 00:03:02.239 align:start position:0%
created from the CTE has two features
 

00:03:02.239 --> 00:03:04.910 align:start position:0%
created from the CTE has two features
first<00:03:02.720><c> this</c><00:03:02.920><c> table</c><00:03:03.200><c> will</c><00:03:03.400><c> not</c><00:03:03.640><c> live</c><00:03:03.959><c> long</c><00:03:04.599><c> so</c>

00:03:04.910 --> 00:03:04.920 align:start position:0%
first this table will not live long so
 

00:03:04.920 --> 00:03:06.990 align:start position:0%
first this table will not live long so
once<00:03:05.280><c> the</c><00:03:05.480><c> query</c><00:03:05.879><c> ends</c><00:03:06.319><c> what</c><00:03:06.480><c> going</c><00:03:06.560><c> to</c><00:03:06.720><c> happen</c>

00:03:06.990 --> 00:03:07.000 align:start position:0%
once the query ends what going to happen
 

00:03:07.000 --> 00:03:10.030 align:start position:0%
once the query ends what going to happen
is<00:03:07.400><c> going</c><00:03:07.480><c> to</c><00:03:07.599><c> go</c><00:03:07.799><c> and</c><00:03:08.080><c> destroy</c><00:03:09.000><c> this</c><00:03:09.239><c> table</c><00:03:09.840><c> so</c>

00:03:10.030 --> 00:03:10.040 align:start position:0%
is going to go and destroy this table so
 

00:03:10.040 --> 00:03:11.869 align:start position:0%
is going to go and destroy this table so
it<00:03:10.159><c> will</c><00:03:10.319><c> not</c><00:03:10.519><c> be</c><00:03:10.720><c> available</c><00:03:11.200><c> afterward</c><00:03:11.760><c> and</c>

00:03:11.869 --> 00:03:11.879 align:start position:0%
it will not be available afterward and
 

00:03:11.879 --> 00:03:14.190 align:start position:0%
it will not be available afterward and
we<00:03:12.000><c> are</c><00:03:12.159><c> not</c><00:03:12.400><c> able</c><00:03:12.640><c> to</c><00:03:12.840><c> query</c><00:03:13.159><c> it</c><00:03:13.360><c> anymore</c><00:03:13.959><c> so</c>

00:03:14.190 --> 00:03:14.200 align:start position:0%
we are not able to query it anymore so
 

00:03:14.200 --> 00:03:16.550 align:start position:0%
we are not able to query it anymore so
isq<00:03:14.640><c> is</c><00:03:14.799><c> doing</c><00:03:15.040><c> here</c><00:03:15.239><c> like</c><00:03:15.400><c> a</c><00:03:15.519><c> cleanup</c><00:03:16.280><c> and</c><00:03:16.400><c> the</c>

00:03:16.550 --> 00:03:16.560 align:start position:0%
isq is doing here like a cleanup and the
 

00:03:16.560 --> 00:03:18.070 align:start position:0%
isq is doing here like a cleanup and the
second<00:03:16.879><c> character</c><00:03:17.239><c> about</c><00:03:17.560><c> this</c><00:03:17.840><c> let's</c>

00:03:18.070 --> 00:03:18.080 align:start position:0%
second character about this let's
 

00:03:18.080 --> 00:03:20.550 align:start position:0%
second character about this let's
imagine<00:03:18.480><c> that</c><00:03:18.599><c> we</c><00:03:18.760><c> have</c><00:03:19.040><c> another</c><00:03:19.480><c> side</c><00:03:19.840><c> query</c>

00:03:20.550 --> 00:03:20.560 align:start position:0%
imagine that we have another side query
 

00:03:20.560 --> 00:03:22.710 align:start position:0%
imagine that we have another side query
and<00:03:20.760><c> it's</c><00:03:20.959><c> retrieving</c><00:03:21.519><c> tables</c><00:03:22.000><c> directly</c><00:03:22.519><c> from</c>

00:03:22.710 --> 00:03:22.720 align:start position:0%
and it's retrieving tables directly from
 

00:03:22.720 --> 00:03:24.990 align:start position:0%
and it's retrieving tables directly from
the<00:03:22.879><c> database</c><00:03:23.360><c> tables</c><00:03:23.959><c> now</c><00:03:24.120><c> if</c><00:03:24.239><c> you</c><00:03:24.360><c> say</c><00:03:24.760><c> let's</c>

00:03:24.990 --> 00:03:25.000 align:start position:0%
the database tables now if you say let's
 

00:03:25.000 --> 00:03:27.830 align:start position:0%
the database tables now if you say let's
go<00:03:25.200><c> and</c><00:03:25.519><c> join</c><00:03:26.360><c> those</c><00:03:26.640><c> tables</c><00:03:27.239><c> as</c><00:03:27.440><c> well</c><00:03:27.680><c> with</c>

00:03:27.830 --> 00:03:27.840 align:start position:0%
go and join those tables as well with
 

00:03:27.840 --> 00:03:30.390 align:start position:0%
go and join those tables as well with
the<00:03:28.000><c> sales</c><00:03:28.680><c> from</c><00:03:28.879><c> the</c><00:03:29.000><c> first</c><00:03:29.360><c> query</c><00:03:30.000><c> well</c><00:03:30.280><c> it</c>

00:03:30.390 --> 00:03:30.400 align:start position:0%
the sales from the first query well it
 

00:03:30.400 --> 00:03:32.229 align:start position:0%
the sales from the first query well it
will<00:03:30.599><c> not</c><00:03:30.760><c> be</c><00:03:30.959><c> working</c><00:03:31.360><c> because</c><00:03:31.680><c> isql</c><00:03:32.120><c> going</c>

00:03:32.229 --> 00:03:32.239 align:start position:0%
will not be working because isql going
 

00:03:32.239 --> 00:03:34.149 align:start position:0%
will not be working because isql going
to<00:03:32.400><c> say</c><00:03:32.959><c> I</c><00:03:33.080><c> don't</c><00:03:33.280><c> know</c><00:03:33.480><c> what</c><00:03:33.560><c> you're</c><00:03:33.840><c> talking</c>

00:03:34.149 --> 00:03:34.159 align:start position:0%
to say I don't know what you're talking
 

00:03:34.159 --> 00:03:36.869 align:start position:0%
to say I don't know what you're talking
about<00:03:34.720><c> and</c><00:03:34.920><c> that's</c><00:03:35.159><c> because</c><00:03:35.720><c> the</c><00:03:35.959><c> sales</c><00:03:36.560><c> is</c>

00:03:36.869 --> 00:03:36.879 align:start position:0%
about and that's because the sales is
 

00:03:36.879 --> 00:03:39.710 align:start position:0%
about and that's because the sales is
only<00:03:37.360><c> locally</c><00:03:38.120><c> available</c><00:03:38.920><c> for</c><00:03:39.200><c> the</c><00:03:39.360><c> main</c>

00:03:39.710 --> 00:03:39.720 align:start position:0%
only locally available for the main
 

00:03:39.720 --> 00:03:43.429 align:start position:0%
only locally available for the main
query<00:03:40.519><c> in</c><00:03:40.799><c> the</c><00:03:41.159><c> same</c><00:03:41.959><c> query</c><00:03:42.680><c> so</c><00:03:42.920><c> that</c><00:03:43.080><c> means</c>

00:03:43.429 --> 00:03:43.439 align:start position:0%
query in the same query so that means
 

00:03:43.439 --> 00:03:45.350 align:start position:0%
query in the same query so that means
it's<00:03:43.640><c> not</c><00:03:43.920><c> globally</c><00:03:44.480><c> available</c><00:03:45.000><c> like</c><00:03:45.200><c> the</c>

00:03:45.350 --> 00:03:45.360 align:start position:0%
it's not globally available like the
 

00:03:45.360 --> 00:03:48.309 align:start position:0%
it's not globally available like the
database<00:03:45.840><c> tables</c><00:03:46.680><c> for</c><00:03:47.000><c> any</c><00:03:47.280><c> query</c><00:03:47.920><c> it</c><00:03:48.080><c> is</c>

00:03:48.309 --> 00:03:48.319 align:start position:0%
database tables for any query it is
 

00:03:48.319 --> 00:03:50.949 align:start position:0%
database tables for any query it is
dedicated<00:03:48.959><c> only</c><00:03:49.239><c> for</c><00:03:49.480><c> the</c><00:03:49.599><c> main</c><00:03:49.920><c> query</c><00:03:50.439><c> within</c>

00:03:50.949 --> 00:03:50.959 align:start position:0%
dedicated only for the main query within
 

00:03:50.959 --> 00:03:53.110 align:start position:0%
dedicated only for the main query within
the<00:03:51.200><c> same</c><00:03:51.640><c> query</c><00:03:52.239><c> and</c><00:03:52.360><c> now</c><00:03:52.519><c> you</c><00:03:52.599><c> might</c><00:03:52.799><c> tell</c><00:03:52.920><c> me</c>

00:03:53.110 --> 00:03:53.120 align:start position:0%
the same query and now you might tell me
 

00:03:53.120 --> 00:03:55.270 align:start position:0%
the same query and now you might tell me
bar<00:03:53.640><c> wait</c><00:03:53.920><c> wait</c><00:03:54.159><c> wait</c><00:03:54.560><c> I</c><00:03:54.680><c> have</c><00:03:54.840><c> heard</c><00:03:55.120><c> this</c>

00:03:55.270 --> 00:03:55.280 align:start position:0%
bar wait wait wait I have heard this
 

00:03:55.280 --> 00:03:57.229 align:start position:0%
bar wait wait wait I have heard this
story<00:03:55.640><c> before</c><00:03:56.079><c> right</c><00:03:56.480><c> so</c><00:03:56.720><c> this</c><00:03:56.840><c> is</c><00:03:57.000><c> an</c>

00:03:57.229 --> 00:03:57.239 align:start position:0%
story before right so this is an
 

00:03:57.239 --> 00:03:59.110 align:start position:0%
story before right so this is an
identical<00:03:57.840><c> story</c><00:03:58.239><c> to</c><00:03:58.439><c> the</c><00:03:58.560><c> one</c><00:03:58.760><c> that</c><00:03:58.879><c> you</c><00:03:58.959><c> have</c>

00:03:59.110 --> 00:03:59.120 align:start position:0%
identical story to the one that you have
 

00:03:59.120 --> 00:04:01.550 align:start position:0%
identical story to the one that you have
told<00:03:59.319><c> us</c><00:03:59.480><c> about</c><00:03:59.920><c> the</c><00:04:00.040><c> subqueries</c><00:04:00.959><c> so</c><00:04:01.200><c> what</c><00:04:01.319><c> is</c>

00:04:01.550 --> 00:04:01.560 align:start position:0%
told us about the subqueries so what is
 

00:04:01.560 --> 00:04:03.069 align:start position:0%
told us about the subqueries so what is
exactly<00:04:02.000><c> the</c><00:04:02.200><c> difference</c><00:04:02.560><c> between</c><00:04:02.920><c> the</c>

00:04:03.069 --> 00:04:03.079 align:start position:0%
exactly the difference between the
 

00:04:03.079 --> 00:04:05.390 align:start position:0%
exactly the difference between the
subquery<00:04:03.799><c> and</c><00:04:03.920><c> the</c><00:04:04.079><c> CTE</c><00:04:04.840><c> well</c><00:04:05.040><c> you</c><00:04:05.159><c> are</c>

00:04:05.390 --> 00:04:05.400 align:start position:0%
subquery and the CTE well you are
 

00:04:05.400 --> 00:04:07.350 align:start position:0%
subquery and the CTE well you are
totally<00:04:05.840><c> right</c><00:04:06.159><c> the</c><00:04:06.280><c> story</c><00:04:06.640><c> is</c><00:04:06.840><c> identical</c>

00:04:07.350 --> 00:04:07.360 align:start position:0%
totally right the story is identical
 

00:04:07.360 --> 00:04:09.750 align:start position:0%
totally right the story is identical
between<00:04:07.680><c> the</c><00:04:07.840><c> subqueries</c><00:04:08.439><c> and</c><00:04:08.599><c> the</c><00:04:08.720><c> CTE</c><00:04:09.519><c> but</c>

00:04:09.750 --> 00:04:09.760 align:start position:0%
between the subqueries and the CTE but
 

00:04:09.760 --> 00:04:11.710 align:start position:0%
between the subqueries and the CTE but
still<00:04:10.079><c> there</c><00:04:10.239><c> are</c><00:04:10.560><c> differences</c><00:04:11.000><c> between</c><00:04:11.360><c> them</c>

00:04:11.710 --> 00:04:11.720 align:start position:0%
still there are differences between them
 

00:04:11.720 --> 00:04:13.630 align:start position:0%
still there are differences between them
so<00:04:11.920><c> let</c><00:04:12.079><c> me</c><00:04:12.200><c> show</c><00:04:12.400><c> you</c><00:04:12.560><c> few</c><00:04:12.840><c> differences</c><00:04:13.480><c> now</c>

00:04:13.630 --> 00:04:13.640 align:start position:0%
so let me show you few differences now
 

00:04:13.640 --> 00:04:15.350 align:start position:0%
so let me show you few differences now
let's<00:04:13.840><c> put</c><00:04:14.040><c> them</c><00:04:14.239><c> side</c><00:04:14.519><c> by</c><00:04:14.760><c> side</c><00:04:15.000><c> we</c><00:04:15.120><c> have</c><00:04:15.239><c> on</c>

00:04:15.350 --> 00:04:15.360 align:start position:0%
let's put them side by side we have on
 

00:04:15.360 --> 00:04:17.030 align:start position:0%
let's put them side by side we have on
the<00:04:15.480><c> left</c><00:04:15.760><c> side</c><00:04:15.920><c> the</c><00:04:16.079><c> subqueries</c><00:04:16.720><c> on</c><00:04:16.840><c> the</c>

00:04:17.030 --> 00:04:17.040 align:start position:0%
the left side the subqueries on the
 

00:04:17.040 --> 00:04:19.310 align:start position:0%
the left side the subqueries on the
right<00:04:17.359><c> side</c><00:04:17.560><c> we</c><00:04:17.759><c> have</c><00:04:18.000><c> the</c><00:04:18.160><c> CTE</c><00:04:18.799><c> so</c><00:04:18.959><c> now</c><00:04:19.079><c> if</c><00:04:19.199><c> you</c>

00:04:19.310 --> 00:04:19.320 align:start position:0%
right side we have the CTE so now if you
 

00:04:19.320 --> 00:04:21.310 align:start position:0%
right side we have the CTE so now if you
look<00:04:19.479><c> on</c><00:04:19.720><c> how</c><00:04:19.919><c> we</c><00:04:20.079><c> wrote</c><00:04:20.519><c> the</c><00:04:20.639><c> CTE</c><00:04:21.040><c> and</c><00:04:21.199><c> the</c>

00:04:21.310 --> 00:04:21.320 align:start position:0%
look on how we wrote the CTE and the
 

00:04:21.320 --> 00:04:23.310 align:start position:0%
look on how we wrote the CTE and the
subqueries<00:04:22.280><c> you</c><00:04:22.400><c> can</c><00:04:22.560><c> see</c><00:04:22.840><c> that</c><00:04:23.040><c> on</c><00:04:23.199><c> the</c>

00:04:23.310 --> 00:04:23.320 align:start position:0%
subqueries you can see that on the
 

00:04:23.320 --> 00:04:25.550 align:start position:0%
subqueries you can see that on the
subquery<00:04:23.919><c> we</c><00:04:24.040><c> are</c><00:04:24.240><c> writing</c><00:04:24.680><c> it</c><00:04:24.880><c> from</c><00:04:25.199><c> bottom</c>

00:04:25.550 --> 00:04:25.560 align:start position:0%
subquery we are writing it from bottom
 

00:04:25.560 --> 00:04:28.110 align:start position:0%
subquery we are writing it from bottom
to<00:04:25.800><c> top</c><00:04:26.240><c> so</c><00:04:26.440><c> first</c><00:04:26.720><c> we</c><00:04:26.880><c> have</c><00:04:27.080><c> this</c><00:04:27.240><c> inner</c><00:04:27.720><c> query</c>

00:04:28.110 --> 00:04:28.120 align:start position:0%
to top so first we have this inner query
 

00:04:28.120 --> 00:04:30.590 align:start position:0%
to top so first we have this inner query
the<00:04:28.440><c> subquery</c><00:04:29.440><c> and</c><00:04:29.600><c> then</c><00:04:29.759><c> then</c><00:04:29.919><c> on</c><00:04:30.120><c> top</c><00:04:30.280><c> of</c><00:04:30.440><c> it</c>

00:04:30.590 --> 00:04:30.600 align:start position:0%
the subquery and then then on top of it
 

00:04:30.600 --> 00:04:32.710 align:start position:0%
the subquery and then then on top of it
we<00:04:30.759><c> have</c><00:04:30.960><c> the</c><00:04:31.120><c> main</c><00:04:31.520><c> query</c><00:04:32.160><c> but</c><00:04:32.280><c> now</c><00:04:32.440><c> in</c><00:04:32.600><c> the</c>

00:04:32.710 --> 00:04:32.720 align:start position:0%
we have the main query but now in the
 

00:04:32.720 --> 00:04:34.590 align:start position:0%
we have the main query but now in the
other<00:04:32.919><c> hand</c><00:04:33.120><c> the</c><00:04:33.280><c> CTE</c><00:04:33.759><c> we</c><00:04:33.880><c> are</c><00:04:34.039><c> writing</c><00:04:34.400><c> it</c>

00:04:34.590 --> 00:04:34.600 align:start position:0%
other hand the CTE we are writing it
 

00:04:34.600 --> 00:04:37.110 align:start position:0%
other hand the CTE we are writing it
from<00:04:34.919><c> top</c><00:04:35.199><c> to</c><00:04:35.440><c> bottom</c><00:04:36.039><c> so</c><00:04:36.280><c> first</c><00:04:36.560><c> we</c><00:04:36.720><c> write</c>

00:04:37.110 --> 00:04:37.120 align:start position:0%
from top to bottom so first we write
 

00:04:37.120 --> 00:04:39.830 align:start position:0%
from top to bottom so first we write
this<00:04:37.320><c> inner</c><00:04:37.759><c> query</c><00:04:38.120><c> the</c><00:04:38.240><c> CTE</c><00:04:38.720><c> query</c><00:04:39.440><c> and</c><00:04:39.600><c> then</c>

00:04:39.830 --> 00:04:39.840 align:start position:0%
this inner query the CTE query and then
 

00:04:39.840 --> 00:04:41.830 align:start position:0%
this inner query the CTE query and then
beneath<00:04:40.320><c> it</c><00:04:40.720><c> we're</c><00:04:40.840><c> going</c><00:04:40.960><c> to</c><00:04:41.080><c> go</c><00:04:41.240><c> and</c><00:04:41.440><c> write</c>

00:04:41.830 --> 00:04:41.840 align:start position:0%
beneath it we're going to go and write
 

00:04:41.840 --> 00:04:43.830 align:start position:0%
beneath it we're going to go and write
the<00:04:42.000><c> main</c><00:04:42.320><c> query</c><00:04:42.840><c> so</c><00:04:43.039><c> this</c><00:04:43.160><c> is</c><00:04:43.320><c> the</c><00:04:43.479><c> first</c>

00:04:43.830 --> 00:04:43.840 align:start position:0%
the main query so this is the first
 

00:04:43.840 --> 00:04:45.990 align:start position:0%
the main query so this is the first
difference<00:04:44.280><c> between</c><00:04:44.639><c> them</c><00:04:45.039><c> on</c><00:04:45.280><c> the</c><00:04:45.479><c> way</c><00:04:45.840><c> we</c>

00:04:45.990 --> 00:04:46.000 align:start position:0%
difference between them on the way we
 

00:04:46.000 --> 00:04:48.070 align:start position:0%
difference between them on the way we
write<00:04:46.280><c> the</c><00:04:46.479><c> query</c><00:04:47.039><c> so</c><00:04:47.280><c> if</c><00:04:47.400><c> I'm</c><00:04:47.600><c> thinking</c><00:04:47.880><c> about</c>

00:04:48.070 --> 00:04:48.080 align:start position:0%
write the query so if I'm thinking about
 

00:04:48.080 --> 00:04:50.510 align:start position:0%
write the query so if I'm thinking about
subqueries<00:04:48.759><c> I</c><00:04:48.880><c> start</c><00:04:49.160><c> from</c><00:04:49.400><c> bottom</c><00:04:49.720><c> to</c><00:04:49.960><c> top</c><00:04:50.360><c> if</c>

00:04:50.510 --> 00:04:50.520 align:start position:0%
subqueries I start from bottom to top if
 

00:04:50.520 --> 00:04:52.710 align:start position:0%
subqueries I start from bottom to top if
I'm<00:04:50.720><c> thinking</c><00:04:51.039><c> about</c><00:04:51.240><c> CTE</c><00:04:51.759><c> I</c><00:04:51.880><c> think</c><00:04:52.160><c> from</c><00:04:52.520><c> top</c>

00:04:52.710 --> 00:04:52.720 align:start position:0%
I'm thinking about CTE I think from top
 

00:04:52.720 --> 00:04:54.670 align:start position:0%
I'm thinking about CTE I think from top
to<00:04:52.919><c> bottom</c><00:04:53.400><c> but</c><00:04:53.600><c> still</c><00:04:53.800><c> you</c><00:04:53.919><c> say</c><00:04:54.120><c> you</c><00:04:54.280><c> know</c><00:04:54.440><c> not</c>

00:04:54.670 --> 00:04:54.680 align:start position:0%
to bottom but still you say you know not
 

00:04:54.680 --> 00:04:56.350 align:start position:0%
to bottom but still you say you know not
I<00:04:54.759><c> don't</c><00:04:54.960><c> care</c><00:04:55.160><c> how</c><00:04:55.320><c> we</c><00:04:55.479><c> write</c><00:04:55.680><c> it</c><00:04:56.080><c> they</c><00:04:56.160><c> are</c>

00:04:56.350 --> 00:04:56.360 align:start position:0%
I don't care how we write it they are
 

00:04:56.360 --> 00:04:58.670 align:start position:0%
I don't care how we write it they are
doing<00:04:56.680><c> the</c><00:04:56.840><c> same</c><00:04:57.120><c> thing</c><00:04:57.600><c> the</c><00:04:57.759><c> subquery</c><00:04:58.400><c> is</c>

00:04:58.670 --> 00:04:58.680 align:start position:0%
doing the same thing the subquery is
 

00:04:58.680 --> 00:05:01.270 align:start position:0%
doing the same thing the subquery is
introducing<00:04:59.400><c> an</c><00:04:59.800><c> intermediate</c><00:05:00.479><c> results</c><00:05:01.120><c> that</c>

00:05:01.270 --> 00:05:01.280 align:start position:0%
introducing an intermediate results that
 

00:05:01.280 --> 00:05:04.189 align:start position:0%
introducing an intermediate results that
is<00:05:01.440><c> used</c><00:05:01.880><c> later</c><00:05:02.440><c> from</c><00:05:02.800><c> the</c><00:05:03.120><c> main</c><00:05:03.479><c> query</c><00:05:04.039><c> and</c>

00:05:04.189 --> 00:05:04.199 align:start position:0%
is used later from the main query and
 

00:05:04.199 --> 00:05:06.390 align:start position:0%
is used later from the main query and
the<00:05:04.320><c> same</c><00:05:04.520><c> thing</c><00:05:04.639><c> for</c><00:05:04.800><c> the</c><00:05:04.919><c> CTE</c><00:05:05.479><c> it</c><00:05:05.759><c> present</c>

00:05:06.390 --> 00:05:06.400 align:start position:0%
the same thing for the CTE it present
 

00:05:06.400 --> 00:05:08.749 align:start position:0%
the same thing for the CTE it present
like<00:05:06.639><c> intermediate</c><00:05:07.240><c> table</c><00:05:07.919><c> that</c><00:05:08.080><c> is</c><00:05:08.199><c> used</c><00:05:08.600><c> as</c>

00:05:08.749 --> 00:05:08.759 align:start position:0%
like intermediate table that is used as
 

00:05:08.759 --> 00:05:10.749 align:start position:0%
like intermediate table that is used as
well<00:05:08.919><c> from</c><00:05:09.080><c> the</c><00:05:09.199><c> main</c><00:05:09.440><c> query</c><00:05:10.080><c> now</c><00:05:10.280><c> let</c><00:05:10.440><c> me</c><00:05:10.600><c> tell</c>

00:05:10.749 --> 00:05:10.759 align:start position:0%
well from the main query now let me tell
 

00:05:10.759 --> 00:05:12.990 align:start position:0%
well from the main query now let me tell
you<00:05:11.000><c> the</c><00:05:11.240><c> big</c><00:05:11.479><c> differences</c><00:05:12.000><c> between</c><00:05:12.320><c> them</c><00:05:12.800><c> is</c>

00:05:12.990 --> 00:05:13.000 align:start position:0%
you the big differences between them is
 

00:05:13.000 --> 00:05:15.430 align:start position:0%
you the big differences between them is
that<00:05:13.280><c> in</c><00:05:13.440><c> the</c><00:05:13.720><c> subquery</c><00:05:14.400><c> the</c><00:05:14.600><c> result</c><00:05:15.120><c> can</c><00:05:15.280><c> be</c>

00:05:15.430 --> 00:05:15.440 align:start position:0%
that in the subquery the result can be
 

00:05:15.440 --> 00:05:18.029 align:start position:0%
that in the subquery the result can be
used<00:05:16.080><c> only</c><00:05:16.520><c> once</c><00:05:17.120><c> so</c><00:05:17.280><c> you</c><00:05:17.400><c> cannot</c><00:05:17.800><c> have</c>

00:05:18.029 --> 00:05:18.039 align:start position:0%
used only once so you cannot have
 

00:05:18.039 --> 00:05:20.350 align:start position:0%
used only once so you cannot have
another<00:05:18.440><c> place</c><00:05:18.680><c> in</c><00:05:18.840><c> your</c><00:05:19.039><c> main</c><00:05:19.400><c> query</c><00:05:20.160><c> where</c>

00:05:20.350 --> 00:05:20.360 align:start position:0%
another place in your main query where
 

00:05:20.360 --> 00:05:22.390 align:start position:0%
another place in your main query where
you<00:05:20.520><c> go</c><00:05:20.759><c> and</c><00:05:21.039><c> reuse</c><00:05:21.600><c> the</c><00:05:21.759><c> results</c><00:05:22.120><c> from</c><00:05:22.280><c> the</c>

00:05:22.390 --> 00:05:22.400 align:start position:0%
you go and reuse the results from the
 

00:05:22.400 --> 00:05:25.150 align:start position:0%
you go and reuse the results from the
subquery<00:05:23.160><c> so</c><00:05:23.360><c> you</c><00:05:23.520><c> can</c><00:05:23.759><c> use</c><00:05:23.960><c> it</c><00:05:24.240><c> maximum</c><00:05:24.880><c> only</c>

00:05:25.150 --> 00:05:25.160 align:start position:0%
subquery so you can use it maximum only
 

00:05:25.160 --> 00:05:27.950 align:start position:0%
subquery so you can use it maximum only
in<00:05:25.400><c> one</c><00:05:25.680><c> position</c><00:05:26.360><c> and</c><00:05:26.560><c> only</c><00:05:26.840><c> once</c><00:05:27.440><c> but</c><00:05:27.639><c> in</c><00:05:27.800><c> the</c>

00:05:27.950 --> 00:05:27.960 align:start position:0%
in one position and only once but in the
 

00:05:27.960 --> 00:05:30.110 align:start position:0%
in one position and only once but in the
other<00:05:28.240><c> hand</c><00:05:28.479><c> with</c><00:05:28.600><c> the</c><00:05:28.759><c> CTE</c><00:05:29.199><c> technique</c><00:05:29.960><c> you</c>

00:05:30.110 --> 00:05:30.120 align:start position:0%
other hand with the CTE technique you
 

00:05:30.120 --> 00:05:32.350 align:start position:0%
other hand with the CTE technique you
can<00:05:30.360><c> think</c><00:05:30.680><c> about</c><00:05:31.000><c> the</c><00:05:31.199><c> sales</c><00:05:31.600><c> table</c><00:05:32.000><c> as</c><00:05:32.120><c> a</c>

00:05:32.350 --> 00:05:32.360 align:start position:0%
can think about the sales table as a
 

00:05:32.360 --> 00:05:34.510 align:start position:0%
can think about the sales table as a
virtual<00:05:32.880><c> table</c><00:05:33.440><c> and</c><00:05:33.600><c> not</c><00:05:33.800><c> only</c><00:05:34.039><c> you</c><00:05:34.160><c> can</c><00:05:34.319><c> use</c>

00:05:34.510 --> 00:05:34.520 align:start position:0%
virtual table and not only you can use
 

00:05:34.520 --> 00:05:37.270 align:start position:0%
virtual table and not only you can use
it<00:05:34.680><c> in</c><00:05:34.880><c> one</c><00:05:35.199><c> place</c><00:05:35.600><c> in</c><00:05:35.759><c> the</c><00:05:35.919><c> main</c><00:05:36.240><c> query</c><00:05:37.120><c> you</c>

00:05:37.270 --> 00:05:37.280 align:start position:0%
it in one place in the main query you
 

00:05:37.280 --> 00:05:39.990 align:start position:0%
it in one place in the main query you
can<00:05:37.440><c> go</c><00:05:37.720><c> and</c><00:05:37.840><c> use</c><00:05:38.039><c> it</c><00:05:38.280><c> in</c><00:05:38.479><c> many</c><00:05:38.800><c> other</c><00:05:39.120><c> places</c>

00:05:39.990 --> 00:05:40.000 align:start position:0%
can go and use it in many other places
 

00:05:40.000 --> 00:05:42.270 align:start position:0%
can go and use it in many other places
so<00:05:40.199><c> you</c><00:05:40.319><c> can</c><00:05:40.520><c> go</c><00:05:40.680><c> and</c><00:05:40.880><c> join</c><00:05:41.160><c> it</c><00:05:41.400><c> again</c><00:05:41.919><c> so</c><00:05:42.120><c> that</c>

00:05:42.270 --> 00:05:42.280 align:start position:0%
so you can go and join it again so that
 

00:05:42.280 --> 00:05:44.950 align:start position:0%
so you can go and join it again so that
means<00:05:42.600><c> I'm</c><00:05:42.840><c> using</c><00:05:43.319><c> the</c><00:05:43.560><c> output</c><00:05:44.039><c> from</c><00:05:44.240><c> the</c><00:05:44.400><c> CTE</c>

00:05:44.950 --> 00:05:44.960 align:start position:0%
means I'm using the output from the CTE
 

00:05:44.960 --> 00:05:47.189 align:start position:0%
means I'm using the output from the CTE
query<00:05:45.520><c> in</c><00:05:45.800><c> two</c><00:05:46.120><c> different</c><00:05:46.560><c> places</c><00:05:46.960><c> in</c><00:05:47.080><c> the</c>

00:05:47.189 --> 00:05:47.199 align:start position:0%
query in two different places in the
 

00:05:47.199 --> 00:05:49.590 align:start position:0%
query in two different places in the
main<00:05:47.479><c> query</c><00:05:48.080><c> or</c><00:05:48.280><c> maybe</c><00:05:48.720><c> from</c><00:05:48.960><c> three</c><00:05:49.280><c> different</c>

00:05:49.590 --> 00:05:49.600 align:start position:0%
main query or maybe from three different
 

00:05:49.600 --> 00:05:51.350 align:start position:0%
main query or maybe from three different
places<00:05:50.000><c> so</c><00:05:50.120><c> you</c><00:05:50.240><c> can</c><00:05:50.440><c> have</c><00:05:50.639><c> another</c><00:05:51.039><c> place</c>

00:05:51.350 --> 00:05:51.360 align:start position:0%
places so you can have another place
 

00:05:51.360 --> 00:05:53.870 align:start position:0%
places so you can have another place
where<00:05:51.520><c> you</c><00:05:51.680><c> go</c><00:05:51.919><c> as</c><00:05:52.080><c> well</c><00:05:52.720><c> and</c><00:05:52.960><c> query</c><00:05:53.280><c> the</c><00:05:53.400><c> sales</c>

00:05:53.870 --> 00:05:53.880 align:start position:0%
where you go as well and query the sales
 

00:05:53.880 --> 00:05:55.830 align:start position:0%
where you go as well and query the sales
table<00:05:54.440><c> that</c><00:05:54.600><c> is</c><00:05:54.759><c> only</c><00:05:55.039><c> available</c><00:05:55.440><c> in</c><00:05:55.600><c> our</c>

00:05:55.830 --> 00:05:55.840 align:start position:0%
table that is only available in our
 

00:05:55.840 --> 00:05:58.150 align:start position:0%
table that is only available in our
query<00:05:56.479><c> so</c><00:05:56.800><c> this</c><00:05:56.960><c> is</c><00:05:57.199><c> the</c><00:05:57.360><c> main</c><00:05:57.680><c> and</c><00:05:57.840><c> the</c><00:05:57.960><c> most</c>

00:05:58.150 --> 00:05:58.160 align:start position:0%
query so this is the main and the most
 

00:05:58.160 --> 00:05:59.870 align:start position:0%
query so this is the main and the most
important<00:05:58.520><c> difference</c><00:05:58.840><c> between</c><00:05:59.120><c> the</c><00:05:59.240><c> sub</c><00:05:59.639><c> qu</c>

00:05:59.870 --> 00:05:59.880 align:start position:0%
important difference between the sub qu
 

00:05:59.880 --> 00:06:01.830 align:start position:0%
important difference between the sub qu
in<00:06:00.000><c> the</c><00:06:00.120><c> CTE</c><00:06:00.680><c> it's</c><00:06:00.800><c> from</c><00:06:01.000><c> the</c><00:06:01.120><c> name</c><00:06:01.479><c> Common</c>

00:06:01.830 --> 00:06:01.840 align:start position:0%
in the CTE it's from the name Common
 

00:06:01.840 --> 00:06:03.909 align:start position:0%
in the CTE it's from the name Common
Table<00:06:02.240><c> expression</c><00:06:02.919><c> we</c><00:06:03.120><c> think</c><00:06:03.479><c> about</c><00:06:03.759><c> the</c>

00:06:03.909 --> 00:06:03.919 align:start position:0%
Table expression we think about the
 

00:06:03.919 --> 00:06:07.270 align:start position:0%
Table expression we think about the
result<00:06:04.280><c> of</c><00:06:04.440><c> the</c><00:06:04.680><c> CTE</c><00:06:05.680><c> as</c><00:06:06.080><c> a</c><00:06:06.280><c> table</c><00:06:06.840><c> so</c><00:06:07.000><c> we</c><00:06:07.120><c> can</c>

00:06:07.270 --> 00:06:07.280 align:start position:0%
result of the CTE as a table so we can
 

00:06:07.280 --> 00:06:09.469 align:start position:0%
result of the CTE as a table so we can
go<00:06:07.440><c> and</c><00:06:07.759><c> select</c><00:06:08.160><c> it</c><00:06:08.400><c> we</c><00:06:08.520><c> can</c><00:06:08.680><c> go</c><00:06:08.840><c> and</c><00:06:09.039><c> join</c><00:06:09.319><c> it</c>

00:06:09.469 --> 00:06:09.479 align:start position:0%
go and select it we can go and join it
 

00:06:09.479 --> 00:06:11.670 align:start position:0%
go and select it we can go and join it
with<00:06:09.680><c> any</c><00:06:09.919><c> other</c><00:06:10.160><c> table</c><00:06:10.759><c> so</c><00:06:11.000><c> it</c><00:06:11.120><c> is</c><00:06:11.319><c> like</c><00:06:11.520><c> a</c>

00:06:11.670 --> 00:06:11.680 align:start position:0%
with any other table so it is like a
 

00:06:11.680 --> 00:06:14.270 align:start position:0%
with any other table so it is like a
hidden<00:06:12.039><c> virtual</c><00:06:12.520><c> table</c><00:06:13.080><c> lives</c><00:06:13.599><c> inside</c><00:06:14.000><c> our</c>

00:06:14.270 --> 00:06:14.280 align:start position:0%
hidden virtual table lives inside our
 

00:06:14.280 --> 00:06:16.430 align:start position:0%
hidden virtual table lives inside our
query<00:06:14.800><c> but</c><00:06:14.960><c> the</c><00:06:15.120><c> subqueries</c><00:06:15.880><c> it's</c><00:06:16.039><c> totally</c>

00:06:16.430 --> 00:06:16.440 align:start position:0%
query but the subqueries it's totally
 

00:06:16.440 --> 00:06:18.790 align:start position:0%
query but the subqueries it's totally
different<00:06:16.880><c> it's</c><00:06:17.080><c> a</c><00:06:17.280><c> results</c><00:06:17.840><c> only</c><00:06:18.080><c> for</c><00:06:18.440><c> one</c>

00:06:18.790 --> 00:06:18.800 align:start position:0%
different it's a results only for one
 

00:06:18.800 --> 00:06:21.510 align:start position:0%
different it's a results only for one
position<00:06:19.280><c> in</c><00:06:19.400><c> the</c><00:06:19.560><c> main</c><00:06:19.800><c> query</c><00:06:20.639><c> and</c><00:06:20.880><c> it's</c><00:06:21.080><c> used</c>

00:06:21.510 --> 00:06:21.520 align:start position:0%
position in the main query and it's used
 

00:06:21.520 --> 00:06:23.629 align:start position:0%
position in the main query and it's used
only<00:06:21.880><c> once</c><00:06:22.440><c> so</c><00:06:22.639><c> that</c><00:06:22.759><c> means</c><00:06:23.039><c> if</c><00:06:23.120><c> you</c><00:06:23.240><c> want</c><00:06:23.440><c> the</c>

00:06:23.629 --> 00:06:23.639 align:start position:0%
only once so that means if you want the
 

00:06:23.639 --> 00:06:25.790 align:start position:0%
only once so that means if you want the
subquery<00:06:24.160><c> in</c><00:06:24.319><c> two</c><00:06:24.520><c> three</c><00:06:24.759><c> different</c><00:06:25.120><c> places</c>

00:06:25.790 --> 00:06:25.800 align:start position:0%
subquery in two three different places
 

00:06:25.800 --> 00:06:28.390 align:start position:0%
subquery in two three different places
you<00:06:25.960><c> have</c><00:06:26.080><c> to</c><00:06:26.240><c> go</c><00:06:26.400><c> and</c><00:06:26.639><c> write</c><00:06:27.039><c> the</c><00:06:27.400><c> subquery</c>

00:06:28.390 --> 00:06:28.400 align:start position:0%
you have to go and write the subquery
 

00:06:28.400 --> 00:06:30.589 align:start position:0%
you have to go and write the subquery
three<00:06:28.919><c> different</c><00:06:29.280><c> times</c><00:06:29.880><c> so</c><00:06:30.039><c> now</c><00:06:30.199><c> you</c>

00:06:30.589 --> 00:06:30.599 align:start position:0%
three different times so now you
 

00:06:30.599 --> 00:06:32.469 align:start position:0%
three different times so now you
understand<00:06:31.000><c> why</c><00:06:31.160><c> do</c><00:06:31.280><c> we</c><00:06:31.440><c> have</c><00:06:31.560><c> CTE</c><00:06:32.080><c> and</c><00:06:32.240><c> why</c><00:06:32.360><c> do</c>

00:06:32.469 --> 00:06:32.479 align:start position:0%
understand why do we have CTE and why do
 

00:06:32.479 --> 00:06:36.870 align:start position:0%
understand why do we have CTE and why do
we<00:06:32.560><c> have</c>

00:06:36.870 --> 00:06:36.880 align:start position:0%
 
 

00:06:36.880 --> 00:06:38.749 align:start position:0%
 
subqueries<00:06:37.880><c> all</c><00:06:38.039><c> right</c><00:06:38.199><c> so</c><00:06:38.360><c> with</c><00:06:38.520><c> that</c><00:06:38.639><c> you</c>

00:06:38.749 --> 00:06:38.759 align:start position:0%
subqueries all right so with that you
 

00:06:38.759 --> 00:06:41.029 align:start position:0%
subqueries all right so with that you
have<00:06:38.919><c> understood</c><00:06:39.520><c> what</c><00:06:39.680><c> is</c><00:06:39.840><c> CTE</c><00:06:40.680><c> now</c><00:06:40.880><c> the</c>

00:06:41.029 --> 00:06:41.039 align:start position:0%
have understood what is CTE now the
 

00:06:41.039 --> 00:06:43.270 align:start position:0%
have understood what is CTE now the
question<00:06:41.400><c> is</c><00:06:42.080><c> why</c><00:06:42.199><c> do</c><00:06:42.319><c> we</c><00:06:42.440><c> need</c><00:06:42.599><c> CTE</c><00:06:43.039><c> in</c><00:06:43.120><c> the</c>

00:06:43.270 --> 00:06:43.280 align:start position:0%
question is why do we need CTE in the
 

00:06:43.280 --> 00:06:45.629 align:start position:0%
question is why do we need CTE in the
first<00:06:43.520><c> place</c><00:06:44.120><c> what</c><00:06:44.280><c> is</c><00:06:44.520><c> the</c><00:06:44.720><c> main</c><00:06:44.960><c> purpose</c><00:06:45.319><c> of</c>

00:06:45.629 --> 00:06:45.639 align:start position:0%
first place what is the main purpose of
 

00:06:45.639 --> 00:06:48.230 align:start position:0%
first place what is the main purpose of
the<00:06:45.800><c> CTE</c><00:06:46.639><c> let's</c><00:06:46.840><c> go</c><00:06:47.039><c> back</c><00:06:47.160><c> to</c><00:06:47.280><c> the</c><00:06:47.440><c> sketch</c><00:06:48.080><c> now</c>

00:06:48.230 --> 00:06:48.240 align:start position:0%
the CTE let's go back to the sketch now
 

00:06:48.240 --> 00:06:50.589 align:start position:0%
the CTE let's go back to the sketch now
let's<00:06:48.400><c> say</c><00:06:48.599><c> in</c><00:06:48.759><c> our</c><00:06:49.120><c> complex</c><00:06:49.560><c> SQL</c><00:06:50.039><c> task</c><00:06:50.479><c> we</c>

00:06:50.589 --> 00:06:50.599 align:start position:0%
let's say in our complex SQL task we
 

00:06:50.599 --> 00:06:52.629 align:start position:0%
let's say in our complex SQL task we
have<00:06:50.720><c> to</c><00:06:50.840><c> do</c><00:06:51.039><c> the</c><00:06:51.160><c> following</c><00:06:51.599><c> step</c><00:06:52.160><c> step</c><00:06:52.400><c> one</c>

00:06:52.629 --> 00:06:52.639 align:start position:0%
have to do the following step step one
 

00:06:52.639 --> 00:06:54.390 align:start position:0%
have to do the following step step one
we<00:06:52.759><c> have</c><00:06:52.880><c> to</c><00:06:53.039><c> go</c><00:06:53.199><c> and</c><00:06:53.440><c> join</c><00:06:53.759><c> the</c><00:06:53.919><c> tables</c>

00:06:54.390 --> 00:06:54.400 align:start position:0%
we have to go and join the tables
 

00:06:54.400 --> 00:06:56.070 align:start position:0%
we have to go and join the tables
together<00:06:54.840><c> in</c><00:06:54.960><c> order</c><00:06:55.240><c> to</c><00:06:55.440><c> prepare</c><00:06:55.759><c> all</c><00:06:55.919><c> the</c>

00:06:56.070 --> 00:06:56.080 align:start position:0%
together in order to prepare all the
 

00:06:56.080 --> 00:06:58.309 align:start position:0%
together in order to prepare all the
data<00:06:56.360><c> that</c><00:06:56.520><c> we</c><00:06:56.639><c> need</c><00:06:57.199><c> for</c><00:06:57.400><c> the</c><00:06:57.599><c> next</c><00:06:57.879><c> step</c><00:06:58.199><c> and</c>

00:06:58.309 --> 00:06:58.319 align:start position:0%
data that we need for the next step and
 

00:06:58.319 --> 00:07:00.110 align:start position:0%
data that we need for the next step and
now<00:06:58.479><c> in</c><00:06:58.599><c> the</c><00:06:58.759><c> second</c><00:06:59.080><c> step</c><00:06:59.280><c> we</c><00:06:59.400><c> have</c><00:06:59.680><c> to</c><00:06:59.800><c> go</c><00:06:59.919><c> and</c>

00:07:00.110 --> 00:07:00.120 align:start position:0%
now in the second step we have to go and
 

00:07:00.120 --> 00:07:01.909 align:start position:0%
now in the second step we have to go and
aggregate<00:07:00.520><c> the</c><00:07:00.680><c> data</c><00:07:01.000><c> Maybe</c><00:07:01.240><c> we</c><00:07:01.319><c> are</c><00:07:01.479><c> doing</c>

00:07:01.909 --> 00:07:01.919 align:start position:0%
aggregate the data Maybe we are doing
 

00:07:01.919 --> 00:07:04.029 align:start position:0%
aggregate the data Maybe we are doing
summarizations<00:07:02.919><c> now</c><00:07:03.080><c> in</c><00:07:03.240><c> our</c><00:07:03.520><c> task</c><00:07:03.800><c> we</c><00:07:03.919><c> have</c>

00:07:04.029 --> 00:07:04.039 align:start position:0%
summarizations now in our task we have
 

00:07:04.039 --> 00:07:05.990 align:start position:0%
summarizations now in our task we have
to<00:07:04.199><c> do</c><00:07:04.440><c> as</c><00:07:04.599><c> well</c><00:07:05.199><c> different</c><00:07:05.560><c> types</c><00:07:05.800><c> of</c>

00:07:05.990 --> 00:07:06.000 align:start position:0%
to do as well different types of
 

00:07:06.000 --> 00:07:08.390 align:start position:0%
to do as well different types of
aggregations<00:07:06.720><c> based</c><00:07:07.039><c> on</c><00:07:07.280><c> different</c><00:07:07.759><c> data</c><00:07:08.280><c> and</c>

00:07:08.390 --> 00:07:08.400 align:start position:0%
aggregations based on different data and
 

00:07:08.400 --> 00:07:10.029 align:start position:0%
aggregations based on different data and
now<00:07:08.599><c> what</c><00:07:08.759><c> might</c><00:07:09.000><c> happen</c><00:07:09.240><c> is</c><00:07:09.400><c> that</c><00:07:09.599><c> we</c><00:07:09.759><c> have</c><00:07:09.879><c> to</c>

00:07:10.029 --> 00:07:10.039 align:start position:0%
now what might happen is that we have to
 

00:07:10.039 --> 00:07:12.390 align:start position:0%
now what might happen is that we have to
go<00:07:10.199><c> and</c><00:07:10.440><c> join</c><00:07:10.840><c> again</c><00:07:11.160><c> the</c><00:07:11.319><c> same</c><00:07:11.599><c> tables</c><00:07:12.240><c> in</c>

00:07:12.390 --> 00:07:12.400 align:start position:0%
go and join again the same tables in
 

00:07:12.400 --> 00:07:14.670 align:start position:0%
go and join again the same tables in
order<00:07:12.639><c> to</c><00:07:12.840><c> prepare</c><00:07:13.160><c> the</c><00:07:13.319><c> data</c><00:07:13.599><c> and</c><00:07:13.800><c> perform</c>

00:07:14.670 --> 00:07:14.680 align:start position:0%
order to prepare the data and perform
 

00:07:14.680 --> 00:07:16.830 align:start position:0%
order to prepare the data and perform
different<00:07:15.039><c> type</c><00:07:15.240><c> of</c><00:07:15.400><c> aggregations</c><00:07:16.400><c> like</c><00:07:16.599><c> for</c>

00:07:16.830 --> 00:07:16.840 align:start position:0%
different type of aggregations like for
 

00:07:16.840 --> 00:07:18.749 align:start position:0%
different type of aggregations like for
example<00:07:17.280><c> the</c><00:07:17.400><c> average</c><00:07:18.039><c> which</c><00:07:18.199><c> going</c><00:07:18.360><c> to</c><00:07:18.479><c> be</c><00:07:18.639><c> in</c>

00:07:18.749 --> 00:07:18.759 align:start position:0%
example the average which going to be in
 

00:07:18.759 --> 00:07:20.710 align:start position:0%
example the average which going to be in
the<00:07:18.919><c> last</c><00:07:19.160><c> step</c><00:07:19.800><c> now</c><00:07:19.960><c> we</c><00:07:20.039><c> have</c><00:07:20.160><c> learned</c><00:07:20.479><c> before</c>

00:07:20.710 --> 00:07:20.720 align:start position:0%
the last step now we have learned before
 

00:07:20.720 --> 00:07:22.710 align:start position:0%
the last step now we have learned before
we<00:07:20.840><c> can</c><00:07:21.000><c> go</c><00:07:21.120><c> and</c><00:07:21.319><c> use</c><00:07:21.599><c> the</c><00:07:21.759><c> subqueries</c><00:07:22.560><c> in</c>

00:07:22.710 --> 00:07:22.720 align:start position:0%
we can go and use the subqueries in
 

00:07:22.720 --> 00:07:25.150 align:start position:0%
we can go and use the subqueries in
order<00:07:23.039><c> to</c><00:07:23.199><c> make</c><00:07:23.560><c> this</c><00:07:23.720><c> logical</c><00:07:24.120><c> flow</c><00:07:24.720><c> so</c><00:07:24.919><c> for</c>

00:07:25.150 --> 00:07:25.160 align:start position:0%
order to make this logical flow so for
 

00:07:25.160 --> 00:07:27.110 align:start position:0%
order to make this logical flow so for
step<00:07:25.400><c> one</c><00:07:25.680><c> step</c><00:07:25.879><c> two</c><00:07:26.160><c> step</c><00:07:26.400><c> three</c><00:07:26.840><c> we</c><00:07:26.919><c> will</c>

00:07:27.110 --> 00:07:27.120 align:start position:0%
step one step two step three we will
 

00:07:27.120 --> 00:07:29.230 align:start position:0%
step one step two step three we will
have<00:07:27.280><c> some</c><00:07:27.599><c> queries</c><00:07:28.360><c> and</c><00:07:28.520><c> the</c><00:07:28.720><c> final</c><00:07:29.000><c> step</c>

00:07:29.230 --> 00:07:29.240 align:start position:0%
have some queries and the final step
 

00:07:29.240 --> 00:07:31.629 align:start position:0%
have some queries and the final step
going<00:07:29.319><c> to</c><00:07:29.400><c> be</c><00:07:29.599><c> be</c><00:07:30.080><c> in</c><00:07:30.240><c> the</c><00:07:30.400><c> main</c><00:07:30.720><c> query</c><00:07:31.319><c> but</c><00:07:31.479><c> now</c>

00:07:31.629 --> 00:07:31.639 align:start position:0%
going to be be in the main query but now
 

00:07:31.639 --> 00:07:33.869 align:start position:0%
going to be be in the main query but now
if<00:07:31.759><c> we</c><00:07:32.000><c> keep</c><00:07:32.240><c> doing</c><00:07:32.639><c> this</c><00:07:33.039><c> we</c><00:07:33.199><c> going</c><00:07:33.319><c> to</c><00:07:33.479><c> have</c><00:07:33.639><c> a</c>

00:07:33.869 --> 00:07:33.879 align:start position:0%
if we keep doing this we going to have a
 

00:07:33.879 --> 00:07:36.550 align:start position:0%
if we keep doing this we going to have a
problem<00:07:34.479><c> and</c><00:07:34.680><c> that</c><00:07:34.840><c> is</c><00:07:35.280><c> we</c><00:07:35.440><c> are</c><00:07:35.720><c> repeating</c><00:07:36.360><c> the</c>

00:07:36.550 --> 00:07:36.560 align:start position:0%
problem and that is we are repeating the
 

00:07:36.560 --> 00:07:38.909 align:start position:0%
problem and that is we are repeating the
same<00:07:36.879><c> step</c><00:07:37.520><c> more</c><00:07:37.720><c> than</c><00:07:37.879><c> once</c><00:07:38.440><c> so</c><00:07:38.599><c> we</c><00:07:38.720><c> are</c>

00:07:38.909 --> 00:07:38.919 align:start position:0%
same step more than once so we are
 

00:07:38.919 --> 00:07:41.070 align:start position:0%
same step more than once so we are
joining<00:07:39.360><c> the</c><00:07:39.560><c> table</c><00:07:39.960><c> twice</c><00:07:40.360><c> in</c><00:07:40.520><c> Step</c><00:07:40.800><c> number</c>

00:07:41.070 --> 00:07:41.080 align:start position:0%
joining the table twice in Step number
 

00:07:41.080 --> 00:07:43.270 align:start position:0%
joining the table twice in Step number
one<00:07:41.400><c> and</c><00:07:41.599><c> three</c><00:07:42.080><c> for</c><00:07:42.319><c> different</c><00:07:42.639><c> purposes</c>

00:07:43.270 --> 00:07:43.280 align:start position:0%
one and three for different purposes
 

00:07:43.280 --> 00:07:45.710 align:start position:0%
one and three for different purposes
which<00:07:43.520><c> cause</c><00:07:43.840><c> us</c><00:07:44.000><c> to</c><00:07:44.280><c> have</c><00:07:44.879><c> two</c><00:07:45.240><c> different</c>

00:07:45.710 --> 00:07:45.720 align:start position:0%
which cause us to have two different
 

00:07:45.720 --> 00:07:48.350 align:start position:0%
which cause us to have two different
subqueries<00:07:46.720><c> that</c><00:07:46.919><c> looks</c><00:07:47.319><c> exactly</c><00:07:47.759><c> the</c><00:07:47.919><c> same</c>

00:07:48.350 --> 00:07:48.360 align:start position:0%
subqueries that looks exactly the same
 

00:07:48.360 --> 00:07:50.230 align:start position:0%
subqueries that looks exactly the same
and<00:07:48.520><c> this</c><00:07:48.639><c> is</c><00:07:48.879><c> exactly</c><00:07:49.319><c> the</c><00:07:49.479><c> weak</c><00:07:49.840><c> point</c><00:07:50.120><c> of</c>

00:07:50.230 --> 00:07:50.240 align:start position:0%
and this is exactly the weak point of
 

00:07:50.240 --> 00:07:53.029 align:start position:0%
and this is exactly the weak point of
the<00:07:50.479><c> subqueries</c><00:07:51.479><c> it</c><00:07:51.720><c> might</c><00:07:52.280><c> introduce</c>

00:07:53.029 --> 00:07:53.039 align:start position:0%
the subqueries it might introduce
 

00:07:53.039 --> 00:07:54.950 align:start position:0%
the subqueries it might introduce
redundancies<00:07:54.039><c> so</c><00:07:54.240><c> that</c><00:07:54.400><c> means</c><00:07:54.800><c> the</c>

00:07:54.950 --> 00:07:54.960 align:start position:0%
redundancies so that means the
 

00:07:54.960 --> 00:07:57.189 align:start position:0%
redundancies so that means the
subqueries<00:07:55.639><c> alone</c><00:07:56.199><c> will</c><00:07:56.440><c> not</c><00:07:56.720><c> help</c><00:07:56.919><c> you</c><00:07:57.039><c> to</c>

00:07:57.189 --> 00:07:57.199 align:start position:0%
subqueries alone will not help you to
 

00:07:57.199 --> 00:07:59.510 align:start position:0%
subqueries alone will not help you to
eliminate<00:07:57.759><c> all</c><00:07:58.000><c> the</c><00:07:58.479><c> duplicates</c><00:07:59.080><c> in</c><00:07:59.199><c> your</c>

00:07:59.510 --> 00:07:59.520 align:start position:0%
eliminate all the duplicates in your
 

00:07:59.520 --> 00:08:01.189 align:start position:0%
eliminate all the duplicates in your
code<00:08:00.039><c> but</c><00:08:00.240><c> still</c><00:08:00.560><c> we</c><00:08:00.720><c> have</c><00:08:00.919><c> different</c>

00:08:01.189 --> 00:08:01.199 align:start position:0%
code but still we have different
 

00:08:01.199 --> 00:08:03.230 align:start position:0%
code but still we have different
techniques<00:08:01.639><c> in</c><00:08:01.759><c> order</c><00:08:02.000><c> to</c><00:08:02.159><c> solve</c><00:08:02.599><c> this</c><00:08:02.800><c> issue</c>

00:08:03.230 --> 00:08:03.240 align:start position:0%
techniques in order to solve this issue
 

00:08:03.240 --> 00:08:04.589 align:start position:0%
techniques in order to solve this issue
so<00:08:03.400><c> what</c><00:08:03.520><c> we</c><00:08:03.639><c> going</c><00:08:03.759><c> to</c><00:08:03.879><c> do</c><00:08:04.199><c> we're</c><00:08:04.319><c> going</c><00:08:04.440><c> to</c>

00:08:04.589 --> 00:08:04.599 align:start position:0%
so what we going to do we're going to
 

00:08:04.599 --> 00:08:07.309 align:start position:0%
so what we going to do we're going to
have<00:08:05.000><c> only</c><00:08:05.440><c> one</c><00:08:05.800><c> step</c><00:08:06.360><c> in</c><00:08:06.520><c> order</c><00:08:06.759><c> to</c><00:08:06.919><c> join</c><00:08:07.159><c> the</c>

00:08:07.309 --> 00:08:07.319 align:start position:0%
have only one step in order to join the
 

00:08:07.319 --> 00:08:09.390 align:start position:0%
have only one step in order to join the
tables<00:08:08.039><c> and</c><00:08:08.159><c> then</c><00:08:08.360><c> this</c><00:08:08.560><c> data</c><00:08:08.759><c> can</c><00:08:08.879><c> to</c><00:08:08.960><c> be</c><00:08:09.120><c> used</c>

00:08:09.390 --> 00:08:09.400 align:start position:0%
tables and then this data can to be used
 

00:08:09.400 --> 00:08:11.309 align:start position:0%
tables and then this data can to be used
in<00:08:09.560><c> the</c><00:08:09.759><c> step</c><00:08:10.000><c> two</c><00:08:10.280><c> in</c><00:08:10.400><c> order</c><00:08:10.720><c> to</c><00:08:10.919><c> aggregate</c>

00:08:11.309 --> 00:08:11.319 align:start position:0%
in the step two in order to aggregate
 

00:08:11.319 --> 00:08:13.670 align:start position:0%
in the step two in order to aggregate
the<00:08:11.520><c> data</c><00:08:12.039><c> and</c><00:08:12.159><c> then</c><00:08:12.319><c> we</c><00:08:12.479><c> don't</c><00:08:12.759><c> need</c><00:08:13.199><c> the</c><00:08:13.400><c> step</c>

00:08:13.670 --> 00:08:13.680 align:start position:0%
the data and then we don't need the step
 

00:08:13.680 --> 00:08:15.710 align:start position:0%
the data and then we don't need the step
three<00:08:14.039><c> of</c><00:08:14.199><c> joining</c><00:08:14.639><c> again</c><00:08:14.919><c> the</c><00:08:15.080><c> data</c><00:08:15.599><c> we're</c>

00:08:15.710 --> 00:08:15.720 align:start position:0%
three of joining again the data we're
 

00:08:15.720 --> 00:08:18.230 align:start position:0%
three of joining again the data we're
going<00:08:15.840><c> to</c><00:08:16.120><c> reuse</c><00:08:16.960><c> the</c><00:08:17.159><c> step</c><00:08:17.440><c> one</c><00:08:18.000><c> and</c><00:08:18.120><c> we're</c>

00:08:18.230 --> 00:08:18.240 align:start position:0%
going to reuse the step one and we're
 

00:08:18.240 --> 00:08:20.710 align:start position:0%
going to reuse the step one and we're
going<00:08:18.360><c> to</c><00:08:18.520><c> use</c><00:08:18.960><c> the</c><00:08:19.199><c> same</c><00:08:19.520><c> data</c><00:08:19.840><c> for</c><00:08:20.159><c> the</c><00:08:20.479><c> step</c>

00:08:20.710 --> 00:08:20.720 align:start position:0%
going to use the same data for the step
 

00:08:20.720 --> 00:08:23.070 align:start position:0%
going to use the same data for the step
four<00:08:21.120><c> which</c><00:08:21.240><c> is</c><00:08:21.479><c> aggregating</c><00:08:22.000><c> the</c><00:08:22.199><c> data</c><00:08:22.720><c> using</c>

00:08:23.070 --> 00:08:23.080 align:start position:0%
four which is aggregating the data using
 

00:08:23.080 --> 00:08:25.589 align:start position:0%
four which is aggregating the data using
aage<00:08:23.800><c> and</c><00:08:23.960><c> we</c><00:08:24.080><c> can</c><00:08:24.319><c> do</c><00:08:24.599><c> this</c><00:08:24.879><c> with</c><00:08:25.039><c> the</c><00:08:25.199><c> help</c><00:08:25.440><c> of</c>

00:08:25.589 --> 00:08:25.599 align:start position:0%
aage and we can do this with the help of
 

00:08:25.599 --> 00:08:27.909 align:start position:0%
aage and we can do this with the help of
the<00:08:25.840><c> amazing</c><00:08:26.440><c> CTE</c><00:08:27.120><c> so</c><00:08:27.240><c> now</c><00:08:27.360><c> if</c><00:08:27.440><c> you</c><00:08:27.560><c> compare</c>

00:08:27.909 --> 00:08:27.919 align:start position:0%
the amazing CTE so now if you compare
 

00:08:27.919 --> 00:08:29.629 align:start position:0%
the amazing CTE so now if you compare
the<00:08:28.039><c> steps</c><00:08:28.319><c> in</c><00:08:28.440><c> the</c><00:08:28.560><c> subqueries</c><00:08:29.199><c> with</c><00:08:29.520><c> the</c>

00:08:29.629 --> 00:08:29.639 align:start position:0%
the steps in the subqueries with the
 

00:08:29.639 --> 00:08:31.749 align:start position:0%
the steps in the subqueries with the
steps<00:08:29.919><c> with</c><00:08:30.039><c> the</c><00:08:30.159><c> CTE</c><00:08:30.599><c> you</c><00:08:30.720><c> can</c><00:08:30.919><c> see</c><00:08:31.440><c> with</c><00:08:31.639><c> the</c>

00:08:31.749 --> 00:08:31.759 align:start position:0%
steps with the CTE you can see with the
 

00:08:31.759 --> 00:08:34.750 align:start position:0%
steps with the CTE you can see with the
CTE<00:08:32.279><c> we</c><00:08:32.399><c> are</c><00:08:32.640><c> reducing</c><00:08:33.640><c> the</c><00:08:33.800><c> number</c><00:08:34.039><c> of</c><00:08:34.200><c> steps</c>

00:08:34.750 --> 00:08:34.760 align:start position:0%
CTE we are reducing the number of steps
 

00:08:34.760 --> 00:08:37.509 align:start position:0%
CTE we are reducing the number of steps
which<00:08:34.959><c> can</c><00:08:35.200><c> lead</c><00:08:35.519><c> to</c><00:08:35.760><c> reduce</c><00:08:36.440><c> the</c><00:08:36.680><c> size</c><00:08:37.080><c> of</c><00:08:37.279><c> the</c>

00:08:37.509 --> 00:08:37.519 align:start position:0%
which can lead to reduce the size of the
 

00:08:37.519 --> 00:08:39.829 align:start position:0%
which can lead to reduce the size of the
query<00:08:38.039><c> so</c><00:08:38.200><c> now</c><00:08:38.399><c> again</c><00:08:38.640><c> here</c><00:08:38.880><c> in</c><00:08:39.080><c> subquery</c><00:08:39.680><c> we</c>

00:08:39.829 --> 00:08:39.839 align:start position:0%
query so now again here in subquery we
 

00:08:39.839 --> 00:08:42.550 align:start position:0%
query so now again here in subquery we
think<00:08:40.080><c> about</c><00:08:40.320><c> the</c><00:08:40.479><c> steps</c><00:08:41.240><c> from</c><00:08:41.519><c> bottom</c><00:08:41.839><c> to</c><00:08:42.039><c> top</c>

00:08:42.550 --> 00:08:42.560 align:start position:0%
think about the steps from bottom to top
 

00:08:42.560 --> 00:08:44.829 align:start position:0%
think about the steps from bottom to top
but<00:08:42.719><c> in</c><00:08:42.880><c> the</c><00:08:43.000><c> CTE</c><00:08:43.479><c> it's</c><00:08:43.719><c> the</c><00:08:43.839><c> way</c><00:08:44.080><c> around</c><00:08:44.680><c> we</c>

00:08:44.829 --> 00:08:44.839 align:start position:0%
but in the CTE it's the way around we
 

00:08:44.839 --> 00:08:46.910 align:start position:0%
but in the CTE it's the way around we
think<00:08:45.080><c> from</c><00:08:45.480><c> top</c><00:08:45.760><c> to</c><00:08:45.959><c> button</c><00:08:46.399><c> so</c><00:08:46.519><c> that</c><00:08:46.640><c> means</c>

00:08:46.910 --> 00:08:46.920 align:start position:0%
think from top to button so that means
 

00:08:46.920 --> 00:08:48.310 align:start position:0%
think from top to button so that means
the<00:08:47.040><c> first</c><00:08:47.279><c> step</c><00:08:47.519><c> on</c><00:08:47.640><c> the</c><00:08:47.800><c> top</c><00:08:48.000><c> it's</c><00:08:48.120><c> going</c><00:08:48.240><c> to</c>

00:08:48.310 --> 00:08:48.320 align:start position:0%
the first step on the top it's going to
 

00:08:48.320 --> 00:08:50.430 align:start position:0%
the first step on the top it's going to
be<00:08:48.560><c> joining</c><00:08:48.920><c> the</c><00:08:49.080><c> tables</c><00:08:49.680><c> and</c><00:08:49.800><c> then</c><00:08:50.000><c> below</c><00:08:50.279><c> it</c>

00:08:50.430 --> 00:08:50.440 align:start position:0%
be joining the tables and then below it
 

00:08:50.440 --> 00:08:52.150 align:start position:0%
be joining the tables and then below it
going<00:08:50.560><c> to</c><00:08:50.640><c> be</c><00:08:50.800><c> step</c><00:08:51.000><c> two</c><00:08:51.200><c> and</c><00:08:51.399><c> step</c><00:08:51.640><c> three</c><00:08:52.040><c> and</c>

00:08:52.150 --> 00:08:52.160 align:start position:0%
going to be step two and step three and
 

00:08:52.160 --> 00:08:53.470 align:start position:0%
going to be step two and step three and
of<00:08:52.279><c> course</c><00:08:52.480><c> since</c><00:08:52.640><c> we</c><00:08:52.760><c> are</c><00:08:52.920><c> repeating</c><00:08:53.240><c> the</c>

00:08:53.470 --> 00:08:53.480 align:start position:0%
of course since we are repeating the
 

00:08:53.480 --> 00:08:55.829 align:start position:0%
of course since we are repeating the
join<00:08:53.959><c> we</c><00:08:54.080><c> can</c><00:08:54.200><c> to</c><00:08:54.360><c> put</c><00:08:54.519><c> it</c><00:08:54.600><c> in</c><00:08:54.800><c> CTE</c><00:08:55.519><c> and</c><00:08:55.640><c> then</c><00:08:55.760><c> we</c>

00:08:55.829 --> 00:08:55.839 align:start position:0%
join we can to put it in CTE and then we
 

00:08:55.839 --> 00:08:58.630 align:start position:0%
join we can to put it in CTE and then we
can<00:08:56.040><c> use</c><00:08:56.240><c> it</c><00:08:56.440><c> twice</c><00:08:56.880><c> in</c><00:08:57.120><c> different</c><00:08:57.519><c> places</c><00:08:58.440><c> in</c>

00:08:58.630 --> 00:08:58.640 align:start position:0%
can use it twice in different places in
 

00:08:58.640 --> 00:09:00.470 align:start position:0%
can use it twice in different places in
the<00:08:58.800><c> main</c><00:08:59.120><c> query</c><00:08:59.760><c> so</c><00:08:59.920><c> as</c><00:09:00.000><c> you</c><00:09:00.079><c> can</c><00:09:00.200><c> see</c><00:09:00.360><c> there</c>

00:09:00.470 --> 00:09:00.480 align:start position:0%
the main query so as you can see there
 

00:09:00.480 --> 00:09:02.710 align:start position:0%
the main query so as you can see there
are<00:09:00.640><c> a</c><00:09:00.760><c> lot</c><00:09:00.920><c> of</c><00:09:01.079><c> benefits</c><00:09:01.519><c> of</c><00:09:01.680><c> the</c><00:09:01.800><c> CTE</c><00:09:02.560><c> it's</c>

00:09:02.710 --> 00:09:02.720 align:start position:0%
are a lot of benefits of the CTE it's
 

00:09:02.720 --> 00:09:04.750 align:start position:0%
are a lot of benefits of the CTE it's
like<00:09:02.920><c> the</c><00:09:03.040><c> subqueries</c><00:09:03.680><c> we</c><00:09:03.800><c> are</c><00:09:04.040><c> breaking</c><00:09:04.440><c> down</c>

00:09:04.750 --> 00:09:04.760 align:start position:0%
like the subqueries we are breaking down
 

00:09:04.760 --> 00:09:07.630 align:start position:0%
like the subqueries we are breaking down
complex<00:09:05.240><c> queries</c><00:09:05.720><c> into</c><00:09:06.480><c> smaller</c><00:09:07.000><c> pieces</c><00:09:07.519><c> that</c>

00:09:07.630 --> 00:09:07.640 align:start position:0%
complex queries into smaller pieces that
 

00:09:07.640 --> 00:09:10.870 align:start position:0%
complex queries into smaller pieces that
are<00:09:07.920><c> easier</c><00:09:08.360><c> to</c><00:09:08.600><c> write</c><00:09:09.440><c> manage</c><00:09:10.440><c> understand</c>

00:09:10.870 --> 00:09:10.880 align:start position:0%
are easier to write manage understand
 

00:09:10.880 --> 00:09:12.750 align:start position:0%
are easier to write manage understand
and<00:09:11.040><c> as</c><00:09:11.160><c> well</c><00:09:11.320><c> we</c><00:09:11.440><c> have</c><00:09:11.600><c> like</c><00:09:11.839><c> a</c><00:09:12.040><c> logical</c><00:09:12.399><c> flow</c>

00:09:12.750 --> 00:09:12.760 align:start position:0%
and as well we have like a logical flow
 

00:09:12.760 --> 00:09:15.389 align:start position:0%
and as well we have like a logical flow
from<00:09:13.000><c> Step</c><00:09:13.279><c> One</c><00:09:13.519><c> 2</c><00:09:13.839><c> three</c><00:09:14.440><c> but</c><00:09:14.720><c> with</c><00:09:14.920><c> one</c><00:09:15.079><c> more</c>

00:09:15.389 --> 00:09:15.399 align:start position:0%
from Step One 2 three but with one more
 

00:09:15.399 --> 00:09:17.790 align:start position:0%
from Step One 2 three but with one more
benefit<00:09:15.800><c> of</c><00:09:16.040><c> that</c><00:09:16.680><c> we</c><00:09:16.920><c> reduce</c><00:09:17.560><c> the</c>

00:09:17.790 --> 00:09:17.800 align:start position:0%
benefit of that we reduce the
 

00:09:17.800 --> 00:09:19.910 align:start position:0%
benefit of that we reduce the
redundancies<00:09:18.480><c> of</c><00:09:18.640><c> our</c><00:09:18.920><c> code</c><00:09:19.399><c> so</c><00:09:19.600><c> we</c><00:09:19.720><c> don't</c>

00:09:19.910 --> 00:09:19.920 align:start position:0%
redundancies of our code so we don't
 

00:09:19.920 --> 00:09:21.870 align:start position:0%
redundancies of our code so we don't
have<00:09:20.040><c> to</c><00:09:20.160><c> join</c><00:09:20.440><c> the</c><00:09:20.600><c> tables</c><00:09:21.079><c> twice</c><00:09:21.640><c> now</c><00:09:21.760><c> I'm</c>

00:09:21.870 --> 00:09:21.880 align:start position:0%
have to join the tables twice now I'm
 

00:09:21.880 --> 00:09:23.430 align:start position:0%
have to join the tables twice now I'm
going<00:09:21.959><c> to</c><00:09:22.040><c> show</c><00:09:22.200><c> you</c><00:09:22.320><c> a</c><00:09:22.440><c> simple</c><00:09:22.760><c> example</c><00:09:23.200><c> how</c>

00:09:23.430 --> 00:09:23.440 align:start position:0%
going to show you a simple example how
 

00:09:23.440 --> 00:09:26.190 align:start position:0%
going to show you a simple example how
the<00:09:23.600><c> CTE</c><00:09:24.360><c> makes</c><00:09:24.640><c> our</c><00:09:24.920><c> life</c><00:09:25.160><c> easier</c><00:09:25.760><c> in</c><00:09:25.920><c> our</c>

00:09:26.190 --> 00:09:26.200 align:start position:0%
the CTE makes our life easier in our
 

00:09:26.200 --> 00:09:27.870 align:start position:0%
the CTE makes our life easier in our
query<00:09:26.600><c> we</c><00:09:26.760><c> might</c><00:09:26.959><c> have</c><00:09:27.079><c> to</c><00:09:27.240><c> do</c><00:09:27.519><c> different</c>

00:09:27.870 --> 00:09:27.880 align:start position:0%
query we might have to do different
 

00:09:27.880 --> 00:09:29.670 align:start position:0%
query we might have to do different
stuff<00:09:28.240><c> like</c><00:09:28.399><c> for</c><00:09:28.600><c> example</c><00:09:28.920><c> we</c><00:09:29.040><c> have</c><00:09:29.120><c> to</c><00:09:29.519><c> and</c>

00:09:29.670 --> 00:09:29.680 align:start position:0%
stuff like for example we have to and
 

00:09:29.680 --> 00:09:32.470 align:start position:0%
stuff like for example we have to and
find<00:09:30.360><c> the</c><00:09:30.600><c> top</c><00:09:30.920><c> customers</c><00:09:31.720><c> so</c><00:09:31.880><c> we</c><00:09:32.000><c> can</c><00:09:32.200><c> put</c>

00:09:32.470 --> 00:09:32.480 align:start position:0%
find the top customers so we can put
 

00:09:32.480 --> 00:09:34.670 align:start position:0%
find the top customers so we can put
this<00:09:32.640><c> in</c><00:09:32.800><c> one</c><00:09:33.040><c> CTE</c><00:09:33.800><c> and</c><00:09:33.920><c> we</c><00:09:34.079><c> might</c><00:09:34.279><c> need</c><00:09:34.560><c> as</c>

00:09:34.670 --> 00:09:34.680 align:start position:0%
this in one CTE and we might need as
 

00:09:34.680 --> 00:09:36.670 align:start position:0%
this in one CTE and we might need as
well<00:09:34.839><c> to</c><00:09:35.079><c> calculate</c><00:09:35.720><c> what</c><00:09:35.839><c> are</c><00:09:36.120><c> the</c><00:09:36.360><c> top</c>

00:09:36.670 --> 00:09:36.680 align:start position:0%
well to calculate what are the top
 

00:09:36.680 --> 00:09:39.190 align:start position:0%
well to calculate what are the top
products<00:09:37.440><c> and</c><00:09:37.560><c> we</c><00:09:37.680><c> can</c><00:09:37.839><c> put</c><00:09:38.120><c> as</c><00:09:38.279><c> well</c><00:09:38.560><c> this</c><00:09:38.959><c> in</c>

00:09:39.190 --> 00:09:39.200 align:start position:0%
products and we can put as well this in
 

00:09:39.200 --> 00:09:41.150 align:start position:0%
products and we can put as well this in
another<00:09:39.560><c> CTE</c><00:09:40.200><c> so</c><00:09:40.360><c> you</c><00:09:40.440><c> don't</c><00:09:40.640><c> have</c><00:09:40.760><c> to</c><00:09:40.880><c> put</c>

00:09:41.150 --> 00:09:41.160 align:start position:0%
another CTE so you don't have to put
 

00:09:41.160 --> 00:09:43.110 align:start position:0%
another CTE so you don't have to put
everything<00:09:41.560><c> in</c><00:09:41.720><c> one</c><00:09:42.000><c> big</c><00:09:42.240><c> CTE</c><00:09:42.680><c> then</c><00:09:42.800><c> you</c><00:09:42.920><c> can</c>

00:09:43.110 --> 00:09:43.120 align:start position:0%
everything in one big CTE then you can
 

00:09:43.120 --> 00:09:44.829 align:start position:0%
everything in one big CTE then you can
have<00:09:43.279><c> the</c><00:09:43.440><c> same</c><00:09:43.640><c> issue</c><00:09:43.920><c> of</c><00:09:44.079><c> having</c><00:09:44.399><c> complex</c>

00:09:44.829 --> 00:09:44.839 align:start position:0%
have the same issue of having complex
 

00:09:44.839 --> 00:09:46.590 align:start position:0%
have the same issue of having complex
query<00:09:45.440><c> and</c><00:09:45.560><c> let's</c><00:09:45.720><c> say</c><00:09:45.880><c> that</c><00:09:46.040><c> we</c><00:09:46.160><c> have</c><00:09:46.320><c> as</c><00:09:46.440><c> well</c>

00:09:46.590 --> 00:09:46.600 align:start position:0%
query and let's say that we have as well
 

00:09:46.600 --> 00:09:49.470 align:start position:0%
query and let's say that we have as well
to<00:09:46.800><c> find</c><00:09:47.079><c> and</c><00:09:47.320><c> calculate</c><00:09:48.120><c> the</c><00:09:48.399><c> daily</c><00:09:48.800><c> revenue</c>

00:09:49.470 --> 00:09:49.480 align:start position:0%
to find and calculate the daily revenue
 

00:09:49.480 --> 00:09:50.870 align:start position:0%
to find and calculate the daily revenue
and<00:09:49.600><c> for</c><00:09:49.800><c> this</c><00:09:49.959><c> as</c><00:09:50.079><c> well</c><00:09:50.240><c> we</c><00:09:50.320><c> have</c><00:09:50.440><c> to</c><00:09:50.560><c> put</c><00:09:50.760><c> it</c>

00:09:50.870 --> 00:09:50.880 align:start position:0%
and for this as well we have to put it
 

00:09:50.880 --> 00:09:52.990 align:start position:0%
and for this as well we have to put it
in<00:09:51.000><c> one</c><00:09:51.200><c> CTE</c><00:09:51.839><c> now</c><00:09:52.000><c> once</c><00:09:52.160><c> we</c><00:09:52.320><c> have</c><00:09:52.480><c> all</c><00:09:52.760><c> those</c>

00:09:52.990 --> 00:09:53.000 align:start position:0%
in one CTE now once we have all those
 

00:09:53.000 --> 00:09:55.710 align:start position:0%
in one CTE now once we have all those
parts<00:09:53.600><c> we</c><00:09:53.720><c> can</c><00:09:53.959><c> put</c><00:09:54.320><c> everything</c><00:09:54.920><c> together</c><00:09:55.519><c> in</c>

00:09:55.710 --> 00:09:55.720 align:start position:0%
parts we can put everything together in
 

00:09:55.720 --> 00:09:57.590 align:start position:0%
parts we can put everything together in
the<00:09:55.920><c> main</c><00:09:56.240><c> query</c><00:09:56.800><c> so</c><00:09:56.959><c> now</c><00:09:57.079><c> if</c><00:09:57.160><c> you</c><00:09:57.279><c> look</c><00:09:57.440><c> to</c>

00:09:57.590 --> 00:09:57.600 align:start position:0%
the main query so now if you look to
 

00:09:57.600 --> 00:09:59.710 align:start position:0%
the main query so now if you look to
this<00:09:57.760><c> structure</c><00:09:58.200><c> you</c><00:09:58.320><c> can</c><00:09:58.480><c> see</c><00:09:59.040><c> it's</c><00:09:59.480><c> really</c>

00:09:59.710 --> 00:09:59.720 align:start position:0%
this structure you can see it's really
 

00:09:59.720 --> 00:10:02.269 align:start position:0%
this structure you can see it's really
easy<00:10:00.120><c> to</c><00:10:00.800><c> understand</c><00:10:01.160><c> this</c><00:10:01.360><c> code</c><00:10:01.760><c> it's</c><00:10:02.040><c> easy</c>

00:10:02.269 --> 00:10:02.279 align:start position:0%
easy to understand this code it's easy
 

00:10:02.279 --> 00:10:05.470 align:start position:0%
easy to understand this code it's easy
to<00:10:02.480><c> read</c><00:10:02.920><c> so</c><00:10:03.120><c> CTE</c><00:10:03.640><c> improves</c><00:10:04.200><c> the</c><00:10:04.480><c> readability</c>

00:10:05.470 --> 00:10:05.480 align:start position:0%
to read so CTE improves the readability
 

00:10:05.480 --> 00:10:07.710 align:start position:0%
to read so CTE improves the readability
of<00:10:05.640><c> our</c><00:10:05.920><c> queries</c><00:10:06.600><c> so</c><00:10:06.800><c> that</c><00:10:06.959><c> means</c><00:10:07.200><c> your</c><00:10:07.440><c> code</c>

00:10:07.710 --> 00:10:07.720 align:start position:0%
of our queries so that means your code
 

00:10:07.720 --> 00:10:10.430 align:start position:0%
of our queries so that means your code
is<00:10:07.920><c> divided</c><00:10:08.320><c> into</c><00:10:08.720><c> clear</c><00:10:09.079><c> sections</c><00:10:09.839><c> making</c><00:10:10.160><c> it</c>

00:10:10.430 --> 00:10:10.440 align:start position:0%
is divided into clear sections making it
 

00:10:10.440 --> 00:10:13.310 align:start position:0%
is divided into clear sections making it
easier<00:10:10.839><c> to</c><00:10:11.320><c> understand</c><00:10:11.920><c> what</c><00:10:12.160><c> each</c><00:10:12.440><c> part</c><00:10:12.800><c> does</c>

00:10:13.310 --> 00:10:13.320 align:start position:0%
easier to understand what each part does
 

00:10:13.320 --> 00:10:15.190 align:start position:0%
easier to understand what each part does
now<00:10:13.480><c> if</c><00:10:13.560><c> you</c><00:10:13.720><c> keep</c><00:10:13.920><c> looking</c><00:10:14.200><c> to</c><00:10:14.440><c> this</c><00:10:14.920><c> we</c><00:10:15.040><c> have</c>

00:10:15.190 --> 00:10:15.200 align:start position:0%
now if you keep looking to this we have
 

00:10:15.200 --> 00:10:18.269 align:start position:0%
now if you keep looking to this we have
another<00:10:15.600><c> advantage</c><00:10:16.120><c> of</c><00:10:16.360><c> the</c><00:10:16.560><c> CTE</c><00:10:17.399><c> introduces</c>

00:10:18.269 --> 00:10:18.279 align:start position:0%
another advantage of the CTE introduces
 

00:10:18.279 --> 00:10:20.910 align:start position:0%
another advantage of the CTE introduces
modularity<00:10:19.240><c> so</c><00:10:19.440><c> that</c><00:10:19.600><c> means</c><00:10:20.000><c> it</c><00:10:20.240><c> breaks</c><00:10:20.680><c> your</c>

00:10:20.910 --> 00:10:20.920 align:start position:0%
modularity so that means it breaks your
 

00:10:20.920 --> 00:10:24.110 align:start position:0%
modularity so that means it breaks your
code<00:10:21.240><c> into</c><00:10:21.640><c> smaller</c><00:10:22.560><c> manageable</c><00:10:23.160><c> parts</c><00:10:23.839><c> so</c>

00:10:24.110 --> 00:10:24.120 align:start position:0%
code into smaller manageable parts so
 

00:10:24.120 --> 00:10:26.509 align:start position:0%
code into smaller manageable parts so
this<00:10:24.240><c> means</c><00:10:24.880><c> instead</c><00:10:25.200><c> of</c><00:10:25.360><c> writing</c><00:10:25.880><c> one</c><00:10:26.200><c> huge</c>

00:10:26.509 --> 00:10:26.519 align:start position:0%
this means instead of writing one huge
 

00:10:26.519 --> 00:10:28.990 align:start position:0%
this means instead of writing one huge
complex<00:10:26.959><c> query</c><00:10:27.760><c> you</c><00:10:27.959><c> break</c><00:10:28.200><c> it</c><00:10:28.399><c> down</c><00:10:28.680><c> into</c>

00:10:28.990 --> 00:10:29.000 align:start position:0%
complex query you break it down into
 

00:10:29.000 --> 00:10:32.190 align:start position:0%
complex query you break it down into
small<00:10:29.320><c> smaller</c><00:10:29.680><c> chunks</c><00:10:30.440><c> using</c><00:10:30.800><c> CTE</c><00:10:31.480><c> each</c><00:10:31.680><c> CTE</c>

00:10:32.190 --> 00:10:32.200 align:start position:0%
small smaller chunks using CTE each CTE
 

00:10:32.200 --> 00:10:34.829 align:start position:0%
small smaller chunks using CTE each CTE
is<00:10:32.360><c> like</c><00:10:32.600><c> self-contained</c><00:10:33.560><c> and</c><00:10:33.839><c> handles</c>

00:10:34.829 --> 00:10:34.839 align:start position:0%
is like self-contained and handles
 

00:10:34.839 --> 00:10:36.750 align:start position:0%
is like self-contained and handles
specific<00:10:35.320><c> part</c><00:10:35.560><c> of</c><00:10:35.720><c> the</c><00:10:35.920><c> problem</c><00:10:36.480><c> and</c><00:10:36.600><c> then</c>

00:10:36.750 --> 00:10:36.760 align:start position:0%
specific part of the problem and then
 

00:10:36.760 --> 00:10:38.509 align:start position:0%
specific part of the problem and then
you<00:10:36.880><c> can</c><00:10:37.079><c> combine</c><00:10:37.480><c> them</c><00:10:37.639><c> all</c><00:10:37.959><c> together</c><00:10:38.200><c> in</c><00:10:38.360><c> the</c>

00:10:38.509 --> 00:10:38.519 align:start position:0%
you can combine them all together in the
 

00:10:38.519 --> 00:10:40.550 align:start position:0%
you can combine them all together in the
final<00:10:38.920><c> query</c><00:10:39.480><c> it's</c><00:10:39.639><c> like</c><00:10:39.839><c> we</c><00:10:39.920><c> are</c><00:10:40.079><c> putting</c>

00:10:40.550 --> 00:10:40.560 align:start position:0%
final query it's like we are putting
 

00:10:40.560 --> 00:10:43.470 align:start position:0%
final query it's like we are putting
together<00:10:40.880><c> a</c><00:10:41.079><c> puzzle</c><00:10:41.920><c> piece</c><00:10:42.320><c> by</c><00:10:42.600><c> piece</c><00:10:43.120><c> and</c><00:10:43.279><c> now</c>

00:10:43.470 --> 00:10:43.480 align:start position:0%
together a puzzle piece by piece and now
 

00:10:43.480 --> 00:10:46.030 align:start position:0%
together a puzzle piece by piece and now
one<00:10:43.800><c> very</c><00:10:44.000><c> important</c><00:10:44.399><c> advantage</c><00:10:44.800><c> of</c><00:10:44.920><c> the</c><00:10:45.040><c> C</c><00:10:45.560><c> is</c>

00:10:46.030 --> 00:10:46.040 align:start position:0%
one very important advantage of the C is
 

00:10:46.040 --> 00:10:48.190 align:start position:0%
one very important advantage of the C is
the<00:10:46.279><c> reusability</c><00:10:47.240><c> so</c><00:10:47.440><c> that</c><00:10:47.600><c> means</c><00:10:47.920><c> we</c><00:10:48.040><c> can</c>

00:10:48.190 --> 00:10:48.200 align:start position:0%
the reusability so that means we can
 

00:10:48.200 --> 00:10:50.790 align:start position:0%
the reusability so that means we can
have<00:10:48.320><c> a</c><00:10:48.519><c> result</c><00:10:48.920><c> set</c><00:10:49.320><c> that</c><00:10:49.480><c> is</c><00:10:49.680><c> used</c><00:10:50.240><c> multiple</c>

00:10:50.790 --> 00:10:50.800 align:start position:0%
have a result set that is used multiple
 

00:10:50.800 --> 00:10:53.069 align:start position:0%
have a result set that is used multiple
times<00:10:51.200><c> inside</c><00:10:51.560><c> our</c><00:10:51.839><c> query</c><00:10:52.360><c> so</c><00:10:52.600><c> that</c><00:10:52.760><c> means</c><00:10:52.959><c> you</c>

00:10:53.069 --> 00:10:53.079 align:start position:0%
times inside our query so that means you
 

00:10:53.079 --> 00:10:55.509 align:start position:0%
times inside our query so that means you
write<00:10:53.399><c> the</c><00:10:53.560><c> logic</c><00:10:53.920><c> the</c><00:10:54.120><c> code</c><00:10:54.480><c> only</c><00:10:54.839><c> once</c><00:10:55.360><c> and</c>

00:10:55.509 --> 00:10:55.519 align:start position:0%
write the logic the code only once and
 

00:10:55.519 --> 00:10:57.430 align:start position:0%
write the logic the code only once and
then<00:10:55.680><c> use</c><00:10:55.880><c> it</c><00:10:56.079><c> in</c><00:10:56.279><c> different</c><00:10:56.639><c> places</c><00:10:57.120><c> inside</c>

00:10:57.430 --> 00:10:57.440 align:start position:0%
then use it in different places inside
 

00:10:57.440 --> 00:10:59.430 align:start position:0%
then use it in different places inside
your<00:10:57.639><c> query</c><00:10:58.200><c> this</c><00:10:58.360><c> is</c><00:10:58.560><c> very</c><00:10:58.720><c> important</c><00:10:59.320><c> not</c>

00:10:59.430 --> 00:10:59.440 align:start position:0%
your query this is very important not
 

00:10:59.440 --> 00:11:01.110 align:start position:0%
your query this is very important not
only<00:10:59.639><c> you</c><00:10:59.720><c> are</c><00:10:59.880><c> wasting</c><00:11:00.279><c> time</c><00:11:00.519><c> writing</c><00:11:00.959><c> the</c>

00:11:01.110 --> 00:11:01.120 align:start position:0%
only you are wasting time writing the
 

00:11:01.120 --> 00:11:03.470 align:start position:0%
only you are wasting time writing the
same<00:11:01.399><c> stuff</c><00:11:01.680><c> over</c><00:11:01.920><c> and</c><00:11:02.120><c> over</c><00:11:02.720><c> but</c><00:11:02.959><c> also</c><00:11:03.279><c> it</c>

00:11:03.470 --> 00:11:03.480 align:start position:0%
same stuff over and over but also it
 

00:11:03.480 --> 00:11:05.790 align:start position:0%
same stuff over and over but also it
reduces<00:11:04.040><c> the</c><00:11:04.200><c> errors</c><00:11:04.680><c> and</c><00:11:04.880><c> mistakes</c><00:11:05.480><c> that</c><00:11:05.639><c> you</c>

00:11:05.790 --> 00:11:05.800 align:start position:0%
reduces the errors and mistakes that you
 

00:11:05.800 --> 00:11:07.790 align:start position:0%
reduces the errors and mistakes that you
might<00:11:06.040><c> do</c><00:11:06.480><c> if</c><00:11:06.600><c> you</c><00:11:06.720><c> are</c><00:11:06.880><c> repeating</c><00:11:07.440><c> the</c><00:11:07.560><c> same</c>

00:11:07.790 --> 00:11:07.800 align:start position:0%
might do if you are repeating the same
 

00:11:07.800 --> 00:11:09.470 align:start position:0%
might do if you are repeating the same
code<00:11:08.279><c> basically</c><00:11:08.600><c> if</c><00:11:08.720><c> later</c><00:11:08.959><c> you</c><00:11:09.079><c> want</c><00:11:09.240><c> to</c><00:11:09.360><c> go</c>

00:11:09.470 --> 00:11:09.480 align:start position:0%
code basically if later you want to go
 

00:11:09.480 --> 00:11:11.430 align:start position:0%
code basically if later you want to go
and<00:11:09.600><c> change</c><00:11:09.959><c> the</c><00:11:10.120><c> logic</c><00:11:10.760><c> then</c><00:11:10.920><c> you</c><00:11:11.040><c> have</c><00:11:11.160><c> to</c><00:11:11.320><c> go</c>

00:11:11.430 --> 00:11:11.440 align:start position:0%
and change the logic then you have to go
 

00:11:11.440 --> 00:11:13.949 align:start position:0%
and change the logic then you have to go
and<00:11:11.680><c> visit</c><00:11:12.360><c> each</c><00:11:12.680><c> time</c><00:11:12.959><c> you</c><00:11:13.120><c> have</c><00:11:13.440><c> done</c><00:11:13.720><c> this</c>

00:11:13.949 --> 00:11:13.959 align:start position:0%
and visit each time you have done this
 

00:11:13.959 --> 00:11:16.150 align:start position:0%
and visit each time you have done this
logic<00:11:14.440><c> and</c><00:11:14.600><c> then</c><00:11:14.760><c> do</c><00:11:14.920><c> the</c><00:11:15.079><c> changes</c><00:11:15.839><c> and</c><00:11:16.040><c> you</c>

00:11:16.150 --> 00:11:16.160 align:start position:0%
logic and then do the changes and you
 

00:11:16.160 --> 00:11:18.110 align:start position:0%
logic and then do the changes and you
might<00:11:16.360><c> forget</c><00:11:16.760><c> some</c><00:11:16.959><c> places</c><00:11:17.600><c> that's</c><00:11:17.800><c> why</c><00:11:18.000><c> the</c>

00:11:18.110 --> 00:11:18.120 align:start position:0%
might forget some places that's why the
 

00:11:18.120 --> 00:11:20.629 align:start position:0%
might forget some places that's why the
CTE<00:11:18.560><c> is</c><00:11:18.760><c> amazing</c><00:11:19.480><c> you</c><00:11:19.600><c> can</c><00:11:19.800><c> write</c><00:11:20.160><c> the</c><00:11:20.320><c> logic</c>

00:11:20.629 --> 00:11:20.639 align:start position:0%
CTE is amazing you can write the logic
 

00:11:20.639 --> 00:11:22.949 align:start position:0%
CTE is amazing you can write the logic
once<00:11:21.240><c> and</c><00:11:21.399><c> then</c><00:11:21.560><c> you</c><00:11:21.760><c> go</c><00:11:22.000><c> and</c><00:11:22.200><c> reuse</c><00:11:22.600><c> it</c><00:11:22.800><c> in</c>

00:11:22.949 --> 00:11:22.959 align:start position:0%
once and then you go and reuse it in
 

00:11:22.959 --> 00:11:24.790 align:start position:0%
once and then you go and reuse it in
different<00:11:23.320><c> places</c><00:11:23.959><c> so</c><00:11:24.200><c> these</c><00:11:24.360><c> are</c><00:11:24.639><c> the</c>

00:11:24.790 --> 00:11:24.800 align:start position:0%
different places so these are the
 

00:11:24.800 --> 00:11:27.150 align:start position:0%
different places so these are the
advantages<00:11:25.360><c> of</c><00:11:25.560><c> using</c><00:11:26.320><c> this</c><00:11:26.560><c> technique</c><00:11:27.000><c> the</c>

00:11:27.150 --> 00:11:27.160 align:start position:0%
advantages of using this technique the
 

00:11:27.160 --> 00:11:33.230 align:start position:0%
advantages of using this technique the
CTE<00:11:28.000><c> inside</c><00:11:28.360><c> your</c><00:11:28.560><c> queries</c>

00:11:33.230 --> 00:11:33.240 align:start position:0%
 
 

00:11:33.240 --> 00:11:35.030 align:start position:0%
 
so<00:11:33.480><c> again</c><00:11:33.680><c> you</c><00:11:33.800><c> are</c><00:11:34.000><c> at</c><00:11:34.200><c> the</c><00:11:34.320><c> client</c><00:11:34.680><c> site</c><00:11:34.920><c> and</c>

00:11:35.030 --> 00:11:35.040 align:start position:0%
so again you are at the client site and
 

00:11:35.040 --> 00:11:37.269 align:start position:0%
so again you are at the client site and
you<00:11:35.200><c> are</c><00:11:35.480><c> data</c><00:11:35.720><c> analyst</c><00:11:36.440><c> you</c><00:11:36.560><c> are</c><00:11:36.720><c> writing</c><00:11:37.040><c> a</c>

00:11:37.269 --> 00:11:37.279 align:start position:0%
you are data analyst you are writing a
 

00:11:37.279 --> 00:11:39.310 align:start position:0%
you are data analyst you are writing a
query<00:11:37.800><c> where</c><00:11:37.959><c> you</c><00:11:38.079><c> are</c><00:11:38.279><c> defining</c><00:11:38.680><c> a</c><00:11:38.839><c> CTE</c>

00:11:39.310 --> 00:11:39.320 align:start position:0%
query where you are defining a CTE
 

00:11:39.320 --> 00:11:41.190 align:start position:0%
query where you are defining a CTE
called<00:11:39.639><c> details</c><00:11:40.399><c> and</c><00:11:40.560><c> inside</c><00:11:40.800><c> it</c><00:11:40.959><c> you</c><00:11:41.040><c> have</c>

00:11:41.190 --> 00:11:41.200 align:start position:0%
called details and inside it you have
 

00:11:41.200 --> 00:11:43.110 align:start position:0%
called details and inside it you have
some<00:11:41.399><c> logic</c><00:11:41.880><c> and</c><00:11:42.000><c> now</c><00:11:42.160><c> in</c><00:11:42.279><c> the</c><00:11:42.399><c> main</c><00:11:42.680><c> query</c><00:11:43.000><c> you</c>

00:11:43.110 --> 00:11:43.120 align:start position:0%
some logic and now in the main query you
 

00:11:43.120 --> 00:11:45.350 align:start position:0%
some logic and now in the main query you
are<00:11:43.279><c> selecting</c><00:11:43.720><c> the</c><00:11:43.920><c> data</c><00:11:44.279><c> from</c><00:11:44.480><c> the</c><00:11:44.600><c> orders</c>

00:11:45.350 --> 00:11:45.360 align:start position:0%
are selecting the data from the orders
 

00:11:45.360 --> 00:11:47.590 align:start position:0%
are selecting the data from the orders
and<00:11:45.560><c> as</c><00:11:45.720><c> well</c><00:11:45.880><c> you</c><00:11:46.000><c> are</c><00:11:46.160><c> joining</c><00:11:46.600><c> it</c><00:11:47.160><c> with</c><00:11:47.360><c> the</c>

00:11:47.590 --> 00:11:47.600 align:start position:0%
and as well you are joining it with the
 

00:11:47.600 --> 00:11:49.750 align:start position:0%
and as well you are joining it with the
details<00:11:48.079><c> with</c><00:11:48.240><c> the</c><00:11:48.360><c> CTE</c><00:11:48.920><c> multiple</c><00:11:49.399><c> times</c>

00:11:49.750 --> 00:11:49.760 align:start position:0%
details with the CTE multiple times
 

00:11:49.760 --> 00:11:51.870 align:start position:0%
details with the CTE multiple times
using<00:11:50.240><c> multiple</c><00:11:50.800><c> conditions</c><00:11:51.360><c> now</c><00:11:51.560><c> once</c><00:11:51.720><c> you</c>

00:11:51.870 --> 00:11:51.880 align:start position:0%
using multiple conditions now once you
 

00:11:51.880 --> 00:11:54.190 align:start position:0%
using multiple conditions now once you
go<00:11:52.040><c> and</c><00:11:52.240><c> execute</c><00:11:52.760><c> this</c><00:11:52.959><c> query</c><00:11:53.639><c> the</c><00:11:53.800><c> database</c>

00:11:54.190 --> 00:11:54.200 align:start position:0%
go and execute this query the database
 

00:11:54.200 --> 00:11:55.910 align:start position:0%
go and execute this query the database
engine<00:11:54.519><c> going</c><00:11:54.639><c> to</c><00:11:54.760><c> read</c><00:11:54.959><c> the</c><00:11:55.160><c> query</c><00:11:55.519><c> and</c><00:11:55.639><c> say</c>

00:11:55.910 --> 00:11:55.920 align:start position:0%
engine going to read the query and say
 

00:11:55.920 --> 00:11:58.590 align:start position:0%
engine going to read the query and say
aha<00:11:56.240><c> we</c><00:11:56.360><c> have</c><00:11:56.519><c> here</c><00:11:56.680><c> a</c><00:11:56.839><c> CTE</c><00:11:57.480><c> and</c><00:11:57.680><c> it</c><00:11:57.880><c> has</c><00:11:58.440><c> the</c>

00:11:58.590 --> 00:11:58.600 align:start position:0%
aha we have here a CTE and it has the
 

00:11:58.600 --> 00:12:00.470 align:start position:0%
aha we have here a CTE and it has the
main<00:11:58.920><c> priority</c><00:11:59.720><c> so</c><00:11:59.880><c> that</c><00:12:00.000><c> means</c><00:12:00.240><c> it's</c><00:12:00.360><c> going</c>

00:12:00.470 --> 00:12:00.480 align:start position:0%
main priority so that means it's going
 

00:12:00.480 --> 00:12:03.269 align:start position:0%
main priority so that means it's going
to<00:12:00.600><c> go</c><00:12:00.760><c> and</c><00:12:01.040><c> execute</c><00:12:01.519><c> the</c><00:12:01.639><c> CTE</c><00:12:02.240><c> first</c><00:12:03.000><c> and</c><00:12:03.120><c> now</c>

00:12:03.269 --> 00:12:03.279 align:start position:0%
to go and execute the CTE first and now
 

00:12:03.279 --> 00:12:04.790 align:start position:0%
to go and execute the CTE first and now
let's<00:12:03.440><c> say</c><00:12:03.680><c> that</c><00:12:03.959><c> in</c><00:12:04.079><c> the</c><00:12:04.160><c> CTE</c><00:12:04.519><c> you</c><00:12:04.639><c> are</c>

00:12:04.790 --> 00:12:04.800 align:start position:0%
let's say that in the CTE you are
 

00:12:04.800 --> 00:12:07.230 align:start position:0%
let's say that in the CTE you are
retrieving<00:12:05.399><c> data</c><00:12:05.680><c> from</c><00:12:05.880><c> the</c><00:12:06.000><c> table</c><00:12:06.279><c> orders</c>

00:12:07.230 --> 00:12:07.240 align:start position:0%
retrieving data from the table orders
 

00:12:07.240 --> 00:12:08.910 align:start position:0%
retrieving data from the table orders
and<00:12:07.399><c> the</c><00:12:07.480><c> table</c><00:12:07.720><c> orders</c><00:12:08.120><c> of</c><00:12:08.279><c> course</c><00:12:08.560><c> in</c><00:12:08.720><c> the</c>

00:12:08.910 --> 00:12:08.920 align:start position:0%
and the table orders of course in the
 

00:12:08.920 --> 00:12:11.389 align:start position:0%
and the table orders of course in the
disk<00:12:09.240><c> storage</c><00:12:09.760><c> inside</c><00:12:10.160><c> the</c><00:12:10.360><c> user</c><00:12:10.720><c> data</c><00:12:11.279><c> and</c>

00:12:11.389 --> 00:12:11.399 align:start position:0%
disk storage inside the user data and
 

00:12:11.399 --> 00:12:13.629 align:start position:0%
disk storage inside the user data and
now<00:12:11.600><c> once</c><00:12:11.839><c> the</c><00:12:12.000><c> city</c><00:12:12.399><c> is</c><00:12:12.560><c> completely</c><00:12:13.000><c> executed</c>

00:12:13.629 --> 00:12:13.639 align:start position:0%
now once the city is completely executed
 

00:12:13.639 --> 00:12:15.230 align:start position:0%
now once the city is completely executed
the<00:12:13.800><c> database</c><00:12:14.199><c> engine</c><00:12:14.480><c> going</c><00:12:14.600><c> to</c><00:12:14.760><c> go</c><00:12:14.920><c> and</c>

00:12:15.230 --> 00:12:15.240 align:start position:0%
the database engine going to go and
 

00:12:15.240 --> 00:12:17.670 align:start position:0%
the database engine going to go and
place<00:12:15.680><c> the</c><00:12:15.959><c> results</c><00:12:16.480><c> in</c><00:12:16.680><c> the</c><00:12:16.920><c> cache</c><00:12:17.440><c> and</c><00:12:17.560><c> it</c>

00:12:17.670 --> 00:12:17.680 align:start position:0%
place the results in the cache and it
 

00:12:17.680 --> 00:12:20.230 align:start position:0%
place the results in the cache and it
going<00:12:17.800><c> to</c><00:12:17.959><c> name</c><00:12:18.320><c> this</c><00:12:18.560><c> result</c><00:12:19.040><c> as</c><00:12:19.360><c> details</c>

00:12:20.230 --> 00:12:20.240 align:start position:0%
going to name this result as details
 

00:12:20.240 --> 00:12:22.150 align:start position:0%
going to name this result as details
it's<00:12:20.440><c> like</c><00:12:20.600><c> a</c><00:12:20.720><c> table</c><00:12:21.040><c> name</c><00:12:21.399><c> so</c><00:12:21.600><c> the</c><00:12:21.760><c> database</c>

00:12:22.150 --> 00:12:22.160 align:start position:0%
it's like a table name so the database
 

00:12:22.160 --> 00:12:23.550 align:start position:0%
it's like a table name so the database
engine<00:12:22.399><c> is</c><00:12:22.519><c> done</c><00:12:22.720><c> with</c><00:12:22.839><c> the</c><00:12:22.959><c> CTE</c><00:12:23.320><c> it's</c><00:12:23.440><c> going</c>

00:12:23.550 --> 00:12:23.560 align:start position:0%
engine is done with the CTE it's going
 

00:12:23.560 --> 00:12:25.910 align:start position:0%
engine is done with the CTE it's going
to<00:12:23.680><c> go</c><00:12:23.839><c> now</c><00:12:24.040><c> and</c><00:12:24.240><c> grab</c><00:12:24.639><c> the</c><00:12:24.800><c> main</c><00:12:25.199><c> query</c><00:12:25.800><c> and</c>

00:12:25.910 --> 00:12:25.920 align:start position:0%
to go now and grab the main query and
 

00:12:25.920 --> 00:12:27.870 align:start position:0%
to go now and grab the main query and
it's<00:12:26.040><c> going</c><00:12:26.160><c> to</c><00:12:26.279><c> start</c><00:12:26.560><c> executing</c><00:12:27.120><c> it</c><00:12:27.399><c> step</c><00:12:27.680><c> by</c>

00:12:27.870 --> 00:12:27.880 align:start position:0%
it's going to start executing it step by
 

00:12:27.880 --> 00:12:29.550 align:start position:0%
it's going to start executing it step by
step<00:12:28.199><c> so</c><00:12:28.399><c> the</c><00:12:28.519><c> first</c><00:12:28.720><c> step</c><00:12:28.880><c> is</c><00:12:29.000><c> that</c><00:12:29.199><c> to</c><00:12:29.360><c> get</c>

00:12:29.550 --> 00:12:29.560 align:start position:0%
step so the first step is that to get
 

00:12:29.560 --> 00:12:32.069 align:start position:0%
step so the first step is that to get
the<00:12:29.800><c> data</c><00:12:30.199><c> from</c><00:12:30.440><c> the</c><00:12:30.600><c> orders</c><00:12:31.360><c> so</c><00:12:31.639><c> since</c><00:12:31.959><c> the</c>

00:12:32.069 --> 00:12:32.079 align:start position:0%
the data from the orders so since the
 

00:12:32.079 --> 00:12:33.910 align:start position:0%
the data from the orders so since the
orders<00:12:32.519><c> exist</c><00:12:32.800><c> in</c><00:12:32.920><c> the</c><00:12:33.079><c> disk</c><00:12:33.320><c> storage</c><00:12:33.800><c> it's</c>

00:12:33.910 --> 00:12:33.920 align:start position:0%
orders exist in the disk storage it's
 

00:12:33.920 --> 00:12:35.750 align:start position:0%
orders exist in the disk storage it's
going<00:12:34.040><c> to</c><00:12:34.160><c> go</c><00:12:34.320><c> and</c><00:12:34.480><c> retrieve</c><00:12:34.880><c> it</c><00:12:35.040><c> from</c><00:12:35.320><c> there</c>

00:12:35.750 --> 00:12:35.760 align:start position:0%
going to go and retrieve it from there
 

00:12:35.760 --> 00:12:37.189 align:start position:0%
going to go and retrieve it from there
now<00:12:35.920><c> the</c><00:12:36.079><c> database</c><00:12:36.480><c> engine</c><00:12:36.760><c> going</c><00:12:36.880><c> to</c><00:12:36.959><c> check</c>

00:12:37.189 --> 00:12:37.199 align:start position:0%
now the database engine going to check
 

00:12:37.199 --> 00:12:39.629 align:start position:0%
now the database engine going to check
the<00:12:37.320><c> details</c><00:12:37.920><c> okay</c><00:12:38.199><c> we</c><00:12:38.399><c> have</c><00:12:38.560><c> it</c><00:12:38.760><c> in</c><00:12:38.959><c> the</c><00:12:39.160><c> cache</c>

00:12:39.629 --> 00:12:39.639 align:start position:0%
the details okay we have it in the cache
 

00:12:39.639 --> 00:12:41.310 align:start position:0%
the details okay we have it in the cache
that<00:12:39.800><c> means</c><00:12:40.279><c> we</c><00:12:40.399><c> don't</c><00:12:40.600><c> have</c><00:12:40.720><c> to</c><00:12:40.839><c> search</c><00:12:41.120><c> for</c>

00:12:41.310 --> 00:12:41.320 align:start position:0%
that means we don't have to search for
 

00:12:41.320 --> 00:12:43.269 align:start position:0%
that means we don't have to search for
it<00:12:41.480><c> in</c><00:12:41.600><c> the</c><00:12:41.760><c> disk</c><00:12:42.079><c> storage</c><00:12:42.720><c> and</c><00:12:42.880><c> it</c><00:12:43.000><c> going</c><00:12:43.120><c> to</c>

00:12:43.269 --> 00:12:43.279 align:start position:0%
it in the disk storage and it going to
 

00:12:43.279 --> 00:12:44.870 align:start position:0%
it in the disk storage and it going to
start<00:12:43.600><c> retrieving</c><00:12:44.120><c> the</c><00:12:44.320><c> data</c><00:12:44.600><c> from</c><00:12:44.760><c> the</c>

00:12:44.870 --> 00:12:44.880 align:start position:0%
start retrieving the data from the
 

00:12:44.880 --> 00:12:47.269 align:start position:0%
start retrieving the data from the
details<00:12:45.760><c> with</c><00:12:46.040><c> high</c><00:12:46.320><c> speed</c><00:12:46.920><c> and</c><00:12:47.040><c> now</c><00:12:47.160><c> it's</c>

00:12:47.269 --> 00:12:47.279 align:start position:0%
details with high speed and now it's
 

00:12:47.279 --> 00:12:48.829 align:start position:0%
details with high speed and now it's
going<00:12:47.360><c> to</c><00:12:47.480><c> go</c><00:12:47.600><c> to</c><00:12:47.760><c> the</c><00:12:47.880><c> Second</c><00:12:48.199><c> Step</c><00:12:48.519><c> as</c><00:12:48.639><c> well</c>

00:12:48.829 --> 00:12:48.839 align:start position:0%
going to go to the Second Step as well
 

00:12:48.839 --> 00:12:50.710 align:start position:0%
going to go to the Second Step as well
joining<00:12:49.160><c> the</c><00:12:49.320><c> data</c><00:12:49.560><c> with</c><00:12:49.680><c> the</c><00:12:49.800><c> details</c><00:12:50.480><c> so</c>

00:12:50.710 --> 00:12:50.720 align:start position:0%
joining the data with the details so
 

00:12:50.720 --> 00:12:52.310 align:start position:0%
joining the data with the details so
again<00:12:50.959><c> the</c><00:12:51.120><c> database</c><00:12:51.519><c> engine</c><00:12:51.800><c> going</c><00:12:51.920><c> to</c><00:12:52.040><c> go</c><00:12:52.160><c> to</c>

00:12:52.310 --> 00:12:52.320 align:start position:0%
again the database engine going to go to
 

00:12:52.320 --> 00:12:53.829 align:start position:0%
again the database engine going to go to
the<00:12:52.480><c> cache</c><00:12:52.800><c> and</c><00:12:52.959><c> going</c><00:12:53.040><c> to</c><00:12:53.199><c> see</c><00:12:53.360><c> the</c><00:12:53.480><c> table</c>

00:12:53.829 --> 00:12:53.839 align:start position:0%
the cache and going to see the table
 

00:12:53.839 --> 00:12:56.110 align:start position:0%
the cache and going to see the table
details<00:12:54.519><c> and</c><00:12:54.680><c> retrieve</c><00:12:55.120><c> the</c><00:12:55.279><c> database</c><00:12:55.880><c> maybe</c>

00:12:56.110 --> 00:12:56.120 align:start position:0%
details and retrieve the database maybe
 

00:12:56.120 --> 00:12:57.870 align:start position:0%
details and retrieve the database maybe
in<00:12:56.279><c> different</c><00:12:56.720><c> conditions</c><00:12:57.320><c> and</c><00:12:57.440><c> then</c><00:12:57.560><c> to</c><00:12:57.720><c> the</c>

00:12:57.870 --> 00:12:57.880 align:start position:0%
in different conditions and then to the
 

00:12:57.880 --> 00:12:59.509 align:start position:0%
in different conditions and then to the
third<00:12:58.120><c> time</c><00:12:58.360><c> as</c><00:12:58.480><c> well</c><00:12:58.600><c> we</c><00:12:58.720><c> are</c><00:12:58.800><c> joining</c><00:12:59.279><c> to</c><00:12:59.399><c> the</c>

00:12:59.509 --> 00:12:59.519 align:start position:0%
third time as well we are joining to the
 

00:12:59.519 --> 00:13:00.949 align:start position:0%
third time as well we are joining to the
details<00:12:59.920><c> and</c><00:13:00.040><c> we're</c><00:13:00.160><c> going</c><00:13:00.240><c> to</c><00:13:00.360><c> get</c><00:13:00.480><c> the</c><00:13:00.639><c> data</c>

00:13:00.949 --> 00:13:00.959 align:start position:0%
details and we're going to get the data
 

00:13:00.959 --> 00:13:02.990 align:start position:0%
details and we're going to get the data
from<00:13:01.160><c> the</c><00:13:01.480><c> cach</c><00:13:01.959><c> so</c><00:13:02.120><c> as</c><00:13:02.199><c> you</c><00:13:02.320><c> can</c><00:13:02.440><c> see</c><00:13:02.680><c> from</c><00:13:02.880><c> the</c>

00:13:02.990 --> 00:13:03.000 align:start position:0%
from the cach so as you can see from the
 

00:13:03.000 --> 00:13:05.750 align:start position:0%
from the cach so as you can see from the
main<00:13:03.199><c> query</c><00:13:03.560><c> we</c><00:13:03.680><c> are</c><00:13:03.920><c> using</c><00:13:04.920><c> the</c><00:13:05.120><c> result</c><00:13:05.600><c> from</c>

00:13:05.750 --> 00:13:05.760 align:start position:0%
main query we are using the result from
 

00:13:05.760 --> 00:13:08.030 align:start position:0%
main query we are using the result from
the<00:13:05.920><c> CTE</c><00:13:06.440><c> multiple</c><00:13:06.920><c> times</c><00:13:07.320><c> in</c><00:13:07.560><c> different</c>

00:13:08.030 --> 00:13:08.040 align:start position:0%
the CTE multiple times in different
 

00:13:08.040 --> 00:13:10.230 align:start position:0%
the CTE multiple times in different
places<00:13:08.680><c> and</c><00:13:08.839><c> the</c><00:13:09.000><c> retrieval</c><00:13:09.639><c> of</c><00:13:09.800><c> all</c><00:13:10.000><c> those</c>

00:13:10.230 --> 00:13:10.240 align:start position:0%
places and the retrieval of all those
 

00:13:10.240 --> 00:13:13.150 align:start position:0%
places and the retrieval of all those
informations<00:13:11.000><c> is</c><00:13:11.279><c> happening</c><00:13:11.760><c> in</c><00:13:12.040><c> high</c><00:13:12.360><c> speed</c>

00:13:13.150 --> 00:13:13.160 align:start position:0%
informations is happening in high speed
 

00:13:13.160 --> 00:13:15.150 align:start position:0%
informations is happening in high speed
so<00:13:13.440><c> this</c><00:13:13.600><c> is</c><00:13:13.800><c> one</c><00:13:14.000><c> big</c><00:13:14.199><c> benefit</c><00:13:14.560><c> of</c><00:13:14.680><c> using</c><00:13:15.000><c> the</c>

00:13:15.150 --> 00:13:15.160 align:start position:0%
so this is one big benefit of using the
 

00:13:15.160 --> 00:13:18.269 align:start position:0%
so this is one big benefit of using the
CTE<00:13:15.880><c> is</c><00:13:16.040><c> to</c><00:13:16.240><c> utilize</c><00:13:16.760><c> using</c><00:13:17.279><c> the</c><00:13:17.720><c> high-speed</c>

00:13:18.269 --> 00:13:18.279 align:start position:0%
CTE is to utilize using the high-speed
 

00:13:18.279 --> 00:13:20.069 align:start position:0%
CTE is to utilize using the high-speed
memory<00:13:18.639><c> of</c><00:13:18.800><c> the</c><00:13:18.959><c> cache</c><00:13:19.440><c> so</c><00:13:19.639><c> this</c><00:13:19.800><c> means</c>

00:13:20.069 --> 00:13:20.079 align:start position:0%
memory of the cache so this means
 

00:13:20.079 --> 00:13:22.230 align:start position:0%
memory of the cache so this means
retrieving<00:13:20.519><c> the</c><00:13:20.720><c> data</c><00:13:21.160><c> from</c><00:13:21.440><c> the</c><00:13:21.639><c> cache</c><00:13:22.040><c> from</c>

00:13:22.230 --> 00:13:22.240 align:start position:0%
retrieving the data from the cache from
 

00:13:22.240 --> 00:13:24.110 align:start position:0%
retrieving the data from the cache from
the<00:13:22.399><c> details</c><00:13:22.920><c> is</c><00:13:23.279><c> way</c><00:13:23.560><c> faster</c><00:13:23.920><c> than</c>

00:13:24.110 --> 00:13:24.120 align:start position:0%
the details is way faster than
 

00:13:24.120 --> 00:13:25.949 align:start position:0%
the details is way faster than
retrieving<00:13:24.560><c> the</c><00:13:24.760><c> data</c><00:13:25.320><c> from</c><00:13:25.519><c> the</c><00:13:25.680><c> disk</c>

00:13:25.949 --> 00:13:25.959 align:start position:0%
retrieving the data from the disk
 

00:13:25.959 --> 00:13:27.949 align:start position:0%
retrieving the data from the disk
storage<00:13:26.440><c> from</c><00:13:26.600><c> the</c><00:13:26.720><c> orders</c><00:13:27.399><c> now</c><00:13:27.600><c> once</c><00:13:27.880><c> the</c>

00:13:27.949 --> 00:13:27.959 align:start position:0%
storage from the orders now once the
 

00:13:27.959 --> 00:13:30.310 align:start position:0%
storage from the orders now once the
main<00:13:28.240><c> query</c><00:13:28.600><c> is</c><00:13:28.760><c> completely</c><00:13:29.320><c> executed</c><00:13:30.120><c> the</c>

00:13:30.310 --> 00:13:30.320 align:start position:0%
main query is completely executed the
 

00:13:30.320 --> 00:13:31.990 align:start position:0%
main query is completely executed the
result<00:13:30.680><c> going</c><00:13:30.800><c> to</c><00:13:30.920><c> be</c><00:13:31.199><c> returned</c><00:13:31.560><c> to</c><00:13:31.760><c> the</c>

00:13:31.990 --> 00:13:32.000 align:start position:0%
result going to be returned to the
 

00:13:32.000 --> 00:13:33.710 align:start position:0%
result going to be returned to the
database<00:13:32.560><c> engine</c><00:13:33.199><c> and</c><00:13:33.320><c> then</c><00:13:33.440><c> it's</c><00:13:33.560><c> going</c><00:13:33.639><c> to</c>

00:13:33.710 --> 00:13:33.720 align:start position:0%
database engine and then it's going to
 

00:13:33.720 --> 00:13:35.389 align:start position:0%
database engine and then it's going to
send<00:13:33.920><c> it</c><00:13:34.040><c> back</c><00:13:34.199><c> to</c><00:13:34.320><c> the</c><00:13:34.440><c> client</c><00:13:34.800><c> site</c><00:13:35.120><c> and</c><00:13:35.279><c> we</c>

00:13:35.389 --> 00:13:35.399 align:start position:0%
send it back to the client site and we
 

00:13:35.399 --> 00:13:37.470 align:start position:0%
send it back to the client site and we
will<00:13:35.560><c> see</c><00:13:35.760><c> the</c><00:13:35.920><c> results</c><00:13:36.399><c> in</c><00:13:36.519><c> the</c><00:13:36.639><c> output</c><00:13:37.279><c> so</c>

00:13:37.470 --> 00:13:37.480 align:start position:0%
will see the results in the output so
 

00:13:37.480 --> 00:13:39.750 align:start position:0%
will see the results in the output so
that's<00:13:37.680><c> it</c><00:13:37.959><c> it's</c><00:13:38.199><c> amazing</c><00:13:38.720><c> right</c><00:13:39.199><c> this</c><00:13:39.320><c> is</c><00:13:39.519><c> how</c>

00:13:39.750 --> 00:13:39.760 align:start position:0%
that's it it's amazing right this is how
 

00:13:39.760 --> 00:13:42.790 align:start position:0%
that's it it's amazing right this is how
the<00:13:40.040><c> database</c><00:13:40.560><c> server</c><00:13:41.279><c> execute</c><00:13:42.040><c> the</c><00:13:42.279><c> amazing</c>

00:13:42.790 --> 00:13:42.800 align:start position:0%
the database server execute the amazing
 

00:13:42.800 --> 00:13:48.389 align:start position:0%
the database server execute the amazing
technique<00:13:43.360><c> the</c><00:13:43.480><c> CTE</c><00:13:44.199><c> behind</c><00:13:44.560><c> the</c>

00:13:48.389 --> 00:13:48.399 align:start position:0%
 
 

00:13:48.399 --> 00:13:50.749 align:start position:0%
 
scenes<00:13:49.399><c> all</c><00:13:49.519><c> right</c><00:13:49.680><c> so</c><00:13:49.839><c> now</c><00:13:49.959><c> for</c><00:13:50.120><c> the</c><00:13:50.240><c> CTE</c><00:13:50.639><c> we</c>

00:13:50.749 --> 00:13:50.759 align:start position:0%
scenes all right so now for the CTE we
 

00:13:50.759 --> 00:13:52.670 align:start position:0%
scenes all right so now for the CTE we
don't<00:13:51.000><c> have</c><00:13:51.199><c> only</c><00:13:51.560><c> one</c><00:13:51.800><c> CTE</c><00:13:52.320><c> we</c><00:13:52.440><c> have</c>

00:13:52.670 --> 00:13:52.680 align:start position:0%
don't have only one CTE we have
 

00:13:52.680 --> 00:13:55.030 align:start position:0%
don't have only one CTE we have
different<00:13:53.079><c> types</c><00:13:53.360><c> of</c><00:13:53.480><c> CTE</c><00:13:54.240><c> so</c><00:13:54.480><c> mainly</c><00:13:54.920><c> there</c>

00:13:55.030 --> 00:13:55.040 align:start position:0%
different types of CTE so mainly there
 

00:13:55.040 --> 00:13:57.430 align:start position:0%
different types of CTE so mainly there
are<00:13:55.279><c> like</c><00:13:55.480><c> two</c><00:13:55.720><c> types</c><00:13:55.959><c> of</c><00:13:56.120><c> CTE</c><00:13:56.880><c> we</c><00:13:57.000><c> have</c><00:13:57.199><c> the</c>

00:13:57.430 --> 00:13:57.440 align:start position:0%
are like two types of CTE we have the
 

00:13:57.440 --> 00:14:01.230 align:start position:0%
are like two types of CTE we have the
nonrecursive<00:13:58.240><c> CTE</c><00:13:59.279><c> and</c><00:13:59.759><c> recursive</c><00:14:00.360><c> CTE</c><00:14:01.079><c> and</c>

00:14:01.230 --> 00:14:01.240 align:start position:0%
nonrecursive CTE and recursive CTE and
 

00:14:01.240 --> 00:14:04.230 align:start position:0%
nonrecursive CTE and recursive CTE and
we<00:14:01.399><c> can</c><00:14:01.560><c> say</c><00:14:01.800><c> for</c><00:14:02.040><c> the</c><00:14:02.199><c> non-recursive</c><00:14:03.040><c> CTE</c><00:14:04.040><c> we</c>

00:14:04.230 --> 00:14:04.240 align:start position:0%
we can say for the non-recursive CTE we
 

00:14:04.240 --> 00:14:07.069 align:start position:0%
we can say for the non-recursive CTE we
have<00:14:04.560><c> two</c><00:14:04.839><c> subtypes</c><00:14:05.759><c> the</c><00:14:05.880><c> first</c><00:14:06.160><c> type</c><00:14:06.440><c> is</c><00:14:06.759><c> the</c>

00:14:07.069 --> 00:14:07.079 align:start position:0%
have two subtypes the first type is the
 

00:14:07.079 --> 00:14:09.790 align:start position:0%
have two subtypes the first type is the
Standalone<00:14:07.720><c> CTE</c><00:14:08.360><c> and</c><00:14:08.519><c> the</c><00:14:08.639><c> second</c><00:14:08.920><c> one</c><00:14:09.160><c> is</c><00:14:09.560><c> the</c>

00:14:09.790 --> 00:14:09.800 align:start position:0%
Standalone CTE and the second one is the
 

00:14:09.800 --> 00:14:11.629 align:start position:0%
Standalone CTE and the second one is the
nested<00:14:10.240><c> CTE</c><00:14:10.959><c> and</c><00:14:11.079><c> now</c><00:14:11.240><c> what</c><00:14:11.320><c> we're</c><00:14:11.440><c> going</c><00:14:11.560><c> to</c>

00:14:11.629 --> 00:14:11.639 align:start position:0%
nested CTE and now what we're going to
 

00:14:11.639 --> 00:14:13.350 align:start position:0%
nested CTE and now what we're going to
do<00:14:11.759><c> we're</c><00:14:11.880><c> going</c><00:14:12.000><c> to</c><00:14:12.120><c> Deep</c><00:14:12.360><c> dive</c><00:14:12.639><c> into</c><00:14:13.000><c> each</c>

00:14:13.350 --> 00:14:13.360 align:start position:0%
do we're going to Deep dive into each
 

00:14:13.360 --> 00:14:15.590 align:start position:0%
do we're going to Deep dive into each
type<00:14:13.959><c> and</c><00:14:14.079><c> we</c><00:14:14.199><c> will</c><00:14:14.399><c> start</c><00:14:14.720><c> with</c><00:14:14.920><c> the</c><00:14:15.160><c> easiest</c>

00:14:15.590 --> 00:14:15.600 align:start position:0%
type and we will start with the easiest
 

00:14:15.600 --> 00:14:19.470 align:start position:0%
type and we will start with the easiest
form<00:14:15.839><c> of</c><00:14:15.959><c> the</c><00:14:16.120><c> CTE</c><00:14:16.920><c> the</c><00:14:17.120><c> Standalone</c><00:14:18.000><c> CTE</c><00:14:19.000><c> it</c><00:14:19.160><c> is</c>

00:14:19.470 --> 00:14:19.480 align:start position:0%
form of the CTE the Standalone CTE it is
 

00:14:19.480 --> 00:14:23.629 align:start position:0%
form of the CTE the Standalone CTE it is
the<00:14:19.639><c> simplest</c>

00:14:23.629 --> 00:14:23.639 align:start position:0%
 
 

00:14:23.639 --> 00:14:27.389 align:start position:0%
 
form<00:14:24.639><c> so</c><00:14:24.880><c> what</c><00:14:25.000><c> is</c><00:14:25.160><c> Standalone</c><00:14:25.800><c> CTE</c><00:14:26.600><c> it</c><00:14:26.720><c> is</c><00:14:26.839><c> a</c><00:14:27.000><c> c</c>

00:14:27.389 --> 00:14:27.399 align:start position:0%
form so what is Standalone CTE it is a c
 

00:14:27.399 --> 00:14:29.629 align:start position:0%
form so what is Standalone CTE it is a c
query<00:14:27.839><c> that</c><00:14:27.959><c> is</c><00:14:28.199><c> defined</c><00:14:28.639><c> and</c><00:14:28.800><c> used</c><00:14:29.120><c> used</c>

00:14:29.629 --> 00:14:29.639 align:start position:0%
query that is defined and used used
 

00:14:29.639 --> 00:14:32.509 align:start position:0%
query that is defined and used used
independently<00:14:30.639><c> in</c><00:14:30.800><c> the</c><00:14:31.000><c> query</c><00:14:31.839><c> so</c><00:14:32.040><c> this</c><00:14:32.199><c> means</c>

00:14:32.509 --> 00:14:32.519 align:start position:0%
independently in the query so this means
 

00:14:32.519 --> 00:14:34.550 align:start position:0%
independently in the query so this means
it<00:14:32.639><c> is</c><00:14:32.880><c> self-contained</c><00:14:33.880><c> and</c><00:14:34.040><c> it</c><00:14:34.199><c> doesn't</c>

00:14:34.550 --> 00:14:34.560 align:start position:0%
it is self-contained and it doesn't
 

00:14:34.560 --> 00:14:36.710 align:start position:0%
it is self-contained and it doesn't
depend<00:14:34.920><c> on</c><00:14:35.160><c> anything</c><00:14:35.600><c> it</c><00:14:35.720><c> doesn't</c><00:14:36.079><c> depend</c><00:14:36.440><c> on</c>

00:14:36.710 --> 00:14:36.720 align:start position:0%
depend on anything it doesn't depend on
 

00:14:36.720 --> 00:14:39.910 align:start position:0%
depend on anything it doesn't depend on
any<00:14:36.959><c> other</c><00:14:37.560><c> CTE</c><00:14:38.240><c> or</c><00:14:38.519><c> queries</c><00:14:39.240><c> so</c><00:14:39.440><c> that</c><00:14:39.600><c> means</c>

00:14:39.910 --> 00:14:39.920 align:start position:0%
any other CTE or queries so that means
 

00:14:39.920 --> 00:14:42.269 align:start position:0%
any other CTE or queries so that means
we<00:14:40.040><c> can</c><00:14:40.240><c> run</c><00:14:40.600><c> the</c><00:14:40.800><c> Standalone</c><00:14:41.440><c> query</c>

00:14:42.269 --> 00:14:42.279 align:start position:0%
we can run the Standalone query
 

00:14:42.279 --> 00:14:44.470 align:start position:0%
we can run the Standalone query
independently<00:14:43.120><c> from</c><00:14:43.440><c> anything</c><00:14:43.920><c> inside</c><00:14:44.240><c> our</c>

00:14:44.470 --> 00:14:44.480 align:start position:0%
independently from anything inside our
 

00:14:44.480 --> 00:14:46.069 align:start position:0%
independently from anything inside our
query<00:14:45.079><c> so</c><00:14:45.199><c> let's</c><00:14:45.639><c> understand</c><00:14:45.800><c> what</c><00:14:45.920><c> this</c>

00:14:46.069 --> 00:14:46.079 align:start position:0%
query so let's understand what this
 

00:14:46.079 --> 00:14:48.230 align:start position:0%
query so let's understand what this
means<00:14:46.639><c> we</c><00:14:46.800><c> have</c><00:14:46.959><c> our</c><00:14:47.160><c> CTE</c><00:14:47.639><c> it's</c><00:14:47.759><c> going</c><00:14:47.880><c> to</c><00:14:48.040><c> go</c>

00:14:48.230 --> 00:14:48.240 align:start position:0%
means we have our CTE it's going to go
 

00:14:48.240 --> 00:14:51.189 align:start position:0%
means we have our CTE it's going to go
and<00:14:48.600><c> query</c><00:14:49.360><c> the</c><00:14:49.519><c> database</c><00:14:50.000><c> tables</c><00:14:50.720><c> and</c><00:14:50.880><c> in</c><00:14:51.040><c> the</c>

00:14:51.189 --> 00:14:51.199 align:start position:0%
and query the database tables and in the
 

00:14:51.199 --> 00:14:52.829 align:start position:0%
and query the database tables and in the
output<00:14:51.639><c> we</c><00:14:51.720><c> will</c><00:14:51.920><c> get</c><00:14:52.120><c> an</c><00:14:52.279><c> intermediate</c>

00:14:52.829 --> 00:14:52.839 align:start position:0%
output we will get an intermediate
 

00:14:52.839 --> 00:14:54.990 align:start position:0%
output we will get an intermediate
results<00:14:53.399><c> and</c><00:14:53.519><c> then</c><00:14:53.639><c> the</c><00:14:53.800><c> output</c><00:14:54.199><c> can</c><00:14:54.399><c> be</c><00:14:54.560><c> used</c>

00:14:54.990 --> 00:14:55.000 align:start position:0%
results and then the output can be used
 

00:14:55.000 --> 00:14:57.069 align:start position:0%
results and then the output can be used
from<00:14:55.320><c> the</c><00:14:55.480><c> main</c><00:14:55.839><c> query</c><00:14:56.360><c> so</c><00:14:56.560><c> the</c><00:14:56.639><c> main</c><00:14:56.800><c> query</c>

00:14:57.069 --> 00:14:57.079 align:start position:0%
from the main query so the main query
 

00:14:57.079 --> 00:14:58.790 align:start position:0%
from the main query so the main query
going<00:14:57.160><c> to</c><00:14:57.320><c> query</c><00:14:57.720><c> the</c><00:14:57.839><c> intermediate</c><00:14:58.399><c> results</c>

00:14:58.790 --> 00:14:58.800 align:start position:0%
going to query the intermediate results
 

00:14:58.800 --> 00:15:00.790 align:start position:0%
going to query the intermediate results
and<00:14:59.160><c> present</c><00:14:59.480><c> in</c><00:14:59.639><c> the</c><00:14:59.759><c> output</c><00:15:00.279><c> the</c><00:15:00.399><c> final</c>

00:15:00.790 --> 00:15:00.800 align:start position:0%
and present in the output the final
 

00:15:00.800 --> 00:15:02.790 align:start position:0%
and present in the output the final
results<00:15:01.320><c> so</c><00:15:01.480><c> now</c><00:15:01.600><c> if</c><00:15:01.680><c> you</c><00:15:01.800><c> check</c><00:15:02.000><c> our</c><00:15:02.240><c> CTE</c><00:15:02.720><c> it</c>

00:15:02.790 --> 00:15:02.800 align:start position:0%
results so now if you check our CTE it
 

00:15:02.800 --> 00:15:05.150 align:start position:0%
results so now if you check our CTE it
is<00:15:03.079><c> completely</c><00:15:03.680><c> independent</c><00:15:04.399><c> from</c><00:15:04.720><c> anything</c>

00:15:05.150 --> 00:15:05.160 align:start position:0%
is completely independent from anything
 

00:15:05.160 --> 00:15:08.030 align:start position:0%
is completely independent from anything
else<00:15:05.759><c> so</c><00:15:05.959><c> it</c><00:15:06.160><c> simply</c><00:15:06.560><c> query</c><00:15:06.920><c> the</c><00:15:07.079><c> database</c><00:15:07.800><c> and</c>

00:15:08.030 --> 00:15:08.040 align:start position:0%
else so it simply query the database and
 

00:15:08.040 --> 00:15:11.069 align:start position:0%
else so it simply query the database and
it<00:15:08.240><c> has</c><00:15:08.600><c> one</c><00:15:08.880><c> output</c><00:15:09.600><c> so</c><00:15:09.800><c> since</c><00:15:10.160><c> this</c><00:15:10.360><c> CTE</c><00:15:10.839><c> is</c>

00:15:11.069 --> 00:15:11.079 align:start position:0%
it has one output so since this CTE is
 

00:15:11.079 --> 00:15:13.389 align:start position:0%
it has one output so since this CTE is
independent<00:15:11.720><c> from</c><00:15:12.040><c> anything</c><00:15:12.440><c> else</c><00:15:13.000><c> we</c><00:15:13.199><c> call</c>

00:15:13.389 --> 00:15:13.399 align:start position:0%
independent from anything else we call
 

00:15:13.399 --> 00:15:16.189 align:start position:0%
independent from anything else we call
it<00:15:13.600><c> a</c><00:15:13.800><c> standalone</c><00:15:14.680><c> CTE</c><00:15:15.399><c> now</c><00:15:15.519><c> if</c><00:15:15.600><c> you</c><00:15:15.800><c> compare</c>

00:15:16.189 --> 00:15:16.199 align:start position:0%
it a standalone CTE now if you compare
 

00:15:16.199 --> 00:15:18.150 align:start position:0%
it a standalone CTE now if you compare
this<00:15:16.360><c> C</c><00:15:16.759><c> with</c><00:15:16.920><c> the</c><00:15:17.040><c> main</c><00:15:17.320><c> query</c><00:15:17.680><c> you</c><00:15:17.759><c> can</c><00:15:17.920><c> see</c>

00:15:18.150 --> 00:15:18.160 align:start position:0%
this C with the main query you can see
 

00:15:18.160 --> 00:15:20.189 align:start position:0%
this C with the main query you can see
that<00:15:18.320><c> the</c><00:15:18.440><c> main</c><00:15:18.720><c> query</c><00:15:19.079><c> cannot</c><00:15:19.399><c> be</c><00:15:19.600><c> executed</c>

00:15:20.189 --> 00:15:20.199 align:start position:0%
that the main query cannot be executed
 

00:15:20.199 --> 00:15:22.629 align:start position:0%
that the main query cannot be executed
alone<00:15:20.920><c> and</c><00:15:21.079><c> that's</c><00:15:21.320><c> because</c><00:15:21.759><c> it</c><00:15:21.959><c> needs</c><00:15:22.480><c> the</c>

00:15:22.629 --> 00:15:22.639 align:start position:0%
alone and that's because it needs the
 

00:15:22.639 --> 00:15:25.230 align:start position:0%
alone and that's because it needs the
result<00:15:23.120><c> from</c><00:15:23.320><c> the</c><00:15:23.480><c> first</c><00:15:23.839><c> query</c><00:15:24.519><c> so</c><00:15:24.759><c> we</c><00:15:24.920><c> cannot</c>

00:15:25.230 --> 00:15:25.240 align:start position:0%
result from the first query so we cannot
 

00:15:25.240 --> 00:15:27.910 align:start position:0%
result from the first query so we cannot
say<00:15:25.519><c> the</c><00:15:25.720><c> main</c><00:15:26.000><c> query</c><00:15:26.360><c> is</c><00:15:26.639><c> independent</c><00:15:27.560><c> cannot</c>

00:15:27.910 --> 00:15:27.920 align:start position:0%
say the main query is independent cannot
 

00:15:27.920 --> 00:15:30.629 align:start position:0%
say the main query is independent cannot
be<00:15:28.079><c> executed</c><00:15:28.560><c> alone</c><00:15:29.279><c> it</c><00:15:29.519><c> always</c><00:15:29.920><c> depend</c><00:15:30.360><c> on</c>

00:15:30.629 --> 00:15:30.639 align:start position:0%
be executed alone it always depend on
 

00:15:30.639 --> 00:15:33.590 align:start position:0%
be executed alone it always depend on
the<00:15:30.920><c> CTE</c><00:15:31.440><c> query</c><00:15:32.040><c> so</c><00:15:32.240><c> this</c><00:15:32.399><c> means</c><00:15:32.680><c> CTE</c><00:15:33.199><c> first</c>

00:15:33.590 --> 00:15:33.600 align:start position:0%
the CTE query so this means CTE first
 

00:15:33.600 --> 00:15:36.030 align:start position:0%
the CTE query so this means CTE first
need<00:15:33.800><c> to</c><00:15:33.920><c> be</c><00:15:34.120><c> executed</c><00:15:35.040><c> then</c><00:15:35.360><c> the</c><00:15:35.480><c> main</c><00:15:35.759><c> query</c>

00:15:36.030 --> 00:15:36.040 align:start position:0%
need to be executed then the main query
 

00:15:36.040 --> 00:15:38.269 align:start position:0%
need to be executed then the main query
can<00:15:36.199><c> be</c><00:15:36.399><c> executed</c><00:15:37.120><c> so</c><00:15:37.399><c> this</c><00:15:37.480><c> is</c><00:15:37.639><c> what</c><00:15:37.800><c> we</c><00:15:37.920><c> mean</c>

00:15:38.269 --> 00:15:38.279 align:start position:0%
can be executed so this is what we mean
 

00:15:38.279 --> 00:15:40.749 align:start position:0%
can be executed so this is what we mean
with<00:15:38.480><c> the</c><00:15:38.720><c> Standalone</c><00:15:39.360><c> CTE</c><00:15:40.199><c> it</c><00:15:40.360><c> doesn't</c>

00:15:40.749 --> 00:15:40.759 align:start position:0%
with the Standalone CTE it doesn't
 

00:15:40.759 --> 00:15:43.230 align:start position:0%
with the Standalone CTE it doesn't
depend<00:15:41.120><c> on</c><00:15:41.440><c> anything</c><00:15:41.839><c> else</c><00:15:42.440><c> so</c><00:15:42.600><c> now</c><00:15:42.680><c> we</c><00:15:42.800><c> can</c>

00:15:43.230 --> 00:15:43.240 align:start position:0%
depend on anything else so now we can
 

00:15:43.240 --> 00:15:45.150 align:start position:0%
depend on anything else so now we can
understand<00:15:43.360><c> the</c><00:15:43.519><c> syntax</c><00:15:43.920><c> of</c><00:15:44.079><c> the</c><00:15:44.199><c> CTE</c><00:15:44.759><c> so</c><00:15:45.000><c> we</c>

00:15:45.150 --> 00:15:45.160 align:start position:0%
understand the syntax of the CTE so we
 

00:15:45.160 --> 00:15:47.389 align:start position:0%
understand the syntax of the CTE so we
have<00:15:45.399><c> a</c><00:15:45.600><c> very</c><00:15:45.759><c> simple</c><00:15:46.120><c> query</c><00:15:46.480><c> select</c><00:15:46.959><c> from</c>

00:15:47.389 --> 00:15:47.399 align:start position:0%
have a very simple query select from
 

00:15:47.399 --> 00:15:49.870 align:start position:0%
have a very simple query select from
where<00:15:47.880><c> so</c><00:15:48.120><c> it</c><00:15:48.240><c> is</c><00:15:48.360><c> a</c><00:15:48.560><c> very</c><00:15:48.800><c> simple</c><00:15:49.440><c> select</c>

00:15:49.870 --> 00:15:49.880 align:start position:0%
where so it is a very simple select
 

00:15:49.880 --> 00:15:52.309 align:start position:0%
where so it is a very simple select
statements<00:15:50.680><c> now</c><00:15:50.880><c> in</c><00:15:51.000><c> order</c><00:15:51.319><c> to</c><00:15:51.519><c> put</c><00:15:51.680><c> it</c><00:15:51.920><c> inside</c>

00:15:52.309 --> 00:15:52.319 align:start position:0%
statements now in order to put it inside
 

00:15:52.319 --> 00:15:56.110 align:start position:0%
statements now in order to put it inside
a<00:15:52.519><c> CTE</c><00:15:53.440><c> we</c><00:15:53.560><c> can</c><00:15:53.759><c> go</c><00:15:53.920><c> and</c><00:15:54.120><c> use</c><00:15:54.600><c> the</c><00:15:54.800><c> with</c><00:15:55.199><c> CLA</c><00:15:55.920><c> so</c>

00:15:56.110 --> 00:15:56.120 align:start position:0%
a CTE we can go and use the with CLA so
 

00:15:56.120 --> 00:15:58.990 align:start position:0%
a CTE we can go and use the with CLA so
it<00:15:56.279><c> starts</c><00:15:56.680><c> with</c><00:15:56.839><c> the</c><00:15:57.000><c> keyword</c><00:15:57.680><c> with</c><00:15:58.399><c> then</c><00:15:58.600><c> the</c>

00:15:58.990 --> 00:15:59.000 align:start position:0%
it starts with the keyword with then the
 

00:15:59.000 --> 00:16:01.590 align:start position:0%
it starts with the keyword with then the
CTE<00:15:59.399><c> name</c><00:15:59.880><c> it's</c><00:16:00.079><c> like</c><00:16:00.240><c> a</c><00:16:00.440><c> table</c><00:16:00.759><c> name</c><00:16:01.319><c> and</c><00:16:01.440><c> then</c>

00:16:01.590 --> 00:16:01.600 align:start position:0%
CTE name it's like a table name and then
 

00:16:01.600 --> 00:16:04.309 align:start position:0%
CTE name it's like a table name and then
we<00:16:01.720><c> have</c><00:16:01.880><c> the</c><00:16:02.040><c> keyword</c><00:16:02.560><c> as</c><00:16:03.000><c> in</c><00:16:03.120><c> order</c><00:16:03.360><c> to</c><00:16:03.519><c> say</c>

00:16:04.309 --> 00:16:04.319 align:start position:0%
we have the keyword as in order to say
 

00:16:04.319 --> 00:16:07.269 align:start position:0%
we have the keyword as in order to say
this<00:16:04.519><c> CTE</c><00:16:05.079><c> is</c><00:16:05.319><c> defined</c><00:16:05.880><c> like</c><00:16:06.160><c> the</c><00:16:06.360><c> following</c>

00:16:07.269 --> 00:16:07.279 align:start position:0%
this CTE is defined like the following
 

00:16:07.279 --> 00:16:09.790 align:start position:0%
this CTE is defined like the following
so<00:16:07.680><c> this</c><00:16:07.839><c> is</c><00:16:08.000><c> the</c><00:16:08.240><c> definition</c><00:16:08.639><c> of</c><00:16:08.800><c> the</c><00:16:08.920><c> CTE</c><00:16:09.639><c> and</c>

00:16:09.790 --> 00:16:09.800 align:start position:0%
so this is the definition of the CTE and
 

00:16:09.800 --> 00:16:11.990 align:start position:0%
so this is the definition of the CTE and
it<00:16:09.959><c> has</c><00:16:10.120><c> two</c><00:16:10.360><c> parentheses</c><00:16:11.240><c> the</c><00:16:11.399><c> starting</c><00:16:11.800><c> and</c>

00:16:11.990 --> 00:16:12.000 align:start position:0%
it has two parentheses the starting and
 

00:16:12.000 --> 00:16:13.949 align:start position:0%
it has two parentheses the starting and
the<00:16:12.120><c> ending</c><00:16:12.759><c> so</c><00:16:13.000><c> with</c><00:16:13.160><c> this</c><00:16:13.279><c> you</c><00:16:13.399><c> are</c><00:16:13.519><c> telling</c>

00:16:13.949 --> 00:16:13.959 align:start position:0%
the ending so with this you are telling
 

00:16:13.959 --> 00:16:16.590 align:start position:0%
the ending so with this you are telling
scale<00:16:14.600><c> okay</c><00:16:14.759><c> now</c><00:16:14.959><c> we</c><00:16:15.079><c> are</c><00:16:15.240><c> talking</c><00:16:15.519><c> about</c><00:16:15.800><c> CTE</c>

00:16:16.590 --> 00:16:16.600 align:start position:0%
scale okay now we are talking about CTE
 

00:16:16.600 --> 00:16:18.749 align:start position:0%
scale okay now we are talking about CTE
and<00:16:16.800><c> it</c><00:16:17.000><c> has</c><00:16:17.120><c> a</c><00:16:17.319><c> name</c><00:16:17.720><c> so</c><00:16:17.920><c> if</c><00:16:18.000><c> you</c><00:16:18.120><c> are</c><00:16:18.240><c> using</c><00:16:18.600><c> a</c>

00:16:18.749 --> 00:16:18.759 align:start position:0%
and it has a name so if you are using a
 

00:16:18.759 --> 00:16:21.430 align:start position:0%
and it has a name so if you are using a
query<00:16:19.160><c> inside</c><00:16:19.720><c> with</c><00:16:20.040><c> Cloud</c><00:16:20.639><c> we</c><00:16:20.800><c> call</c><00:16:21.079><c> this</c><00:16:21.319><c> a</c>

00:16:21.430 --> 00:16:21.440 align:start position:0%
query inside with Cloud we call this a
 

00:16:21.440 --> 00:16:25.150 align:start position:0%
query inside with Cloud we call this a
CTE<00:16:21.920><c> query</c><00:16:22.560><c> it</c><00:16:22.680><c> is</c><00:16:22.959><c> where</c><00:16:23.160><c> you</c><00:16:23.440><c> define</c><00:16:24.199><c> the</c><00:16:24.399><c> CTE</c>

00:16:25.150 --> 00:16:25.160 align:start position:0%
CTE query it is where you define the CTE
 

00:16:25.160 --> 00:16:26.670 align:start position:0%
CTE query it is where you define the CTE
now<00:16:25.319><c> of</c><00:16:25.440><c> course</c><00:16:25.600><c> we</c><00:16:25.759><c> don't</c><00:16:25.920><c> want</c><00:16:26.199><c> only</c><00:16:26.480><c> to</c>

00:16:26.670 --> 00:16:26.680 align:start position:0%
now of course we don't want only to
 

00:16:26.680 --> 00:16:28.949 align:start position:0%
now of course we don't want only to
define<00:16:26.959><c> a</c><00:16:27.079><c> CTE</c><00:16:27.519><c> we</c><00:16:27.639><c> want</c><00:16:27.800><c> to</c><00:16:27.959><c> use</c><00:16:28.160><c> it</c><00:16:28.519><c> so</c>

00:16:28.949 --> 00:16:28.959 align:start position:0%
define a CTE we want to use it so
 

00:16:28.959 --> 00:16:31.150 align:start position:0%
define a CTE we want to use it so
outside<00:16:29.480><c> of</c><00:16:29.720><c> this</c><00:16:29.920><c> definition</c><00:16:30.480><c> we</c><00:16:30.600><c> can</c><00:16:30.759><c> go</c><00:16:30.959><c> and</c>

00:16:31.150 --> 00:16:31.160 align:start position:0%
outside of this definition we can go and
 

00:16:31.160 --> 00:16:33.790 align:start position:0%
outside of this definition we can go and
use<00:16:31.440><c> it</c><00:16:31.720><c> like</c><00:16:31.920><c> this</c><00:16:32.279><c> so</c><00:16:32.440><c> we</c><00:16:32.519><c> are</c><00:16:32.680><c> saying</c><00:16:33.079><c> select</c>

00:16:33.790 --> 00:16:33.800 align:start position:0%
use it like this so we are saying select
 

00:16:33.800 --> 00:16:36.990 align:start position:0%
use it like this so we are saying select
from<00:16:34.560><c> the</c><00:16:34.759><c> CTE</c><00:16:35.480><c> name</c><00:16:36.120><c> so</c><00:16:36.360><c> that</c><00:16:36.480><c> means</c><00:16:36.680><c> we</c><00:16:36.800><c> want</c>

00:16:36.990 --> 00:16:37.000 align:start position:0%
from the CTE name so that means we want
 

00:16:37.000 --> 00:16:39.069 align:start position:0%
from the CTE name so that means we want
to<00:16:37.120><c> select</c><00:16:37.480><c> the</c><00:16:37.680><c> data</c><00:16:38.040><c> from</c><00:16:38.279><c> the</c><00:16:38.480><c> result</c><00:16:38.920><c> of</c>

00:16:39.069 --> 00:16:39.079 align:start position:0%
to select the data from the result of
 

00:16:39.079 --> 00:16:41.110 align:start position:0%
to select the data from the result of
the<00:16:39.199><c> CTE</c><00:16:39.959><c> and</c><00:16:40.120><c> here</c><00:16:40.279><c> it's</c><00:16:40.440><c> very</c><00:16:40.600><c> important</c><00:16:40.959><c> to</c>

00:16:41.110 --> 00:16:41.120 align:start position:0%
the CTE and here it's very important to
 

00:16:41.120 --> 00:16:43.749 align:start position:0%
the CTE and here it's very important to
use<00:16:41.560><c> exactly</c><00:16:42.160><c> the</c><00:16:42.440><c> same</c><00:16:42.720><c> name</c><00:16:43.079><c> as</c><00:16:43.199><c> you</c><00:16:43.399><c> define</c>

00:16:43.749 --> 00:16:43.759 align:start position:0%
use exactly the same name as you define
 

00:16:43.759 --> 00:16:46.230 align:start position:0%
use exactly the same name as you define
it<00:16:44.120><c> in</c><00:16:44.240><c> the</c><00:16:44.399><c> with</c><00:16:44.759><c> clouds</c><00:16:45.399><c> so</c><00:16:45.639><c> if</c><00:16:45.720><c> you</c><00:16:45.839><c> leave</c><00:16:46.040><c> it</c>

00:16:46.230 --> 00:16:46.240 align:start position:0%
it in the with clouds so if you leave it
 

00:16:46.240 --> 00:16:48.590 align:start position:0%
it in the with clouds so if you leave it
like<00:16:46.480><c> this</c><00:16:46.880><c> we</c><00:16:47.000><c> can</c><00:16:47.240><c> call</c><00:16:47.560><c> this</c><00:16:48.000><c> the</c><00:16:48.199><c> main</c>

00:16:48.590 --> 00:16:48.600 align:start position:0%
like this we can call this the main
 

00:16:48.600 --> 00:16:51.670 align:start position:0%
like this we can call this the main
query<00:16:49.319><c> it</c><00:16:49.480><c> is</c><00:16:49.800><c> the</c><00:16:50.079><c> place</c><00:16:50.480><c> where</c><00:16:50.720><c> we</c><00:16:50.959><c> use</c><00:16:51.519><c> the</c>

00:16:51.670 --> 00:16:51.680 align:start position:0%
query it is the place where we use the
 

00:16:51.680 --> 00:16:54.350 align:start position:0%
query it is the place where we use the
CTE<00:16:52.480><c> so</c><00:16:52.720><c> this</c><00:16:52.920><c> is</c><00:16:53.079><c> the</c><00:16:53.240><c> syntax</c><00:16:53.720><c> of</c><00:16:53.920><c> a</c><00:16:54.120><c> very</c>

00:16:54.350 --> 00:16:54.360 align:start position:0%
CTE so this is the syntax of a very
 

00:16:54.360 --> 00:16:57.189 align:start position:0%
CTE so this is the syntax of a very
simple<00:16:54.959><c> CTE</c><00:16:55.519><c> in</c><00:16:55.720><c> SQL</c><00:16:56.560><c> okay</c><00:16:56.680><c> so</c><00:16:56.839><c> now</c><00:16:57.000><c> what</c><00:16:57.079><c> we're</c>

00:16:57.189 --> 00:16:57.199 align:start position:0%
simple CTE in SQL okay so now what we're
 

00:16:57.199 --> 00:16:58.470 align:start position:0%
simple CTE in SQL okay so now what we're
going<00:16:57.319><c> to</c><00:16:57.440><c> do</c><00:16:57.560><c> we're</c><00:16:57.680><c> going</c><00:16:57.759><c> to</c><00:16:57.920><c> have</c><00:16:58.120><c> like</c><00:16:58.279><c> a</c>

00:16:58.470 --> 00:16:58.480 align:start position:0%
going to do we're going to have like a
 

00:16:58.480 --> 00:17:00.870 align:start position:0%
going to do we're going to have like a
task<00:16:59.160><c> that's</c><00:16:59.399><c> going</c><00:16:59.519><c> to</c><00:16:59.720><c> keep</c><00:17:00.120><c> progressing</c>

00:17:00.870 --> 00:17:00.880 align:start position:0%
task that's going to keep progressing
 

00:17:00.880 --> 00:17:02.430 align:start position:0%
task that's going to keep progressing
through<00:17:01.160><c> this</c><00:17:01.360><c> section</c><00:17:01.920><c> so</c><00:17:02.079><c> we're</c><00:17:02.240><c> going</c><00:17:02.319><c> to</c>

00:17:02.430 --> 00:17:02.440 align:start position:0%
through this section so we're going to
 

00:17:02.440 --> 00:17:03.910 align:start position:0%
through this section so we're going to
start<00:17:02.639><c> with</c><00:17:02.759><c> the</c><00:17:02.880><c> first</c><00:17:03.160><c> step</c><00:17:03.440><c> and</c><00:17:03.560><c> we</c><00:17:03.680><c> will</c>

00:17:03.910 --> 00:17:03.920 align:start position:0%
start with the first step and we will
 

00:17:03.920 --> 00:17:06.069 align:start position:0%
start with the first step and we will
keep<00:17:04.199><c> adding</c><00:17:04.559><c> steps</c><00:17:05.039><c> as</c><00:17:05.199><c> we</c><00:17:05.439><c> progress</c><00:17:05.799><c> in</c><00:17:05.919><c> the</c>

00:17:06.069 --> 00:17:06.079 align:start position:0%
keep adding steps as we progress in the
 

00:17:06.079 --> 00:17:08.270 align:start position:0%
keep adding steps as we progress in the
CTE<00:17:06.640><c> so</c><00:17:06.799><c> now</c><00:17:07.039><c> the</c><00:17:07.160><c> first</c><00:17:07.400><c> step</c><00:17:07.600><c> in</c><00:17:07.760><c> this</c><00:17:07.959><c> task</c>

00:17:08.270 --> 00:17:08.280 align:start position:0%
CTE so now the first step in this task
 

00:17:08.280 --> 00:17:11.789 align:start position:0%
CTE so now the first step in this task
says<00:17:09.039><c> find</c><00:17:09.480><c> the</c><00:17:09.679><c> total</c><00:17:10.039><c> sales</c><00:17:10.720><c> per</c><00:17:11.120><c> customer</c>

00:17:11.789 --> 00:17:11.799 align:start position:0%
says find the total sales per customer
 

00:17:11.799 --> 00:17:13.470 align:start position:0%
says find the total sales per customer
and<00:17:11.919><c> now</c><00:17:12.079><c> of</c><00:17:12.240><c> course</c><00:17:12.480><c> since</c><00:17:12.679><c> we</c><00:17:12.799><c> have</c><00:17:12.959><c> only</c><00:17:13.199><c> one</c>

00:17:13.470 --> 00:17:13.480 align:start position:0%
and now of course since we have only one
 

00:17:13.480 --> 00:17:15.870 align:start position:0%
and now of course since we have only one
step<00:17:13.760><c> it</c><00:17:13.880><c> makes</c><00:17:14.160><c> no</c><00:17:14.360><c> sense</c><00:17:14.559><c> to</c><00:17:14.679><c> use</c><00:17:14.959><c> the</c><00:17:15.120><c> CTE</c>

00:17:15.870 --> 00:17:15.880 align:start position:0%
step it makes no sense to use the CTE
 

00:17:15.880 --> 00:17:17.870 align:start position:0%
step it makes no sense to use the CTE
but<00:17:16.039><c> we</c><00:17:16.160><c> will</c><00:17:16.360><c> use</c><00:17:16.520><c> it</c><00:17:16.760><c> since</c><00:17:17.039><c> we</c><00:17:17.160><c> know</c><00:17:17.480><c> that</c>

00:17:17.870 --> 00:17:17.880 align:start position:0%
but we will use it since we know that
 

00:17:17.880 --> 00:17:20.470 align:start position:0%
but we will use it since we know that
there<00:17:18.000><c> will</c><00:17:18.240><c> be</c><00:17:18.799><c> different</c><00:17:19.160><c> steps</c><00:17:19.559><c> later</c><00:17:20.240><c> so</c>

00:17:20.470 --> 00:17:20.480 align:start position:0%
there will be different steps later so
 

00:17:20.480 --> 00:17:22.390 align:start position:0%
there will be different steps later so
let's<00:17:20.679><c> start</c><00:17:20.919><c> doing</c><00:17:21.280><c> that</c><00:17:21.679><c> now</c><00:17:21.839><c> before</c><00:17:22.079><c> I</c><00:17:22.199><c> use</c>

00:17:22.390 --> 00:17:22.400 align:start position:0%
let's start doing that now before I use
 

00:17:22.400 --> 00:17:24.510 align:start position:0%
let's start doing that now before I use
any<00:17:22.559><c> CTE</c><00:17:23.079><c> I</c><00:17:23.199><c> would</c><00:17:23.360><c> like</c><00:17:23.600><c> just</c><00:17:23.760><c> to</c><00:17:23.959><c> write</c><00:17:24.240><c> our</c>

00:17:24.510 --> 00:17:24.520 align:start position:0%
any CTE I would like just to write our
 

00:17:24.520 --> 00:17:26.710 align:start position:0%
any CTE I would like just to write our
query<00:17:24.959><c> first</c><00:17:25.559><c> so</c><00:17:25.760><c> we</c><00:17:25.839><c> need</c><00:17:26.000><c> the</c><00:17:26.160><c> total</c><00:17:26.439><c> sales</c>

00:17:26.710 --> 00:17:26.720 align:start position:0%
query first so we need the total sales
 

00:17:26.720 --> 00:17:29.070 align:start position:0%
query first so we need the total sales
for<00:17:26.919><c> each</c><00:17:27.199><c> customers</c><00:17:27.799><c> it's</c><00:17:27.959><c> very</c><00:17:28.240><c> simple</c><00:17:28.919><c> so</c>

00:17:29.070 --> 00:17:29.080 align:start position:0%
for each customers it's very simple so
 

00:17:29.080 --> 00:17:31.029 align:start position:0%
for each customers it's very simple so
we're<00:17:29.200><c> going</c><00:17:29.320><c> to</c><00:17:29.440><c> go</c><00:17:29.559><c> and</c><00:17:29.720><c> select</c><00:17:30.559><c> and</c><00:17:30.760><c> what</c><00:17:30.919><c> do</c>

00:17:31.029 --> 00:17:31.039 align:start position:0%
we're going to go and select and what do
 

00:17:31.039 --> 00:17:33.950 align:start position:0%
we're going to go and select and what do
we<00:17:31.160><c> need</c><00:17:31.400><c> let's</c><00:17:31.600><c> go</c><00:17:31.760><c> and</c><00:17:32.000><c> get</c><00:17:32.320><c> the</c><00:17:32.520><c> customer</c><00:17:33.000><c> ID</c>

00:17:33.950 --> 00:17:33.960 align:start position:0%
we need let's go and get the customer ID
 

00:17:33.960 --> 00:17:36.870 align:start position:0%
we need let's go and get the customer ID
and<00:17:34.240><c> we</c><00:17:34.480><c> need</c><00:17:35.039><c> to</c><00:17:35.240><c> do</c><00:17:35.520><c> aggregations</c><00:17:36.320><c> on</c><00:17:36.520><c> the</c>

00:17:36.870 --> 00:17:36.880 align:start position:0%
and we need to do aggregations on the
 

00:17:36.880 --> 00:17:39.909 align:start position:0%
and we need to do aggregations on the
sales<00:17:37.320><c> so</c><00:17:38.160><c> summarize</c><00:17:38.799><c> the</c><00:17:38.960><c> sales</c><00:17:39.640><c> and</c><00:17:39.799><c> we're</c>

00:17:39.909 --> 00:17:39.919 align:start position:0%
sales so summarize the sales and we're
 

00:17:39.919 --> 00:17:43.789 align:start position:0%
sales so summarize the sales and we're
going<00:17:40.000><c> to</c><00:17:40.160><c> call</c><00:17:40.360><c> it</c><00:17:41.280><c> total</c><00:17:42.360><c> sales</c><00:17:43.360><c> from</c><00:17:43.600><c> the</c>

00:17:43.789 --> 00:17:43.799 align:start position:0%
going to call it total sales from the
 

00:17:43.799 --> 00:17:45.710 align:start position:0%
going to call it total sales from the
table<00:17:44.320><c> and</c><00:17:44.440><c> now</c><00:17:44.679><c> since</c><00:17:44.960><c> this</c><00:17:45.080><c> is</c><00:17:45.200><c> our</c><00:17:45.400><c> first</c>

00:17:45.710 --> 00:17:45.720 align:start position:0%
table and now since this is our first
 

00:17:45.720 --> 00:17:47.909 align:start position:0%
table and now since this is our first
query<00:17:46.039><c> we</c><00:17:46.160><c> have</c><00:17:46.240><c> to</c><00:17:46.400><c> get</c><00:17:46.600><c> the</c><00:17:46.760><c> data</c><00:17:47.360><c> from</c><00:17:47.600><c> our</c>

00:17:47.909 --> 00:17:47.919 align:start position:0%
query we have to get the data from our
 

00:17:47.919 --> 00:17:49.830 align:start position:0%
query we have to get the data from our
database<00:17:48.799><c> so</c><00:17:49.000><c> we</c><00:17:49.120><c> don't</c><00:17:49.320><c> have</c><00:17:49.480><c> any</c><00:17:49.640><c> other</c>

00:17:49.830 --> 00:17:49.840 align:start position:0%
database so we don't have any other
 

00:17:49.840 --> 00:17:51.830 align:start position:0%
database so we don't have any other
option<00:17:50.240><c> our</c><00:17:50.480><c> data</c><00:17:50.720><c> going</c><00:17:50.799><c> to</c><00:17:50.919><c> be</c><00:17:51.039><c> in</c><00:17:51.160><c> the</c><00:17:51.280><c> sales</c>

00:17:51.830 --> 00:17:51.840 align:start position:0%
option our data going to be in the sales
 

00:17:51.840 --> 00:17:54.950 align:start position:0%
option our data going to be in the sales
orders<00:17:52.600><c> so</c><00:17:53.200><c> let's</c><00:17:53.400><c> go</c><00:17:53.640><c> and</c><00:17:53.880><c> get</c><00:17:54.039><c> it</c><00:17:54.600><c> and</c><00:17:54.760><c> don't</c>

00:17:54.950 --> 00:17:54.960 align:start position:0%
orders so let's go and get it and don't
 

00:17:54.960 --> 00:17:57.430 align:start position:0%
orders so let's go and get it and don't
forget<00:17:55.360><c> to</c><00:17:55.799><c> group</c><00:17:56.159><c> by</c><00:17:56.400><c> for</c><00:17:56.559><c> the</c><00:17:56.720><c> aggregation</c>

00:17:57.430 --> 00:17:57.440 align:start position:0%
forget to group by for the aggregation
 

00:17:57.440 --> 00:17:59.029 align:start position:0%
forget to group by for the aggregation
we<00:17:57.520><c> are</c><00:17:57.640><c> grouping</c><00:17:58.080><c> by</c><00:17:58.320><c> the</c><00:17:58.480><c> customer</c><00:17:58.840><c> customer</c>

00:17:59.029 --> 00:17:59.039 align:start position:0%
we are grouping by the customer customer
 

00:17:59.039 --> 00:18:02.350 align:start position:0%
we are grouping by the customer customer
ID<00:17:59.720><c> that's</c><00:18:00.039><c> it</c><00:18:00.640><c> let's</c><00:18:00.919><c> go</c><00:18:01.159><c> and</c><00:18:01.440><c> execute</c><00:18:01.880><c> it</c><00:18:02.240><c> and</c>

00:18:02.350 --> 00:18:02.360 align:start position:0%
ID that's it let's go and execute it and
 

00:18:02.360 --> 00:18:03.909 align:start position:0%
ID that's it let's go and execute it and
as<00:18:02.480><c> you</c><00:18:02.559><c> can</c><00:18:02.679><c> see</c><00:18:02.840><c> in</c><00:18:02.919><c> the</c><00:18:03.039><c> output</c><00:18:03.480><c> nothing</c><00:18:03.720><c> is</c>

00:18:03.909 --> 00:18:03.919 align:start position:0%
as you can see in the output nothing is
 

00:18:03.919 --> 00:18:05.909 align:start position:0%
as you can see in the output nothing is
fancy<00:18:04.320><c> we</c><00:18:04.440><c> are</c><00:18:04.640><c> just</c><00:18:04.880><c> aggregating</c><00:18:05.400><c> the</c><00:18:05.480><c> sales</c>

00:18:05.909 --> 00:18:05.919 align:start position:0%
fancy we are just aggregating the sales
 

00:18:05.919 --> 00:18:07.549 align:start position:0%
fancy we are just aggregating the sales
by<00:18:06.080><c> the</c><00:18:06.240><c> customers</c><00:18:06.919><c> so</c><00:18:07.120><c> with</c><00:18:07.240><c> that</c><00:18:07.360><c> you</c><00:18:07.480><c> have</c>

00:18:07.549 --> 00:18:07.559 align:start position:0%
by the customers so with that you have
 

00:18:07.559 --> 00:18:09.990 align:start position:0%
by the customers so with that you have
so<00:18:07.880><c> the</c><00:18:08.000><c> task</c><00:18:08.679><c> but</c><00:18:08.880><c> now</c><00:18:09.200><c> I</c><00:18:09.280><c> would</c><00:18:09.440><c> like</c><00:18:09.600><c> to</c><00:18:09.760><c> put</c>

00:18:09.990 --> 00:18:10.000 align:start position:0%
so the task but now I would like to put
 

00:18:10.000 --> 00:18:12.510 align:start position:0%
so the task but now I would like to put
my<00:18:10.240><c> query</c><00:18:10.600><c> in</c><00:18:10.840><c> a</c><00:18:11.080><c> CTE</c><00:18:11.919><c> and</c><00:18:12.039><c> that's</c><00:18:12.240><c> because</c>

00:18:12.510 --> 00:18:12.520 align:start position:0%
my query in a CTE and that's because
 

00:18:12.520 --> 00:18:14.630 align:start position:0%
my query in a CTE and that's because
later<00:18:12.760><c> we're</c><00:18:12.919><c> going</c><00:18:13.000><c> to</c><00:18:13.159><c> add</c><00:18:13.320><c> more</c><00:18:13.559><c> steps</c><00:18:14.159><c> so</c>

00:18:14.630 --> 00:18:14.640 align:start position:0%
later we're going to add more steps so
 

00:18:14.640 --> 00:18:17.630 align:start position:0%
later we're going to add more steps so
let's<00:18:15.000><c> put</c><00:18:15.400><c> our</c><00:18:15.760><c> query</c><00:18:16.120><c> in</c><00:18:16.320><c> a</c><00:18:16.559><c> c</c><00:18:17.120><c> and</c><00:18:17.280><c> in</c><00:18:17.400><c> order</c>

00:18:17.630 --> 00:18:17.640 align:start position:0%
let's put our query in a c and in order
 

00:18:17.640 --> 00:18:19.710 align:start position:0%
let's put our query in a c and in order
to<00:18:17.760><c> do</c><00:18:18.000><c> that</c><00:18:18.559><c> we're</c><00:18:18.720><c> going</c><00:18:18.840><c> to</c><00:18:19.000><c> start</c><00:18:19.280><c> with</c><00:18:19.480><c> the</c>

00:18:19.710 --> 00:18:19.720 align:start position:0%
to do that we're going to start with the
 

00:18:19.720 --> 00:18:22.230 align:start position:0%
to do that we're going to start with the
with<00:18:20.159><c> keyword</c><00:18:21.080><c> and</c><00:18:21.240><c> now</c><00:18:21.360><c> we</c><00:18:21.480><c> have</c><00:18:21.600><c> to</c><00:18:21.840><c> define</c>

00:18:22.230 --> 00:18:22.240 align:start position:0%
with keyword and now we have to define
 

00:18:22.240 --> 00:18:24.070 align:start position:0%
with keyword and now we have to define
the<00:18:22.440><c> name</c><00:18:22.720><c> of</c><00:18:22.880><c> the</c><00:18:23.000><c> CTE</c><00:18:23.520><c> so</c><00:18:23.640><c> I'm</c><00:18:23.720><c> going</c><00:18:23.840><c> to</c><00:18:23.960><c> call</c>

00:18:24.070 --> 00:18:24.080 align:start position:0%
the name of the CTE so I'm going to call
 

00:18:24.080 --> 00:18:28.750 align:start position:0%
the name of the CTE so I'm going to call
it<00:18:24.559><c> ctor</c><00:18:26.000><c> total</c><00:18:27.000><c> sales</c><00:18:27.640><c> like</c><00:18:27.880><c> this</c><00:18:28.360><c> and</c><00:18:28.440><c> then</c>

00:18:28.750 --> 00:18:28.760 align:start position:0%
it ctor total sales like this and then
 

00:18:28.760 --> 00:18:30.630 align:start position:0%
it ctor total sales like this and then
afterward<00:18:29.240><c> we're</c><00:18:29.360><c> going</c><00:18:29.440><c> to</c><00:18:29.559><c> say</c><00:18:29.840><c> as</c><00:18:30.360><c> and</c><00:18:30.520><c> then</c>

00:18:30.630 --> 00:18:30.640 align:start position:0%
afterward we're going to say as and then
 

00:18:30.640 --> 00:18:32.950 align:start position:0%
afterward we're going to say as and then
we<00:18:30.760><c> have</c><00:18:30.880><c> to</c><00:18:31.039><c> go</c><00:18:31.200><c> and</c><00:18:31.440><c> add</c><00:18:31.799><c> the</c><00:18:32.039><c> parenthesis</c><00:18:32.760><c> at</c>

00:18:32.950 --> 00:18:32.960 align:start position:0%
we have to go and add the parenthesis at
 

00:18:32.960 --> 00:18:35.750 align:start position:0%
we have to go and add the parenthesis at
the<00:18:33.120><c> start</c><00:18:33.799><c> and</c><00:18:34.039><c> as</c><00:18:34.240><c> well</c><00:18:34.799><c> at</c><00:18:35.000><c> the</c><00:18:35.120><c> end</c><00:18:35.600><c> and</c>

00:18:35.750 --> 00:18:35.760 align:start position:0%
the start and as well at the end and
 

00:18:35.760 --> 00:18:38.110 align:start position:0%
the start and as well at the end and
with<00:18:35.919><c> that</c><00:18:36.080><c> we</c><00:18:36.200><c> are</c><00:18:36.320><c> telling</c><00:18:36.640><c> esql</c><00:18:37.520><c> this</c><00:18:37.720><c> query</c>

00:18:38.110 --> 00:18:38.120 align:start position:0%
with that we are telling esql this query
 

00:18:38.120 --> 00:18:41.350 align:start position:0%
with that we are telling esql this query
is<00:18:38.400><c> a</c><00:18:38.640><c> CTE</c><00:18:39.159><c> query</c><00:18:39.720><c> so</c><00:18:39.919><c> that</c><00:18:40.120><c> means</c><00:18:40.679><c> the</c><00:18:40.840><c> SQL</c>

00:18:41.350 --> 00:18:41.360 align:start position:0%
is a CTE query so that means the SQL
 

00:18:41.360 --> 00:18:44.390 align:start position:0%
is a CTE query so that means the SQL
should<00:18:41.799><c> store</c><00:18:42.520><c> the</c><00:18:42.720><c> result</c><00:18:43.080><c> of</c><00:18:43.280><c> this</c><00:18:43.440><c> query</c><00:18:44.200><c> in</c>

00:18:44.390 --> 00:18:44.400 align:start position:0%
should store the result of this query in
 

00:18:44.400 --> 00:18:47.350 align:start position:0%
should store the result of this query in
a<00:18:44.640><c> cach</c><00:18:44.919><c> in</c><00:18:45.120><c> memory</c><00:18:45.679><c> to</c><00:18:45.840><c> be</c><00:18:46.000><c> used</c><00:18:46.400><c> later</c><00:18:47.080><c> in</c><00:18:47.240><c> the</c>

00:18:47.350 --> 00:18:47.360 align:start position:0%
a cach in memory to be used later in the
 

00:18:47.360 --> 00:18:49.870 align:start position:0%
a cach in memory to be used later in the
main<00:18:47.640><c> query</c><00:18:48.240><c> our</c><00:18:48.600><c> CTE</c><00:18:49.080><c> and</c><00:18:49.200><c> of</c><00:18:49.360><c> course</c><00:18:49.600><c> what</c><00:18:49.720><c> is</c>

00:18:49.870 --> 00:18:49.880 align:start position:0%
main query our CTE and of course what is
 

00:18:49.880 --> 00:18:52.190 align:start position:0%
main query our CTE and of course what is
missing<00:18:50.320><c> is</c><00:18:50.679><c> the</c><00:18:50.840><c> main</c><00:18:51.120><c> query</c><00:18:51.720><c> and</c><00:18:51.799><c> we</c><00:18:51.960><c> have</c><00:18:52.080><c> to</c>

00:18:52.190 --> 00:18:52.200 align:start position:0%
missing is the main query and we have to
 

00:18:52.200 --> 00:18:54.270 align:start position:0%
missing is the main query and we have to
do<00:18:52.360><c> it</c><00:18:52.559><c> exactly</c><00:18:53.240><c> after</c><00:18:53.640><c> the</c><00:18:53.799><c> definition</c><00:18:54.159><c> of</c>

00:18:54.270 --> 00:18:54.280 align:start position:0%
do it exactly after the definition of
 

00:18:54.280 --> 00:18:56.350 align:start position:0%
do it exactly after the definition of
the<00:18:54.440><c> CTE</c><00:18:55.120><c> I</c><00:18:55.200><c> will</c><00:18:55.400><c> just</c><00:18:55.559><c> make</c><00:18:55.760><c> here</c><00:18:55.919><c> a</c><00:18:56.039><c> small</c>

00:18:56.350 --> 00:18:56.360 align:start position:0%
the CTE I will just make here a small
 

00:18:56.360 --> 00:18:58.950 align:start position:0%
the CTE I will just make here a small
comment<00:18:56.880><c> about</c><00:18:57.400><c> the</c><00:18:57.559><c> main</c><00:18:57.840><c> query</c><00:18:58.360><c> and</c><00:18:58.520><c> let</c><00:18:58.840><c> me</c>

00:18:58.950 --> 00:18:58.960 align:start position:0%
comment about the main query and let me
 

00:18:58.960 --> 00:19:01.669 align:start position:0%
comment about the main query and let me
just<00:18:59.120><c> make</c><00:18:59.360><c> this</c><00:18:59.640><c> smaller</c><00:19:00.640><c> like</c><00:19:00.960><c> this</c><00:19:01.400><c> and</c><00:19:01.520><c> now</c>

00:19:01.669 --> 00:19:01.679 align:start position:0%
just make this smaller like this and now
 

00:19:01.679 --> 00:19:03.470 align:start position:0%
just make this smaller like this and now
we<00:19:01.799><c> have</c><00:19:01.919><c> to</c><00:19:02.080><c> go</c><00:19:02.360><c> and</c><00:19:02.640><c> have</c><00:19:02.880><c> a</c><00:19:03.000><c> very</c><00:19:03.159><c> simple</c>

00:19:03.470 --> 00:19:03.480 align:start position:0%
we have to go and have a very simple
 

00:19:03.480 --> 00:19:04.390 align:start position:0%
we have to go and have a very simple
select

00:19:04.390 --> 00:19:04.400 align:start position:0%
select
 

00:19:04.400 --> 00:19:06.830 align:start position:0%
select
statements<00:19:05.400><c> from</c><00:19:06.080><c> and</c><00:19:06.200><c> now</c><00:19:06.320><c> I</c><00:19:06.400><c> would</c><00:19:06.559><c> like</c><00:19:06.679><c> to</c>

00:19:06.830 --> 00:19:06.840 align:start position:0%
statements from and now I would like to
 

00:19:06.840 --> 00:19:08.510 align:start position:0%
statements from and now I would like to
get<00:19:07.000><c> more</c><00:19:07.240><c> details</c><00:19:07.679><c> from</c><00:19:07.880><c> the</c><00:19:08.039><c> customers</c>

00:19:08.510 --> 00:19:08.520 align:start position:0%
get more details from the customers
 

00:19:08.520 --> 00:19:13.029 align:start position:0%
get more details from the customers
table<00:19:09.200><c> so</c><00:19:09.520><c> I</c><00:19:09.640><c> will</c><00:19:09.919><c> just</c><00:19:10.159><c> go</c><00:19:10.400><c> now</c><00:19:10.600><c> to</c><00:19:10.799><c> the</c>

00:19:13.029 --> 00:19:13.039 align:start position:0%
table so I will just go now to the
 

00:19:13.039 --> 00:19:15.830 align:start position:0%
table so I will just go now to the
customers<00:19:14.039><c> so</c><00:19:14.240><c> now</c><00:19:14.400><c> we</c><00:19:14.520><c> are</c><00:19:14.760><c> not</c><00:19:15.000><c> querying</c><00:19:15.720><c> the</c>

00:19:15.830 --> 00:19:15.840 align:start position:0%
customers so now we are not querying the
 

00:19:15.840 --> 00:19:17.909 align:start position:0%
customers so now we are not querying the
CTE<00:19:16.440><c> right</c><00:19:16.600><c> we</c><00:19:16.679><c> are</c><00:19:16.880><c> just</c><00:19:17.080><c> querying</c><00:19:17.760><c> the</c>

00:19:17.909 --> 00:19:17.919 align:start position:0%
CTE right we are just querying the
 

00:19:17.919 --> 00:19:19.870 align:start position:0%
CTE right we are just querying the
database<00:19:18.400><c> table</c><00:19:18.679><c> that</c><00:19:18.840><c> we</c><00:19:19.039><c> have</c><00:19:19.480><c> and</c><00:19:19.640><c> I</c><00:19:19.760><c> would</c>

00:19:19.870 --> 00:19:19.880 align:start position:0%
database table that we have and I would
 

00:19:19.880 --> 00:19:21.630 align:start position:0%
database table that we have and I would
like<00:19:20.039><c> to</c><00:19:20.200><c> get</c><00:19:20.720><c> from</c><00:19:20.919><c> the</c><00:19:21.120><c> customer</c><00:19:21.520><c> the</c>

00:19:21.630 --> 00:19:21.640 align:start position:0%
like to get from the customer the
 

00:19:21.640 --> 00:19:26.789 align:start position:0%
like to get from the customer the
customer<00:19:22.320><c> ID</c><00:19:23.559><c> and</c><00:19:24.559><c> the</c><00:19:24.880><c> first</c><00:19:25.480><c> name</c><00:19:26.480><c> and</c><00:19:26.600><c> let's</c>

00:19:26.789 --> 00:19:26.799 align:start position:0%
customer ID and the first name and let's
 

00:19:26.799 --> 00:19:29.270 align:start position:0%
customer ID and the first name and let's
go<00:19:26.960><c> and</c><00:19:27.159><c> get</c><00:19:27.520><c> as</c><00:19:27.720><c> well</c><00:19:28.120><c> the</c><00:19:28.320><c> last</c><00:19:28.520><c> name</c>

00:19:29.270 --> 00:19:29.280 align:start position:0%
go and get as well the last name
 

00:19:29.280 --> 00:19:32.870 align:start position:0%
go and get as well the last name
name<00:19:30.280><c> so</c><00:19:30.480><c> now</c><00:19:30.799><c> if</c><00:19:30.960><c> we</c><00:19:31.159><c> go</c><00:19:31.360><c> and</c><00:19:31.679><c> query</c><00:19:32.200><c> this</c><00:19:32.679><c> what</c>

00:19:32.870 --> 00:19:32.880 align:start position:0%
name so now if we go and query this what
 

00:19:32.880 --> 00:19:34.750 align:start position:0%
name so now if we go and query this what
happens<00:19:33.240><c> in</c><00:19:33.400><c> the</c><00:19:33.520><c> output</c><00:19:33.919><c> we</c><00:19:34.000><c> are</c><00:19:34.159><c> getting</c><00:19:34.520><c> the</c>

00:19:34.750 --> 00:19:34.760 align:start position:0%
happens in the output we are getting the
 

00:19:34.760 --> 00:19:37.669 align:start position:0%
happens in the output we are getting the
data<00:19:35.120><c> actually</c><00:19:35.840><c> completely</c><00:19:36.840><c> from</c><00:19:37.360><c> the</c>

00:19:37.669 --> 00:19:37.679 align:start position:0%
data actually completely from the
 

00:19:37.679 --> 00:19:40.029 align:start position:0%
data actually completely from the
database<00:19:38.159><c> table</c><00:19:38.600><c> the</c><00:19:38.880><c> customers</c><00:19:39.640><c> and</c><00:19:39.840><c> of</c>

00:19:40.029 --> 00:19:40.039 align:start position:0%
database table the customers and of
 

00:19:40.039 --> 00:19:42.350 align:start position:0%
database table the customers and of
course<00:19:40.240><c> we</c><00:19:40.360><c> are</c><00:19:40.559><c> not</c><00:19:40.760><c> using</c><00:19:41.240><c> at</c><00:19:41.440><c> all</c><00:19:41.640><c> the</c><00:19:41.799><c> CTE</c>

00:19:42.350 --> 00:19:42.360 align:start position:0%
course we are not using at all the CTE
 

00:19:42.360 --> 00:19:44.070 align:start position:0%
course we are not using at all the CTE
inside<00:19:42.640><c> our</c><00:19:42.840><c> main</c><00:19:43.120><c> query</c><00:19:43.559><c> of</c><00:19:43.679><c> course</c><00:19:43.840><c> we</c><00:19:43.960><c> can</c>

00:19:44.070 --> 00:19:44.080 align:start position:0%
inside our main query of course we can
 

00:19:44.080 --> 00:19:46.110 align:start position:0%
inside our main query of course we can
do<00:19:44.240><c> that</c><00:19:44.480><c> but</c><00:19:44.600><c> it's</c><00:19:44.799><c> just</c><00:19:45.080><c> waste</c><00:19:45.480><c> of</c><00:19:45.880><c> like</c>

00:19:46.110 --> 00:19:46.120 align:start position:0%
do that but it's just waste of like
 

00:19:46.120 --> 00:19:48.470 align:start position:0%
do that but it's just waste of like
space<00:19:46.440><c> in</c><00:19:46.559><c> the</c><00:19:46.679><c> memory</c><00:19:47.120><c> because</c><00:19:47.720><c> SQL</c><00:19:48.240><c> did</c>

00:19:48.470 --> 00:19:48.480 align:start position:0%
space in the memory because SQL did
 

00:19:48.480 --> 00:19:50.590 align:start position:0%
space in the memory because SQL did
execute<00:19:49.039><c> this</c><00:19:49.240><c> and</c><00:19:49.400><c> stored</c><00:19:49.760><c> it</c><00:19:49.919><c> in</c><00:19:50.080><c> the</c>

00:19:50.590 --> 00:19:50.600 align:start position:0%
execute this and stored it in the
 

00:19:50.600 --> 00:19:52.190 align:start position:0%
execute this and stored it in the
database<00:19:51.080><c> memory</c><00:19:51.520><c> and</c><00:19:51.640><c> of</c><00:19:51.760><c> course</c><00:19:51.919><c> we</c><00:19:52.039><c> would</c>

00:19:52.190 --> 00:19:52.200 align:start position:0%
database memory and of course we would
 

00:19:52.200 --> 00:19:54.830 align:start position:0%
database memory and of course we would
like<00:19:52.360><c> to</c><00:19:52.440><c> use</c><00:19:52.880><c> the</c><00:19:53.000><c> CT</c><00:19:53.480><c> in</c><00:19:53.640><c> our</c><00:19:53.880><c> main</c><00:19:54.200><c> query</c><00:19:54.640><c> so</c>

00:19:54.830 --> 00:19:54.840 align:start position:0%
like to use the CT in our main query so
 

00:19:54.840 --> 00:19:57.190 align:start position:0%
like to use the CT in our main query so
let's<00:19:55.039><c> go</c><00:19:55.240><c> and</c><00:19:55.360><c> do</c><00:19:55.559><c> that</c><00:19:56.320><c> so</c><00:19:56.559><c> let's</c><00:19:56.720><c> go</c><00:19:56.919><c> and</c><00:19:57.039><c> do</c>

00:19:57.190 --> 00:19:57.200 align:start position:0%
let's go and do that so let's go and do
 

00:19:57.200 --> 00:20:00.070 align:start position:0%
let's go and do that so let's go and do
a<00:19:57.400><c> join</c><00:19:58.760><c> but</c><00:19:58.960><c> this</c><00:19:59.159><c> time</c><00:19:59.400><c> we're</c><00:19:59.520><c> going</c><00:19:59.640><c> to</c><00:19:59.799><c> join</c>

00:20:00.070 --> 00:20:00.080 align:start position:0%
a join but this time we're going to join
 

00:20:00.080 --> 00:20:02.950 align:start position:0%
a join but this time we're going to join
the<00:20:00.280><c> data</c><00:20:00.679><c> from</c><00:20:00.960><c> the</c><00:20:01.200><c> CTE</c><00:20:02.159><c> so</c><00:20:02.440><c> let's</c><00:20:02.640><c> go</c><00:20:02.840><c> and</c>

00:20:02.950 --> 00:20:02.960 align:start position:0%
the data from the CTE so let's go and
 

00:20:02.960 --> 00:20:06.750 align:start position:0%
the data from the CTE so let's go and
get<00:20:03.080><c> the</c><00:20:03.360><c> name</c><00:20:04.320><c> and</c><00:20:04.520><c> I</c><00:20:04.600><c> will</c><00:20:04.799><c> just</c><00:20:05.000><c> call</c><00:20:05.200><c> it</c><00:20:05.760><c> CTS</c>

00:20:06.750 --> 00:20:06.760 align:start position:0%
get the name and I will just call it CTS
 

00:20:06.760 --> 00:20:08.669 align:start position:0%
get the name and I will just call it CTS
so<00:20:06.919><c> what</c><00:20:07.039><c> we</c><00:20:07.120><c> are</c><00:20:07.280><c> doing</c><00:20:07.559><c> now</c><00:20:07.799><c> we</c><00:20:07.919><c> are</c><00:20:08.120><c> joining</c>

00:20:08.669 --> 00:20:08.679 align:start position:0%
so what we are doing now we are joining
 

00:20:08.679 --> 00:20:11.230 align:start position:0%
so what we are doing now we are joining
the<00:20:08.880><c> physical</c><00:20:09.320><c> table</c><00:20:09.720><c> the</c><00:20:10.000><c> customers</c><00:20:11.000><c> with</c>

00:20:11.230 --> 00:20:11.240 align:start position:0%
the physical table the customers with
 

00:20:11.240 --> 00:20:13.470 align:start position:0%
the physical table the customers with
the<00:20:11.679><c> virtual</c><00:20:12.200><c> table</c><00:20:12.559><c> that</c><00:20:12.679><c> we</c><00:20:12.799><c> have</c><00:20:13.000><c> created</c>

00:20:13.470 --> 00:20:13.480 align:start position:0%
the virtual table that we have created
 

00:20:13.480 --> 00:20:16.789 align:start position:0%
the virtual table that we have created
with<00:20:13.600><c> the</c><00:20:13.960><c> CTE</c><00:20:14.960><c> that</c><00:20:15.320><c> exist</c><00:20:15.840><c> only</c><00:20:16.320><c> in</c><00:20:16.520><c> our</c>

00:20:16.789 --> 00:20:16.799 align:start position:0%
with the CTE that exist only in our
 

00:20:16.799 --> 00:20:19.190 align:start position:0%
with the CTE that exist only in our
query<00:20:17.400><c> and</c><00:20:17.559><c> of</c><00:20:17.720><c> course</c><00:20:18.120><c> not</c><00:20:18.280><c> only</c><00:20:18.640><c> are</c><00:20:18.840><c> joining</c>

00:20:19.190 --> 00:20:19.200 align:start position:0%
query and of course not only are joining
 

00:20:19.200 --> 00:20:21.470 align:start position:0%
query and of course not only are joining
the<00:20:19.400><c> tables</c><00:20:20.120><c> we</c><00:20:20.240><c> would</c><00:20:20.440><c> like</c><00:20:20.640><c> to</c><00:20:20.840><c> get</c><00:20:21.320><c> the</c>

00:20:21.470 --> 00:20:21.480 align:start position:0%
the tables we would like to get the
 

00:20:21.480 --> 00:20:24.750 align:start position:0%
the tables we would like to get the
informations<00:20:22.120><c> from</c><00:20:22.280><c> the</c><00:20:22.440><c> CT</c><00:20:22.960><c> so</c><00:20:23.240><c> CTS</c><00:20:24.240><c> and</c><00:20:24.640><c> we</c>

00:20:24.750 --> 00:20:24.760 align:start position:0%
informations from the CT so CTS and we
 

00:20:24.760 --> 00:20:27.870 align:start position:0%
informations from the CT so CTS and we
need<00:20:25.000><c> only</c><00:20:25.400><c> that</c><00:20:25.640><c> total</c><00:20:25.960><c> sales</c><00:20:26.400><c> so</c><00:20:26.880><c> total</c>

00:20:27.870 --> 00:20:27.880 align:start position:0%
need only that total sales so total
 

00:20:27.880 --> 00:20:29.190 align:start position:0%
need only that total sales so total
sales

00:20:29.190 --> 00:20:29.200 align:start position:0%
sales
 

00:20:29.200 --> 00:20:31.750 align:start position:0%
sales
so<00:20:29.440><c> that</c><00:20:29.640><c> means</c><00:20:30.320><c> those</c><00:20:30.600><c> three</c><00:20:30.840><c> columns</c><00:20:31.400><c> comes</c>

00:20:31.750 --> 00:20:31.760 align:start position:0%
so that means those three columns comes
 

00:20:31.760 --> 00:20:34.190 align:start position:0%
so that means those three columns comes
from<00:20:31.960><c> our</c><00:20:32.200><c> database</c><00:20:32.640><c> table</c><00:20:33.039><c> customers</c><00:20:33.960><c> and</c>

00:20:34.190 --> 00:20:34.200 align:start position:0%
from our database table customers and
 

00:20:34.200 --> 00:20:36.110 align:start position:0%
from our database table customers and
only<00:20:34.520><c> this</c><00:20:34.720><c> column</c><00:20:35.000><c> the</c><00:20:35.159><c> total</c><00:20:35.400><c> sales</c><00:20:35.840><c> comes</c>

00:20:36.110 --> 00:20:36.120 align:start position:0%
only this column the total sales comes
 

00:20:36.120 --> 00:20:38.549 align:start position:0%
only this column the total sales comes
from<00:20:36.320><c> our</c><00:20:36.640><c> CTE</c><00:20:37.280><c> so</c><00:20:37.480><c> let's</c><00:20:37.640><c> go</c><00:20:37.799><c> and</c><00:20:38.000><c> execute</c><00:20:38.400><c> the</c>

00:20:38.549 --> 00:20:38.559 align:start position:0%
from our CTE so let's go and execute the
 

00:20:38.559 --> 00:20:40.230 align:start position:0%
from our CTE so let's go and execute the
whole<00:20:38.799><c> thing</c><00:20:39.360><c> now</c><00:20:39.559><c> as</c><00:20:39.679><c> you</c><00:20:39.760><c> can</c><00:20:39.880><c> see</c><00:20:40.000><c> in</c><00:20:40.120><c> the</c>

00:20:40.230 --> 00:20:40.240 align:start position:0%
whole thing now as you can see in the
 

00:20:40.240 --> 00:20:42.350 align:start position:0%
whole thing now as you can see in the
output<00:20:40.679><c> everything</c><00:20:40.960><c> is</c><00:20:41.120><c> working</c><00:20:41.840><c> we</c><00:20:42.000><c> have</c><00:20:42.240><c> the</c>

00:20:42.350 --> 00:20:42.360 align:start position:0%
output everything is working we have the
 

00:20:42.360 --> 00:20:44.870 align:start position:0%
output everything is working we have the
three<00:20:42.600><c> columns</c><00:20:43.080><c> from</c><00:20:43.280><c> the</c><00:20:43.440><c> table</c><00:20:43.919><c> customers</c>

00:20:44.870 --> 00:20:44.880 align:start position:0%
three columns from the table customers
 

00:20:44.880 --> 00:20:46.990 align:start position:0%
three columns from the table customers
and<00:20:45.039><c> we</c><00:20:45.200><c> have</c><00:20:45.360><c> the</c><00:20:45.520><c> total</c><00:20:45.880><c> sales</c><00:20:46.480><c> for</c><00:20:46.720><c> each</c>

00:20:46.990 --> 00:20:47.000 align:start position:0%
and we have the total sales for each
 

00:20:47.000 --> 00:20:49.070 align:start position:0%
and we have the total sales for each
customer<00:20:47.640><c> and</c><00:20:47.840><c> this</c><00:20:48.000><c> total</c><00:20:48.280><c> sales</c><00:20:48.600><c> comes</c><00:20:48.880><c> from</c>

00:20:49.070 --> 00:20:49.080 align:start position:0%
customer and this total sales comes from
 

00:20:49.080 --> 00:20:51.350 align:start position:0%
customer and this total sales comes from
our<00:20:49.360><c> CTE</c><00:20:50.000><c> now</c><00:20:50.159><c> as</c><00:20:50.280><c> you</c><00:20:50.360><c> can</c><00:20:50.520><c> see</c><00:20:50.840><c> the</c><00:20:51.039><c> last</c>

00:20:51.350 --> 00:20:51.360 align:start position:0%
our CTE now as you can see the last
 

00:20:51.360 --> 00:20:53.990 align:start position:0%
our CTE now as you can see the last
customer<00:20:52.159><c> has</c><00:20:52.320><c> a</c><00:20:52.480><c> null</c><00:20:52.840><c> over</c><00:20:53.159><c> here</c><00:20:53.600><c> and</c><00:20:53.760><c> that's</c>

00:20:53.990 --> 00:20:54.000 align:start position:0%
customer has a null over here and that's
 

00:20:54.000 --> 00:20:56.350 align:start position:0%
customer has a null over here and that's
because<00:20:54.360><c> in</c><00:20:54.520><c> the</c><00:20:54.720><c> table</c><00:20:55.000><c> orders</c><00:20:55.919><c> we</c><00:20:56.080><c> don't</c>

00:20:56.350 --> 00:20:56.360 align:start position:0%
because in the table orders we don't
 

00:20:56.360 --> 00:20:58.110 align:start position:0%
because in the table orders we don't
have<00:20:56.520><c> the</c><00:20:56.679><c> customer</c><00:20:57.080><c> five</c><00:20:57.600><c> and</c><00:20:57.720><c> now</c><00:20:57.840><c> you</c><00:20:57.960><c> might</c>

00:20:58.110 --> 00:20:58.120 align:start position:0%
have the customer five and now you might
 

00:20:58.120 --> 00:20:59.549 align:start position:0%
have the customer five and now you might
say<00:20:58.280><c> you</c><00:20:58.400><c> know</c><00:20:58.720><c> what</c><00:20:58.840><c> I</c><00:20:58.919><c> would</c><00:20:59.039><c> like</c><00:20:59.200><c> to</c><00:20:59.280><c> see</c>

00:20:59.549 --> 00:20:59.559 align:start position:0%
say you know what I would like to see
 

00:20:59.559 --> 00:21:01.909 align:start position:0%
say you know what I would like to see
the<00:20:59.760><c> intermediate</c><00:21:00.440><c> result</c><00:21:00.799><c> from</c><00:21:01.000><c> the</c><00:21:01.120><c> CTE</c>

00:21:01.909 --> 00:21:01.919 align:start position:0%
the intermediate result from the CTE
 

00:21:01.919 --> 00:21:03.270 align:start position:0%
the intermediate result from the CTE
because<00:21:02.200><c> what</c><00:21:02.320><c> we</c><00:21:02.440><c> are</c><00:21:02.559><c> seeing</c><00:21:02.840><c> now</c><00:21:03.000><c> in</c><00:21:03.120><c> the</c>

00:21:03.270 --> 00:21:03.280 align:start position:0%
because what we are seeing now in the
 

00:21:03.280 --> 00:21:06.190 align:start position:0%
because what we are seeing now in the
output<00:21:03.760><c> is</c><00:21:04.440><c> the</c><00:21:04.679><c> final</c><00:21:05.159><c> result</c><00:21:05.600><c> from</c><00:21:05.799><c> the</c><00:21:05.919><c> main</c>

00:21:06.190 --> 00:21:06.200 align:start position:0%
output is the final result from the main
 

00:21:06.200 --> 00:21:08.549 align:start position:0%
output is the final result from the main
query<00:21:06.919><c> so</c><00:21:07.120><c> now</c><00:21:07.280><c> what</c><00:21:07.400><c> we</c><00:21:07.520><c> can</c><00:21:07.760><c> do</c><00:21:07.960><c> in</c><00:21:08.080><c> order</c><00:21:08.400><c> to</c>

00:21:08.549 --> 00:21:08.559 align:start position:0%
query so now what we can do in order to
 

00:21:08.559 --> 00:21:11.110 align:start position:0%
query so now what we can do in order to
see<00:21:08.760><c> the</c><00:21:08.919><c> result</c><00:21:09.240><c> of</c><00:21:09.480><c> the</c><00:21:09.960><c> CTE</c><00:21:10.760><c> we're</c><00:21:10.880><c> going</c><00:21:11.000><c> to</c>

00:21:11.110 --> 00:21:11.120 align:start position:0%
see the result of the CTE we're going to
 

00:21:11.120 --> 00:21:13.510 align:start position:0%
see the result of the CTE we're going to
Mark<00:21:11.559><c> the</c><00:21:11.799><c> query</c><00:21:12.240><c> in</c><00:21:12.400><c> the</c><00:21:12.520><c> CTE</c><00:21:13.120><c> of</c><00:21:13.240><c> course</c>

00:21:13.510 --> 00:21:13.520 align:start position:0%
Mark the query in the CTE of course
 

00:21:13.520 --> 00:21:15.830 align:start position:0%
Mark the query in the CTE of course
without<00:21:13.840><c> any</c><00:21:14.120><c> parenthesis</c><00:21:14.720><c> or</c><00:21:14.960><c> the</c><00:21:15.159><c> wi</c><00:21:15.520><c> so</c>

00:21:15.830 --> 00:21:15.840 align:start position:0%
without any parenthesis or the wi so
 

00:21:15.840 --> 00:21:17.990 align:start position:0%
without any parenthesis or the wi so
just<00:21:16.000><c> the</c><00:21:16.200><c> query</c><00:21:16.640><c> and</c><00:21:16.919><c> execute</c><00:21:17.320><c> it</c><00:21:17.720><c> and</c><00:21:17.880><c> with</c>

00:21:17.990 --> 00:21:18.000 align:start position:0%
just the query and execute it and with
 

00:21:18.000 --> 00:21:19.630 align:start position:0%
just the query and execute it and with
that<00:21:18.159><c> you</c><00:21:18.240><c> can</c><00:21:18.360><c> see</c><00:21:18.559><c> in</c><00:21:18.679><c> the</c><00:21:18.799><c> output</c><00:21:19.440><c> the</c>

00:21:19.630 --> 00:21:19.640 align:start position:0%
that you can see in the output the
 

00:21:19.640 --> 00:21:22.070 align:start position:0%
that you can see in the output the
intermediate<00:21:20.279><c> results</c><00:21:20.840><c> that</c><00:21:21.080><c> we</c><00:21:21.200><c> are</c><00:21:21.440><c> passing</c>

00:21:22.070 --> 00:21:22.080 align:start position:0%
intermediate results that we are passing
 

00:21:22.080 --> 00:21:24.390 align:start position:0%
intermediate results that we are passing
to<00:21:22.240><c> the</c><00:21:22.360><c> main</c><00:21:22.679><c> query</c><00:21:23.600><c> and</c><00:21:23.760><c> as</c><00:21:23.880><c> you</c><00:21:23.960><c> can</c><00:21:24.080><c> see</c><00:21:24.279><c> we</c>

00:21:24.390 --> 00:21:24.400 align:start position:0%
to the main query and as you can see we
 

00:21:24.400 --> 00:21:26.430 align:start position:0%
to the main query and as you can see we
don't<00:21:24.640><c> have</c><00:21:24.799><c> here</c><00:21:25.039><c> customer</c><00:21:25.440><c> number</c><00:21:25.760><c> five</c>

00:21:26.430 --> 00:21:26.440 align:start position:0%
don't have here customer number five
 

00:21:26.440 --> 00:21:28.789 align:start position:0%
don't have here customer number five
that's<00:21:26.679><c> why</c><00:21:26.919><c> in</c><00:21:27.080><c> the</c><00:21:27.279><c> final</c><00:21:27.679><c> results</c><00:21:28.279><c> we</c><00:21:28.640><c> are</c>

00:21:28.789 --> 00:21:28.799 align:start position:0%
that's why in the final results we are
 

00:21:28.799 --> 00:21:30.630 align:start position:0%
that's why in the final results we are
getting<00:21:29.279><c> null</c><00:21:29.799><c> and</c><00:21:29.960><c> that's</c><00:21:30.159><c> of</c><00:21:30.320><c> course</c>

00:21:30.630 --> 00:21:30.640 align:start position:0%
getting null and that's of course
 

00:21:30.640 --> 00:21:33.070 align:start position:0%
getting null and that's of course
because<00:21:30.960><c> we</c><00:21:31.039><c> are</c><00:21:31.240><c> using</c><00:21:31.640><c> the</c><00:21:31.799><c> lift</c><00:21:32.080><c> join</c><00:21:32.600><c> so</c><00:21:32.960><c> if</c>

00:21:33.070 --> 00:21:33.080 align:start position:0%
because we are using the lift join so if
 

00:21:33.080 --> 00:21:34.990 align:start position:0%
because we are using the lift join so if
I<00:21:33.279><c> execute</c><00:21:33.679><c> the</c><00:21:33.840><c> whole</c><00:21:34.080><c> thing</c><00:21:34.480><c> you</c><00:21:34.600><c> can</c><00:21:34.720><c> see</c><00:21:34.919><c> we</c>

00:21:34.990 --> 00:21:35.000 align:start position:0%
I execute the whole thing you can see we
 

00:21:35.000 --> 00:21:36.669 align:start position:0%
I execute the whole thing you can see we
are<00:21:35.159><c> getting</c><00:21:35.400><c> the</c><00:21:35.600><c> customer</c><00:21:35.960><c> 5</c><00:21:36.240><c> over</c><00:21:36.440><c> here</c>

00:21:36.669 --> 00:21:36.679 align:start position:0%
are getting the customer 5 over here
 

00:21:36.679 --> 00:21:38.549 align:start position:0%
are getting the customer 5 over here
with<00:21:36.840><c> the</c><00:21:36.960><c> null</c><00:21:37.360><c> so</c><00:21:37.520><c> as</c><00:21:37.600><c> you</c><00:21:37.720><c> can</c><00:21:37.799><c> see</c><00:21:38.000><c> CTE</c><00:21:38.400><c> is</c>

00:21:38.549 --> 00:21:38.559 align:start position:0%
with the null so as you can see CTE is
 

00:21:38.559 --> 00:21:40.590 align:start position:0%
with the null so as you can see CTE is
very<00:21:38.720><c> simple</c><00:21:39.080><c> we</c><00:21:39.279><c> just</c><00:21:39.440><c> treat</c><00:21:39.760><c> it</c><00:21:40.080><c> as</c><00:21:40.360><c> any</c>

00:21:40.590 --> 00:21:40.600 align:start position:0%
very simple we just treat it as any
 

00:21:40.600 --> 00:21:42.830 align:start position:0%
very simple we just treat it as any
normal<00:21:41.039><c> database</c><00:21:41.559><c> table</c><00:21:42.039><c> but</c><00:21:42.240><c> this</c><00:21:42.400><c> table</c><00:21:42.679><c> is</c>

00:21:42.830 --> 00:21:42.840 align:start position:0%
normal database table but this table is
 

00:21:42.840 --> 00:21:44.830 align:start position:0%
normal database table but this table is
Created<00:21:43.279><c> from</c><00:21:43.520><c> our</c><00:21:43.919><c> query</c><00:21:44.279><c> that</c><00:21:44.559><c> we</c><00:21:44.640><c> have</c>

00:21:44.830 --> 00:21:44.840 align:start position:0%
Created from our query that we have
 

00:21:44.840 --> 00:21:47.470 align:start position:0%
Created from our query that we have
defined<00:21:45.480><c> in</c><00:21:45.679><c> the</c><00:21:45.880><c> CTE</c><00:21:46.480><c> over</c><00:21:46.760><c> here</c><00:21:47.159><c> now</c><00:21:47.320><c> of</c>

00:21:47.470 --> 00:21:47.480 align:start position:0%
defined in the CTE over here now of
 

00:21:47.480 --> 00:21:49.590 align:start position:0%
defined in the CTE over here now of
course<00:21:47.760><c> in</c><00:21:47.880><c> the</c><00:21:48.039><c> CTE</c><00:21:48.480><c> you</c><00:21:48.600><c> can</c><00:21:48.799><c> use</c><00:21:49.159><c> any</c><00:21:49.400><c> kind</c>

00:21:49.590 --> 00:21:49.600 align:start position:0%
course in the CTE you can use any kind
 

00:21:49.600 --> 00:21:53.110 align:start position:0%
course in the CTE you can use any kind
of<00:21:49.760><c> claes</c><00:21:50.400><c> like</c><00:21:51.000><c> select</c><00:21:51.559><c> from</c><00:21:52.039><c> join</c><00:21:52.559><c> group</c><00:21:52.840><c> by</c>

00:21:53.110 --> 00:21:53.120 align:start position:0%
of claes like select from join group by
 

00:21:53.120 --> 00:21:55.269 align:start position:0%
of claes like select from join group by
having<00:21:53.480><c> everything</c><00:21:53.919><c> that</c><00:21:54.080><c> you</c><00:21:54.240><c> want</c><00:21:54.919><c> window</c>

00:21:55.269 --> 00:21:55.279 align:start position:0%
having everything that you want window
 

00:21:55.279 --> 00:21:57.590 align:start position:0%
having everything that you want window
functions<00:21:55.880><c> all</c><00:21:56.159><c> aggregate</c><00:21:56.640><c> functions</c><00:21:57.400><c> but</c>

00:21:57.590 --> 00:21:57.600 align:start position:0%
functions all aggregate functions but
 

00:21:57.600 --> 00:22:00.269 align:start position:0%
functions all aggregate functions but
there<00:21:57.720><c> is</c><00:21:57.960><c> only</c><00:21:58.240><c> one</c><00:21:58.679><c> restriction</c><00:21:59.640><c> you</c><00:21:59.840><c> cannot</c>

00:22:00.269 --> 00:22:00.279 align:start position:0%
there is only one restriction you cannot
 

00:22:00.279 --> 00:22:03.230 align:start position:0%
there is only one restriction you cannot
go<00:22:00.440><c> and</c><00:22:00.679><c> use</c><00:22:01.120><c> the</c><00:22:01.279><c> order</c><00:22:01.640><c> by</c><00:22:02.000><c> Cloud</c><00:22:02.720><c> so</c><00:22:03.000><c> you</c>

00:22:03.230 --> 00:22:03.240 align:start position:0%
go and use the order by Cloud so you
 

00:22:03.240 --> 00:22:06.230 align:start position:0%
go and use the order by Cloud so you
cannot<00:22:03.760><c> sort</c><00:22:04.520><c> the</c><00:22:04.720><c> data</c><00:22:04.919><c> in</c><00:22:05.080><c> the</c><00:22:05.159><c> CTE</c><00:22:05.679><c> so</c><00:22:06.039><c> let's</c>

00:22:06.230 --> 00:22:06.240 align:start position:0%
cannot sort the data in the CTE so let's
 

00:22:06.240 --> 00:22:09.350 align:start position:0%
cannot sort the data in the CTE so let's
go<00:22:06.400><c> and</c><00:22:06.600><c> try</c><00:22:06.799><c> it</c><00:22:06.960><c> out</c><00:22:07.799><c> let's</c><00:22:08.039><c> go</c><00:22:08.320><c> and</c><00:22:08.520><c> say</c><00:22:08.960><c> order</c>

00:22:09.350 --> 00:22:09.360 align:start position:0%
go and try it out let's go and say order
 

00:22:09.360 --> 00:22:11.750 align:start position:0%
go and try it out let's go and say order
by<00:22:10.039><c> and</c><00:22:10.200><c> let's</c><00:22:10.360><c> say</c><00:22:10.600><c> I</c><00:22:10.720><c> want</c><00:22:10.919><c> to</c><00:22:11.080><c> sort</c><00:22:11.440><c> by</c><00:22:11.640><c> the</c>

00:22:11.750 --> 00:22:11.760 align:start position:0%
by and let's say I want to sort by the
 

00:22:11.760 --> 00:22:14.310 align:start position:0%
by and let's say I want to sort by the
order<00:22:12.039><c> ID</c><00:22:12.400><c> for</c><00:22:12.600><c> example</c><00:22:13.400><c> so</c><00:22:13.760><c> let's</c><00:22:13.960><c> go</c><00:22:14.120><c> and</c>

00:22:14.310 --> 00:22:14.320 align:start position:0%
order ID for example so let's go and
 

00:22:14.320 --> 00:22:16.230 align:start position:0%
order ID for example so let's go and
execute<00:22:14.760><c> it</c><00:22:15.159><c> you</c><00:22:15.279><c> can</c><00:22:15.400><c> see</c><00:22:15.559><c> here</c><00:22:15.720><c> SQL</c><00:22:16.120><c> is</c>

00:22:16.230 --> 00:22:16.240 align:start position:0%
execute it you can see here SQL is
 

00:22:16.240 --> 00:22:18.590 align:start position:0%
execute it you can see here SQL is
saying<00:22:16.679><c> okay</c><00:22:17.039><c> I</c><00:22:17.240><c> cannot</c><00:22:17.559><c> do</c><00:22:17.679><c> it</c><00:22:17.799><c> for</c><00:22:18.039><c> you</c>

00:22:18.590 --> 00:22:18.600 align:start position:0%
saying okay I cannot do it for you
 

00:22:18.600 --> 00:22:20.950 align:start position:0%
saying okay I cannot do it for you
because<00:22:18.880><c> order</c><00:22:19.240><c> buy</c><00:22:19.559><c> is</c><00:22:19.720><c> not</c><00:22:20.000><c> allowed</c><00:22:20.400><c> in</c><00:22:20.600><c> many</c>

00:22:20.950 --> 00:22:20.960 align:start position:0%
because order buy is not allowed in many
 

00:22:20.960 --> 00:22:23.669 align:start position:0%
because order buy is not allowed in many
things<00:22:21.520><c> so</c><00:22:21.720><c> you</c><00:22:21.880><c> cannot</c><00:22:22.200><c> use</c><00:22:22.400><c> it</c><00:22:22.640><c> in</c><00:22:22.840><c> views</c><00:22:23.400><c> in</c>

00:22:23.669 --> 00:22:23.679 align:start position:0%
things so you cannot use it in views in
 

00:22:23.679 --> 00:22:26.110 align:start position:0%
things so you cannot use it in views in
subqueries<00:22:24.679><c> in</c><00:22:25.000><c> commentable</c><00:22:25.600><c> Expressions</c>

00:22:26.110 --> 00:22:26.120 align:start position:0%
subqueries in commentable Expressions
 

00:22:26.120 --> 00:22:28.909 align:start position:0%
subqueries in commentable Expressions
the<00:22:26.320><c> CTE</c><00:22:26.840><c> over</c><00:22:27.159><c> here</c><00:22:27.679><c> so</c><00:22:28.000><c> it</c><00:22:28.120><c> is</c><00:22:28.240><c> not</c><00:22:28.559><c> allowed</c>

00:22:28.909 --> 00:22:28.919 align:start position:0%
the CTE over here so it is not allowed
 

00:22:28.919 --> 00:22:31.470 align:start position:0%
the CTE over here so it is not allowed
you<00:22:29.039><c> cannot</c><00:22:29.400><c> use</c><00:22:29.760><c> order</c><00:22:30.120><c> bu</c><00:22:30.480><c> in</c><00:22:30.640><c> the</c><00:22:30.799><c> CTE</c><00:22:31.279><c> but</c>

00:22:31.470 --> 00:22:31.480 align:start position:0%
you cannot use order bu in the CTE but
 

00:22:31.480 --> 00:22:34.110 align:start position:0%
you cannot use order bu in the CTE but
of<00:22:31.679><c> course</c><00:22:32.440><c> you</c><00:22:32.600><c> can</c><00:22:32.840><c> go</c><00:22:33.039><c> and</c><00:22:33.279><c> sort</c><00:22:33.720><c> the</c><00:22:33.880><c> data</c>

00:22:34.110 --> 00:22:34.120 align:start position:0%
of course you can go and sort the data
 

00:22:34.120 --> 00:22:36.350 align:start position:0%
of course you can go and sort the data
in<00:22:34.240><c> the</c><00:22:34.400><c> main</c><00:22:34.640><c> query</c><00:22:35.120><c> so</c><00:22:35.640><c> if</c><00:22:35.760><c> you</c><00:22:35.880><c> go</c><00:22:36.039><c> over</c><00:22:36.200><c> here</c>

00:22:36.350 --> 00:22:36.360 align:start position:0%
in the main query so if you go over here
 

00:22:36.360 --> 00:22:42.070 align:start position:0%
in the main query so if you go over here
and<00:22:36.600><c> say</c><00:22:37.600><c> order</c><00:22:38.120><c> by</c><00:22:39.279><c> customer</c><00:22:40.279><c> ID</c><00:22:41.279><c> so</c><00:22:41.720><c> if</c><00:22:41.840><c> we</c>

00:22:42.070 --> 00:22:42.080 align:start position:0%
and say order by customer ID so if we
 

00:22:42.080 --> 00:22:44.149 align:start position:0%
and say order by customer ID so if we
execute<00:22:42.520><c> it</c><00:22:42.880><c> it</c><00:22:43.039><c> going</c><00:22:43.159><c> to</c><00:22:43.279><c> be</c><00:22:43.480><c> working</c><00:22:43.840><c> so</c><00:22:44.039><c> in</c>

00:22:44.149 --> 00:22:44.159 align:start position:0%
execute it it going to be working so in
 

00:22:44.159 --> 00:22:46.350 align:start position:0%
execute it it going to be working so in
the<00:22:44.279><c> main</c><00:22:44.480><c> quer</c><00:22:44.760><c> you</c><00:22:44.880><c> can</c><00:22:45.080><c> use</c><00:22:45.320><c> order</c><00:22:45.720><c> buy</c><00:22:46.120><c> but</c>

00:22:46.350 --> 00:22:46.360 align:start position:0%
the main quer you can use order buy but
 

00:22:46.360 --> 00:22:48.390 align:start position:0%
the main quer you can use order buy but
in<00:22:46.520><c> the</c><00:22:46.640><c> CTE</c><00:22:47.240><c> this</c><00:22:47.360><c> is</c><00:22:47.640><c> the</c><00:22:47.760><c> only</c><00:22:48.039><c> thing</c><00:22:48.279><c> that</c>

00:22:48.390 --> 00:22:48.400 align:start position:0%
in the CTE this is the only thing that
 

00:22:48.400 --> 00:22:51.029 align:start position:0%
in the CTE this is the only thing that
you<00:22:48.559><c> cannot</c><00:22:48.960><c> use</c><00:22:49.440><c> inside</c><00:22:49.760><c> the</c><00:22:49.880><c> CTE</c><00:22:50.520><c> so</c><00:22:50.840><c> that's</c>

00:22:51.029 --> 00:22:51.039 align:start position:0%
you cannot use inside the CTE so that's
 

00:22:51.039 --> 00:22:54.149 align:start position:0%
you cannot use inside the CTE so that's
it<00:22:51.360><c> this</c><00:22:51.440><c> is</c><00:22:51.640><c> our</c><00:22:51.880><c> first</c><00:22:52.159><c> CTE</c><00:22:52.679><c> in</c><00:22:52.919><c> this</c><00:22:53.400><c> section</c>

00:22:54.149 --> 00:22:54.159 align:start position:0%
it this is our first CTE in this section
 

00:22:54.159 --> 00:22:56.110 align:start position:0%
it this is our first CTE in this section
all<00:22:54.320><c> right</c><00:22:54.520><c> so</c><00:22:54.799><c> this</c><00:22:54.919><c> is</c><00:22:55.159><c> the</c><00:22:55.320><c> simplest</c><00:22:55.799><c> form</c>

00:22:56.110 --> 00:22:56.120 align:start position:0%
all right so this is the simplest form
 

00:22:56.120 --> 00:22:58.950 align:start position:0%
all right so this is the simplest form
of<00:22:56.279><c> the</c><00:22:56.440><c> CTE</c><00:22:56.960><c> the</c><00:22:57.240><c> Standalone</c><00:22:58.240><c> now</c><00:22:58.679><c> we</c><00:22:58.760><c> can</c>

00:22:58.950 --> 00:22:58.960 align:start position:0%
of the CTE the Standalone now we can
 

00:22:58.960 --> 00:23:00.870 align:start position:0%
of the CTE the Standalone now we can
have<00:22:59.159><c> not</c><00:22:59.360><c> only</c><00:22:59.600><c> one</c><00:22:59.760><c> CTE</c><00:23:00.240><c> we</c><00:23:00.360><c> can</c><00:23:00.559><c> have</c>

00:23:00.870 --> 00:23:00.880 align:start position:0%
have not only one CTE we can have
 

00:23:00.880 --> 00:23:05.710 align:start position:0%
have not only one CTE we can have
multiple

00:23:05.710 --> 00:23:05.720 align:start position:0%
 
 

00:23:05.720 --> 00:23:07.950 align:start position:0%
 
CTE<00:23:06.720><c> so</c><00:23:06.919><c> it's</c><00:23:07.039><c> going</c><00:23:07.120><c> to</c><00:23:07.240><c> look</c><00:23:07.440><c> like</c><00:23:07.640><c> this</c><00:23:07.840><c> we</c>

00:23:07.950 --> 00:23:07.960 align:start position:0%
CTE so it's going to look like this we
 

00:23:07.960 --> 00:23:10.310 align:start position:0%
CTE so it's going to look like this we
have<00:23:08.120><c> our</c><00:23:08.360><c> database</c><00:23:09.200><c> and</c><00:23:09.480><c> this</c><00:23:09.679><c> time</c><00:23:09.919><c> we</c><00:23:10.039><c> don't</c>

00:23:10.310 --> 00:23:10.320 align:start position:0%
have our database and this time we don't
 

00:23:10.320 --> 00:23:13.909 align:start position:0%
have our database and this time we don't
have<00:23:10.559><c> only</c><00:23:10.880><c> one</c><00:23:11.120><c> CTE</c><00:23:12.080><c> we</c><00:23:12.279><c> have</c><00:23:12.600><c> multiple</c><00:23:13.080><c> CTE</c>

00:23:13.909 --> 00:23:13.919 align:start position:0%
have only one CTE we have multiple CTE
 

00:23:13.919 --> 00:23:16.669 align:start position:0%
have only one CTE we have multiple CTE
in<00:23:14.080><c> our</c><00:23:14.480><c> query</c><00:23:15.039><c> and</c><00:23:15.240><c> each</c><00:23:15.480><c> CTE</c><00:23:16.000><c> is</c><00:23:16.159><c> going</c>

00:23:16.669 --> 00:23:16.679 align:start position:0%
in our query and each CTE is going
 

00:23:16.679 --> 00:23:18.630 align:start position:0%
in our query and each CTE is going
directly<00:23:17.080><c> to</c><00:23:17.240><c> the</c><00:23:17.400><c> database</c><00:23:18.080><c> and</c><00:23:18.240><c> it</c><00:23:18.360><c> will</c>

00:23:18.630 --> 00:23:18.640 align:start position:0%
directly to the database and it will
 

00:23:18.640 --> 00:23:21.590 align:start position:0%
directly to the database and it will
query<00:23:19.000><c> the</c><00:23:19.159><c> database</c><00:23:19.559><c> in</c><00:23:19.720><c> order</c><00:23:20.440><c> to</c><00:23:20.760><c> prepare</c>

00:23:21.590 --> 00:23:21.600 align:start position:0%
query the database in order to prepare
 

00:23:21.600 --> 00:23:23.470 align:start position:0%
query the database in order to prepare
the<00:23:21.840><c> intermediate</c><00:23:22.480><c> results</c><00:23:23.000><c> so</c><00:23:23.159><c> in</c><00:23:23.279><c> this</c>

00:23:23.470 --> 00:23:23.480 align:start position:0%
the intermediate results so in this
 

00:23:23.480 --> 00:23:25.350 align:start position:0%
the intermediate results so in this
example<00:23:23.840><c> four</c><00:23:24.120><c> cdes</c><00:23:24.640><c> is</c><00:23:24.840><c> going</c><00:23:25.080><c> to</c><00:23:25.200><c> the</c>

00:23:25.350 --> 00:23:25.360 align:start position:0%
example four cdes is going to the
 

00:23:25.360 --> 00:23:28.510 align:start position:0%
example four cdes is going to the
database<00:23:25.880><c> and</c><00:23:26.120><c> preparing</c><00:23:26.960><c> four</c><00:23:27.559><c> different</c>

00:23:28.510 --> 00:23:28.520 align:start position:0%
database and preparing four different
 

00:23:28.520 --> 00:23:30.549 align:start position:0%
database and preparing four different
intermediate<00:23:29.120><c> results</c><00:23:29.720><c> and</c><00:23:29.840><c> of</c><00:23:29.960><c> course</c><00:23:30.159><c> SQL</c>

00:23:30.549 --> 00:23:30.559 align:start position:0%
intermediate results and of course SQL
 

00:23:30.559 --> 00:23:32.149 align:start position:0%
intermediate results and of course SQL
going<00:23:30.640><c> to</c><00:23:30.760><c> execute</c><00:23:31.120><c> it</c><00:23:31.320><c> from</c><00:23:31.480><c> the</c><00:23:31.679><c> top</c><00:23:31.880><c> to</c><00:23:32.039><c> the</c>

00:23:32.149 --> 00:23:32.159 align:start position:0%
going to execute it from the top to the
 

00:23:32.159 --> 00:23:35.029 align:start position:0%
going to execute it from the top to the
bottom<00:23:32.480><c> so</c><00:23:32.640><c> first</c><00:23:32.919><c> the</c><00:23:33.080><c> C1</c><00:23:33.720><c> then</c><00:23:33.919><c> two</c><00:23:34.240><c> 3</c><00:23:34.520><c> four</c>

00:23:35.029 --> 00:23:35.039 align:start position:0%
bottom so first the C1 then two 3 four
 

00:23:35.039 --> 00:23:36.350 align:start position:0%
bottom so first the C1 then two 3 four
but<00:23:35.200><c> they</c><00:23:35.360><c> have</c><00:23:35.520><c> nothing</c><00:23:35.799><c> to</c><00:23:35.919><c> do</c><00:23:36.080><c> with</c><00:23:36.200><c> each</c>

00:23:36.350 --> 00:23:36.360 align:start position:0%
but they have nothing to do with each
 

00:23:36.360 --> 00:23:38.750 align:start position:0%
but they have nothing to do with each
others<00:23:36.919><c> so</c><00:23:37.080><c> now</c><00:23:37.279><c> once</c><00:23:37.559><c> we</c><00:23:37.720><c> have</c><00:23:37.960><c> all</c><00:23:38.159><c> the</c><00:23:38.360><c> four</c>

00:23:38.750 --> 00:23:38.760 align:start position:0%
others so now once we have all the four
 

00:23:38.760 --> 00:23:40.590 align:start position:0%
others so now once we have all the four
intermediate<00:23:39.360><c> results</c><00:23:39.960><c> the</c><00:23:40.080><c> main</c><00:23:40.320><c> query</c>

00:23:40.590 --> 00:23:40.600 align:start position:0%
intermediate results the main query
 

00:23:40.600 --> 00:23:41.990 align:start position:0%
intermediate results the main query
going<00:23:40.679><c> to</c><00:23:40.840><c> go</c><00:23:40.960><c> and</c><00:23:41.120><c> retrieve</c><00:23:41.520><c> all</c><00:23:41.760><c> those</c>

00:23:41.990 --> 00:23:42.000 align:start position:0%
going to go and retrieve all those
 

00:23:42.000 --> 00:23:44.110 align:start position:0%
going to go and retrieve all those
informations<00:23:42.960><c> and</c><00:23:43.120><c> do</c><00:23:43.279><c> some</c><00:23:43.480><c> magic</c><00:23:43.760><c> in</c><00:23:43.880><c> order</c>

00:23:44.110 --> 00:23:44.120 align:start position:0%
informations and do some magic in order
 

00:23:44.120 --> 00:23:46.630 align:start position:0%
informations and do some magic in order
to<00:23:44.320><c> prepare</c><00:23:44.960><c> the</c><00:23:45.120><c> final</c><00:23:45.480><c> result</c><00:23:45.840><c> for</c><00:23:46.120><c> the</c><00:23:46.360><c> end</c>

00:23:46.630 --> 00:23:46.640 align:start position:0%
to prepare the final result for the end
 

00:23:46.640 --> 00:23:48.470 align:start position:0%
to prepare the final result for the end
user<00:23:47.120><c> so</c><00:23:47.279><c> now</c><00:23:47.480><c> by</c><00:23:47.640><c> looking</c><00:23:47.840><c> to</c><00:23:48.000><c> this</c><00:23:48.159><c> sketch</c>

00:23:48.470 --> 00:23:48.480 align:start position:0%
user so now by looking to this sketch
 

00:23:48.480 --> 00:23:51.029 align:start position:0%
user so now by looking to this sketch
you<00:23:48.559><c> can</c><00:23:49.080><c> understand</c><00:23:49.640><c> all</c><00:23:49.919><c> those</c><00:23:50.159><c> cdes</c><00:23:50.679><c> are</c>

00:23:51.029 --> 00:23:51.039 align:start position:0%
you can understand all those cdes are
 

00:23:51.039 --> 00:23:53.110 align:start position:0%
you can understand all those cdes are
independent<00:23:51.679><c> from</c><00:23:51.919><c> each</c><00:23:52.039><c> others</c><00:23:52.600><c> so</c><00:23:52.840><c> there</c><00:23:52.960><c> is</c>

00:23:53.110 --> 00:23:53.120 align:start position:0%
independent from each others so there is
 

00:23:53.120 --> 00:23:55.950 align:start position:0%
independent from each others so there is
no<00:23:53.320><c> nesting</c><00:23:53.799><c> or</c><00:23:54.039><c> something</c><00:23:54.799><c> each</c><00:23:55.120><c> CTE</c><00:23:55.640><c> is</c>

00:23:55.950 --> 00:23:55.960 align:start position:0%
no nesting or something each CTE is
 

00:23:55.960 --> 00:23:58.510 align:start position:0%
no nesting or something each CTE is
self-contained<00:23:56.960><c> and</c><00:23:57.120><c> it</c><00:23:57.279><c> could</c><00:23:57.480><c> be</c><00:23:57.760><c> executed</c>

00:23:58.510 --> 00:23:58.520 align:start position:0%
self-contained and it could be executed
 

00:23:58.520 --> 00:24:00.750 align:start position:0%
self-contained and it could be executed
on<00:23:58.720><c> its</c><00:23:58.880><c> own</c><00:23:59.400><c> without</c><00:23:59.760><c> depending</c><00:24:00.240><c> on</c><00:24:00.559><c> any</c>

00:24:00.750 --> 00:24:00.760 align:start position:0%
on its own without depending on any
 

00:24:00.760 --> 00:24:03.710 align:start position:0%
on its own without depending on any
other<00:24:01.039><c> results</c><00:24:01.520><c> from</c><00:24:01.760><c> any</c><00:24:01.960><c> other</c><00:24:02.159><c> CTE</c><00:24:02.919><c> or</c><00:24:03.520><c> any</c>

00:24:03.710 --> 00:24:03.720 align:start position:0%
other results from any other CTE or any
 

00:24:03.720 --> 00:24:05.909 align:start position:0%
other results from any other CTE or any
other<00:24:03.960><c> query</c><00:24:04.480><c> so</c><00:24:04.720><c> it</c><00:24:04.880><c> goes</c><00:24:05.279><c> directly</c><00:24:05.640><c> to</c><00:24:05.760><c> the</c>

00:24:05.909 --> 00:24:05.919 align:start position:0%
other query so it goes directly to the
 

00:24:05.919 --> 00:24:08.510 align:start position:0%
other query so it goes directly to the
database<00:24:06.520><c> and</c><00:24:06.880><c> get</c><00:24:07.159><c> the</c><00:24:07.320><c> data</c><00:24:07.799><c> so</c><00:24:08.080><c> that's</c><00:24:08.320><c> why</c>

00:24:08.510 --> 00:24:08.520 align:start position:0%
database and get the data so that's why
 

00:24:08.520 --> 00:24:11.230 align:start position:0%
database and get the data so that's why
all<00:24:08.679><c> of</c><00:24:08.840><c> them</c><00:24:09.000><c> are</c><00:24:09.279><c> Standalone</c><00:24:09.960><c> CDs</c><00:24:10.840><c> and</c><00:24:11.039><c> since</c>

00:24:11.230 --> 00:24:11.240 align:start position:0%
all of them are Standalone CDs and since
 

00:24:11.240 --> 00:24:13.070 align:start position:0%
all of them are Standalone CDs and since
we<00:24:11.400><c> have</c><00:24:11.559><c> multiple</c><00:24:11.960><c> CDs</c><00:24:12.520><c> then</c><00:24:12.720><c> it</c><00:24:12.840><c> is</c>

00:24:13.070 --> 00:24:13.080 align:start position:0%
we have multiple CDs then it is
 

00:24:13.080 --> 00:24:15.630 align:start position:0%
we have multiple CDs then it is
Standalone<00:24:14.000><c> multiple</c><00:24:14.520><c> cities</c><00:24:15.279><c> that's</c><00:24:15.440><c> it</c>

00:24:15.630 --> 00:24:15.640 align:start position:0%
Standalone multiple cities that's it
 

00:24:15.640 --> 00:24:16.990 align:start position:0%
Standalone multiple cities that's it
it's<00:24:15.799><c> simple</c><00:24:16.200><c> so</c><00:24:16.360><c> now</c><00:24:16.480><c> let's</c><00:24:16.640><c> check</c><00:24:16.880><c> the</c>

00:24:16.990 --> 00:24:17.000 align:start position:0%
it's simple so now let's check the
 

00:24:17.000 --> 00:24:19.230 align:start position:0%
it's simple so now let's check the
syntax<00:24:17.400><c> of</c><00:24:17.520><c> the</c><00:24:17.720><c> multiple</c><00:24:18.159><c> Standalone</c><00:24:18.640><c> cities</c>

00:24:19.230 --> 00:24:19.240 align:start position:0%
syntax of the multiple Standalone cities
 

00:24:19.240 --> 00:24:20.590 align:start position:0%
syntax of the multiple Standalone cities
so<00:24:19.360><c> we're</c><00:24:19.480><c> going</c><00:24:19.559><c> to</c><00:24:19.720><c> start</c><00:24:19.919><c> writing</c><00:24:20.360><c> our</c>

00:24:20.590 --> 00:24:20.600 align:start position:0%
so we're going to start writing our
 

00:24:20.600 --> 00:24:23.669 align:start position:0%
so we're going to start writing our
first<00:24:20.960><c> city</c><00:24:21.679><c> so</c><00:24:21.880><c> it</c><00:24:22.039><c> start</c><00:24:22.400><c> with</c><00:24:22.559><c> the</c><00:24:22.720><c> with</c><00:24:23.039><c> CLA</c>

00:24:23.669 --> 00:24:23.679 align:start position:0%
first city so it start with the with CLA
 

00:24:23.679 --> 00:24:25.710 align:start position:0%
first city so it start with the with CLA
and<00:24:23.799><c> then</c><00:24:23.960><c> we</c><00:24:24.080><c> have</c><00:24:24.279><c> the</c><00:24:24.440><c> CTE</c><00:24:24.960><c> name</c><00:24:25.399><c> and</c><00:24:25.559><c> then</c>

00:24:25.710 --> 00:24:25.720 align:start position:0%
and then we have the CTE name and then
 

00:24:25.720 --> 00:24:28.350 align:start position:0%
and then we have the CTE name and then
the<00:24:25.880><c> logic</c><00:24:26.240><c> of</c><00:24:26.399><c> our</c><00:24:26.600><c> CTE</c><00:24:27.200><c> so</c><00:24:27.440><c> nothing</c><00:24:27.799><c> new</c><00:24:28.200><c> this</c>

00:24:28.350 --> 00:24:28.360 align:start position:0%
the logic of our CTE so nothing new this
 

00:24:28.360 --> 00:24:30.510 align:start position:0%
the logic of our CTE so nothing new this
this<00:24:28.440><c> is</c><00:24:28.559><c> how</c><00:24:28.720><c> we</c><00:24:28.880><c> Define</c><00:24:29.480><c> the</c><00:24:29.640><c> CTE</c><00:24:30.240><c> and</c><00:24:30.360><c> then</c>

00:24:30.510 --> 00:24:30.520 align:start position:0%
this is how we Define the CTE and then
 

00:24:30.520 --> 00:24:31.870 align:start position:0%
this is how we Define the CTE and then
in<00:24:30.640><c> order</c><00:24:30.919><c> to</c><00:24:31.039><c> use</c><00:24:31.240><c> it</c><00:24:31.399><c> we're</c><00:24:31.480><c> going</c><00:24:31.600><c> to</c><00:24:31.720><c> have</c>

00:24:31.870 --> 00:24:31.880 align:start position:0%
in order to use it we're going to have
 

00:24:31.880 --> 00:24:34.590 align:start position:0%
in order to use it we're going to have
our<00:24:32.080><c> main</c><00:24:32.399><c> query</c><00:24:32.960><c> where</c><00:24:33.120><c> we</c><00:24:33.320><c> select</c><00:24:33.880><c> from</c><00:24:34.320><c> our</c>

00:24:34.590 --> 00:24:34.600 align:start position:0%
our main query where we select from our
 

00:24:34.600 --> 00:24:36.710 align:start position:0%
our main query where we select from our
new<00:24:34.799><c> CTE</c><00:24:35.480><c> and</c><00:24:35.600><c> we</c><00:24:35.760><c> make</c><00:24:35.919><c> sure</c><00:24:36.080><c> we</c><00:24:36.159><c> are</c><00:24:36.360><c> using</c>

00:24:36.710 --> 00:24:36.720 align:start position:0%
new CTE and we make sure we are using
 

00:24:36.720 --> 00:24:39.669 align:start position:0%
new CTE and we make sure we are using
the<00:24:36.880><c> name</c><00:24:37.200><c> of</c><00:24:37.399><c> our</c><00:24:37.600><c> CTE</c><00:24:38.200><c> so</c><00:24:38.480><c> nothing</c><00:24:38.840><c> new</c><00:24:39.440><c> now</c>

00:24:39.669 --> 00:24:39.679 align:start position:0%
the name of our CTE so nothing new now
 

00:24:39.679 --> 00:24:42.470 align:start position:0%
the name of our CTE so nothing new now
in<00:24:39.799><c> order</c><00:24:40.120><c> to</c><00:24:40.320><c> add</c><00:24:40.720><c> another</c><00:24:41.120><c> CTE</c><00:24:41.559><c> to</c><00:24:41.679><c> our</c><00:24:41.919><c> query</c>

00:24:42.470 --> 00:24:42.480 align:start position:0%
in order to add another CTE to our query
 

00:24:42.480 --> 00:24:43.950 align:start position:0%
in order to add another CTE to our query
what<00:24:42.600><c> we're</c><00:24:42.720><c> going</c><00:24:42.799><c> to</c><00:24:42.960><c> do</c><00:24:43.279><c> we're</c><00:24:43.440><c> going</c><00:24:43.559><c> to</c><00:24:43.720><c> go</c>

00:24:43.950 --> 00:24:43.960 align:start position:0%
what we're going to do we're going to go
 

00:24:43.960 --> 00:24:46.549 align:start position:0%
what we're going to do we're going to go
after<00:24:44.520><c> the</c><00:24:44.679><c> definition</c><00:24:45.120><c> of</c><00:24:45.279><c> the</c><00:24:45.440><c> CTE</c><00:24:46.360><c> and</c>

00:24:46.549 --> 00:24:46.559 align:start position:0%
after the definition of the CTE and
 

00:24:46.559 --> 00:24:48.430 align:start position:0%
after the definition of the CTE and
below<00:24:46.919><c> it</c><00:24:47.320><c> we're</c><00:24:47.480><c> going</c><00:24:47.600><c> to</c><00:24:47.720><c> go</c><00:24:47.919><c> and</c><00:24:48.080><c> start</c>

00:24:48.430 --> 00:24:48.440 align:start position:0%
below it we're going to go and start
 

00:24:48.440 --> 00:24:51.430 align:start position:0%
below it we're going to go and start
defining<00:24:49.360><c> the</c><00:24:49.559><c> cte2</c><00:24:50.440><c> but</c><00:24:50.760><c> this</c><00:24:50.960><c> time</c><00:24:51.240><c> as</c><00:24:51.320><c> you</c>

00:24:51.430 --> 00:24:51.440 align:start position:0%
defining the cte2 but this time as you
 

00:24:51.440 --> 00:24:54.510 align:start position:0%
defining the cte2 but this time as you
can<00:24:51.600><c> see</c><00:24:52.080><c> we</c><00:24:52.279><c> are</c><00:24:52.559><c> not</c><00:24:52.799><c> using</c><00:24:53.240><c> the</c><00:24:53.480><c> with</c><00:24:53.919><c> Cloud</c>

00:24:54.510 --> 00:24:54.520 align:start position:0%
can see we are not using the with Cloud
 

00:24:54.520 --> 00:24:57.389 align:start position:0%
can see we are not using the with Cloud
we<00:24:54.640><c> are</c><00:24:54.880><c> using</c><00:24:55.240><c> a</c><00:24:55.480><c> comma</c><00:24:55.880><c> so</c><00:24:56.080><c> that</c><00:24:56.279><c> means</c><00:24:57.080><c> only</c>

00:24:57.389 --> 00:24:57.399 align:start position:0%
we are using a comma so that means only
 

00:24:57.399 --> 00:25:00.190 align:start position:0%
we are using a comma so that means only
the<00:24:57.640><c> first</c><00:24:58.520><c> be</c><00:24:58.679><c> using</c><00:24:59.080><c> the</c><00:24:59.240><c> wi</c><00:24:59.559><c> clouds</c><00:25:00.080><c> in</c>

00:25:00.190 --> 00:25:00.200 align:start position:0%
the first be using the wi clouds in
 

00:25:00.200 --> 00:25:02.590 align:start position:0%
the first be using the wi clouds in
order<00:25:00.440><c> to</c><00:25:00.600><c> tell</c><00:25:01.159><c> SQL</c><00:25:01.640><c> we</c><00:25:01.760><c> are</c><00:25:01.919><c> talking</c><00:25:02.320><c> about</c>

00:25:02.590 --> 00:25:02.600 align:start position:0%
order to tell SQL we are talking about
 

00:25:02.600 --> 00:25:05.149 align:start position:0%
order to tell SQL we are talking about
CDE<00:25:03.279><c> all</c><00:25:03.520><c> the</c><00:25:03.640><c> other</c><00:25:03.840><c> cdes</c><00:25:04.679><c> you're</c><00:25:04.840><c> going</c><00:25:04.960><c> to</c>

00:25:05.149 --> 00:25:05.159 align:start position:0%
CDE all the other cdes you're going to
 

00:25:05.159 --> 00:25:07.389 align:start position:0%
CDE all the other cdes you're going to
separate<00:25:05.559><c> it</c><00:25:05.760><c> using</c><00:25:06.240><c> the</c><00:25:06.520><c> comma</c><00:25:06.960><c> so</c><00:25:07.279><c> the</c>

00:25:07.389 --> 00:25:07.399 align:start position:0%
separate it using the comma so the
 

00:25:07.399 --> 00:25:10.269 align:start position:0%
separate it using the comma so the
syntax<00:25:07.799><c> going</c><00:25:07.919><c> to</c><00:25:08.039><c> be</c><00:25:08.399><c> comma</c><00:25:08.880><c> instead</c><00:25:09.240><c> of</c><00:25:09.520><c> with</c>

00:25:10.269 --> 00:25:10.279 align:start position:0%
syntax going to be comma instead of with
 

00:25:10.279 --> 00:25:12.389 align:start position:0%
syntax going to be comma instead of with
then<00:25:10.559><c> the</c><00:25:10.919><c> name</c><00:25:11.159><c> of</c><00:25:11.279><c> the</c><00:25:11.440><c> C</c><00:25:12.039><c> and</c><00:25:12.159><c> then</c><00:25:12.279><c> we're</c>

00:25:12.389 --> 00:25:12.399 align:start position:0%
then the name of the C and then we're
 

00:25:12.399 --> 00:25:14.669 align:start position:0%
then the name of the C and then we're
going<00:25:12.480><c> to</c><00:25:12.600><c> say</c><00:25:12.919><c> as</c><00:25:13.480><c> the</c><00:25:13.640><c> following</c><00:25:14.039><c> definition</c>

00:25:14.669 --> 00:25:14.679 align:start position:0%
going to say as the following definition
 

00:25:14.679 --> 00:25:16.510 align:start position:0%
going to say as the following definition
so<00:25:14.840><c> we're</c><00:25:14.960><c> going</c><00:25:15.080><c> to</c><00:25:15.240><c> write</c><00:25:15.480><c> here</c><00:25:15.720><c> the</c><00:25:15.919><c> query</c>

00:25:16.510 --> 00:25:16.520 align:start position:0%
so we're going to write here the query
 

00:25:16.520 --> 00:25:19.029 align:start position:0%
so we're going to write here the query
of<00:25:16.760><c> the</c><00:25:17.080><c> second</c><00:25:17.600><c> CTE</c><00:25:18.240><c> so</c><00:25:18.399><c> now</c><00:25:18.559><c> of</c><00:25:18.720><c> course</c><00:25:18.960><c> if</c>

00:25:19.029 --> 00:25:19.039 align:start position:0%
of the second CTE so now of course if
 

00:25:19.039 --> 00:25:21.350 align:start position:0%
of the second CTE so now of course if
you<00:25:19.120><c> want</c><00:25:19.279><c> to</c><00:25:19.440><c> go</c><00:25:19.559><c> and</c><00:25:19.799><c> add</c><00:25:20.039><c> more</c><00:25:20.279><c> CTE</c><00:25:20.919><c> you</c><00:25:21.120><c> go</c>

00:25:21.350 --> 00:25:21.360 align:start position:0%
you want to go and add more CTE you go
 

00:25:21.360 --> 00:25:23.470 align:start position:0%
you want to go and add more CTE you go
and<00:25:21.559><c> use</c><00:25:21.880><c> the</c><00:25:22.039><c> comma</c><00:25:22.440><c> below</c><00:25:22.720><c> it</c><00:25:22.960><c> and</c><00:25:23.159><c> as</c><00:25:23.320><c> well</c>

00:25:23.470 --> 00:25:23.480 align:start position:0%
and use the comma below it and as well
 

00:25:23.480 --> 00:25:25.789 align:start position:0%
and use the comma below it and as well
you<00:25:23.679><c> define</c><00:25:24.080><c> the</c><00:25:24.360><c> third</c><00:25:24.640><c> City</c><00:25:25.240><c> so</c><00:25:25.440><c> you</c><00:25:25.559><c> can</c>

00:25:25.789 --> 00:25:25.799 align:start position:0%
you define the third City so you can
 

00:25:25.799 --> 00:25:27.990 align:start position:0%
you define the third City so you can
have<00:25:26.120><c> as</c><00:25:26.320><c> much</c><00:25:26.600><c> Citys</c><00:25:27.200><c> as</c><00:25:27.320><c> you</c><00:25:27.480><c> want</c><00:25:27.840><c> and</c>

00:25:27.990 --> 00:25:28.000 align:start position:0%
have as much Citys as you want and
 

00:25:28.000 --> 00:25:30.510 align:start position:0%
have as much Citys as you want and
always<00:25:28.360><c> was</c><00:25:28.480><c> separated</c><00:25:29.039><c> with</c><00:25:29.279><c> comma</c><00:25:29.919><c> but</c><00:25:30.200><c> only</c>

00:25:30.510 --> 00:25:30.520 align:start position:0%
always was separated with comma but only
 

00:25:30.520 --> 00:25:32.590 align:start position:0%
always was separated with comma but only
the<00:25:30.640><c> first</c><00:25:30.880><c> CTE</c><00:25:31.279><c> start</c><00:25:31.600><c> with</c><00:25:31.720><c> the</c><00:25:31.919><c> with</c><00:25:32.279><c> and</c><00:25:32.440><c> of</c>

00:25:32.590 --> 00:25:32.600 align:start position:0%
the first CTE start with the with and of
 

00:25:32.600 --> 00:25:34.190 align:start position:0%
the first CTE start with the with and of
course<00:25:32.840><c> in</c><00:25:32.919><c> the</c><00:25:33.039><c> main</c><00:25:33.320><c> query</c><00:25:33.600><c> we</c><00:25:33.720><c> can</c><00:25:33.880><c> go</c><00:25:34.039><c> and</c>

00:25:34.190 --> 00:25:34.200 align:start position:0%
course in the main query we can go and
 

00:25:34.200 --> 00:25:37.029 align:start position:0%
course in the main query we can go and
use<00:25:34.559><c> the</c><00:25:34.760><c> results</c><00:25:35.320><c> from</c><00:25:35.640><c> the</c><00:25:35.840><c> cte2</c><00:25:36.799><c> where</c><00:25:36.960><c> we</c>

00:25:37.029 --> 00:25:37.039 align:start position:0%
use the results from the cte2 where we
 

00:25:37.039 --> 00:25:38.669 align:start position:0%
use the results from the cte2 where we
are<00:25:37.200><c> for</c><00:25:37.360><c> example</c><00:25:37.679><c> here</c><00:25:37.840><c> joining</c><00:25:38.200><c> the</c><00:25:38.399><c> data</c>

00:25:38.669 --> 00:25:38.679 align:start position:0%
are for example here joining the data
 

00:25:38.679 --> 00:25:41.029 align:start position:0%
are for example here joining the data
between<00:25:39.039><c> the</c><00:25:39.240><c> city</c><00:25:39.559><c> 1</c><00:25:39.840><c> and</c><00:25:40.039><c> city2</c><00:25:40.679><c> so</c><00:25:40.840><c> as</c><00:25:40.919><c> you</c>

00:25:41.029 --> 00:25:41.039 align:start position:0%
between the city 1 and city2 so as you
 

00:25:41.039 --> 00:25:42.510 align:start position:0%
between the city 1 and city2 so as you
can<00:25:41.120><c> see</c><00:25:41.320><c> in</c><00:25:41.399><c> the</c><00:25:41.520><c> main</c><00:25:41.760><c> query</c><00:25:42.080><c> here</c><00:25:42.240><c> we</c><00:25:42.360><c> are</c>

00:25:42.510 --> 00:25:42.520 align:start position:0%
can see in the main query here we are
 

00:25:42.520 --> 00:25:44.350 align:start position:0%
can see in the main query here we are
like<00:25:42.799><c> collecting</c><00:25:43.360><c> the</c><00:25:43.559><c> data</c><00:25:43.840><c> from</c><00:25:44.080><c> these</c>

00:25:44.350 --> 00:25:44.360 align:start position:0%
like collecting the data from these
 

00:25:44.360 --> 00:25:47.350 align:start position:0%
like collecting the data from these
different<00:25:45.039><c> CTE</c><00:25:45.880><c> in</c><00:25:46.000><c> order</c><00:25:46.279><c> to</c><00:25:46.440><c> do</c><00:25:46.679><c> the</c><00:25:46.919><c> final</c>

00:25:47.350 --> 00:25:47.360 align:start position:0%
different CTE in order to do the final
 

00:25:47.360 --> 00:25:49.710 align:start position:0%
different CTE in order to do the final
step<00:25:47.919><c> in</c><00:25:48.080><c> the</c><00:25:48.200><c> main</c><00:25:48.480><c> query</c><00:25:48.960><c> it</c><00:25:49.120><c> start</c><00:25:49.399><c> with</c><00:25:49.559><c> the</c>

00:25:49.710 --> 00:25:49.720 align:start position:0%
step in the main query it start with the
 

00:25:49.720 --> 00:25:51.789 align:start position:0%
step in the main query it start with the
wi<00:25:50.080><c> so</c><00:25:50.279><c> SQL</c><00:25:50.919><c> understands</c><00:25:51.240><c> okay</c><00:25:51.399><c> now</c><00:25:51.559><c> we</c><00:25:51.640><c> are</c>

00:25:51.789 --> 00:25:51.799 align:start position:0%
wi so SQL understands okay now we are
 

00:25:51.799 --> 00:25:54.549 align:start position:0%
wi so SQL understands okay now we are
talking<00:25:52.080><c> about</c><00:25:52.360><c> CTE</c><00:25:53.120><c> and</c><00:25:53.320><c> once</c><00:25:53.559><c> SQL</c><00:25:54.000><c> sees</c>

00:25:54.549 --> 00:25:54.559 align:start position:0%
talking about CTE and once SQL sees
 

00:25:54.559 --> 00:25:57.070 align:start position:0%
talking about CTE and once SQL sees
after<00:25:54.840><c> the</c><00:25:55.000><c> parenthesis</c><00:25:55.760><c> comma</c><00:25:56.200><c> SQL</c><00:25:56.640><c> can</c>

00:25:57.070 --> 00:25:57.080 align:start position:0%
after the parenthesis comma SQL can
 

00:25:57.080 --> 00:25:58.909 align:start position:0%
after the parenthesis comma SQL can
understand<00:25:57.440><c> okay</c><00:25:57.679><c> now</c><00:25:57.799><c> we</c><00:25:57.919><c> are</c><00:25:58.279><c> talking</c><00:25:58.559><c> about</c>

00:25:58.909 --> 00:25:58.919 align:start position:0%
understand okay now we are talking about
 

00:25:58.919 --> 00:26:00.830 align:start position:0%
understand okay now we are talking about
another<00:25:59.279><c> CTE</c><00:25:59.919><c> and</c><00:26:00.039><c> now</c><00:26:00.159><c> if</c><00:26:00.240><c> you</c><00:26:00.320><c> don't</c><00:26:00.520><c> go</c><00:26:00.679><c> and</c>

00:26:00.830 --> 00:26:00.840 align:start position:0%
another CTE and now if you don't go and
 

00:26:00.840 --> 00:26:03.350 align:start position:0%
another CTE and now if you don't go and
use<00:26:01.120><c> a</c><00:26:01.320><c> comma</c><00:26:01.679><c> after</c><00:26:01.919><c> the</c><00:26:02.120><c> parenthesis</c><00:26:02.919><c> SQL</c>

00:26:03.350 --> 00:26:03.360 align:start position:0%
use a comma after the parenthesis SQL
 

00:26:03.360 --> 00:26:04.990 align:start position:0%
use a comma after the parenthesis SQL
can<00:26:03.799><c> understand</c><00:26:04.159><c> okay</c><00:26:04.360><c> we</c><00:26:04.480><c> don't</c><00:26:04.679><c> have</c><00:26:04.880><c> any</c>

00:26:04.990 --> 00:26:05.000 align:start position:0%
can understand okay we don't have any
 

00:26:05.000 --> 00:26:07.950 align:start position:0%
can understand okay we don't have any
more<00:26:05.200><c> CTE</c><00:26:06.080><c> then</c><00:26:06.320><c> next</c><00:26:06.559><c> query</c><00:26:07.120><c> it's</c><00:26:07.399><c> about</c><00:26:07.799><c> the</c>

00:26:07.950 --> 00:26:07.960 align:start position:0%
more CTE then next query it's about the
 

00:26:07.960 --> 00:26:10.029 align:start position:0%
more CTE then next query it's about the
main<00:26:08.279><c> query</c><00:26:08.799><c> so</c><00:26:09.000><c> this</c><00:26:09.120><c> is</c><00:26:09.279><c> how</c><00:26:09.440><c> you</c><00:26:09.640><c> create</c>

00:26:10.029 --> 00:26:10.039 align:start position:0%
main query so this is how you create
 

00:26:10.039 --> 00:26:12.590 align:start position:0%
main query so this is how you create
multiple<00:26:10.480><c> Standalone</c><00:26:11.120><c> CTS</c><00:26:12.000><c> all</c><00:26:12.120><c> right</c><00:26:12.279><c> so</c><00:26:12.399><c> now</c>

00:26:12.590 --> 00:26:12.600 align:start position:0%
multiple Standalone CTS all right so now
 

00:26:12.600 --> 00:26:14.430 align:start position:0%
multiple Standalone CTS all right so now
back<00:26:12.720><c> to</c><00:26:12.840><c> our</c><00:26:13.080><c> task</c><00:26:13.440><c> where</c><00:26:13.640><c> we</c><00:26:13.720><c> are</c><00:26:13.919><c> creating</c>

00:26:14.430 --> 00:26:14.440 align:start position:0%
back to our task where we are creating
 

00:26:14.440 --> 00:26:16.669 align:start position:0%
back to our task where we are creating
like<00:26:14.600><c> a</c><00:26:14.799><c> report</c><00:26:15.360><c> step</c><00:26:15.640><c> by</c><00:26:15.880><c> step</c><00:26:16.240><c> so</c><00:26:16.399><c> now</c><00:26:16.559><c> we</c>

00:26:16.669 --> 00:26:16.679 align:start position:0%
like a report step by step so now we
 

00:26:16.679 --> 00:26:18.590 align:start position:0%
like a report step by step so now we
have<00:26:16.880><c> in</c><00:26:17.000><c> the</c><00:26:17.240><c> task</c><00:26:17.520><c> a</c><00:26:17.679><c> second</c><00:26:18.000><c> step</c><00:26:18.320><c> where</c><00:26:18.440><c> it</c>

00:26:18.590 --> 00:26:18.600 align:start position:0%
have in the task a second step where it
 

00:26:18.600 --> 00:26:22.070 align:start position:0%
have in the task a second step where it
says<00:26:19.480><c> find</c><00:26:20.000><c> the</c><00:26:20.240><c> last</c><00:26:20.559><c> order</c><00:26:21.039><c> date</c><00:26:21.440><c> for</c><00:26:21.760><c> each</c>

00:26:22.070 --> 00:26:22.080 align:start position:0%
says find the last order date for each
 

00:26:22.080 --> 00:26:23.710 align:start position:0%
says find the last order date for each
customer<00:26:22.640><c> so</c><00:26:22.799><c> now</c><00:26:22.919><c> we</c><00:26:23.000><c> have</c><00:26:23.120><c> to</c><00:26:23.240><c> go</c><00:26:23.360><c> and</c><00:26:23.520><c> add</c>

00:26:23.710 --> 00:26:23.720 align:start position:0%
customer so now we have to go and add
 

00:26:23.720 --> 00:26:25.950 align:start position:0%
customer so now we have to go and add
one<00:26:23.880><c> more</c><00:26:24.120><c> information</c><00:26:24.679><c> about</c><00:26:24.919><c> our</c><00:26:25.240><c> customer</c>

00:26:25.950 --> 00:26:25.960 align:start position:0%
one more information about our customer
 

00:26:25.960 --> 00:26:28.029 align:start position:0%
one more information about our customer
so<00:26:26.240><c> when</c><00:26:26.520><c> the</c><00:26:26.720><c> last</c><00:26:26.960><c> time</c><00:26:27.320><c> the</c><00:26:27.559><c> customer</c><00:26:27.880><c> did</c>

00:26:28.029 --> 00:26:28.039 align:start position:0%
so when the last time the customer did
 

00:26:28.039 --> 00:26:30.149 align:start position:0%
so when the last time the customer did
order<00:26:28.279><c> order</c><00:26:28.679><c> so</c><00:26:28.880><c> how</c><00:26:29.000><c> we</c><00:26:29.120><c> going</c><00:26:29.240><c> to</c><00:26:29.360><c> do</c><00:26:29.520><c> it</c><00:26:30.000><c> now</c>

00:26:30.149 --> 00:26:30.159 align:start position:0%
order order so how we going to do it now
 

00:26:30.159 --> 00:26:32.470 align:start position:0%
order order so how we going to do it now
we<00:26:30.279><c> have</c><00:26:30.399><c> to</c><00:26:30.559><c> add</c><00:26:30.760><c> this</c><00:26:30.919><c> to</c><00:26:31.120><c> our</c><00:26:31.440><c> query</c><00:26:32.200><c> and</c><00:26:32.399><c> I</c>

00:26:32.470 --> 00:26:32.480 align:start position:0%
we have to add this to our query and I
 

00:26:32.480 --> 00:26:34.669 align:start position:0%
we have to add this to our query and I
would<00:26:32.679><c> like</c><00:26:32.840><c> to</c><00:26:32.960><c> use</c><00:26:33.279><c> as</c><00:26:33.440><c> well</c><00:26:33.640><c> the</c><00:26:33.760><c> CTE</c><00:26:34.520><c> in</c>

00:26:34.669 --> 00:26:34.679 align:start position:0%
would like to use as well the CTE in
 

00:26:34.679 --> 00:26:36.510 align:start position:0%
would like to use as well the CTE in
order<00:26:35.120><c> to</c><00:26:35.320><c> have</c><00:26:35.520><c> this</c><00:26:35.679><c> logic</c><00:26:36.120><c> so</c><00:26:36.320><c> as</c><00:26:36.440><c> we</c>

00:26:36.510 --> 00:26:36.520 align:start position:0%
order to have this logic so as we
 

00:26:36.520 --> 00:26:39.070 align:start position:0%
order to have this logic so as we
learned<00:26:36.799><c> from</c><00:26:36.960><c> the</c><00:26:37.120><c> first</c><00:26:37.399><c> task</c><00:26:38.039><c> this</c><00:26:38.240><c> is</c><00:26:38.880><c> the</c>

00:26:39.070 --> 00:26:39.080 align:start position:0%
learned from the first task this is the
 

00:26:39.080 --> 00:26:40.990 align:start position:0%
learned from the first task this is the
first<00:26:39.399><c> step</c><00:26:39.960><c> in</c><00:26:40.080><c> order</c><00:26:40.320><c> to</c><00:26:40.440><c> find</c><00:26:40.600><c> the</c><00:26:40.760><c> total</c>

00:26:40.990 --> 00:26:41.000 align:start position:0%
first step in order to find the total
 

00:26:41.000 --> 00:26:42.750 align:start position:0%
first step in order to find the total
sales<00:26:41.279><c> for</c><00:26:41.440><c> each</c><00:26:41.679><c> customer</c><00:26:42.200><c> and</c><00:26:42.360><c> here</c><00:26:42.480><c> we</c><00:26:42.600><c> have</c>

00:26:42.750 --> 00:26:42.760 align:start position:0%
sales for each customer and here we have
 

00:26:42.760 --> 00:26:44.950 align:start position:0%
sales for each customer and here we have
the<00:26:42.880><c> main</c><00:26:43.120><c> query</c><00:26:43.840><c> now</c><00:26:44.000><c> I</c><00:26:44.120><c> would</c><00:26:44.360><c> like</c><00:26:44.520><c> to</c><00:26:44.679><c> put</c>

00:26:44.950 --> 00:26:44.960 align:start position:0%
the main query now I would like to put
 

00:26:44.960 --> 00:26:48.110 align:start position:0%
the main query now I would like to put
now<00:26:45.360><c> in</c><00:26:45.640><c> between</c><00:26:46.600><c> another</c><00:26:47.000><c> CTE</c><00:26:47.720><c> and</c><00:26:47.919><c> as</c><00:26:48.000><c> we</c>

00:26:48.110 --> 00:26:48.120 align:start position:0%
now in between another CTE and as we
 

00:26:48.120 --> 00:26:49.909 align:start position:0%
now in between another CTE and as we
learned<00:26:48.399><c> from</c><00:26:48.520><c> the</c><00:26:48.679><c> syntax</c><00:26:49.360><c> we</c><00:26:49.520><c> have</c><00:26:49.640><c> to</c><00:26:49.799><c> go</c>

00:26:49.909 --> 00:26:49.919 align:start position:0%
learned from the syntax we have to go
 

00:26:49.919 --> 00:26:52.310 align:start position:0%
learned from the syntax we have to go
and<00:26:50.159><c> add</c><00:26:50.399><c> a</c><00:26:50.600><c> comma</c><00:26:51.120><c> we</c><00:26:51.240><c> cannot</c><00:26:51.520><c> go</c><00:26:51.640><c> and</c><00:26:51.799><c> use</c><00:26:52.120><c> the</c>

00:26:52.310 --> 00:26:52.320 align:start position:0%
and add a comma we cannot go and use the
 

00:26:52.320 --> 00:26:54.110 align:start position:0%
and add a comma we cannot go and use the
with<00:26:52.640><c> again</c><00:26:53.279><c> and</c><00:26:53.399><c> we</c><00:26:53.520><c> have</c><00:26:53.640><c> to</c><00:26:53.720><c> give</c><00:26:53.840><c> it</c><00:26:53.960><c> the</c>

00:26:54.110 --> 00:26:54.120 align:start position:0%
with again and we have to give it the
 

00:26:54.120 --> 00:26:58.430 align:start position:0%
with again and we have to give it the
name<00:26:54.360><c> so</c><00:26:54.559><c> let's</c><00:26:54.760><c> call</c><00:26:54.960><c> it</c><00:26:55.159><c> CTE</c><00:26:56.159><c> and</c><00:26:56.679><c> last</c><00:26:57.559><c> order</c>

00:26:58.430 --> 00:26:58.440 align:start position:0%
name so let's call it CTE and last order
 

00:26:58.440 --> 00:27:00.669 align:start position:0%
name so let's call it CTE and last order
so<00:26:58.799><c> like</c><00:26:59.120><c> this</c><00:26:59.399><c> and</c><00:26:59.520><c> we</c><00:26:59.640><c> have</c><00:26:59.760><c> to</c><00:26:59.919><c> Define</c><00:27:00.200><c> it</c><00:27:00.360><c> so</c>

00:27:00.669 --> 00:27:00.679 align:start position:0%
so like this and we have to Define it so
 

00:27:00.679 --> 00:27:03.870 align:start position:0%
so like this and we have to Define it so
as<00:27:01.120><c> and</c><00:27:01.279><c> then</c><00:27:01.559><c> double</c><00:27:02.520><c> parenthesis</c><00:27:03.520><c> and</c><00:27:03.640><c> now</c>

00:27:03.870 --> 00:27:03.880 align:start position:0%
as and then double parenthesis and now
 

00:27:03.880 --> 00:27:05.510 align:start position:0%
as and then double parenthesis and now
in<00:27:04.039><c> between</c><00:27:04.399><c> we</c><00:27:04.520><c> have</c><00:27:04.640><c> to</c><00:27:04.760><c> go</c><00:27:04.919><c> and</c><00:27:05.080><c> add</c><00:27:05.279><c> our</c>

00:27:05.510 --> 00:27:05.520 align:start position:0%
in between we have to go and add our
 

00:27:05.520 --> 00:27:07.470 align:start position:0%
in between we have to go and add our
logic<00:27:06.000><c> so</c><00:27:06.200><c> now</c><00:27:06.360><c> we</c><00:27:06.440><c> have</c><00:27:06.559><c> to</c><00:27:06.720><c> focus</c><00:27:07.039><c> only</c><00:27:07.240><c> in</c>

00:27:07.470 --> 00:27:07.480 align:start position:0%
logic so now we have to focus only in
 

00:27:07.480 --> 00:27:10.310 align:start position:0%
logic so now we have to focus only in
this<00:27:07.640><c> logic</c><00:27:07.919><c> so</c><00:27:08.120><c> forget</c><00:27:08.520><c> about</c><00:27:09.080><c> the</c><00:27:09.200><c> other</c><00:27:09.399><c> CTE</c>

00:27:10.310 --> 00:27:10.320 align:start position:0%
this logic so forget about the other CTE
 

00:27:10.320 --> 00:27:12.870 align:start position:0%
this logic so forget about the other CTE
and<00:27:10.919><c> the</c><00:27:11.039><c> main</c><00:27:11.320><c> query</c><00:27:11.919><c> so</c><00:27:12.120><c> we</c><00:27:12.240><c> have</c><00:27:12.360><c> to</c><00:27:12.520><c> find</c>

00:27:12.870 --> 00:27:12.880 align:start position:0%
and the main query so we have to find
 

00:27:12.880 --> 00:27:15.950 align:start position:0%
and the main query so we have to find
the<00:27:13.080><c> last</c><00:27:13.360><c> order</c><00:27:13.720><c> date</c><00:27:13.960><c> for</c><00:27:14.200><c> each</c><00:27:14.480><c> customer</c><00:27:15.360><c> so</c>

00:27:15.950 --> 00:27:15.960 align:start position:0%
the last order date for each customer so
 

00:27:15.960 --> 00:27:17.789 align:start position:0%
the last order date for each customer so
we're<00:27:16.120><c> going</c><00:27:16.240><c> to</c><00:27:16.399><c> go</c><00:27:16.679><c> and</c><00:27:16.919><c> query</c><00:27:17.320><c> again</c><00:27:17.640><c> the</c>

00:27:17.789 --> 00:27:17.799 align:start position:0%
we're going to go and query again the
 

00:27:17.799 --> 00:27:20.269 align:start position:0%
we're going to go and query again the
table<00:27:18.200><c> orders</c><00:27:19.200><c> so</c><00:27:19.399><c> what</c><00:27:19.520><c> do</c><00:27:19.640><c> we</c><00:27:19.760><c> need</c><00:27:20.000><c> we</c><00:27:20.120><c> need</c>

00:27:20.269 --> 00:27:20.279 align:start position:0%
table orders so what do we need we need
 

00:27:20.279 --> 00:27:23.909 align:start position:0%
table orders so what do we need we need
the<00:27:20.559><c> customer</c><00:27:20.960><c> ID</c><00:27:21.840><c> we</c><00:27:21.960><c> need</c><00:27:22.399><c> the</c><00:27:22.559><c> order</c>

00:27:23.909 --> 00:27:23.919 align:start position:0%
the customer ID we need the order
 

00:27:23.919 --> 00:27:28.669 align:start position:0%
the customer ID we need the order
date<00:27:24.919><c> from</c><00:27:25.159><c> our</c><00:27:25.480><c> table</c><00:27:26.559><c> sales</c><00:27:27.559><c> orders</c>

00:27:28.669 --> 00:27:28.679 align:start position:0%
date from our table sales orders
 

00:27:28.679 --> 00:27:31.750 align:start position:0%
date from our table sales orders
so<00:27:29.200><c> that's</c><00:27:29.360><c> it</c><00:27:29.480><c> for</c><00:27:29.679><c> now</c><00:27:29.880><c> let</c><00:27:30.159><c> just</c><00:27:30.799><c> select</c><00:27:31.279><c> it</c>

00:27:31.750 --> 00:27:31.760 align:start position:0%
so that's it for now let just select it
 

00:27:31.760 --> 00:27:33.909 align:start position:0%
so that's it for now let just select it
and<00:27:32.120><c> execute</c><00:27:32.600><c> it</c><00:27:33.000><c> and</c><00:27:33.120><c> now</c><00:27:33.320><c> with</c><00:27:33.480><c> that</c><00:27:33.640><c> you</c><00:27:33.760><c> can</c>

00:27:33.909 --> 00:27:33.919 align:start position:0%
and execute it and now with that you can
 

00:27:33.919 --> 00:27:36.269 align:start position:0%
and execute it and now with that you can
see<00:27:34.360><c> all</c><00:27:34.559><c> the</c><00:27:34.799><c> customers</c><00:27:35.600><c> and</c><00:27:35.760><c> as</c><00:27:35.919><c> well</c><00:27:36.080><c> all</c>

00:27:36.269 --> 00:27:36.279 align:start position:0%
see all the customers and as well all
 

00:27:36.279 --> 00:27:38.430 align:start position:0%
see all the customers and as well all
the<00:27:36.399><c> orders</c><00:27:37.039><c> but</c><00:27:37.159><c> we</c><00:27:37.279><c> would</c><00:27:37.440><c> like</c><00:27:37.600><c> to</c><00:27:37.799><c> have</c><00:27:38.159><c> the</c>

00:27:38.430 --> 00:27:38.440 align:start position:0%
the orders but we would like to have the
 

00:27:38.440 --> 00:27:40.630 align:start position:0%
the orders but we would like to have the
highest<00:27:38.799><c> order</c><00:27:39.120><c> for</c><00:27:39.360><c> each</c><00:27:39.600><c> customer</c><00:27:40.360><c> and</c><00:27:40.519><c> we</c>

00:27:40.630 --> 00:27:40.640 align:start position:0%
highest order for each customer and we
 

00:27:40.640 --> 00:27:43.389 align:start position:0%
highest order for each customer and we
can<00:27:40.919><c> go</c><00:27:41.080><c> and</c><00:27:41.279><c> use</c><00:27:41.640><c> our</c><00:27:42.279><c> aggregate</c><00:27:42.720><c> function</c>

00:27:43.389 --> 00:27:43.399 align:start position:0%
can go and use our aggregate function
 

00:27:43.399 --> 00:27:45.350 align:start position:0%
can go and use our aggregate function
the<00:27:43.559><c> max</c><00:27:43.919><c> function</c><00:27:44.640><c> so</c><00:27:44.880><c> what</c><00:27:45.000><c> we're</c><00:27:45.120><c> going</c><00:27:45.240><c> to</c>

00:27:45.350 --> 00:27:45.360 align:start position:0%
the max function so what we're going to
 

00:27:45.360 --> 00:27:47.789 align:start position:0%
the max function so what we're going to
do<00:27:45.519><c> it's</c><00:27:45.720><c> like</c><00:27:46.000><c> here</c><00:27:46.159><c> at</c><00:27:46.320><c> the</c><00:27:46.519><c> top</c><00:27:47.399><c> so</c><00:27:47.559><c> we</c><00:27:47.679><c> have</c>

00:27:47.789 --> 00:27:47.799 align:start position:0%
do it's like here at the top so we have
 

00:27:47.799 --> 00:27:50.590 align:start position:0%
do it's like here at the top so we have
to<00:27:47.919><c> go</c><00:27:48.039><c> and</c><00:27:48.159><c> use</c><00:27:48.360><c> the</c><00:27:48.519><c> function</c><00:27:49.039><c> Max</c><00:27:50.039><c> and</c><00:27:50.279><c> group</c>

00:27:50.590 --> 00:27:50.600 align:start position:0%
to go and use the function Max and group
 

00:27:50.600 --> 00:27:55.669 align:start position:0%
to go and use the function Max and group
up<00:27:51.440><c> by</c><00:27:51.640><c> the</c><00:27:51.840><c> customer</c><00:27:52.360><c> ID</c><00:27:53.039><c> so</c><00:27:53.640><c> group</c><00:27:54.440><c> up</c><00:27:55.440><c> the</c>

00:27:55.669 --> 00:27:55.679 align:start position:0%
up by the customer ID so group up the
 

00:27:55.679 --> 00:27:56.870 align:start position:0%
up by the customer ID so group up the
customer

00:27:56.870 --> 00:27:56.880 align:start position:0%
customer
 

00:27:56.880 --> 00:27:59.669 align:start position:0%
customer
ID<00:27:57.880><c> and</c><00:27:58.159><c> let</c><00:27:58.279><c> me</c><00:27:58.399><c> just</c><00:27:58.519><c> shift</c><00:27:58.799><c> it</c><00:27:59.000><c> like</c><00:27:59.240><c> this</c>

00:27:59.669 --> 00:27:59.679 align:start position:0%
ID and let me just shift it like this
 

00:27:59.679 --> 00:28:03.350 align:start position:0%
ID and let me just shift it like this
and<00:27:59.840><c> let's</c><00:28:00.039><c> give</c><00:28:00.120><c> it</c><00:28:00.240><c> the</c><00:28:00.440><c> name</c><00:28:01.320><c> last</c><00:28:02.320><c> order</c><00:28:03.039><c> so</c>

00:28:03.350 --> 00:28:03.360 align:start position:0%
and let's give it the name last order so
 

00:28:03.360 --> 00:28:05.230 align:start position:0%
and let's give it the name last order so
like<00:28:03.640><c> this</c><00:28:04.000><c> and</c><00:28:04.159><c> as</c><00:28:04.279><c> you</c><00:28:04.360><c> can</c><00:28:04.519><c> see</c><00:28:04.799><c> I'm</c><00:28:05.039><c> just</c>

00:28:05.230 --> 00:28:05.240 align:start position:0%
like this and as you can see I'm just
 

00:28:05.240 --> 00:28:08.110 align:start position:0%
like this and as you can see I'm just
selecting<00:28:05.880><c> now</c><00:28:06.320><c> only</c><00:28:06.600><c> my</c><00:28:06.880><c> query</c><00:28:07.799><c> I'm</c><00:28:07.919><c> not</c>

00:28:08.110 --> 00:28:08.120 align:start position:0%
selecting now only my query I'm not
 

00:28:08.120 --> 00:28:10.149 align:start position:0%
selecting now only my query I'm not
selecting<00:28:08.679><c> everything</c><00:28:09.480><c> and</c><00:28:09.679><c> I</c><00:28:09.880><c> keep</c>

00:28:10.149 --> 00:28:10.159 align:start position:0%
selecting everything and I keep
 

00:28:10.159 --> 00:28:12.149 align:start position:0%
selecting everything and I keep
executing<00:28:10.840><c> in</c><00:28:10.960><c> order</c><00:28:11.320><c> just</c><00:28:11.519><c> to</c><00:28:11.679><c> check</c><00:28:11.919><c> the</c>

00:28:12.149 --> 00:28:12.159 align:start position:0%
executing in order just to check the
 

00:28:12.159 --> 00:28:14.549 align:start position:0%
executing in order just to check the
results<00:28:12.679><c> before</c><00:28:12.960><c> we</c><00:28:13.120><c> integrate</c><00:28:13.600><c> it</c><00:28:13.919><c> in</c><00:28:14.200><c> the</c>

00:28:14.549 --> 00:28:14.559 align:start position:0%
results before we integrate it in the
 

00:28:14.559 --> 00:28:16.590 align:start position:0%
results before we integrate it in the
main<00:28:14.880><c> query</c><00:28:15.360><c> so</c><00:28:15.519><c> now</c><00:28:15.679><c> as</c><00:28:15.760><c> you</c><00:28:15.880><c> can</c><00:28:16.000><c> see</c><00:28:16.279><c> we</c><00:28:16.440><c> have</c>

00:28:16.590 --> 00:28:16.600 align:start position:0%
main query so now as you can see we have
 

00:28:16.600 --> 00:28:18.870 align:start position:0%
main query so now as you can see we have
for<00:28:16.840><c> each</c><00:28:17.120><c> customer</c><00:28:17.559><c> one</c><00:28:17.799><c> row</c><00:28:18.240><c> and</c><00:28:18.399><c> we</c><00:28:18.519><c> have</c><00:28:18.720><c> as</c>

00:28:18.870 --> 00:28:18.880 align:start position:0%
for each customer one row and we have as
 

00:28:18.880 --> 00:28:20.990 align:start position:0%
for each customer one row and we have as
well<00:28:19.159><c> the</c><00:28:19.360><c> highest</c><00:28:19.679><c> order</c><00:28:20.000><c> for</c><00:28:20.240><c> each</c><00:28:20.440><c> customer</c>

00:28:20.990 --> 00:28:21.000 align:start position:0%
well the highest order for each customer
 

00:28:21.000 --> 00:28:23.669 align:start position:0%
well the highest order for each customer
so<00:28:21.200><c> with</c><00:28:21.360><c> that</c><00:28:21.600><c> we</c><00:28:21.679><c> have</c><00:28:21.880><c> solved</c><00:28:22.679><c> this</c><00:28:22.880><c> subtask</c>

00:28:23.669 --> 00:28:23.679 align:start position:0%
so with that we have solved this subtask
 

00:28:23.679 --> 00:28:25.310 align:start position:0%
so with that we have solved this subtask
so<00:28:23.840><c> as</c><00:28:23.960><c> you</c><00:28:24.039><c> can</c><00:28:24.200><c> see</c><00:28:24.480><c> it's</c><00:28:24.640><c> really</c><00:28:24.880><c> easy</c><00:28:25.120><c> to</c>

00:28:25.310 --> 00:28:25.320 align:start position:0%
so as you can see it's really easy to
 

00:28:25.320 --> 00:28:28.149 align:start position:0%
so as you can see it's really easy to
extend<00:28:26.000><c> I'm</c><00:28:26.200><c> just</c><00:28:26.399><c> making</c><00:28:26.840><c> like</c><00:28:27.480><c> another</c><00:28:27.880><c> box</c>

00:28:28.149 --> 00:28:28.159 align:start position:0%
extend I'm just making like another box
 

00:28:28.159 --> 00:28:30.070 align:start position:0%
extend I'm just making like another box
box<00:28:28.519><c> and</c><00:28:28.679><c> I'm</c><00:28:28.840><c> adding</c><00:28:29.240><c> inside</c><00:28:29.559><c> it</c><00:28:29.840><c> the</c>

00:28:30.070 --> 00:28:30.080 align:start position:0%
box and I'm adding inside it the
 

00:28:30.080 --> 00:28:31.909 align:start position:0%
box and I'm adding inside it the
business<00:28:30.399><c> logic</c><00:28:30.799><c> that</c><00:28:31.039><c> I</c><00:28:31.159><c> want</c><00:28:31.640><c> and</c><00:28:31.799><c> this</c>

00:28:31.909 --> 00:28:31.919 align:start position:0%
business logic that I want and this
 

00:28:31.919 --> 00:28:34.230 align:start position:0%
business logic that I want and this
going<00:28:32.080><c> to</c><00:28:32.240><c> solve</c><00:28:32.720><c> one</c><00:28:33.039><c> problem</c><00:28:33.480><c> from</c><00:28:33.799><c> the</c>

00:28:34.230 --> 00:28:34.240 align:start position:0%
going to solve one problem from the
 

00:28:34.240 --> 00:28:36.710 align:start position:0%
going to solve one problem from the
whole<00:28:34.559><c> task</c><00:28:35.120><c> so</c><00:28:35.320><c> you</c><00:28:35.440><c> feel</c><00:28:35.760><c> now</c><00:28:36.159><c> exactly</c><00:28:36.559><c> the</c>

00:28:36.710 --> 00:28:36.720 align:start position:0%
whole task so you feel now exactly the
 

00:28:36.720 --> 00:28:39.110 align:start position:0%
whole task so you feel now exactly the
power<00:28:36.960><c> of</c><00:28:37.039><c> the</c><00:28:37.159><c> CTE</c><00:28:37.840><c> we</c><00:28:37.960><c> are</c><00:28:38.120><c> making</c><00:28:38.600><c> complex</c>

00:28:39.110 --> 00:28:39.120 align:start position:0%
power of the CTE we are making complex
 

00:28:39.120 --> 00:28:41.549 align:start position:0%
power of the CTE we are making complex
logic<00:28:39.760><c> but</c><00:28:39.960><c> still</c><00:28:40.279><c> it's</c><00:28:40.480><c> easy</c><00:28:40.760><c> to</c><00:28:40.919><c> add</c><00:28:41.399><c> now</c>

00:28:41.549 --> 00:28:41.559 align:start position:0%
logic but still it's easy to add now
 

00:28:41.559 --> 00:28:43.149 align:start position:0%
logic but still it's easy to add now
imagine<00:28:41.919><c> you</c><00:28:42.039><c> are</c><00:28:42.200><c> not</c><00:28:42.360><c> doing</c><00:28:42.679><c> this</c><00:28:42.840><c> you</c><00:28:42.960><c> are</c>

00:28:43.149 --> 00:28:43.159 align:start position:0%
imagine you are not doing this you are
 

00:28:43.159 --> 00:28:45.470 align:start position:0%
imagine you are not doing this you are
always<00:28:43.559><c> extending</c><00:28:44.200><c> one</c><00:28:44.399><c> big</c><00:28:44.679><c> query</c><00:28:45.320><c> it's</c>

00:28:45.470 --> 00:28:45.480 align:start position:0%
always extending one big query it's
 

00:28:45.480 --> 00:28:47.269 align:start position:0%
always extending one big query it's
going<00:28:45.559><c> to</c><00:28:45.760><c> be</c><00:28:45.960><c> really</c><00:28:46.240><c> hard</c><00:28:46.480><c> to</c><00:28:46.679><c> extend</c><00:28:47.120><c> and</c>

00:28:47.269 --> 00:28:47.279 align:start position:0%
going to be really hard to extend and
 

00:28:47.279 --> 00:28:49.909 align:start position:0%
going to be really hard to extend and
that's<00:28:47.559><c> why</c><00:28:47.799><c> a</c><00:28:47.919><c> lot</c><00:28:48.080><c> of</c><00:28:48.480><c> SQL</c><00:28:48.919><c> developers</c>

00:28:49.909 --> 00:28:49.919 align:start position:0%
that's why a lot of SQL developers
 

00:28:49.919 --> 00:28:52.669 align:start position:0%
that's why a lot of SQL developers
really<00:28:50.200><c> love</c><00:28:50.519><c> using</c><00:28:50.880><c> tte</c><00:28:51.720><c> and</c><00:28:51.919><c> they</c><00:28:52.200><c> like</c><00:28:52.440><c> use</c>

00:28:52.669 --> 00:28:52.679 align:start position:0%
really love using tte and they like use
 

00:28:52.679 --> 00:28:55.310 align:start position:0%
really love using tte and they like use
it<00:28:52.919><c> in</c><00:28:53.200><c> each</c><00:28:53.480><c> query</c><00:28:53.880><c> or</c><00:28:54.159><c> in</c><00:28:54.399><c> each</c><00:28:54.720><c> task</c><00:28:55.120><c> that</c>

00:28:55.310 --> 00:28:55.320 align:start position:0%
it in each query or in each task that
 

00:28:55.320 --> 00:28:57.830 align:start position:0%
it in each query or in each task that
they<00:28:55.519><c> have</c><00:28:56.039><c> so</c><00:28:56.320><c> we</c><00:28:56.480><c> have</c><00:28:56.640><c> solved</c><00:28:57.240><c> this</c><00:28:57.480><c> task</c>

00:28:57.830 --> 00:28:57.840 align:start position:0%
they have so we have solved this task
 

00:28:57.840 --> 00:28:59.630 align:start position:0%
they have so we have solved this task
and<00:28:58.159><c> we</c><00:28:58.240><c> have</c><00:28:58.360><c> to</c><00:28:58.440><c> go</c><00:28:58.600><c> now</c><00:28:58.840><c> integrate</c><00:28:59.279><c> it</c><00:28:59.480><c> in</c>

00:28:59.630 --> 00:28:59.640 align:start position:0%
and we have to go now integrate it in
 

00:28:59.640 --> 00:29:01.310 align:start position:0%
and we have to go now integrate it in
the<00:28:59.880><c> main</c><00:29:00.200><c> query</c><00:29:00.559><c> it's</c><00:29:00.679><c> going</c><00:29:00.799><c> to</c><00:29:00.880><c> be</c><00:29:01.080><c> very</c>

00:29:01.310 --> 00:29:01.320 align:start position:0%
the main query it's going to be very
 

00:29:01.320 --> 00:29:03.909 align:start position:0%
the main query it's going to be very
simple<00:29:01.960><c> so</c><00:29:02.159><c> we're</c><00:29:02.279><c> going</c><00:29:02.399><c> to</c><00:29:02.559><c> get</c><00:29:02.799><c> over</c><00:29:03.159><c> here</c>

00:29:03.909 --> 00:29:03.919 align:start position:0%
simple so we're going to get over here
 

00:29:03.919 --> 00:29:06.630 align:start position:0%
simple so we're going to get over here
and<00:29:04.080><c> we</c><00:29:04.200><c> will</c><00:29:04.399><c> go</c><00:29:04.600><c> and</c><00:29:04.840><c> just</c><00:29:05.159><c> add</c><00:29:05.559><c> another</c><00:29:06.080><c> join</c>

00:29:06.630 --> 00:29:06.640 align:start position:0%
and we will go and just add another join
 

00:29:06.640 --> 00:29:08.830 align:start position:0%
and we will go and just add another join
so<00:29:06.840><c> we're</c><00:29:06.960><c> going</c><00:29:07.039><c> to</c><00:29:07.200><c> join</c><00:29:07.440><c> it</c><00:29:07.600><c> with</c><00:29:07.760><c> the</c><00:29:07.960><c> CTE</c>

00:29:08.830 --> 00:29:08.840 align:start position:0%
so we're going to join it with the CTE
 

00:29:08.840 --> 00:29:10.789 align:start position:0%
so we're going to join it with the CTE
and<00:29:09.000><c> as</c><00:29:09.080><c> you</c><00:29:09.159><c> can</c><00:29:09.279><c> see</c><00:29:09.440><c> SQL</c><00:29:09.840><c> Now</c><00:29:10.039><c> is</c><00:29:10.320><c> offering</c>

00:29:10.789 --> 00:29:10.799 align:start position:0%
and as you can see SQL Now is offering
 

00:29:10.799 --> 00:29:13.110 align:start position:0%
and as you can see SQL Now is offering
it<00:29:11.120><c> as</c><00:29:11.279><c> a</c><00:29:11.480><c> table</c><00:29:12.039><c> even</c><00:29:12.279><c> though</c><00:29:12.480><c> it</c><00:29:12.600><c> is</c><00:29:12.760><c> not</c><00:29:12.919><c> the</c>

00:29:13.110 --> 00:29:13.120 align:start position:0%
it as a table even though it is not the
 

00:29:13.120 --> 00:29:14.830 align:start position:0%
it as a table even though it is not the
physical<00:29:13.480><c> table</c><00:29:13.840><c> that</c><00:29:14.120><c> exist</c><00:29:14.399><c> in</c><00:29:14.519><c> our</c>

00:29:14.830 --> 00:29:14.840 align:start position:0%
physical table that exist in our
 

00:29:14.840 --> 00:29:17.789 align:start position:0%
physical table that exist in our
database<00:29:15.840><c> it</c><00:29:16.000><c> only</c><00:29:16.320><c> lives</c><00:29:16.760><c> inside</c><00:29:17.080><c> our</c><00:29:17.360><c> data</c>

00:29:17.789 --> 00:29:17.799 align:start position:0%
database it only lives inside our data
 

00:29:17.799 --> 00:29:20.149 align:start position:0%
database it only lives inside our data
but<00:29:17.960><c> still</c><00:29:18.240><c> SQL</c><00:29:18.720><c> treat</c><00:29:19.039><c> it</c><00:29:19.320><c> as</c><00:29:19.440><c> a</c><00:29:19.600><c> table</c><00:29:20.000><c> and</c>

00:29:20.149 --> 00:29:20.159 align:start position:0%
but still SQL treat it as a table and
 

00:29:20.159 --> 00:29:21.630 align:start position:0%
but still SQL treat it as a table and
this<00:29:20.240><c> is</c><00:29:20.440><c> exactly</c><00:29:20.799><c> what</c><00:29:20.880><c> we</c><00:29:21.000><c> are</c><00:29:21.120><c> doing</c><00:29:21.480><c> we</c>

00:29:21.630 --> 00:29:21.640 align:start position:0%
this is exactly what we are doing we
 

00:29:21.640 --> 00:29:24.870 align:start position:0%
this is exactly what we are doing we
treat<00:29:22.000><c> those</c><00:29:22.200><c> informations</c><00:29:22.760><c> as</c><00:29:22.960><c> table</c><00:29:23.679><c> so</c><00:29:23.919><c> CTE</c>

00:29:24.870 --> 00:29:24.880 align:start position:0%
treat those informations as table so CTE
 

00:29:24.880 --> 00:29:28.269 align:start position:0%
treat those informations as table so CTE
the<00:29:25.159><c> last</c><00:29:25.480><c> order</c><00:29:26.120><c> and</c><00:29:26.360><c> I</c><00:29:26.440><c> will</c><00:29:26.720><c> call</c><00:29:26.919><c> it</c><00:29:27.120><c> CL</c><00:29:28.159><c> and</c>

00:29:28.269 --> 00:29:28.279 align:start position:0%
the last order and I will call it CL and
 

00:29:28.279 --> 00:29:30.430 align:start position:0%
the last order and I will call it CL and
then<00:29:28.440><c> of</c><00:29:28.559><c> course</c><00:29:28.720><c> we</c><00:29:28.840><c> have</c><00:29:28.960><c> to</c><00:29:29.120><c> go</c><00:29:29.440><c> and</c><00:29:29.919><c> do</c><00:29:30.279><c> the</c>

00:29:30.430 --> 00:29:30.440 align:start position:0%
then of course we have to go and do the
 

00:29:30.440 --> 00:29:34.789 align:start position:0%
then of course we have to go and do the
same<00:29:30.960><c> condition</c><00:29:31.480><c> like</c><00:29:31.760><c> here</c><00:29:32.519><c> so</c><00:29:33.519><c> the</c><00:29:33.799><c> clo</c>

00:29:34.789 --> 00:29:34.799 align:start position:0%
same condition like here so the clo
 

00:29:34.799 --> 00:29:36.750 align:start position:0%
same condition like here so the clo
customer<00:29:35.240><c> ID</c><00:29:35.600><c> should</c><00:29:35.840><c> be</c><00:29:36.120><c> equal</c><00:29:36.440><c> to</c><00:29:36.600><c> the</c>

00:29:36.750 --> 00:29:36.760 align:start position:0%
customer ID should be equal to the
 

00:29:36.760 --> 00:29:38.870 align:start position:0%
customer ID should be equal to the
customer<00:29:37.120><c> ID</c><00:29:37.480><c> from</c><00:29:37.720><c> the</c><00:29:37.880><c> first</c><00:29:38.200><c> table</c><00:29:38.679><c> the</c>

00:29:38.870 --> 00:29:38.880 align:start position:0%
customer ID from the first table the
 

00:29:38.880 --> 00:29:40.470 align:start position:0%
customer ID from the first table the
customers<00:29:39.480><c> and</c><00:29:39.640><c> of</c><00:29:39.760><c> course</c><00:29:39.960><c> we</c><00:29:40.080><c> have</c><00:29:40.200><c> to</c><00:29:40.320><c> go</c>

00:29:40.470 --> 00:29:40.480 align:start position:0%
customers and of course we have to go
 

00:29:40.480 --> 00:29:42.750 align:start position:0%
customers and of course we have to go
and<00:29:40.720><c> add</c><00:29:41.200><c> this</c><00:29:41.440><c> new</c><00:29:41.679><c> information</c><00:29:42.240><c> to</c><00:29:42.360><c> the</c><00:29:42.519><c> main</c>

00:29:42.750 --> 00:29:42.760 align:start position:0%
and add this new information to the main
 

00:29:42.760 --> 00:29:44.110 align:start position:0%
and add this new information to the main
query<00:29:43.320><c> so</c>

00:29:44.110 --> 00:29:44.120 align:start position:0%
query so
 

00:29:44.120 --> 00:29:47.310 align:start position:0%
query so
clo<00:29:45.120><c> the</c><00:29:45.360><c> last</c><00:29:46.320><c> order</c><00:29:46.840><c> so</c><00:29:46.960><c> now</c><00:29:47.120><c> what</c><00:29:47.200><c> we're</c>

00:29:47.310 --> 00:29:47.320 align:start position:0%
clo the last order so now what we're
 

00:29:47.320 --> 00:29:48.630 align:start position:0%
clo the last order so now what we're
going<00:29:47.440><c> to</c><00:29:47.559><c> do</c><00:29:47.720><c> we're</c><00:29:47.840><c> going</c><00:29:47.919><c> to</c><00:29:48.120><c> go</c><00:29:48.320><c> and</c>

00:29:48.630 --> 00:29:48.640 align:start position:0%
going to do we're going to go and
 

00:29:48.640 --> 00:29:50.430 align:start position:0%
going to do we're going to go and
execute<00:29:49.120><c> the</c><00:29:49.279><c> whole</c><00:29:49.519><c> thing</c><00:29:49.840><c> so</c><00:29:49.960><c> we</c><00:29:50.080><c> have</c><00:29:50.240><c> now</c>

00:29:50.430 --> 00:29:50.440 align:start position:0%
execute the whole thing so we have now
 

00:29:50.440 --> 00:29:53.230 align:start position:0%
execute the whole thing so we have now
two<00:29:50.600><c> cdes</c><00:29:51.440><c> and</c><00:29:51.600><c> as</c><00:29:51.720><c> well</c><00:29:51.880><c> our</c><00:29:52.120><c> main</c><00:29:52.399><c> query</c><00:29:52.919><c> so</c>

00:29:53.230 --> 00:29:53.240 align:start position:0%
two cdes and as well our main query so
 

00:29:53.240 --> 00:29:55.029 align:start position:0%
two cdes and as well our main query so
let's<00:29:53.440><c> go</c><00:29:53.640><c> ah</c><00:29:53.760><c> and</c><00:29:53.919><c> execute</c><00:29:54.320><c> it</c><00:29:54.640><c> now</c><00:29:54.840><c> again</c>

00:29:55.029 --> 00:29:55.039 align:start position:0%
let's go ah and execute it now again
 

00:29:55.039 --> 00:29:56.830 align:start position:0%
let's go ah and execute it now again
let's<00:29:55.200><c> check</c><00:29:55.440><c> the</c><00:29:55.600><c> data</c><00:29:56.080><c> the</c><00:29:56.240><c> first</c><00:29:56.559><c> three</c>

00:29:56.830 --> 00:29:56.840 align:start position:0%
let's check the data the first three
 

00:29:56.840 --> 00:29:58.710 align:start position:0%
let's check the data the first three
columns<00:29:57.320><c> comes</c><00:29:57.600><c> from</c><00:29:57.799><c> the</c><00:29:58.039><c> physical</c><00:29:58.360><c> table</c>

00:29:58.710 --> 00:29:58.720 align:start position:0%
columns comes from the physical table
 

00:29:58.720 --> 00:30:01.350 align:start position:0%
columns comes from the physical table
customers<00:29:59.559><c> the</c><00:29:59.760><c> fourth</c><00:30:00.120><c> one</c><00:30:00.360><c> the</c><00:30:00.519><c> total</c><00:30:00.840><c> sales</c>

00:30:01.350 --> 00:30:01.360 align:start position:0%
customers the fourth one the total sales
 

00:30:01.360 --> 00:30:05.269 align:start position:0%
customers the fourth one the total sales
comes<00:30:02.200><c> from</c><00:30:02.440><c> our</c><00:30:02.720><c> Fair</c><00:30:03.120><c> City</c><00:30:03.760><c> over</c><00:30:04.120><c> here</c><00:30:04.880><c> so</c>

00:30:05.269 --> 00:30:05.279 align:start position:0%
comes from our Fair City over here so
 

00:30:05.279 --> 00:30:07.830 align:start position:0%
comes from our Fair City over here so
from<00:30:05.559><c> here</c><00:30:06.200><c> and</c><00:30:06.360><c> the</c><00:30:06.559><c> last</c><00:30:06.840><c> order</c><00:30:07.279><c> comes</c><00:30:07.600><c> from</c>

00:30:07.830 --> 00:30:07.840 align:start position:0%
from here and the last order comes from
 

00:30:07.840 --> 00:30:10.389 align:start position:0%
from here and the last order comes from
our<00:30:08.120><c> new</c><00:30:08.360><c> city</c><00:30:08.880><c> that</c><00:30:09.039><c> we</c><00:30:09.200><c> just</c><00:30:09.480><c> defined</c><00:30:10.279><c> the</c>

00:30:10.389 --> 00:30:10.399 align:start position:0%
our new city that we just defined the
 

00:30:10.399 --> 00:30:12.269 align:start position:0%
our new city that we just defined the
city<00:30:10.720><c> number</c><00:30:10.960><c> two</c><00:30:11.360><c> so</c><00:30:11.480><c> as</c><00:30:11.559><c> you</c><00:30:11.679><c> can</c><00:30:11.760><c> see</c><00:30:12.039><c> guys</c>

00:30:12.269 --> 00:30:12.279 align:start position:0%
city number two so as you can see guys
 

00:30:12.279 --> 00:30:14.310 align:start position:0%
city number two so as you can see guys
Everything<00:30:12.600><c> feels</c><00:30:12.960><c> like</c><00:30:13.399><c> organized</c><00:30:14.080><c> and</c>

00:30:14.310 --> 00:30:14.320 align:start position:0%
Everything feels like organized and
 

00:30:14.320 --> 00:30:16.950 align:start position:0%
Everything feels like organized and
structures<00:30:15.240><c> and</c><00:30:15.399><c> we</c><00:30:15.519><c> have</c><00:30:15.720><c> like</c><00:30:15.960><c> flow</c><00:30:16.640><c> and</c><00:30:16.799><c> of</c>

00:30:16.950 --> 00:30:16.960 align:start position:0%
structures and we have like flow and of
 

00:30:16.960 --> 00:30:20.070 align:start position:0%
structures and we have like flow and of
course<00:30:17.480><c> those</c><00:30:17.720><c> CTE</c><00:30:18.279><c> are</c><00:30:18.480><c> Standalone</c><00:30:19.120><c> CES</c><00:30:19.919><c> so</c>

00:30:20.070 --> 00:30:20.080 align:start position:0%
course those CTE are Standalone CES so
 

00:30:20.080 --> 00:30:22.710 align:start position:0%
course those CTE are Standalone CES so
we<00:30:20.200><c> can</c><00:30:20.399><c> go</c><00:30:20.600><c> always</c><00:30:21.159><c> and</c><00:30:21.440><c> select</c><00:30:21.880><c> the</c><00:30:22.080><c> city</c><00:30:22.440><c> and</c>

00:30:22.710 --> 00:30:22.720 align:start position:0%
we can go always and select the city and
 

00:30:22.720 --> 00:30:25.029 align:start position:0%
we can go always and select the city and
execute<00:30:23.120><c> it</c><00:30:23.320><c> subtly</c><00:30:24.159><c> it</c><00:30:24.279><c> doesn't</c><00:30:24.640><c> need</c>

00:30:25.029 --> 00:30:25.039 align:start position:0%
execute it subtly it doesn't need
 

00:30:25.039 --> 00:30:27.190 align:start position:0%
execute it subtly it doesn't need
anything<00:30:25.440><c> else</c><00:30:25.720><c> from</c><00:30:26.000><c> outside</c><00:30:26.480><c> this</c><00:30:26.640><c> quer</c><00:30:27.039><c> it</c>

00:30:27.190 --> 00:30:27.200 align:start position:0%
anything else from outside this quer it
 

00:30:27.200 --> 00:30:29.190 align:start position:0%
anything else from outside this quer it
just<00:30:27.360><c> needs</c><00:30:27.640><c> the</c><00:30:28.000><c> tabls</c><00:30:28.519><c> inside</c><00:30:28.960><c> your</c>

00:30:29.190 --> 00:30:29.200 align:start position:0%
just needs the tabls inside your
 

00:30:29.200 --> 00:30:31.029 align:start position:0%
just needs the tabls inside your
database<00:30:29.880><c> so</c><00:30:30.159><c> guys</c><00:30:30.399><c> again</c><00:30:30.640><c> here</c><00:30:30.840><c> pay</c>

00:30:31.029 --> 00:30:31.039 align:start position:0%
database so guys again here pay
 

00:30:31.039 --> 00:30:33.310 align:start position:0%
database so guys again here pay
attention<00:30:31.559><c> if</c><00:30:31.640><c> you</c><00:30:31.760><c> want</c><00:30:31.880><c> to</c><00:30:32.080><c> add</c><00:30:32.399><c> more</c><00:30:32.600><c> ctes</c>

00:30:33.310 --> 00:30:33.320 align:start position:0%
attention if you want to add more ctes
 

00:30:33.320 --> 00:30:35.070 align:start position:0%
attention if you want to add more ctes
use<00:30:33.640><c> the</c><00:30:33.840><c> comma</c><00:30:34.120><c> you</c><00:30:34.200><c> cannot</c><00:30:34.480><c> go</c><00:30:34.600><c> and</c><00:30:34.720><c> use</c><00:30:34.919><c> for</c>

00:30:35.070 --> 00:30:35.080 align:start position:0%
use the comma you cannot go and use for
 

00:30:35.080 --> 00:30:37.269 align:start position:0%
use the comma you cannot go and use for
example<00:30:35.480><c> here</c><00:30:35.760><c> I</c><00:30:36.120><c> another</c><00:30:36.519><c> wi</c><00:30:36.880><c> so</c><00:30:37.039><c> if</c><00:30:37.159><c> I</c>

00:30:37.269 --> 00:30:37.279 align:start position:0%
example here I another wi so if I
 

00:30:37.279 --> 00:30:39.470 align:start position:0%
example here I another wi so if I
execute<00:30:37.679><c> it</c><00:30:37.840><c> I</c><00:30:37.880><c> will</c><00:30:38.039><c> get</c><00:30:38.200><c> an</c><00:30:38.360><c> error</c><00:30:39.000><c> so</c><00:30:39.320><c> you</c>

00:30:39.470 --> 00:30:39.480 align:start position:0%
execute it I will get an error so you
 

00:30:39.480 --> 00:30:41.110 align:start position:0%
execute it I will get an error so you
have<00:30:39.600><c> to</c><00:30:39.720><c> separate</c><00:30:40.080><c> it</c><00:30:40.240><c> with</c><00:30:40.480><c> comma</c><00:30:40.919><c> and</c>

00:30:41.110 --> 00:30:41.120 align:start position:0%
have to separate it with comma and
 

00:30:41.120 --> 00:30:43.190 align:start position:0%
have to separate it with comma and
another<00:30:41.440><c> mistake</c><00:30:41.840><c> that</c><00:30:42.039><c> I</c><00:30:42.159><c> do</c><00:30:42.440><c> frequently</c>

00:30:43.190 --> 00:30:43.200 align:start position:0%
another mistake that I do frequently
 

00:30:43.200 --> 00:30:46.310 align:start position:0%
another mistake that I do frequently
that<00:30:44.000><c> I</c><00:30:44.120><c> forget</c><00:30:44.480><c> and</c><00:30:44.720><c> go</c><00:30:44.960><c> add</c><00:30:45.320><c> here</c><00:30:45.600><c> like</c><00:30:46.080><c> to</c>

00:30:46.310 --> 00:30:46.320 align:start position:0%
that I forget and go add here like to
 

00:30:46.320 --> 00:30:49.070 align:start position:0%
that I forget and go add here like to
the<00:30:46.640><c> last</c><00:30:47.120><c> CTE</c><00:30:47.960><c> comma</c><00:30:48.360><c> and</c><00:30:48.519><c> this</c><00:30:48.640><c> happens</c><00:30:48.919><c> to</c>

00:30:49.070 --> 00:30:49.080 align:start position:0%
the last CTE comma and this happens to
 

00:30:49.080 --> 00:30:52.230 align:start position:0%
the last CTE comma and this happens to
me<00:30:49.240><c> if</c><00:30:49.360><c> I'm</c><00:30:49.480><c> using</c><00:30:49.760><c> a</c><00:30:49.880><c> lot</c><00:30:50.039><c> of</c><00:30:50.159><c> CTE</c><00:30:51.120><c> so</c><00:30:51.720><c> if</c><00:30:51.960><c> I</c><00:30:52.080><c> go</c>

00:30:52.230 --> 00:30:52.240 align:start position:0%
me if I'm using a lot of CTE so if I go
 

00:30:52.240 --> 00:30:54.190 align:start position:0%
me if I'm using a lot of CTE so if I go
and<00:30:52.399><c> do</c><00:30:52.519><c> it</c><00:30:52.679><c> like</c><00:30:52.880><c> this</c><00:30:53.440><c> I</c><00:30:53.519><c> will</c><00:30:53.679><c> get</c><00:30:53.880><c> as</c><00:30:54.039><c> well</c>

00:30:54.190 --> 00:30:54.200 align:start position:0%
and do it like this I will get as well
 

00:30:54.200 --> 00:30:56.870 align:start position:0%
and do it like this I will get as well
an<00:30:54.360><c> error</c><00:30:54.799><c> because</c><00:30:55.679><c> the</c><00:30:55.840><c> main</c><00:30:56.120><c> query</c><00:30:56.519><c> doesn't</c>

00:30:56.870 --> 00:30:56.880 align:start position:0%
an error because the main query doesn't
 

00:30:56.880 --> 00:30:59.190 align:start position:0%
an error because the main query doesn't
need<00:30:57.120><c> a</c><00:30:57.360><c> comma</c><00:30:57.720><c> so</c><00:30:58.120><c> the</c><00:30:58.240><c> last</c><00:30:58.399><c> C</c><00:30:58.760><c> should</c><00:30:58.960><c> not</c>

00:30:59.190 --> 00:30:59.200 align:start position:0%
need a comma so the last C should not
 

00:30:59.200 --> 00:31:01.750 align:start position:0%
need a comma so the last C should not
has<00:30:59.480><c> a</c><00:30:59.639><c> comma</c><00:30:59.919><c> after</c><00:31:00.159><c> the</c><00:31:00.279><c> parenthesis</c><00:31:01.080><c> so</c><00:31:01.600><c> I</c>

00:31:01.750 --> 00:31:01.760 align:start position:0%
has a comma after the parenthesis so I
 

00:31:01.760 --> 00:31:03.990 align:start position:0%
has a comma after the parenthesis so I
just<00:31:01.919><c> removed</c><00:31:02.279><c> it</c><00:31:02.480><c> and</c><00:31:02.720><c> execute</c><00:31:03.320><c> so</c><00:31:03.639><c> guys</c><00:31:03.799><c> with</c>

00:31:03.990 --> 00:31:04.000 align:start position:0%
just removed it and execute so guys with
 

00:31:04.000 --> 00:31:09.830 align:start position:0%
just removed it and execute so guys with
us<00:31:04.200><c> we</c><00:31:04.320><c> have</c><00:31:04.480><c> now</c><00:31:04.720><c> multiple</c><00:31:05.200><c> CS</c><00:31:05.720><c> inside</c><00:31:06.039><c> our</c>

00:31:09.830 --> 00:31:09.840 align:start position:0%
 
 

00:31:09.840 --> 00:31:12.509 align:start position:0%
 
query<00:31:10.840><c> all</c><00:31:10.960><c> right</c><00:31:11.120><c> so</c><00:31:11.320><c> now</c><00:31:11.519><c> what</c><00:31:11.679><c> is</c><00:31:11.880><c> a</c><00:31:12.080><c> nested</c>

00:31:12.509 --> 00:31:12.519 align:start position:0%
query all right so now what is a nested
 

00:31:12.519 --> 00:31:16.269 align:start position:0%
query all right so now what is a nested
CTE<00:31:13.279><c> it</c><00:31:13.399><c> is</c><00:31:13.559><c> a</c><00:31:13.760><c> CTE</c><00:31:14.360><c> inside</c><00:31:14.919><c> another</c><00:31:15.240><c> CTE</c><00:31:16.080><c> so</c>

00:31:16.269 --> 00:31:16.279 align:start position:0%
CTE it is a CTE inside another CTE so
 

00:31:16.279 --> 00:31:18.430 align:start position:0%
CTE it is a CTE inside another CTE so
it's<00:31:16.480><c> kind</c><00:31:16.639><c> of</c><00:31:16.760><c> like</c><00:31:16.919><c> subqueries</c><00:31:17.679><c> a</c><00:31:17.880><c> query</c>

00:31:18.430 --> 00:31:18.440 align:start position:0%
it's kind of like subqueries a query
 

00:31:18.440 --> 00:31:20.950 align:start position:0%
it's kind of like subqueries a query
inside<00:31:18.880><c> another</c><00:31:19.200><c> query</c><00:31:19.799><c> so</c><00:31:20.039><c> not</c><00:31:20.240><c> only</c><00:31:20.559><c> a</c><00:31:20.679><c> main</c>

00:31:20.950 --> 00:31:20.960 align:start position:0%
inside another query so not only a main
 

00:31:20.960 --> 00:31:23.909 align:start position:0%
inside another query so not only a main
query<00:31:21.320><c> can</c><00:31:21.440><c> use</c><00:31:21.720><c> the</c><00:31:21.960><c> result</c><00:31:22.320><c> of</c><00:31:22.600><c> CTE</c><00:31:23.600><c> another</c>

00:31:23.909 --> 00:31:23.919 align:start position:0%
query can use the result of CTE another
 

00:31:23.919 --> 00:31:26.509 align:start position:0%
query can use the result of CTE another
CTE<00:31:24.399><c> can</c><00:31:24.519><c> use</c><00:31:24.760><c> the</c><00:31:24.919><c> result</c><00:31:25.240><c> from</c><00:31:25.440><c> a</c><00:31:25.559><c> CTE</c><00:31:26.240><c> and</c><00:31:26.360><c> of</c>

00:31:26.509 --> 00:31:26.519 align:start position:0%
CTE can use the result from a CTE and of
 

00:31:26.519 --> 00:31:28.430 align:start position:0%
CTE can use the result from a CTE and of
course<00:31:26.799><c> the</c><00:31:26.960><c> Ned</c><00:31:27.279><c> CTE</c><00:31:27.639><c> is</c><00:31:27.760><c> like</c><00:31:27.919><c> Like</c><00:31:28.080><c> A</c><00:31:28.159><c> Min</c>

00:31:28.430 --> 00:31:28.440 align:start position:0%
course the Ned CTE is like Like A Min
 

00:31:28.440 --> 00:31:31.149 align:start position:0%
course the Ned CTE is like Like A Min
query<00:31:28.799><c> is</c><00:31:28.960><c> depend</c><00:31:29.480><c> on</c><00:31:30.039><c> other</c><00:31:30.399><c> queries</c><00:31:30.960><c> that</c>

00:31:31.149 --> 00:31:31.159 align:start position:0%
query is depend on other queries that
 

00:31:31.159 --> 00:31:33.230 align:start position:0%
query is depend on other queries that
means<00:31:31.639><c> you</c><00:31:31.760><c> cannot</c><00:31:32.120><c> go</c><00:31:32.279><c> and</c><00:31:32.480><c> select</c><00:31:32.840><c> it</c><00:31:33.080><c> and</c>

00:31:33.230 --> 00:31:33.240 align:start position:0%
means you cannot go and select it and
 

00:31:33.240 --> 00:31:35.990 align:start position:0%
means you cannot go and select it and
run<00:31:33.519><c> it</c><00:31:33.960><c> independently</c><00:31:34.919><c> from</c><00:31:35.080><c> the</c><00:31:35.240><c> query</c><00:31:35.720><c> so</c>

00:31:35.990 --> 00:31:36.000 align:start position:0%
run it independently from the query so
 

00:31:36.000 --> 00:31:38.509 align:start position:0%
run it independently from the query so
always<00:31:36.200><c> you</c><00:31:36.320><c> have</c><00:31:36.440><c> to</c><00:31:36.600><c> run</c><00:31:37.240><c> the</c><00:31:37.399><c> CTE</c><00:31:37.919><c> inside</c><00:31:38.320><c> it</c>

00:31:38.509 --> 00:31:38.519 align:start position:0%
always you have to run the CTE inside it
 

00:31:38.519 --> 00:31:41.110 align:start position:0%
always you have to run the CTE inside it
first<00:31:39.039><c> before</c><00:31:39.360><c> seeing</c><00:31:39.799><c> the</c><00:31:40.000><c> result</c><00:31:40.360><c> of</c><00:31:40.519><c> theed</c>

00:31:41.110 --> 00:31:41.120 align:start position:0%
first before seeing the result of theed
 

00:31:41.120 --> 00:31:43.029 align:start position:0%
first before seeing the result of theed
CTE<00:31:41.799><c> okay</c><00:31:41.919><c> so</c><00:31:42.120><c> now</c><00:31:42.279><c> let's</c><00:31:42.720><c> understand</c><00:31:42.919><c> what</c>

00:31:43.029 --> 00:31:43.039 align:start position:0%
CTE okay so now let's understand what
 

00:31:43.039 --> 00:31:45.070 align:start position:0%
CTE okay so now let's understand what
this<00:31:43.200><c> means</c><00:31:43.720><c> again</c><00:31:44.000><c> we</c><00:31:44.120><c> have</c><00:31:44.240><c> our</c><00:31:44.519><c> database</c>

00:31:45.070 --> 00:31:45.080 align:start position:0%
this means again we have our database
 

00:31:45.080 --> 00:31:47.590 align:start position:0%
this means again we have our database
and<00:31:45.279><c> we</c><00:31:45.440><c> have</c><00:31:45.840><c> a</c><00:31:46.000><c> city</c><00:31:46.440><c> query</c><00:31:46.919><c> that</c><00:31:47.159><c> goes</c>

00:31:47.590 --> 00:31:47.600 align:start position:0%
and we have a city query that goes
 

00:31:47.600 --> 00:31:49.950 align:start position:0%
and we have a city query that goes
directly<00:31:48.000><c> to</c><00:31:48.200><c> the</c><00:31:48.360><c> database</c><00:31:49.200><c> and</c><00:31:49.399><c> queries</c><00:31:49.799><c> the</c>

00:31:49.950 --> 00:31:49.960 align:start position:0%
directly to the database and queries the
 

00:31:49.960 --> 00:31:52.110 align:start position:0%
directly to the database and queries the
data<00:31:50.200><c> from</c><00:31:50.480><c> there</c><00:31:51.000><c> and</c><00:31:51.200><c> in</c><00:31:51.360><c> the</c><00:31:51.519><c> output</c><00:31:52.000><c> we</c>

00:31:52.110 --> 00:31:52.120 align:start position:0%
data from there and in the output we
 

00:31:52.120 --> 00:31:54.230 align:start position:0%
data from there and in the output we
will<00:31:52.320><c> get</c><00:31:52.600><c> the</c><00:31:52.799><c> intermediate</c><00:31:53.519><c> results</c><00:31:54.120><c> and</c>

00:31:54.230 --> 00:31:54.240 align:start position:0%
will get the intermediate results and
 

00:31:54.240 --> 00:31:56.230 align:start position:0%
will get the intermediate results and
now<00:31:54.399><c> in</c><00:31:54.559><c> this</c><00:31:54.720><c> scenario</c><00:31:55.279><c> this</c><00:31:55.480><c> time</c><00:31:55.960><c> we</c><00:31:56.039><c> will</c>

00:31:56.230 --> 00:31:56.240 align:start position:0%
now in this scenario this time we will
 

00:31:56.240 --> 00:31:57.909 align:start position:0%
now in this scenario this time we will
not<00:31:56.480><c> have</c><00:31:56.720><c> only</c><00:31:56.960><c> one</c><00:31:57.159><c> intermediate</c><00:31:57.639><c> result</c>

00:31:57.909 --> 00:31:57.919 align:start position:0%
not have only one intermediate result
 

00:31:57.919 --> 00:32:00.029 align:start position:0%
not have only one intermediate result
results<00:31:58.279><c> because</c><00:31:58.559><c> we</c><00:31:58.720><c> have</c><00:31:59.279><c> many</c><00:31:59.639><c> different</c>

00:32:00.029 --> 00:32:00.039 align:start position:0%
results because we have many different
 

00:32:00.039 --> 00:32:02.149 align:start position:0%
results because we have many different
steps<00:32:00.639><c> we</c><00:32:00.760><c> need</c><00:32:01.200><c> another</c><00:32:01.559><c> intermediate</c>

00:32:02.149 --> 00:32:02.159 align:start position:0%
steps we need another intermediate
 

00:32:02.159 --> 00:32:04.070 align:start position:0%
steps we need another intermediate
results<00:32:02.600><c> before</c><00:32:03.080><c> everything</c><00:32:03.399><c> is</c><00:32:03.600><c> prepared</c>

00:32:04.070 --> 00:32:04.080 align:start position:0%
results before everything is prepared
 

00:32:04.080 --> 00:32:07.110 align:start position:0%
results before everything is prepared
for<00:32:04.279><c> the</c><00:32:04.480><c> main</c><00:32:05.200><c> query</c><00:32:05.919><c> so</c><00:32:06.120><c> that</c><00:32:06.279><c> means</c><00:32:06.559><c> we</c><00:32:06.760><c> have</c>

00:32:07.110 --> 00:32:07.120 align:start position:0%
for the main query so that means we have
 

00:32:07.120 --> 00:32:09.350 align:start position:0%
for the main query so that means we have
another<00:32:07.559><c> step</c><00:32:07.919><c> that's</c><00:32:08.080><c> going</c><00:32:08.200><c> to</c><00:32:08.320><c> be</c><00:32:08.519><c> built</c><00:32:08.840><c> up</c>

00:32:09.350 --> 00:32:09.360 align:start position:0%
another step that's going to be built up
 

00:32:09.360 --> 00:32:12.110 align:start position:0%
another step that's going to be built up
on<00:32:09.600><c> top</c><00:32:09.840><c> of</c><00:32:10.039><c> the</c><00:32:10.559><c> first</c><00:32:10.919><c> intermediate</c><00:32:11.600><c> results</c>

00:32:12.110 --> 00:32:12.120 align:start position:0%
on top of the first intermediate results
 

00:32:12.120 --> 00:32:14.870 align:start position:0%
on top of the first intermediate results
so<00:32:12.320><c> that</c><00:32:12.440><c> means</c><00:32:12.679><c> we</c><00:32:12.840><c> can</c><00:32:13.159><c> have</c><00:32:13.519><c> another</c><00:32:14.080><c> CTE</c>

00:32:14.870 --> 00:32:14.880 align:start position:0%
so that means we can have another CTE
 

00:32:14.880 --> 00:32:16.789 align:start position:0%
so that means we can have another CTE
that's<00:32:15.080><c> going</c><00:32:15.200><c> to</c><00:32:15.320><c> be</c><00:32:15.480><c> querying</c><00:32:16.039><c> the</c><00:32:16.320><c> results</c>

00:32:16.789 --> 00:32:16.799 align:start position:0%
that's going to be querying the results
 

00:32:16.799 --> 00:32:19.190 align:start position:0%
that's going to be querying the results
from<00:32:17.039><c> the</c><00:32:17.200><c> first</c><00:32:17.519><c> CTE</c><00:32:18.159><c> and</c><00:32:18.320><c> build</c><00:32:18.679><c> on</c><00:32:18.840><c> top</c><00:32:19.039><c> of</c>

00:32:19.190 --> 00:32:19.200 align:start position:0%
from the first CTE and build on top of
 

00:32:19.200 --> 00:32:21.950 align:start position:0%
from the first CTE and build on top of
it<00:32:19.840><c> another</c><00:32:20.320><c> intermediate</c><00:32:21.000><c> result</c><00:32:21.519><c> so</c><00:32:21.679><c> as</c><00:32:21.799><c> you</c>

00:32:21.950 --> 00:32:21.960 align:start position:0%
it another intermediate result so as you
 

00:32:21.960 --> 00:32:25.190 align:start position:0%
it another intermediate result so as you
can<00:32:22.080><c> see</c><00:32:22.279><c> here</c><00:32:22.440><c> we</c><00:32:22.639><c> have</c><00:32:22.840><c> cte1</c><00:32:23.799><c> and</c><00:32:24.080><c> cte2</c><00:32:25.080><c> and</c>

00:32:25.190 --> 00:32:25.200 align:start position:0%
can see here we have cte1 and cte2 and
 

00:32:25.200 --> 00:32:26.909 align:start position:0%
can see here we have cte1 and cte2 and
that<00:32:25.360><c> means</c><00:32:25.799><c> now</c><00:32:26.000><c> we</c><00:32:26.159><c> have</c><00:32:26.440><c> like</c><00:32:26.639><c> two</c>

00:32:26.909 --> 00:32:26.919 align:start position:0%
that means now we have like two
 

00:32:26.919 --> 00:32:28.830 align:start position:0%
that means now we have like two
intermediate<00:32:27.519><c> results</c><00:32:28.279><c> and</c><00:32:28.399><c> now</c><00:32:28.559><c> of</c><00:32:28.679><c> course</c>

00:32:28.830 --> 00:32:28.840 align:start position:0%
intermediate results and now of course
 

00:32:28.840 --> 00:32:32.230 align:start position:0%
intermediate results and now of course
we<00:32:28.960><c> can</c><00:32:29.200><c> go</c><00:32:29.360><c> and</c><00:32:29.600><c> add</c><00:32:30.080><c> CTE</c><00:32:30.600><c> 3</c><00:32:31.000><c> 4</c><00:32:31.360><c> and</c><00:32:31.519><c> so</c><00:32:31.679><c> on</c><00:32:32.080><c> but</c>

00:32:32.230 --> 00:32:32.240 align:start position:0%
we can go and add CTE 3 4 and so on but
 

00:32:32.240 --> 00:32:34.350 align:start position:0%
we can go and add CTE 3 4 and so on but
now<00:32:32.399><c> let's</c><00:32:32.559><c> say</c><00:32:32.840><c> that</c><00:32:33.360><c> the</c><00:32:33.480><c> cte2</c><00:32:34.080><c> going</c><00:32:34.159><c> to</c>

00:32:34.350 --> 00:32:34.360 align:start position:0%
now let's say that the cte2 going to
 

00:32:34.360 --> 00:32:36.909 align:start position:0%
now let's say that the cte2 going to
prepare<00:32:35.039><c> the</c><00:32:35.320><c> final</c><00:32:35.720><c> intermediate</c><00:32:36.480><c> result</c>

00:32:36.909 --> 00:32:36.919 align:start position:0%
prepare the final intermediate result
 

00:32:36.919 --> 00:32:39.230 align:start position:0%
prepare the final intermediate result
for<00:32:37.120><c> the</c><00:32:37.279><c> main</c><00:32:37.600><c> query</c><00:32:38.200><c> so</c><00:32:38.360><c> now</c><00:32:38.519><c> the</c><00:32:38.639><c> main</c><00:32:38.880><c> query</c>

00:32:39.230 --> 00:32:39.240 align:start position:0%
for the main query so now the main query
 

00:32:39.240 --> 00:32:41.149 align:start position:0%
for the main query so now the main query
going<00:32:39.360><c> to</c><00:32:39.519><c> go</c><00:32:39.679><c> and</c><00:32:40.000><c> query</c><00:32:40.559><c> the</c><00:32:40.799><c> second</c>

00:32:41.149 --> 00:32:41.159 align:start position:0%
going to go and query the second
 

00:32:41.159 --> 00:32:43.149 align:start position:0%
going to go and query the second
intermediate<00:32:41.760><c> results</c><00:32:42.440><c> and</c><00:32:42.600><c> it</c><00:32:42.720><c> going</c><00:32:42.840><c> to</c><00:32:42.960><c> do</c>

00:32:43.149 --> 00:32:43.159 align:start position:0%
intermediate results and it going to do
 

00:32:43.159 --> 00:32:45.470 align:start position:0%
intermediate results and it going to do
the<00:32:43.399><c> final</c><00:32:43.880><c> step</c><00:32:44.480><c> where</c><00:32:44.720><c> the</c><00:32:44.880><c> final</c><00:32:45.159><c> result</c>

00:32:45.470 --> 00:32:45.480 align:start position:0%
the final step where the final result
 

00:32:45.480 --> 00:32:47.350 align:start position:0%
the final step where the final result
can<00:32:45.639><c> be</c><00:32:45.799><c> presented</c><00:32:46.120><c> for</c><00:32:46.320><c> the</c><00:32:46.440><c> user</c><00:32:47.080><c> and</c><00:32:47.200><c> of</c>

00:32:47.350 --> 00:32:47.360 align:start position:0%
can be presented for the user and of
 

00:32:47.360 --> 00:32:49.310 align:start position:0%
can be presented for the user and of
course<00:32:47.559><c> if</c><00:32:47.679><c> it</c><00:32:47.799><c> is</c><00:32:47.919><c> needed</c><00:32:48.399><c> the</c><00:32:48.559><c> main</c><00:32:48.880><c> query</c>

00:32:49.310 --> 00:32:49.320 align:start position:0%
course if it is needed the main query
 

00:32:49.320 --> 00:32:51.669 align:start position:0%
course if it is needed the main query
can<00:32:49.919><c> access</c><00:32:50.320><c> not</c><00:32:50.519><c> only</c><00:32:50.960><c> the</c><00:32:51.279><c> second</c>

00:32:51.669 --> 00:32:51.679 align:start position:0%
can access not only the second
 

00:32:51.679 --> 00:32:54.230 align:start position:0%
can access not only the second
intermediate<00:32:52.320><c> result</c><00:32:52.840><c> from</c><00:32:53.000><c> the</c><00:32:53.159><c> second</c><00:32:53.440><c> CTE</c>

00:32:54.230 --> 00:32:54.240 align:start position:0%
intermediate result from the second CTE
 

00:32:54.240 --> 00:32:56.629 align:start position:0%
intermediate result from the second CTE
but<00:32:54.559><c> also</c><00:32:55.320><c> the</c><00:32:55.480><c> first</c><00:32:55.799><c> intermediate</c><00:32:56.360><c> result</c>

00:32:56.629 --> 00:32:56.639 align:start position:0%
but also the first intermediate result
 

00:32:56.639 --> 00:32:59.750 align:start position:0%
but also the first intermediate result
from<00:32:56.799><c> the</c><00:32:56.919><c> cte1</c><00:32:57.840><c> now</c><00:32:58.000><c> we</c><00:32:58.159><c> call</c><00:32:58.559><c> the</c><00:32:58.720><c> first</c><00:32:59.000><c> CTE</c>

00:32:59.750 --> 00:32:59.760 align:start position:0%
from the cte1 now we call the first CTE
 

00:32:59.760 --> 00:33:02.269 align:start position:0%
from the cte1 now we call the first CTE
a<00:32:59.960><c> standalone</c><00:33:00.519><c> CTE</c><00:33:01.360><c> because</c><00:33:01.720><c> it</c><00:33:01.840><c> doesn't</c>

00:33:02.269 --> 00:33:02.279 align:start position:0%
a standalone CTE because it doesn't
 

00:33:02.279 --> 00:33:04.509 align:start position:0%
a standalone CTE because it doesn't
depend<00:33:02.639><c> on</c><00:33:02.919><c> any</c><00:33:03.120><c> intermediate</c><00:33:03.679><c> results</c><00:33:04.360><c> it</c>

00:33:04.509 --> 00:33:04.519 align:start position:0%
depend on any intermediate results it
 

00:33:04.519 --> 00:33:06.789 align:start position:0%
depend on any intermediate results it
goes<00:33:04.880><c> directly</c><00:33:05.240><c> to</c><00:33:05.519><c> database</c><00:33:06.120><c> and</c><00:33:06.279><c> get</c><00:33:06.600><c> the</c>

00:33:06.789 --> 00:33:06.799 align:start position:0%
goes directly to database and get the
 

00:33:06.799 --> 00:33:09.549 align:start position:0%
goes directly to database and get the
data<00:33:07.360><c> but</c><00:33:07.519><c> now</c><00:33:07.760><c> since</c><00:33:08.200><c> the</c><00:33:08.440><c> second</c><00:33:08.799><c> CTE</c><00:33:09.360><c> is</c>

00:33:09.549 --> 00:33:09.559 align:start position:0%
data but now since the second CTE is
 

00:33:09.559 --> 00:33:13.070 align:start position:0%
data but now since the second CTE is
completely<00:33:10.200><c> depending</c><00:33:11.200><c> on</c><00:33:11.399><c> the</c><00:33:11.600><c> cte1</c><00:33:12.600><c> so</c><00:33:12.960><c> this</c>

00:33:13.070 --> 00:33:13.080 align:start position:0%
completely depending on the cte1 so this
 

00:33:13.080 --> 00:33:14.789 align:start position:0%
completely depending on the cte1 so this
time<00:33:13.240><c> we're</c><00:33:13.360><c> going</c><00:33:13.480><c> to</c><00:33:13.600><c> call</c><00:33:13.880><c> this</c><00:33:14.000><c> CTE</c><00:33:14.519><c> a</c>

00:33:14.789 --> 00:33:14.799 align:start position:0%
time we're going to call this CTE a
 

00:33:14.799 --> 00:33:16.990 align:start position:0%
time we're going to call this CTE a
nested<00:33:15.200><c> CTE</c><00:33:16.000><c> because</c><00:33:16.240><c> we</c><00:33:16.360><c> cannot</c><00:33:16.679><c> go</c><00:33:16.799><c> and</c>

00:33:16.990 --> 00:33:17.000 align:start position:0%
nested CTE because we cannot go and
 

00:33:17.000 --> 00:33:19.149 align:start position:0%
nested CTE because we cannot go and
excuse<00:33:17.320><c> it</c><00:33:17.440><c> on</c><00:33:17.600><c> its</c><00:33:17.760><c> own</c><00:33:18.080><c> it</c><00:33:18.279><c> always</c><00:33:18.720><c> depends</c>

00:33:19.149 --> 00:33:19.159 align:start position:0%
excuse it on its own it always depends
 

00:33:19.159 --> 00:33:21.629 align:start position:0%
excuse it on its own it always depends
on<00:33:19.320><c> the</c><00:33:19.440><c> cte1</c><00:33:20.279><c> and</c><00:33:20.399><c> of</c><00:33:20.559><c> course</c><00:33:20.799><c> the</c><00:33:20.919><c> main</c><00:33:21.120><c> C</c><00:33:21.480><c> is</c>

00:33:21.629 --> 00:33:21.639 align:start position:0%
on the cte1 and of course the main C is
 

00:33:21.639 --> 00:33:23.350 align:start position:0%
on the cte1 and of course the main C is
depending<00:33:22.080><c> on</c><00:33:22.320><c> everything</c><00:33:22.919><c> so</c><00:33:23.039><c> as</c><00:33:23.159><c> you</c><00:33:23.240><c> can</c>

00:33:23.350 --> 00:33:23.360 align:start position:0%
depending on everything so as you can
 

00:33:23.360 --> 00:33:25.470 align:start position:0%
depending on everything so as you can
see<00:33:23.639><c> using</c><00:33:23.919><c> the</c><00:33:24.080><c> CTE</c><00:33:24.799><c> we're</c><00:33:24.960><c> going</c><00:33:25.039><c> to</c><00:33:25.200><c> go</c><00:33:25.320><c> and</c>

00:33:25.470 --> 00:33:25.480 align:start position:0%
see using the CTE we're going to go and
 

00:33:25.480 --> 00:33:27.549 align:start position:0%
see using the CTE we're going to go and
build<00:33:25.799><c> like</c><00:33:25.960><c> a</c><00:33:26.120><c> chain</c><00:33:26.720><c> so</c><00:33:27.000><c> this</c><00:33:27.159><c> is</c><00:33:27.320><c> what</c><00:33:27.440><c> we</c>

00:33:27.549 --> 00:33:27.559 align:start position:0%
build like a chain so this is what we
 

00:33:27.559 --> 00:33:30.269 align:start position:0%
build like a chain so this is what we
mean<00:33:27.919><c> with</c><00:33:28.120><c> the</c><00:33:28.399><c> Standalone</c><00:33:28.960><c> CTE</c><00:33:29.519><c> and</c><00:33:29.880><c> nested</c>

00:33:30.269 --> 00:33:30.279 align:start position:0%
mean with the Standalone CTE and nested
 

00:33:30.279 --> 00:33:32.190 align:start position:0%
mean with the Standalone CTE and nested
CTE<00:33:31.080><c> okay</c><00:33:31.200><c> so</c><00:33:31.360><c> now</c><00:33:31.519><c> let's</c><00:33:31.919><c> understand</c><00:33:32.080><c> the</c>

00:33:32.190 --> 00:33:32.200 align:start position:0%
CTE okay so now let's understand the
 

00:33:32.200 --> 00:33:34.710 align:start position:0%
CTE okay so now let's understand the
syntax<00:33:32.600><c> of</c><00:33:32.760><c> the</c><00:33:32.919><c> nested</c><00:33:33.240><c> CTE</c><00:33:33.919><c> so</c><00:33:34.080><c> we</c><00:33:34.240><c> start</c><00:33:34.559><c> as</c>

00:33:34.710 --> 00:33:34.720 align:start position:0%
syntax of the nested CTE so we start as
 

00:33:34.720 --> 00:33:36.710 align:start position:0%
syntax of the nested CTE so we start as
usual<00:33:35.120><c> with</c><00:33:35.279><c> the</c><00:33:35.440><c> definition</c><00:33:36.000><c> of</c><00:33:36.159><c> the</c><00:33:36.320><c> fair</c>

00:33:36.710 --> 00:33:36.720 align:start position:0%
usual with the definition of the fair
 

00:33:36.720 --> 00:33:39.269 align:start position:0%
usual with the definition of the fair
City<00:33:37.440><c> using</c><00:33:37.880><c> the</c><00:33:38.039><c> whis</c><00:33:38.360><c> clouds</c><00:33:38.840><c> and</c><00:33:39.000><c> then</c><00:33:39.159><c> the</c>

00:33:39.269 --> 00:33:39.279 align:start position:0%
City using the whis clouds and then the
 

00:33:39.279 --> 00:33:41.269 align:start position:0%
City using the whis clouds and then the
name<00:33:39.480><c> of</c><00:33:39.600><c> the</c><00:33:39.760><c> city</c><00:33:40.200><c> and</c><00:33:40.360><c> the</c><00:33:40.519><c> definition</c><00:33:41.159><c> of</c>

00:33:41.269 --> 00:33:41.279 align:start position:0%
name of the city and the definition of
 

00:33:41.279 --> 00:33:44.070 align:start position:0%
name of the city and the definition of
the<00:33:41.440><c> city</c><00:33:42.000><c> so</c><00:33:42.240><c> here</c><00:33:42.399><c> it's</c><00:33:42.679><c> nothing</c><00:33:43.000><c> new</c><00:33:43.760><c> now</c><00:33:43.960><c> we</c>

00:33:44.070 --> 00:33:44.080 align:start position:0%
the city so here it's nothing new now we
 

00:33:44.080 --> 00:33:46.430 align:start position:0%
the city so here it's nothing new now we
go<00:33:44.240><c> and</c><00:33:44.480><c> Define</c><00:33:44.840><c> the</c><00:33:45.080><c> second</c><00:33:45.440><c> CTE</c><00:33:46.200><c> as</c><00:33:46.279><c> we</c>

00:33:46.430 --> 00:33:46.440 align:start position:0%
go and Define the second CTE as we
 

00:33:46.440 --> 00:33:48.870 align:start position:0%
go and Define the second CTE as we
learned<00:33:47.080><c> using</c><00:33:47.440><c> the</c><00:33:47.679><c> comma</c><00:33:48.200><c> then</c><00:33:48.360><c> the</c><00:33:48.519><c> name</c><00:33:48.760><c> of</c>

00:33:48.870 --> 00:33:48.880 align:start position:0%
learned using the comma then the name of
 

00:33:48.880 --> 00:33:51.430 align:start position:0%
learned using the comma then the name of
the<00:33:49.000><c> CTE</c><00:33:49.600><c> and</c><00:33:49.760><c> the</c><00:33:49.960><c> definition</c><00:33:50.679><c> so</c><00:33:51.120><c> this</c><00:33:51.240><c> is</c>

00:33:51.430 --> 00:33:51.440 align:start position:0%
the CTE and the definition so this is
 

00:33:51.440 --> 00:33:54.509 align:start position:0%
the CTE and the definition so this is
our<00:33:51.799><c> CTE</c><00:33:52.240><c> number</c><00:33:52.480><c> two</c><00:33:52.960><c> so</c><00:33:53.159><c> now</c><00:33:53.399><c> the</c><00:33:53.679><c> second</c><00:33:54.000><c> CTE</c>

00:33:54.509 --> 00:33:54.519 align:start position:0%
our CTE number two so now the second CTE
 

00:33:54.519 --> 00:33:56.950 align:start position:0%
our CTE number two so now the second CTE
is<00:33:54.760><c> depending</c><00:33:55.279><c> on</c><00:33:55.480><c> the</c><00:33:55.639><c> results</c><00:33:56.120><c> of</c><00:33:56.320><c> the</c><00:33:56.600><c> first</c>

00:33:56.950 --> 00:33:56.960 align:start position:0%
is depending on the results of the first
 

00:33:56.960 --> 00:33:58.909 align:start position:0%
is depending on the results of the first
CTE<00:33:57.799><c> so</c><00:33:57.919><c> how</c><00:33:58.039><c> we're</c><00:33:58.159><c> going</c><00:33:58.279><c> to</c><00:33:58.399><c> do</c><00:33:58.519><c> it</c><00:33:58.720><c> it's</c>

00:33:58.909 --> 00:33:58.919 align:start position:0%
CTE so how we're going to do it it's
 

00:33:58.919 --> 00:34:01.430 align:start position:0%
CTE so how we're going to do it it's
very<00:33:59.159><c> simple</c><00:33:59.880><c> now</c><00:34:00.159><c> for</c><00:34:00.399><c> the</c><00:34:00.559><c> CTE</c><00:34:01.000><c> number</c><00:34:01.200><c> two</c>

00:34:01.430 --> 00:34:01.440 align:start position:0%
very simple now for the CTE number two
 

00:34:01.440 --> 00:34:03.830 align:start position:0%
very simple now for the CTE number two
we're<00:34:01.559><c> going</c><00:34:01.679><c> to</c><00:34:01.840><c> select</c><00:34:02.200><c> the</c><00:34:02.399><c> data</c><00:34:02.880><c> from</c><00:34:03.679><c> the</c>

00:34:03.830 --> 00:34:03.840 align:start position:0%
we're going to select the data from the
 

00:34:03.840 --> 00:34:06.190 align:start position:0%
we're going to select the data from the
CTE<00:34:04.360><c> number</c><00:34:04.639><c> one</c><00:34:05.200><c> and</c><00:34:05.360><c> with</c><00:34:05.559><c> that</c><00:34:05.880><c> we</c><00:34:06.000><c> are</c>

00:34:06.190 --> 00:34:06.200 align:start position:0%
CTE number one and with that we are
 

00:34:06.200 --> 00:34:08.909 align:start position:0%
CTE number one and with that we are
making<00:34:06.760><c> the</c><00:34:07.000><c> second</c><00:34:07.399><c> CTE</c><00:34:08.000><c> depending</c><00:34:08.560><c> on</c><00:34:08.760><c> the</c>

00:34:08.909 --> 00:34:08.919 align:start position:0%
making the second CTE depending on the
 

00:34:08.919 --> 00:34:11.190 align:start position:0%
making the second CTE depending on the
first<00:34:09.200><c> one</c><00:34:09.639><c> so</c><00:34:09.800><c> this</c><00:34:09.960><c> means</c><00:34:10.240><c> the</c><00:34:10.359><c> second</c><00:34:10.679><c> CTE</c>

00:34:11.190 --> 00:34:11.200 align:start position:0%
first one so this means the second CTE
 

00:34:11.200 --> 00:34:13.310 align:start position:0%
first one so this means the second CTE
is<00:34:11.399><c> getting</c><00:34:11.720><c> the</c><00:34:11.879><c> data</c><00:34:12.119><c> from</c><00:34:12.320><c> the</c><00:34:12.480><c> first</c><00:34:12.679><c> one</c>

00:34:13.310 --> 00:34:13.320 align:start position:0%
is getting the data from the first one
 

00:34:13.320 --> 00:34:15.470 align:start position:0%
is getting the data from the first one
and<00:34:13.520><c> it</c><00:34:13.800><c> querying</c><00:34:14.240><c> the</c><00:34:14.399><c> data</c><00:34:14.720><c> in</c><00:34:14.839><c> order</c><00:34:15.079><c> to</c><00:34:15.240><c> do</c>

00:34:15.470 --> 00:34:15.480 align:start position:0%
and it querying the data in order to do
 

00:34:15.480 --> 00:34:17.909 align:start position:0%
and it querying the data in order to do
the<00:34:15.679><c> second</c><00:34:16.079><c> step</c><00:34:16.720><c> and</c><00:34:16.919><c> with</c><00:34:17.159><c> that</c><00:34:17.520><c> we</c><00:34:17.639><c> are</c>

00:34:17.909 --> 00:34:17.919 align:start position:0%
the second step and with that we are
 

00:34:17.919 --> 00:34:21.430 align:start position:0%
the second step and with that we are
nesting<00:34:18.720><c> one</c><00:34:18.960><c> CTE</c><00:34:19.520><c> in</c><00:34:19.879><c> another</c><00:34:20.560><c> and</c><00:34:20.679><c> the</c><00:34:20.800><c> cte2</c>

00:34:21.430 --> 00:34:21.440 align:start position:0%
nesting one CTE in another and the cte2
 

00:34:21.440 --> 00:34:23.829 align:start position:0%
nesting one CTE in another and the cte2
is<00:34:21.760><c> completely</c><00:34:22.280><c> depending</c><00:34:22.800><c> on</c><00:34:22.960><c> the</c><00:34:23.119><c> first</c><00:34:23.399><c> one</c>

00:34:23.829 --> 00:34:23.839 align:start position:0%
is completely depending on the first one
 

00:34:23.839 --> 00:34:26.149 align:start position:0%
is completely depending on the first one
so<00:34:24.079><c> again</c><00:34:24.280><c> we</c><00:34:24.480><c> call</c><00:34:24.760><c> the</c><00:34:24.960><c> first</c><00:34:25.280><c> CTE</c><00:34:25.839><c> as</c>

00:34:26.149 --> 00:34:26.159 align:start position:0%
so again we call the first CTE as
 

00:34:26.159 --> 00:34:29.069 align:start position:0%
so again we call the first CTE as
Standalone<00:34:26.720><c> CTE</c><00:34:27.919><c> because</c><00:34:28.280><c> it</c><00:34:28.399><c> doesn't</c><00:34:28.760><c> depend</c>

00:34:29.069 --> 00:34:29.079 align:start position:0%
Standalone CTE because it doesn't depend
 

00:34:29.079 --> 00:34:31.950 align:start position:0%
Standalone CTE because it doesn't depend
on<00:34:29.320><c> anything</c><00:34:30.040><c> we</c><00:34:30.159><c> can</c><00:34:30.399><c> execute</c><00:34:30.839><c> it</c><00:34:31.000><c> on</c><00:34:31.159><c> its</c><00:34:31.320><c> own</c>

00:34:31.950 --> 00:34:31.960 align:start position:0%
on anything we can execute it on its own
 

00:34:31.960 --> 00:34:33.629 align:start position:0%
on anything we can execute it on its own
and<00:34:32.159><c> it</c><00:34:32.320><c> just</c><00:34:32.480><c> need</c><00:34:32.720><c> the</c><00:34:32.879><c> data</c><00:34:33.159><c> directly</c><00:34:33.480><c> from</c>

00:34:33.629 --> 00:34:33.639 align:start position:0%
and it just need the data directly from
 

00:34:33.639 --> 00:34:36.629 align:start position:0%
and it just need the data directly from
the<00:34:33.839><c> database</c><00:34:34.599><c> but</c><00:34:34.800><c> the</c><00:34:35.000><c> second</c><00:34:35.399><c> CT</c><00:34:35.960><c> since</c><00:34:36.240><c> is</c>

00:34:36.629 --> 00:34:36.639 align:start position:0%
the database but the second CT since is
 

00:34:36.639 --> 00:34:38.550 align:start position:0%
the database but the second CT since is
completely<00:34:37.159><c> depending</c><00:34:37.599><c> on</c><00:34:37.760><c> the</c><00:34:37.879><c> CTE</c><00:34:38.280><c> number</c>

00:34:38.550 --> 00:34:38.560 align:start position:0%
completely depending on the CTE number
 

00:34:38.560 --> 00:34:41.669 align:start position:0%
completely depending on the CTE number
one<00:34:39.200><c> we</c><00:34:39.399><c> call</c><00:34:39.599><c> it</c><00:34:39.879><c> in</c><00:34:40.159><c> nested</c><00:34:40.520><c> CTE</c><00:34:41.159><c> so</c><00:34:41.399><c> they</c><00:34:41.480><c> are</c>

00:34:41.669 --> 00:34:41.679 align:start position:0%
one we call it in nested CTE so they are
 

00:34:41.679 --> 00:34:43.510 align:start position:0%
one we call it in nested CTE so they are
very<00:34:41.879><c> similar</c><00:34:42.240><c> we</c><00:34:42.320><c> are</c><00:34:42.560><c> just</c><00:34:42.800><c> selecting</c><00:34:43.320><c> the</c>

00:34:43.510 --> 00:34:43.520 align:start position:0%
very similar we are just selecting the
 

00:34:43.520 --> 00:34:46.149 align:start position:0%
very similar we are just selecting the
data<00:34:44.079><c> from</c><00:34:44.320><c> the</c><00:34:44.520><c> c</c><00:34:44.839><c> number</c><00:34:45.079><c> one</c><00:34:45.560><c> and</c><00:34:45.679><c> now</c><00:34:45.879><c> comes</c>

00:34:46.149 --> 00:34:46.159 align:start position:0%
data from the c number one and now comes
 

00:34:46.159 --> 00:34:48.109 align:start position:0%
data from the c number one and now comes
our<00:34:46.359><c> main</c><00:34:46.639><c> query</c><00:34:47.280><c> and</c><00:34:47.440><c> of</c><00:34:47.639><c> course</c><00:34:47.839><c> it's</c><00:34:48.000><c> going</c>

00:34:48.109 --> 00:34:48.119 align:start position:0%
our main query and of course it's going
 

00:34:48.119 --> 00:34:51.030 align:start position:0%
our main query and of course it's going
to<00:34:48.280><c> go</c><00:34:48.440><c> and</c><00:34:48.679><c> use</c><00:34:49.040><c> the</c><00:34:49.280><c> data</c><00:34:50.000><c> from</c><00:34:50.320><c> the</c><00:34:50.599><c> Second</c>

00:34:51.030 --> 00:34:51.040 align:start position:0%
to go and use the data from the Second
 

00:34:51.040 --> 00:34:52.750 align:start position:0%
to go and use the data from the Second
Step<00:34:51.520><c> so</c><00:34:51.760><c> it's</c><00:34:51.839><c> going</c><00:34:51.960><c> to</c><00:34:52.040><c> go</c><00:34:52.159><c> and</c><00:34:52.320><c> select</c><00:34:52.599><c> the</c>

00:34:52.750 --> 00:34:52.760 align:start position:0%
Step so it's going to go and select the
 

00:34:52.760 --> 00:34:55.149 align:start position:0%
Step so it's going to go and select the
data<00:34:53.159><c> from</c><00:34:53.440><c> the</c><00:34:53.599><c> c</c><00:34:54.159><c> number</c><00:34:54.399><c> two</c><00:34:54.839><c> but</c><00:34:54.960><c> it's</c>

00:34:55.149 --> 00:34:55.159 align:start position:0%
data from the c number two but it's
 

00:34:55.159 --> 00:34:57.310 align:start position:0%
data from the c number two but it's
still<00:34:55.359><c> of</c><00:34:55.520><c> course</c><00:34:55.839><c> it's</c><00:34:56.040><c> not</c><00:34:56.200><c> a</c><00:34:56.399><c> rule</c><00:34:56.919><c> it</c><00:34:57.079><c> can</c>

00:34:57.310 --> 00:34:57.320 align:start position:0%
still of course it's not a rule it can
 

00:34:57.320 --> 00:34:59.510 align:start position:0%
still of course it's not a rule it can
go<00:34:57.440><c> and</c><00:34:57.880><c> access</c><00:34:58.320><c> the</c><00:34:58.520><c> data</c><00:34:58.880><c> and</c><00:34:59.040><c> select</c><00:34:59.359><c> the</c>

00:34:59.510 --> 00:34:59.520 align:start position:0%
go and access the data and select the
 

00:34:59.520 --> 00:35:01.670 align:start position:0%
go and access the data and select the
data<00:34:59.720><c> from</c><00:34:59.839><c> the</c><00:34:59.960><c> city</c><00:35:00.320><c> number</c><00:35:00.520><c> one</c><00:35:00.960><c> so</c><00:35:01.359><c> this</c><00:35:01.480><c> is</c>

00:35:01.670 --> 00:35:01.680 align:start position:0%
data from the city number one so this is
 

00:35:01.680 --> 00:35:04.829 align:start position:0%
data from the city number one so this is
how<00:35:01.839><c> we</c><00:35:01.960><c> can</c><00:35:02.160><c> create</c><00:35:02.599><c> a</c><00:35:02.839><c> nested</c><00:35:03.240><c> C</c><00:35:03.680><c> in</c><00:35:03.839><c> SQL</c><00:35:04.720><c> all</c>

00:35:04.829 --> 00:35:04.839 align:start position:0%
how we can create a nested C in SQL all
 

00:35:04.839 --> 00:35:06.670 align:start position:0%
how we can create a nested C in SQL all
right<00:35:05.119><c> guys</c><00:35:05.359><c> back</c><00:35:05.560><c> to</c><00:35:05.760><c> our</c><00:35:06.040><c> project</c><00:35:06.440><c> where</c><00:35:06.599><c> we</c>

00:35:06.670 --> 00:35:06.680 align:start position:0%
right guys back to our project where we
 

00:35:06.680 --> 00:35:09.030 align:start position:0%
right guys back to our project where we
are<00:35:06.880><c> creating</c><00:35:07.320><c> report</c><00:35:07.800><c> about</c><00:35:08.040><c> the</c><00:35:08.280><c> customers</c>

00:35:09.030 --> 00:35:09.040 align:start position:0%
are creating report about the customers
 

00:35:09.040 --> 00:35:10.990 align:start position:0%
are creating report about the customers
and<00:35:09.160><c> we</c><00:35:09.280><c> would</c><00:35:09.440><c> like</c><00:35:09.599><c> to</c><00:35:09.800><c> add</c><00:35:10.119><c> one</c><00:35:10.280><c> more</c><00:35:10.560><c> step</c>

00:35:10.990 --> 00:35:11.000 align:start position:0%
and we would like to add one more step
 

00:35:11.000 --> 00:35:13.550 align:start position:0%
and we would like to add one more step
so<00:35:11.280><c> the</c><00:35:11.440><c> task</c><00:35:11.760><c> says</c><00:35:12.440><c> rank</c><00:35:12.839><c> the</c><00:35:13.040><c> customers</c>

00:35:13.550 --> 00:35:13.560 align:start position:0%
so the task says rank the customers
 

00:35:13.560 --> 00:35:16.829 align:start position:0%
so the task says rank the customers
based<00:35:14.079><c> on</c><00:35:14.400><c> total</c><00:35:14.800><c> sales</c><00:35:15.520><c> per</c><00:35:15.839><c> customer</c><00:35:16.520><c> so</c>

00:35:16.829 --> 00:35:16.839 align:start position:0%
based on total sales per customer so
 

00:35:16.839 --> 00:35:18.510 align:start position:0%
based on total sales per customer so
this<00:35:16.960><c> is</c><00:35:17.119><c> one</c><00:35:17.280><c> more</c><00:35:17.520><c> step</c><00:35:17.839><c> inside</c><00:35:18.280><c> our</c>

00:35:18.510 --> 00:35:18.520 align:start position:0%
this is one more step inside our
 

00:35:18.520 --> 00:35:20.510 align:start position:0%
this is one more step inside our
projects<00:35:19.240><c> and</c><00:35:19.400><c> we</c><00:35:19.520><c> would</c><00:35:19.680><c> like</c><00:35:19.800><c> to</c><00:35:19.920><c> go</c><00:35:20.079><c> and</c><00:35:20.240><c> use</c>

00:35:20.510 --> 00:35:20.520 align:start position:0%
projects and we would like to go and use
 

00:35:20.520 --> 00:35:23.790 align:start position:0%
projects and we would like to go and use
as<00:35:20.640><c> well</c><00:35:20.839><c> the</c><00:35:20.960><c> CTE</c><00:35:21.480><c> in</c><00:35:21.680><c> order</c><00:35:22.480><c> to</c><00:35:22.880><c> implement</c>

00:35:23.790 --> 00:35:23.800 align:start position:0%
as well the CTE in order to implement
 

00:35:23.800 --> 00:35:25.710 align:start position:0%
as well the CTE in order to implement
this<00:35:24.000><c> step</c><00:35:24.400><c> so</c><00:35:24.560><c> now</c><00:35:24.760><c> what</c><00:35:24.839><c> do</c><00:35:24.960><c> we</c><00:35:25.079><c> need</c><00:35:25.359><c> we</c><00:35:25.480><c> need</c>

00:35:25.710 --> 00:35:25.720 align:start position:0%
this step so now what do we need we need
 

00:35:25.720 --> 00:35:27.990 align:start position:0%
this step so now what do we need we need
to<00:35:25.920><c> rank</c><00:35:26.240><c> the</c><00:35:26.440><c> customers</c><00:35:27.040><c> based</c><00:35:27.359><c> on</c><00:35:27.720><c> total</c>

00:35:27.990 --> 00:35:28.000 align:start position:0%
to rank the customers based on total
 

00:35:28.000 --> 00:35:30.190 align:start position:0%
to rank the customers based on total
sales<00:35:28.280><c> for</c><00:35:28.480><c> each</c><00:35:28.680><c> customer</c><00:35:29.320><c> so</c><00:35:29.520><c> here</c><00:35:29.720><c> like</c><00:35:30.040><c> we</c>

00:35:30.190 --> 00:35:30.200 align:start position:0%
sales for each customer so here like we
 

00:35:30.200 --> 00:35:31.910 align:start position:0%
sales for each customer so here like we
have<00:35:30.359><c> two</c><00:35:30.599><c> steps</c><00:35:31.320><c> first</c><00:35:31.560><c> we</c><00:35:31.680><c> have</c><00:35:31.800><c> to</c>

00:35:31.910 --> 00:35:31.920 align:start position:0%
have two steps first we have to
 

00:35:31.920 --> 00:35:34.069 align:start position:0%
have two steps first we have to
calculate<00:35:32.359><c> the</c><00:35:32.480><c> total</c><00:35:32.760><c> sales</c><00:35:33.160><c> per</c><00:35:33.440><c> customer</c>

00:35:34.069 --> 00:35:34.079 align:start position:0%
calculate the total sales per customer
 

00:35:34.079 --> 00:35:36.710 align:start position:0%
calculate the total sales per customer
and<00:35:34.320><c> then</c><00:35:34.640><c> we</c><00:35:34.760><c> have</c><00:35:34.880><c> to</c><00:35:35.000><c> go</c><00:35:35.160><c> and</c><00:35:35.440><c> rank</c><00:35:35.880><c> it</c><00:35:36.440><c> based</c>

00:35:36.710 --> 00:35:36.720 align:start position:0%
and then we have to go and rank it based
 

00:35:36.720 --> 00:35:38.510 align:start position:0%
and then we have to go and rank it based
on<00:35:36.920><c> this</c><00:35:37.119><c> information</c><00:35:37.880><c> and</c><00:35:38.079><c> of</c><00:35:38.200><c> course</c><00:35:38.400><c> the</c>

00:35:38.510 --> 00:35:38.520 align:start position:0%
on this information and of course the
 

00:35:38.520 --> 00:35:41.069 align:start position:0%
on this information and of course the
sales<00:35:38.800><c> are</c><00:35:39.040><c> stores</c><00:35:39.599><c> inside</c><00:35:40.000><c> the</c><00:35:40.200><c> orders</c><00:35:40.920><c> so</c>

00:35:41.069 --> 00:35:41.079 align:start position:0%
sales are stores inside the orders so
 

00:35:41.079 --> 00:35:42.710 align:start position:0%
sales are stores inside the orders so
now<00:35:41.240><c> let's</c><00:35:41.440><c> go</c><00:35:41.599><c> and</c><00:35:41.800><c> start</c><00:35:42.119><c> implementing</c><00:35:42.599><c> the</c>

00:35:42.710 --> 00:35:42.720 align:start position:0%
now let's go and start implementing the
 

00:35:42.720 --> 00:35:45.670 align:start position:0%
now let's go and start implementing the
CTE<00:35:43.680><c> so</c><00:35:44.240><c> we're</c><00:35:44.400><c> going</c><00:35:44.480><c> to</c><00:35:44.640><c> have</c><00:35:44.800><c> a</c><00:35:45.000><c> comma</c><00:35:45.560><c> and</c>

00:35:45.670 --> 00:35:45.680 align:start position:0%
CTE so we're going to have a comma and
 

00:35:45.680 --> 00:35:49.589 align:start position:0%
CTE so we're going to have a comma and
we're<00:35:45.800><c> going</c><00:35:45.920><c> to</c><00:35:46.079><c> call</c><00:35:46.240><c> it</c><00:35:46.440><c> CTE</c><00:35:47.720><c> customer</c>

00:35:49.589 --> 00:35:49.599 align:start position:0%
we're going to call it CTE customer
 

00:35:49.599 --> 00:35:52.430 align:start position:0%
we're going to call it CTE customer
rank<00:35:50.599><c> as</c><00:35:51.040><c> and</c><00:35:51.200><c> then</c><00:35:51.319><c> we're</c><00:35:51.480><c> going</c><00:35:51.599><c> to</c><00:35:51.839><c> go</c><00:35:52.079><c> have</c>

00:35:52.430 --> 00:35:52.440 align:start position:0%
rank as and then we're going to go have
 

00:35:52.440 --> 00:35:54.390 align:start position:0%
rank as and then we're going to go have
the<00:35:52.680><c> parenthesis</c><00:35:53.560><c> and</c><00:35:53.800><c> inside</c><00:35:54.119><c> it</c><00:35:54.280><c> we're</c>

00:35:54.390 --> 00:35:54.400 align:start position:0%
the parenthesis and inside it we're
 

00:35:54.400 --> 00:35:56.510 align:start position:0%
the parenthesis and inside it we're
going<00:35:54.480><c> to</c><00:35:54.599><c> develop</c><00:35:55.040><c> now</c><00:35:55.440><c> the</c><00:35:55.640><c> logic</c><00:35:56.160><c> so</c><00:35:56.319><c> first</c>

00:35:56.510 --> 00:35:56.520 align:start position:0%
going to develop now the logic so first
 

00:35:56.520 --> 00:35:58.630 align:start position:0%
going to develop now the logic so first
we<00:35:56.640><c> have</c><00:35:56.760><c> to</c><00:35:56.880><c> go</c><00:35:57.040><c> and</c><00:35:57.200><c> aggregate</c><00:35:57.680><c> the</c><00:35:57.839><c> data</c><00:35:58.359><c> by</c>

00:35:58.630 --> 00:35:58.640 align:start position:0%
we have to go and aggregate the data by
 

00:35:58.640 --> 00:36:03.069 align:start position:0%
we have to go and aggregate the data by
the<00:35:58.880><c> total</c><00:35:59.160><c> sales</c><00:35:59.960><c> so</c><00:36:00.680><c> select</c><00:36:01.680><c> customer</c><00:36:02.119><c> ID</c>

00:36:03.069 --> 00:36:03.079 align:start position:0%
the total sales so select customer ID
 

00:36:03.079 --> 00:36:05.990 align:start position:0%
the total sales so select customer ID
and<00:36:03.280><c> then</c><00:36:03.520><c> sum</c><00:36:04.520><c> the</c>

00:36:05.990 --> 00:36:06.000 align:start position:0%
and then sum the
 

00:36:06.000 --> 00:36:10.390 align:start position:0%
and then sum the
sales<00:36:07.000><c> from</c><00:36:07.240><c> the</c><00:36:07.440><c> table</c><00:36:08.280><c> sales</c><00:36:09.280><c> orders</c><00:36:10.240><c> and</c>

00:36:10.390 --> 00:36:10.400 align:start position:0%
sales from the table sales orders and
 

00:36:10.400 --> 00:36:11.950 align:start position:0%
sales from the table sales orders and
then<00:36:10.640><c> of</c><00:36:10.800><c> course</c><00:36:11.079><c> Group</c>

00:36:11.950 --> 00:36:11.960 align:start position:0%
then of course Group
 

00:36:11.960 --> 00:36:15.470 align:start position:0%
then of course Group
by<00:36:12.960><c> the</c><00:36:13.280><c> customer</c><00:36:13.839><c> ID</c><00:36:14.640><c> and</c><00:36:14.800><c> now</c><00:36:15.000><c> I</c><00:36:15.079><c> can</c><00:36:15.280><c> hear</c>

00:36:15.470 --> 00:36:15.480 align:start position:0%
by the customer ID and now I can hear
 

00:36:15.480 --> 00:36:17.510 align:start position:0%
by the customer ID and now I can hear
you<00:36:15.640><c> even</c><00:36:15.880><c> telling</c><00:36:16.160><c> me</c><00:36:16.359><c> bar</c><00:36:16.720><c> we</c><00:36:16.839><c> have</c><00:36:17.079><c> already</c>

00:36:17.510 --> 00:36:17.520 align:start position:0%
you even telling me bar we have already
 

00:36:17.520 --> 00:36:19.710 align:start position:0%
you even telling me bar we have already
done<00:36:17.839><c> this</c><00:36:18.280><c> we</c><00:36:18.440><c> have</c><00:36:18.599><c> already</c><00:36:18.920><c> this</c><00:36:19.119><c> logic</c><00:36:19.440><c> so</c>

00:36:19.710 --> 00:36:19.720 align:start position:0%
done this we have already this logic so
 

00:36:19.720 --> 00:36:22.309 align:start position:0%
done this we have already this logic so
why<00:36:19.880><c> we</c><00:36:20.000><c> are</c><00:36:20.200><c> repeating</c><00:36:21.200><c> if</c><00:36:21.359><c> we</c><00:36:21.640><c> go</c><00:36:21.880><c> to</c><00:36:22.079><c> the</c>

00:36:22.309 --> 00:36:22.319 align:start position:0%
why we are repeating if we go to the
 

00:36:22.319 --> 00:36:24.470 align:start position:0%
why we are repeating if we go to the
first<00:36:22.720><c> CTE</c><00:36:23.280><c> you</c><00:36:23.400><c> can</c><00:36:23.599><c> see</c><00:36:23.920><c> we</c><00:36:24.040><c> have</c><00:36:24.200><c> already</c>

00:36:24.470 --> 00:36:24.480 align:start position:0%
first CTE you can see we have already
 

00:36:24.480 --> 00:36:26.550 align:start position:0%
first CTE you can see we have already
done<00:36:24.720><c> that</c><00:36:25.200><c> and</c><00:36:25.319><c> you</c><00:36:25.440><c> are</c><00:36:25.720><c> totally</c><00:36:26.200><c> right</c><00:36:26.440><c> we</c>

00:36:26.550 --> 00:36:26.560 align:start position:0%
done that and you are totally right we
 

00:36:26.560 --> 00:36:28.470 align:start position:0%
done that and you are totally right we
have<00:36:26.760><c> already</c><00:36:27.160><c> the</c><00:36:27.280><c> logic</c><00:36:27.640><c> so</c><00:36:27.800><c> it</c><00:36:27.920><c> makes</c><00:36:28.200><c> no</c>

00:36:28.470 --> 00:36:28.480 align:start position:0%
have already the logic so it makes no
 

00:36:28.480 --> 00:36:31.030 align:start position:0%
have already the logic so it makes no
sense<00:36:29.079><c> to</c><00:36:29.280><c> repeat</c><00:36:29.599><c> it</c><00:36:29.839><c> again</c><00:36:30.359><c> and</c><00:36:30.520><c> if</c><00:36:30.640><c> we</c><00:36:30.800><c> do</c>

00:36:31.030 --> 00:36:31.040 align:start position:0%
sense to repeat it again and if we do
 

00:36:31.040 --> 00:36:33.589 align:start position:0%
sense to repeat it again and if we do
this<00:36:31.319><c> then</c><00:36:31.480><c> we</c><00:36:31.640><c> didn't</c><00:36:32.000><c> understood</c><00:36:33.000><c> the</c><00:36:33.319><c> power</c>

00:36:33.589 --> 00:36:33.599 align:start position:0%
this then we didn't understood the power
 

00:36:33.599 --> 00:36:36.470 align:start position:0%
this then we didn't understood the power
of<00:36:33.760><c> the</c><00:36:33.920><c> CTE</c><00:36:34.680><c> so</c><00:36:34.960><c> we</c><00:36:35.119><c> don't</c><00:36:35.400><c> have</c><00:36:35.680><c> to</c><00:36:35.920><c> repeat</c>

00:36:36.470 --> 00:36:36.480 align:start position:0%
of the CTE so we don't have to repeat
 

00:36:36.480 --> 00:36:39.630 align:start position:0%
of the CTE so we don't have to repeat
the<00:36:36.640><c> same</c><00:36:36.920><c> logic</c><00:36:37.520><c> and</c><00:36:37.680><c> we</c><00:36:37.839><c> can</c><00:36:38.119><c> reuse</c><00:36:38.960><c> the</c><00:36:39.119><c> CTE</c>

00:36:39.630 --> 00:36:39.640 align:start position:0%
the same logic and we can reuse the CTE
 

00:36:39.640 --> 00:36:42.109 align:start position:0%
the same logic and we can reuse the CTE
inside<00:36:40.119><c> another</c><00:36:40.440><c> CTE</c><00:36:41.160><c> so</c><00:36:41.319><c> now</c><00:36:41.520><c> we</c><00:36:41.640><c> don't</c><00:36:41.880><c> need</c>

00:36:42.109 --> 00:36:42.119 align:start position:0%
inside another CTE so now we don't need
 

00:36:42.119 --> 00:36:44.030 align:start position:0%
inside another CTE so now we don't need
all<00:36:42.400><c> those</c><00:36:42.640><c> stuff</c><00:36:43.040><c> we</c><00:36:43.119><c> can</c><00:36:43.280><c> go</c><00:36:43.440><c> and</c><00:36:43.680><c> focus</c>

00:36:44.030 --> 00:36:44.040 align:start position:0%
all those stuff we can go and focus
 

00:36:44.040 --> 00:36:46.829 align:start position:0%
all those stuff we can go and focus
immediately<00:36:45.000><c> with</c><00:36:45.440><c> ranking</c><00:36:45.920><c> the</c><00:36:46.119><c> customers</c>

00:36:46.829 --> 00:36:46.839 align:start position:0%
immediately with ranking the customers
 

00:36:46.839 --> 00:36:48.910 align:start position:0%
immediately with ranking the customers
so<00:36:47.079><c> first</c><00:36:47.440><c> let</c><00:36:47.560><c> me</c><00:36:47.760><c> just</c><00:36:47.960><c> select</c><00:36:48.319><c> the</c><00:36:48.520><c> data</c>

00:36:48.910 --> 00:36:48.920 align:start position:0%
so first let me just select the data
 

00:36:48.920 --> 00:36:51.270 align:start position:0%
so first let me just select the data
from<00:36:49.119><c> the</c><00:36:49.280><c> first</c><00:36:49.560><c> CD</c><00:36:50.440><c> so</c><00:36:50.640><c> I'm</c><00:36:50.760><c> going</c><00:36:50.880><c> to</c><00:36:51.000><c> go</c><00:36:51.160><c> and</c>

00:36:51.270 --> 00:36:51.280 align:start position:0%
from the first CD so I'm going to go and
 

00:36:51.280 --> 00:36:53.069 align:start position:0%
from the first CD so I'm going to go and
select<00:36:52.000><c> so</c><00:36:52.240><c> what</c><00:36:52.359><c> do</c><00:36:52.480><c> we</c><00:36:52.599><c> have</c><00:36:52.760><c> we</c><00:36:52.880><c> have</c>

00:36:53.069 --> 00:36:53.079 align:start position:0%
select so what do we have we have
 

00:36:53.079 --> 00:36:54.829 align:start position:0%
select so what do we have we have
customer

00:36:54.829 --> 00:36:54.839 align:start position:0%
customer
 

00:36:54.839 --> 00:36:58.829 align:start position:0%
customer
ID<00:36:55.839><c> and</c><00:36:56.040><c> we</c><00:36:56.200><c> have</c><00:36:56.440><c> total</c><00:36:56.880><c> sales</c>

00:36:58.829 --> 00:36:58.839 align:start position:0%
ID and we have total sales
 

00:36:58.839 --> 00:37:00.750 align:start position:0%
ID and we have total sales
and<00:36:59.000><c> we're</c><00:36:59.160><c> going</c><00:36:59.240><c> to</c><00:36:59.400><c> select</c><00:36:59.720><c> it</c><00:36:59.960><c> this</c><00:37:00.160><c> time</c>

00:37:00.750 --> 00:37:00.760 align:start position:0%
and we're going to select it this time
 

00:37:00.760 --> 00:37:02.790 align:start position:0%
and we're going to select it this time
not<00:37:01.079><c> from</c><00:37:01.480><c> any</c><00:37:01.720><c> physical</c><00:37:02.160><c> table</c><00:37:02.520><c> we're</c><00:37:02.680><c> going</c>

00:37:02.790 --> 00:37:02.800 align:start position:0%
not from any physical table we're going
 

00:37:02.800 --> 00:37:06.270 align:start position:0%
not from any physical table we're going
to<00:37:03.000><c> select</c><00:37:03.760><c> our</c><00:37:04.079><c> CTE</c><00:37:04.880><c> so</c><00:37:05.240><c> like</c><00:37:05.480><c> this</c><00:37:06.000><c> and</c><00:37:06.119><c> now</c>

00:37:06.270 --> 00:37:06.280 align:start position:0%
to select our CTE so like this and now
 

00:37:06.280 --> 00:37:07.390 align:start position:0%
to select our CTE so like this and now
what<00:37:06.359><c> we're</c><00:37:06.480><c> going</c><00:37:06.560><c> to</c><00:37:06.680><c> do</c><00:37:06.839><c> we're</c><00:37:06.960><c> going</c><00:37:07.040><c> to</c><00:37:07.200><c> go</c>

00:37:07.390 --> 00:37:07.400 align:start position:0%
what we're going to do we're going to go
 

00:37:07.400 --> 00:37:09.750 align:start position:0%
what we're going to do we're going to go
and<00:37:07.640><c> select</c><00:37:08.000><c> the</c><00:37:08.160><c> whole</c><00:37:08.440><c> thing</c><00:37:08.920><c> and</c><00:37:09.240><c> execute</c>

00:37:09.750 --> 00:37:09.760 align:start position:0%
and select the whole thing and execute
 

00:37:09.760 --> 00:37:13.870 align:start position:0%
and select the whole thing and execute
it<00:37:10.240><c> well</c><00:37:10.560><c> this</c><00:37:10.760><c> is</c><00:37:11.000><c> the</c><00:37:11.200><c> issue</c><00:37:11.560><c> of</c><00:37:11.880><c> nesting</c><00:37:12.880><c> C</c>

00:37:13.870 --> 00:37:13.880 align:start position:0%
it well this is the issue of nesting C
 

00:37:13.880 --> 00:37:17.069 align:start position:0%
it well this is the issue of nesting C
sadly<00:37:14.440><c> this</c><00:37:14.599><c> CTE</c><00:37:15.280><c> is</c><00:37:15.680><c> completely</c><00:37:16.400><c> depending</c>

00:37:17.069 --> 00:37:17.079 align:start position:0%
sadly this CTE is completely depending
 

00:37:17.079 --> 00:37:19.349 align:start position:0%
sadly this CTE is completely depending
on<00:37:17.240><c> the</c><00:37:17.359><c> first</c><00:37:17.720><c> CTE</c><00:37:18.200><c> so</c><00:37:18.400><c> we</c><00:37:18.599><c> cannot</c><00:37:18.960><c> go</c><00:37:19.119><c> and</c>

00:37:19.349 --> 00:37:19.359 align:start position:0%
on the first CTE so we cannot go and
 

00:37:19.359 --> 00:37:21.270 align:start position:0%
on the first CTE so we cannot go and
execute<00:37:19.760><c> it</c><00:37:19.920><c> on</c><00:37:20.079><c> its</c><00:37:20.280><c> own</c><00:37:20.760><c> and</c><00:37:20.880><c> this</c><00:37:21.000><c> is</c><00:37:21.119><c> of</c>

00:37:21.270 --> 00:37:21.280 align:start position:0%
execute it on its own and this is of
 

00:37:21.280 --> 00:37:24.309 align:start position:0%
execute it on its own and this is of
course<00:37:21.680><c> very</c><00:37:21.960><c> annoying</c><00:37:22.960><c> because</c><00:37:23.680><c> each</c><00:37:23.960><c> time</c><00:37:24.160><c> I</c>

00:37:24.309 --> 00:37:24.319 align:start position:0%
course very annoying because each time I
 

00:37:24.319 --> 00:37:26.510 align:start position:0%
course very annoying because each time I
execute<00:37:24.800><c> the</c><00:37:24.960><c> query</c><00:37:25.839><c> by</c><00:37:26.000><c> the</c><00:37:26.119><c> end</c><00:37:26.280><c> of</c><00:37:26.400><c> the</c>

00:37:26.510 --> 00:37:26.520 align:start position:0%
execute the query by the end of the
 

00:37:26.520 --> 00:37:29.109 align:start position:0%
execute the query by the end of the
query<00:37:26.839><c> isql</c><00:37:27.240><c> going</c><00:37:27.319><c> to</c><00:37:27.400><c> go</c><00:37:27.560><c> go</c><00:37:27.720><c> and</c><00:37:28.119><c> destroy</c>

00:37:29.109 --> 00:37:29.119 align:start position:0%
query isql going to go go and destroy
 

00:37:29.119 --> 00:37:32.230 align:start position:0%
query isql going to go go and destroy
all<00:37:29.400><c> the</c><00:37:29.760><c> CTE</c><00:37:30.640><c> so</c><00:37:30.880><c> in</c><00:37:31.000><c> the</c><00:37:31.160><c> memory</c><00:37:31.599><c> we</c><00:37:31.720><c> will</c><00:37:31.960><c> not</c>

00:37:32.230 --> 00:37:32.240 align:start position:0%
all the CTE so in the memory we will not
 

00:37:32.240 --> 00:37:35.030 align:start position:0%
all the CTE so in the memory we will not
find<00:37:32.920><c> the</c><00:37:33.079><c> CTE</c><00:37:33.839><c> and</c><00:37:34.000><c> that's</c><00:37:34.280><c> why</c><00:37:34.599><c> once</c><00:37:34.839><c> I</c>

00:37:35.030 --> 00:37:35.040 align:start position:0%
find the CTE and that's why once I
 

00:37:35.040 --> 00:37:37.589 align:start position:0%
find the CTE and that's why once I
executed<00:37:35.599><c> it</c><00:37:35.960><c> SQL</c><00:37:36.480><c> don't</c><00:37:36.720><c> know</c><00:37:37.079><c> anything</c>

00:37:37.589 --> 00:37:37.599 align:start position:0%
executed it SQL don't know anything
 

00:37:37.599 --> 00:37:40.670 align:start position:0%
executed it SQL don't know anything
about<00:37:38.359><c> this</c><00:37:38.520><c> C</c><00:37:39.200><c> and</c><00:37:39.400><c> in</c><00:37:39.560><c> order</c><00:37:39.920><c> now</c><00:37:40.079><c> to</c><00:37:40.200><c> see</c><00:37:40.440><c> the</c>

00:37:40.670 --> 00:37:40.680 align:start position:0%
about this C and in order now to see the
 

00:37:40.680 --> 00:37:43.069 align:start position:0%
about this C and in order now to see the
result<00:37:41.040><c> of</c><00:37:41.240><c> this</c><00:37:41.440><c> we</c><00:37:41.599><c> have</c><00:37:41.839><c> always</c><00:37:42.240><c> to</c><00:37:42.520><c> execute</c>

00:37:43.069 --> 00:37:43.079 align:start position:0%
result of this we have always to execute
 

00:37:43.079 --> 00:37:46.910 align:start position:0%
result of this we have always to execute
as<00:37:43.240><c> well</c><00:37:44.000><c> with</c><00:37:44.240><c> it</c><00:37:45.000><c> the</c><00:37:45.400><c> CTE</c><00:37:45.920><c> that</c><00:37:46.119><c> I'm</c><00:37:46.280><c> using</c>

00:37:46.910 --> 00:37:46.920 align:start position:0%
as well with it the CTE that I'm using
 

00:37:46.920 --> 00:37:50.109 align:start position:0%
as well with it the CTE that I'm using
so<00:37:47.160><c> what</c><00:37:47.319><c> I</c><00:37:47.440><c> usually</c><00:37:47.800><c> do</c><00:37:48.119><c> I</c><00:37:48.280><c> go</c><00:37:48.480><c> over</c><00:37:48.760><c> here</c><00:37:49.240><c> and</c>

00:37:50.109 --> 00:37:50.119 align:start position:0%
so what I usually do I go over here and
 

00:37:50.119 --> 00:37:52.510 align:start position:0%
so what I usually do I go over here and
make<00:37:50.440><c> everything</c><00:37:50.880><c> in</c><00:37:51.119><c> comment</c><00:37:51.560><c> in</c><00:37:51.680><c> the</c><00:37:51.839><c> main</c>

00:37:52.510 --> 00:37:52.520 align:start position:0%
make everything in comment in the main
 

00:37:52.520 --> 00:37:55.109 align:start position:0%
make everything in comment in the main
query<00:37:53.520><c> and</c><00:37:53.680><c> now</c><00:37:53.880><c> I</c><00:37:53.960><c> can</c><00:37:54.160><c> go</c><00:37:54.280><c> and</c><00:37:54.520><c> execute</c><00:37:54.960><c> the</c>

00:37:55.109 --> 00:37:55.119 align:start position:0%
query and now I can go and execute the
 

00:37:55.119 --> 00:37:56.910 align:start position:0%
query and now I can go and execute the
whole<00:37:55.400><c> thing</c><00:37:55.920><c> and</c><00:37:56.040><c> now</c><00:37:56.200><c> I</c><00:37:56.280><c> will</c><00:37:56.400><c> see</c><00:37:56.599><c> in</c><00:37:56.760><c> the</c>

00:37:56.910 --> 00:37:56.920 align:start position:0%
whole thing and now I will see in the
 

00:37:56.920 --> 00:38:00.390 align:start position:0%
whole thing and now I will see in the
output<00:37:57.800><c> the</c><00:37:58.000><c> outcome</c><00:37:58.599><c> of</c><00:37:58.880><c> this</c><00:37:59.079><c> nested</c><00:37:59.440><c> CTE</c><00:38:00.079><c> so</c>

00:38:00.390 --> 00:38:00.400 align:start position:0%
output the outcome of this nested CTE so
 

00:38:00.400 --> 00:38:02.270 align:start position:0%
output the outcome of this nested CTE so
this<00:38:00.560><c> is</c><00:38:01.000><c> the</c><00:38:01.200><c> big</c><00:38:01.440><c> difference</c><00:38:01.800><c> between</c><00:38:02.119><c> the</c>

00:38:02.270 --> 00:38:02.280 align:start position:0%
this is the big difference between the
 

00:38:02.280 --> 00:38:05.230 align:start position:0%
this is the big difference between the
Standalone<00:38:02.960><c> CES</c><00:38:03.520><c> like</c><00:38:03.760><c> here</c><00:38:04.319><c> and</c><00:38:04.480><c> the</c><00:38:04.680><c> nested</c>

00:38:05.230 --> 00:38:05.240 align:start position:0%
Standalone CES like here and the nested
 

00:38:05.240 --> 00:38:06.950 align:start position:0%
Standalone CES like here and the nested
so<00:38:05.400><c> now</c><00:38:05.560><c> let's</c><00:38:05.720><c> go</c><00:38:05.880><c> back</c><00:38:06.000><c> to</c><00:38:06.119><c> our</c><00:38:06.359><c> task</c><00:38:06.680><c> we</c><00:38:06.800><c> have</c>

00:38:06.950 --> 00:38:06.960 align:start position:0%
so now let's go back to our task we have
 

00:38:06.960 --> 00:38:09.829 align:start position:0%
so now let's go back to our task we have
to<00:38:07.200><c> rank</c><00:38:07.800><c> those</c><00:38:08.040><c> sales</c><00:38:08.960><c> based</c><00:38:09.280><c> on</c><00:38:09.400><c> the</c><00:38:09.560><c> total</c>

00:38:09.829 --> 00:38:09.839 align:start position:0%
to rank those sales based on the total
 

00:38:09.839 --> 00:38:12.829 align:start position:0%
to rank those sales based on the total
sale<00:38:10.280><c> so</c><00:38:10.599><c> we</c><00:38:10.720><c> can</c><00:38:10.920><c> go</c><00:38:11.040><c> and</c><00:38:11.240><c> use</c><00:38:12.119><c> the</c><00:38:12.319><c> rank</c>

00:38:12.829 --> 00:38:12.839 align:start position:0%
sale so we can go and use the rank
 

00:38:12.839 --> 00:38:15.670 align:start position:0%
sale so we can go and use the rank
function<00:38:13.839><c> from</c><00:38:14.119><c> the</c><00:38:14.280><c> window</c><00:38:14.640><c> function</c><00:38:15.280><c> so</c>

00:38:15.670 --> 00:38:15.680 align:start position:0%
function from the window function so
 

00:38:15.680 --> 00:38:18.670 align:start position:0%
function from the window function so
rank<00:38:16.839><c> over</c><00:38:17.839><c> and</c><00:38:17.960><c> now</c><00:38:18.079><c> we</c><00:38:18.200><c> don't</c><00:38:18.400><c> have</c><00:38:18.520><c> to</c>

00:38:18.670 --> 00:38:18.680 align:start position:0%
rank over and now we don't have to
 

00:38:18.680 --> 00:38:21.069 align:start position:0%
rank over and now we don't have to
partition<00:38:19.119><c> the</c><00:38:19.319><c> data</c><00:38:19.880><c> we</c><00:38:20.040><c> just</c><00:38:20.200><c> want</c><00:38:20.400><c> to</c><00:38:20.640><c> sort</c>

00:38:21.069 --> 00:38:21.079 align:start position:0%
partition the data we just want to sort
 

00:38:21.079 --> 00:38:25.470 align:start position:0%
partition the data we just want to sort
the<00:38:21.240><c> data</c><00:38:21.720><c> by</c><00:38:21.960><c> the</c><00:38:22.400><c> total</c><00:38:23.440><c> sales</c>

00:38:25.470 --> 00:38:25.480 align:start position:0%
the data by the total sales
 

00:38:25.480 --> 00:38:27.870 align:start position:0%
the data by the total sales
descending<00:38:26.480><c> so</c><00:38:26.760><c> like</c><00:38:27.000><c> this</c><00:38:27.520><c> the</c><00:38:27.640><c> highest</c>

00:38:27.870 --> 00:38:27.880 align:start position:0%
descending so like this the highest
 

00:38:27.880 --> 00:38:30.030 align:start position:0%
descending so like this the highest
sales<00:38:28.240><c> going</c><00:38:28.359><c> to</c><00:38:28.599><c> get</c><00:38:28.880><c> the</c><00:38:29.119><c> rank</c><00:38:29.400><c> number</c><00:38:29.640><c> one</c>

00:38:30.030 --> 00:38:30.040 align:start position:0%
sales going to get the rank number one
 

00:38:30.040 --> 00:38:32.550 align:start position:0%
sales going to get the rank number one
so<00:38:30.440><c> let's</c><00:38:30.640><c> go</c><00:38:30.839><c> and</c><00:38:30.960><c> give</c><00:38:31.079><c> it</c><00:38:31.240><c> the</c><00:38:31.400><c> name</c><00:38:31.839><c> as</c>

00:38:32.550 --> 00:38:32.560 align:start position:0%
so let's go and give it the name as
 

00:38:32.560 --> 00:38:35.309 align:start position:0%
so let's go and give it the name as
customer<00:38:33.560><c> rank</c><00:38:34.400><c> now</c><00:38:34.599><c> as</c><00:38:34.720><c> you</c><00:38:34.800><c> can</c><00:38:34.920><c> see</c><00:38:35.079><c> we</c><00:38:35.160><c> have</c>

00:38:35.309 --> 00:38:35.319 align:start position:0%
customer rank now as you can see we have
 

00:38:35.319 --> 00:38:37.069 align:start position:0%
customer rank now as you can see we have
a<00:38:35.480><c> really</c><00:38:35.720><c> nice</c><00:38:35.960><c> rank</c><00:38:36.400><c> beside</c><00:38:36.880><c> those</c>

00:38:37.069 --> 00:38:37.079 align:start position:0%
a really nice rank beside those
 

00:38:37.079 --> 00:38:39.309 align:start position:0%
a really nice rank beside those
informations<00:38:38.000><c> customer</c><00:38:38.400><c> three</c><00:38:38.839><c> has</c><00:38:39.119><c> the</c>

00:38:39.309 --> 00:38:39.319 align:start position:0%
informations customer three has the
 

00:38:39.319 --> 00:38:41.510 align:start position:0%
informations customer three has the
highest<00:38:39.640><c> sales</c><00:38:40.079><c> and</c><00:38:40.319><c> customer</c><00:38:40.680><c> two</c><00:38:41.079><c> has</c><00:38:41.359><c> the</c>

00:38:41.510 --> 00:38:41.520 align:start position:0%
highest sales and customer two has the
 

00:38:41.520 --> 00:38:43.470 align:start position:0%
highest sales and customer two has the
lowest<00:38:41.880><c> total</c><00:38:42.200><c> sales</c><00:38:42.720><c> so</c><00:38:42.960><c> with</c><00:38:43.079><c> that</c><00:38:43.240><c> as</c><00:38:43.359><c> you</c>

00:38:43.470 --> 00:38:43.480 align:start position:0%
lowest total sales so with that as you
 

00:38:43.480 --> 00:38:46.190 align:start position:0%
lowest total sales so with that as you
can<00:38:43.680><c> see</c><00:38:44.119><c> we</c><00:38:44.280><c> didn't</c><00:38:44.640><c> repeat</c><00:38:45.079><c> ourself</c><00:38:45.720><c> we</c><00:38:45.920><c> just</c>

00:38:46.190 --> 00:38:46.200 align:start position:0%
can see we didn't repeat ourself we just
 

00:38:46.200 --> 00:38:50.030 align:start position:0%
can see we didn't repeat ourself we just
reused<00:38:47.079><c> another</c><00:38:47.440><c> CTE</c><00:38:48.440><c> in</c><00:38:48.720><c> our</c><00:38:49.000><c> current</c><00:38:49.319><c> CTE</c>

00:38:50.030 --> 00:38:50.040 align:start position:0%
reused another CTE in our current CTE
 

00:38:50.040 --> 00:38:51.790 align:start position:0%
reused another CTE in our current CTE
and<00:38:50.200><c> this</c><00:38:50.280><c> is</c><00:38:50.520><c> exactly</c><00:38:50.960><c> why</c><00:38:51.160><c> this</c><00:38:51.319><c> technique</c>

00:38:51.790 --> 00:38:51.800 align:start position:0%
and this is exactly why this technique
 

00:38:51.800 --> 00:38:54.190 align:start position:0%
and this is exactly why this technique
is<00:38:52.040><c> very</c><00:38:52.280><c> amazing</c><00:38:52.720><c> in</c><00:38:52.880><c> order</c><00:38:53.240><c> to</c><00:38:53.440><c> reduce</c>

00:38:54.190 --> 00:38:54.200 align:start position:0%
is very amazing in order to reduce
 

00:38:54.200 --> 00:38:56.150 align:start position:0%
is very amazing in order to reduce
redundancies<00:38:55.200><c> and</c><00:38:55.319><c> to</c><00:38:55.520><c> reduce</c><00:38:55.960><c> the</c>

00:38:56.150 --> 00:38:56.160 align:start position:0%
redundancies and to reduce the
 

00:38:56.160 --> 00:38:58.630 align:start position:0%
redundancies and to reduce the
complexity<00:38:56.680><c> of</c><00:38:56.880><c> the</c><00:38:57.000><c> whole</c><00:38:57.440><c> query</c><00:38:57.920><c> so</c><00:38:58.160><c> nested</c>

00:38:58.630 --> 00:38:58.640 align:start position:0%
complexity of the whole query so nested
 

00:38:58.640 --> 00:39:01.910 align:start position:0%
complexity of the whole query so nested
are<00:38:58.880><c> annoying</c><00:38:59.319><c> to</c><00:38:59.520><c> execute</c><00:39:00.480><c> but</c><00:39:01.160><c> they</c><00:39:01.359><c> reduce</c>

00:39:01.910 --> 00:39:01.920 align:start position:0%
are annoying to execute but they reduce
 

00:39:01.920 --> 00:39:04.270 align:start position:0%
are annoying to execute but they reduce
the<00:39:02.119><c> redundancies</c><00:39:02.800><c> of</c><00:39:02.960><c> our</c><00:39:03.240><c> code</c><00:39:03.800><c> now</c><00:39:03.960><c> we</c><00:39:04.079><c> are</c>

00:39:04.270 --> 00:39:04.280 align:start position:0%
the redundancies of our code now we are
 

00:39:04.280 --> 00:39:06.390 align:start position:0%
the redundancies of our code now we are
done<00:39:04.480><c> with</c><00:39:04.680><c> our</c><00:39:04.920><c> logic</c><00:39:05.280><c> we</c><00:39:05.520><c> tested</c><00:39:05.920><c> everything</c>

00:39:06.390 --> 00:39:06.400 align:start position:0%
done with our logic we tested everything
 

00:39:06.400 --> 00:39:07.670 align:start position:0%
done with our logic we tested everything
so<00:39:06.680><c> what</c><00:39:06.800><c> we're</c><00:39:06.920><c> going</c><00:39:07.000><c> to</c><00:39:07.119><c> do</c><00:39:07.319><c> we're</c><00:39:07.440><c> going</c><00:39:07.560><c> to</c>

00:39:07.670 --> 00:39:07.680 align:start position:0%
so what we're going to do we're going to
 

00:39:07.680 --> 00:39:10.750 align:start position:0%
so what we're going to do we're going to
go<00:39:07.839><c> and</c><00:39:08.079><c> integrate</c><00:39:08.560><c> it</c><00:39:08.800><c> in</c><00:39:09.040><c> our</c><00:39:09.800><c> main</c><00:39:10.160><c> query</c><00:39:10.599><c> so</c>

00:39:10.750 --> 00:39:10.760 align:start position:0%
go and integrate it in our main query so
 

00:39:10.760 --> 00:39:12.510 align:start position:0%
go and integrate it in our main query so
let<00:39:10.880><c> me</c><00:39:11.040><c> just</c><00:39:11.240><c> remove</c><00:39:11.560><c> the</c><00:39:11.800><c> comments</c><00:39:12.240><c> from</c>

00:39:12.510 --> 00:39:12.520 align:start position:0%
let me just remove the comments from
 

00:39:12.520 --> 00:39:15.030 align:start position:0%
let me just remove the comments from
here<00:39:13.280><c> and</c><00:39:13.640><c> let's</c><00:39:13.839><c> go</c><00:39:13.960><c> and</c><00:39:14.160><c> add</c><00:39:14.359><c> it</c><00:39:14.520><c> in</c><00:39:14.680><c> the</c><00:39:14.800><c> main</c>

00:39:15.030 --> 00:39:15.040 align:start position:0%
here and let's go and add it in the main
 

00:39:15.040 --> 00:39:17.589 align:start position:0%
here and let's go and add it in the main
query<00:39:15.680><c> so</c><00:39:16.160><c> we</c><00:39:16.240><c> will</c><00:39:16.440><c> do</c><00:39:16.640><c> the</c><00:39:16.800><c> same</c><00:39:17.079><c> thing</c><00:39:17.480><c> we're</c>

00:39:17.589 --> 00:39:17.599 align:start position:0%
query so we will do the same thing we're
 

00:39:17.599 --> 00:39:20.150 align:start position:0%
query so we will do the same thing we're
going<00:39:17.720><c> to</c><00:39:17.880><c> go</c><00:39:18.079><c> and</c><00:39:18.240><c> do</c><00:39:18.440><c> a</c><00:39:18.599><c> lift</c><00:39:18.839><c> join</c><00:39:19.560><c> with</c><00:39:19.760><c> the</c>

00:39:20.150 --> 00:39:20.160 align:start position:0%
going to go and do a lift join with the
 

00:39:20.160 --> 00:39:22.790 align:start position:0%
going to go and do a lift join with the
last<00:39:20.480><c> city</c><00:39:20.920><c> that</c><00:39:21.079><c> we</c><00:39:21.240><c> just</c><00:39:21.480><c> created</c><00:39:22.119><c> so</c><00:39:22.480><c> let</c><00:39:22.560><c> me</c>

00:39:22.790 --> 00:39:22.800 align:start position:0%
last city that we just created so let me
 

00:39:22.800 --> 00:39:24.150 align:start position:0%
last city that we just created so let me
just<00:39:22.960><c> call</c><00:39:23.200><c> it</c>

00:39:24.150 --> 00:39:24.160 align:start position:0%
just call it
 

00:39:24.160 --> 00:39:26.750 align:start position:0%
just call it
CCR<00:39:25.160><c> and</c><00:39:25.560><c> the</c><00:39:25.720><c> same</c><00:39:26.079><c> conditions</c><00:39:26.440><c> we</c><00:39:26.560><c> are</c>

00:39:26.750 --> 00:39:26.760 align:start position:0%
CCR and the same conditions we are
 

00:39:26.760 --> 00:39:29.309 align:start position:0%
CCR and the same conditions we are
always<00:39:27.000><c> joining</c><00:39:27.640><c> on</c><00:39:27.960><c> the</c><00:39:28.240><c> customer</c><00:39:28.640><c> ID</c><00:39:29.160><c> but</c>

00:39:29.309 --> 00:39:29.319 align:start position:0%
always joining on the customer ID but
 

00:39:29.319 --> 00:39:33.349 align:start position:0%
always joining on the customer ID but
don't<00:39:29.560><c> forget</c><00:39:30.040><c> to</c><00:39:30.440><c> rename</c><00:39:31.440><c> the</c><00:39:31.640><c> ilas</c><00:39:32.400><c> so</c><00:39:32.720><c> it</c><00:39:32.920><c> is</c>

00:39:33.349 --> 00:39:33.359 align:start position:0%
don't forget to rename the ilas so it is
 

00:39:33.359 --> 00:39:36.750 align:start position:0%
don't forget to rename the ilas so it is
CCR<00:39:34.240><c> customer</c><00:39:34.680><c> ID</c><00:39:35.200><c> equal</c><00:39:35.599><c> to</c><00:39:35.800><c> the</c><00:39:36.079><c> customer</c><00:39:36.480><c> ID</c>

00:39:36.750 --> 00:39:36.760 align:start position:0%
CCR customer ID equal to the customer ID
 

00:39:36.760 --> 00:39:38.829 align:start position:0%
CCR customer ID equal to the customer ID
from<00:39:36.920><c> the</c><00:39:37.079><c> first</c><00:39:37.359><c> table</c><00:39:37.960><c> and</c><00:39:38.160><c> of</c><00:39:38.319><c> course</c><00:39:38.720><c> we</c>

00:39:38.829 --> 00:39:38.839 align:start position:0%
from the first table and of course we
 

00:39:38.839 --> 00:39:40.589 align:start position:0%
from the first table and of course we
have<00:39:39.000><c> to</c><00:39:39.160><c> go</c><00:39:39.359><c> and</c><00:39:39.599><c> select</c><00:39:40.200><c> the</c><00:39:40.359><c> new</c>

00:39:40.589 --> 00:39:40.599 align:start position:0%
have to go and select the new
 

00:39:40.599 --> 00:39:45.870 align:start position:0%
have to go and select the new
information<00:39:41.560><c> so</c><00:39:42.000><c> CCR</c><00:39:42.960><c> do</c><00:39:43.680><c> customer</c><00:39:44.720><c> Rank</c><00:39:45.720><c> and</c>

00:39:45.870 --> 00:39:45.880 align:start position:0%
information so CCR do customer Rank and
 

00:39:45.880 --> 00:39:48.230 align:start position:0%
information so CCR do customer Rank and
now<00:39:46.119><c> let's</c><00:39:46.359><c> go</c><00:39:46.640><c> and</c><00:39:46.920><c> execute</c><00:39:47.400><c> the</c><00:39:47.520><c> whole</c><00:39:47.760><c> thing</c>

00:39:48.230 --> 00:39:48.240 align:start position:0%
now let's go and execute the whole thing
 

00:39:48.240 --> 00:39:50.230 align:start position:0%
now let's go and execute the whole thing
now<00:39:48.440><c> as</c><00:39:48.560><c> you</c><00:39:48.640><c> can</c><00:39:48.760><c> see</c><00:39:48.920><c> in</c><00:39:49.040><c> the</c><00:39:49.160><c> results</c><00:39:50.000><c> those</c>

00:39:50.230 --> 00:39:50.240 align:start position:0%
now as you can see in the results those
 

00:39:50.240 --> 00:39:52.190 align:start position:0%
now as you can see in the results those
three<00:39:50.480><c> columns</c><00:39:50.880><c> comes</c><00:39:51.200><c> from</c><00:39:51.520><c> the</c><00:39:51.720><c> customer</c>

00:39:52.190 --> 00:39:52.200 align:start position:0%
three columns comes from the customer
 

00:39:52.200 --> 00:39:55.109 align:start position:0%
three columns comes from the customer
table<00:39:52.680><c> the</c><00:39:52.839><c> total</c><00:39:53.119><c> sales</c><00:39:54.040><c> comes</c><00:39:54.640><c> from</c><00:39:54.960><c> the</c>

00:39:55.109 --> 00:39:55.119 align:start position:0%
table the total sales comes from the
 

00:39:55.119 --> 00:39:58.030 align:start position:0%
table the total sales comes from the
first<00:39:55.480><c> CTE</c><00:39:56.040><c> the</c><00:39:56.240><c> last</c><00:39:56.520><c> order</c><00:39:57.040><c> from</c><00:39:57.480><c> the</c><00:39:57.640><c> second</c>

00:39:58.030 --> 00:39:58.040 align:start position:0%
first CTE the last order from the second
 

00:39:58.040 --> 00:40:01.349 align:start position:0%
first CTE the last order from the second
CTE<00:39:58.920><c> and</c><00:39:59.119><c> the</c><00:39:59.280><c> customer</c><00:39:59.800><c> rank</c><00:40:00.319><c> comes</c><00:40:00.720><c> from</c><00:40:01.040><c> our</c>

00:40:01.349 --> 00:40:01.359 align:start position:0%
CTE and the customer rank comes from our
 

00:40:01.359 --> 00:40:04.270 align:start position:0%
CTE and the customer rank comes from our
nested<00:40:02.000><c> CTE</c><00:40:02.560><c> that</c><00:40:02.680><c> we</c><00:40:02.880><c> just</c><00:40:03.079><c> created</c><00:40:03.760><c> so</c><00:40:04.040><c> guys</c>

00:40:04.270 --> 00:40:04.280 align:start position:0%
nested CTE that we just created so guys
 

00:40:04.280 --> 00:40:07.030 align:start position:0%
nested CTE that we just created so guys
it<00:40:04.400><c> is</c><00:40:04.599><c> not</c><00:40:04.839><c> a</c><00:40:05.000><c> simple</c><00:40:05.440><c> task</c><00:40:05.800><c> creating</c><00:40:06.359><c> such</c><00:40:06.520><c> a</c>

00:40:07.030 --> 00:40:07.040 align:start position:0%
it is not a simple task creating such a
 

00:40:07.040 --> 00:40:09.670 align:start position:0%
it is not a simple task creating such a
report<00:40:08.040><c> because</c><00:40:08.520><c> it</c><00:40:08.720><c> involves</c><00:40:09.280><c> different</c>

00:40:09.670 --> 00:40:09.680 align:start position:0%
report because it involves different
 

00:40:09.680 --> 00:40:12.109 align:start position:0%
report because it involves different
aggregations<00:40:10.480><c> and</c><00:40:10.720><c> different</c><00:40:11.040><c> functions</c><00:40:11.880><c> but</c>

00:40:12.109 --> 00:40:12.119 align:start position:0%
aggregations and different functions but
 

00:40:12.119 --> 00:40:14.150 align:start position:0%
aggregations and different functions but
our<00:40:12.359><c> work</c><00:40:12.640><c> is</c><00:40:12.839><c> organized</c><00:40:13.560><c> as</c><00:40:13.680><c> you</c><00:40:13.760><c> can</c><00:40:13.920><c> see</c>

00:40:14.150 --> 00:40:14.160 align:start position:0%
our work is organized as you can see
 

00:40:14.160 --> 00:40:16.190 align:start position:0%
our work is organized as you can see
it's<00:40:14.359><c> very</c><00:40:14.560><c> simple</c><00:40:15.160><c> we</c><00:40:15.280><c> have</c><00:40:15.480><c> step</c><00:40:15.720><c> one</c><00:40:15.960><c> step</c>

00:40:16.190 --> 00:40:16.200 align:start position:0%
it's very simple we have step one step
 

00:40:16.200 --> 00:40:18.589 align:start position:0%
it's very simple we have step one step
two<00:40:16.480><c> step</c><00:40:16.800><c> three</c><00:40:17.119><c> and</c><00:40:17.280><c> the</c><00:40:17.440><c> main</c><00:40:17.720><c> query</c><00:40:18.440><c> and</c>

00:40:18.589 --> 00:40:18.599 align:start position:0%
two step three and the main query and
 

00:40:18.599 --> 00:40:21.030 align:start position:0%
two step three and the main query and
it's<00:40:18.800><c> really</c><00:40:19.040><c> easy</c><00:40:19.280><c> to</c><00:40:19.480><c> add</c><00:40:19.800><c> more</c><00:40:20.119><c> components</c>

00:40:21.030 --> 00:40:21.040 align:start position:0%
it's really easy to add more components
 

00:40:21.040 --> 00:40:23.589 align:start position:0%
it's really easy to add more components
to<00:40:21.359><c> our</c><00:40:21.920><c> query</c><00:40:22.520><c> now</c><00:40:22.720><c> I</c><00:40:22.800><c> would</c><00:40:22.960><c> like</c><00:40:23.119><c> really</c><00:40:23.359><c> to</c>

00:40:23.589 --> 00:40:23.599 align:start position:0%
to our query now I would like really to
 

00:40:23.599 --> 00:40:26.069 align:start position:0%
to our query now I would like really to
keep<00:40:23.880><c> practicing</c><00:40:24.440><c> using</c><00:40:24.760><c> those</c><00:40:25.000><c> Ned</c><00:40:25.440><c> queries</c>

00:40:26.069 --> 00:40:26.079 align:start position:0%
keep practicing using those Ned queries
 

00:40:26.079 --> 00:40:27.670 align:start position:0%
keep practicing using those Ned queries
so<00:40:26.240><c> we</c><00:40:26.359><c> have</c><00:40:26.480><c> the</c><00:40:26.560><c> following</c><00:40:26.960><c> task</c><00:40:27.400><c> we</c><00:40:27.520><c> would</c>

00:40:27.670 --> 00:40:27.680 align:start position:0%
so we have the following task we would
 

00:40:27.680 --> 00:40:30.190 align:start position:0%
so we have the following task we would
like<00:40:27.839><c> to</c><00:40:28.040><c> add</c><00:40:28.319><c> one</c><00:40:28.480><c> more</c><00:40:28.680><c> step</c><00:40:28.960><c> in</c><00:40:29.079><c> our</c><00:40:29.400><c> report</c>

00:40:30.190 --> 00:40:30.200 align:start position:0%
like to add one more step in our report
 

00:40:30.200 --> 00:40:32.710 align:start position:0%
like to add one more step in our report
segment<00:40:30.680><c> the</c><00:40:30.880><c> customers</c><00:40:31.440><c> based</c><00:40:32.160><c> on</c><00:40:32.440><c> their</c>

00:40:32.710 --> 00:40:32.720 align:start position:0%
segment the customers based on their
 

00:40:32.720 --> 00:40:35.030 align:start position:0%
segment the customers based on their
total<00:40:33.079><c> sales</c><00:40:33.839><c> so</c><00:40:34.079><c> I</c><00:40:34.160><c> would</c><00:40:34.359><c> like</c><00:40:34.480><c> to</c><00:40:34.599><c> implement</c>

00:40:35.030 --> 00:40:35.040 align:start position:0%
total sales so I would like to implement
 

00:40:35.040 --> 00:40:38.230 align:start position:0%
total sales so I would like to implement
this<00:40:35.480><c> as</c><00:40:35.680><c> well</c><00:40:36.119><c> using</c><00:40:36.480><c> CTE</c><00:40:37.400><c> so</c><00:40:37.640><c> let's</c><00:40:37.839><c> go</c><00:40:38.000><c> and</c>

00:40:38.230 --> 00:40:38.240 align:start position:0%
this as well using CTE so let's go and
 

00:40:38.240 --> 00:40:40.910 align:start position:0%
this as well using CTE so let's go and
solve<00:40:38.520><c> it</c><00:40:38.920><c> we</c><00:40:39.040><c> want</c><00:40:39.200><c> to</c><00:40:39.400><c> go</c><00:40:39.560><c> and</c><00:40:39.800><c> add</c><00:40:40.040><c> a</c><00:40:40.200><c> new</c><00:40:40.400><c> CTE</c>

00:40:40.910 --> 00:40:40.920 align:start position:0%
solve it we want to go and add a new CTE
 

00:40:40.920 --> 00:40:45.069 align:start position:0%
solve it we want to go and add a new CTE
it's<00:40:41.079><c> going</c><00:40:41.160><c> to</c><00:40:41.280><c> be</c><00:40:41.560><c> CTE</c><00:40:42.720><c> customer</c>

00:40:45.069 --> 00:40:45.079 align:start position:0%
it's going to be CTE customer
 

00:40:45.079 --> 00:40:47.990 align:start position:0%
it's going to be CTE customer
segments<00:40:46.079><c> as</c><00:40:46.599><c> and</c><00:40:46.839><c> then</c><00:40:47.000><c> we</c><00:40:47.119><c> have</c><00:40:47.280><c> to</c><00:40:47.480><c> go</c><00:40:47.720><c> and</c>

00:40:47.990 --> 00:40:48.000 align:start position:0%
segments as and then we have to go and
 

00:40:48.000 --> 00:40:50.630 align:start position:0%
segments as and then we have to go and
Define<00:40:48.920><c> our</c><00:40:49.200><c> logic</c><00:40:49.760><c> now</c><00:40:49.920><c> if</c><00:40:50.040><c> you</c><00:40:50.160><c> check</c><00:40:50.359><c> our</c>

00:40:50.630 --> 00:40:50.640 align:start position:0%
Define our logic now if you check our
 

00:40:50.640 --> 00:40:53.109 align:start position:0%
Define our logic now if you check our
task<00:40:50.960><c> it</c><00:40:51.119><c> has</c><00:40:51.400><c> two</c><00:40:52.000><c> parts</c><00:40:52.520><c> we</c><00:40:52.640><c> have</c><00:40:52.760><c> to</c><00:40:52.880><c> find</c>

00:40:53.109 --> 00:40:53.119 align:start position:0%
task it has two parts we have to find
 

00:40:53.119 --> 00:40:55.470 align:start position:0%
task it has two parts we have to find
the<00:40:53.319><c> total</c><00:40:53.599><c> sales</c><00:40:54.480><c> and</c><00:40:54.720><c> then</c><00:40:54.960><c> we</c><00:40:55.079><c> have</c><00:40:55.200><c> to</c>

00:40:55.470 --> 00:40:55.480 align:start position:0%
the total sales and then we have to
 

00:40:55.480 --> 00:40:57.309 align:start position:0%
the total sales and then we have to
segment<00:40:55.920><c> the</c><00:40:56.079><c> customers</c><00:40:56.599><c> based</c><00:40:56.839><c> on</c><00:40:56.960><c> this</c>

00:40:57.309 --> 00:40:57.319 align:start position:0%
segment the customers based on this
 

00:40:57.319 --> 00:40:59.790 align:start position:0%
segment the customers based on this
information<00:40:58.240><c> so</c><00:40:58.520><c> it</c><00:40:58.680><c> is</c><00:40:58.960><c> something</c><00:40:59.520><c> very</c>

00:40:59.790 --> 00:40:59.800 align:start position:0%
information so it is something very
 

00:40:59.800 --> 00:41:02.109 align:start position:0%
information so it is something very
similar<00:41:00.400><c> to</c><00:41:00.599><c> what</c><00:41:00.720><c> we</c><00:41:00.839><c> have</c><00:41:01.040><c> done</c><00:41:01.400><c> in</c><00:41:01.599><c> the</c><00:41:01.839><c> step</c>

00:41:02.109 --> 00:41:02.119 align:start position:0%
similar to what we have done in the step
 

00:41:02.119 --> 00:41:04.550 align:start position:0%
similar to what we have done in the step
three<00:41:02.640><c> so</c><00:41:02.920><c> that</c><00:41:03.119><c> means</c><00:41:03.480><c> we</c><00:41:03.640><c> don't</c><00:41:03.920><c> have</c><00:41:04.119><c> to</c><00:41:04.400><c> go</c>

00:41:04.550 --> 00:41:04.560 align:start position:0%
three so that means we don't have to go
 

00:41:04.560 --> 00:41:06.150 align:start position:0%
three so that means we don't have to go
and<00:41:04.720><c> calculate</c><00:41:05.119><c> again</c><00:41:05.359><c> the</c><00:41:05.480><c> total</c><00:41:05.720><c> sales</c><00:41:06.040><c> we</c>

00:41:06.150 --> 00:41:06.160 align:start position:0%
and calculate again the total sales we
 

00:41:06.160 --> 00:41:08.750 align:start position:0%
and calculate again the total sales we
have<00:41:06.280><c> to</c><00:41:06.400><c> go</c><00:41:06.520><c> and</c><00:41:06.680><c> use</c><00:41:07.000><c> as</c><00:41:07.200><c> well</c><00:41:07.640><c> our</c><00:41:08.200><c> amazing</c>

00:41:08.750 --> 00:41:08.760 align:start position:0%
have to go and use as well our amazing
 

00:41:08.760 --> 00:41:12.510 align:start position:0%
have to go and use as well our amazing
first<00:41:09.119><c> C</c><00:41:09.800><c> so</c><00:41:10.200><c> let's</c><00:41:10.400><c> go</c><00:41:10.560><c> and</c><00:41:10.720><c> do</c><00:41:11.200><c> it</c><00:41:12.200><c> what</c><00:41:12.319><c> do</c><00:41:12.400><c> we</c>

00:41:12.510 --> 00:41:12.520 align:start position:0%
first C so let's go and do it what do we
 

00:41:12.520 --> 00:41:16.750 align:start position:0%
first C so let's go and do it what do we
need<00:41:12.760><c> we</c><00:41:12.839><c> need</c><00:41:13.119><c> the</c><00:41:13.400><c> customer</c><00:41:14.280><c> ID</c><00:41:15.280><c> like</c><00:41:15.760><c> this</c>

00:41:16.750 --> 00:41:16.760 align:start position:0%
need we need the customer ID like this
 

00:41:16.760 --> 00:41:18.910 align:start position:0%
need we need the customer ID like this
and<00:41:16.920><c> let's</c><00:41:17.119><c> do</c><00:41:17.359><c> basic</c><00:41:17.680><c> segmentations</c><00:41:18.520><c> using</c>

00:41:18.910 --> 00:41:18.920 align:start position:0%
and let's do basic segmentations using
 

00:41:18.920 --> 00:41:22.270 align:start position:0%
and let's do basic segmentations using
the<00:41:19.119><c> case</c><00:41:19.440><c> when</c><00:41:20.160><c> so</c><00:41:20.480><c> let's</c><00:41:20.680><c> say</c><00:41:20.920><c> case</c><00:41:21.200><c> when</c><00:41:21.920><c> the</c>

00:41:22.270 --> 00:41:22.280 align:start position:0%
the case when so let's say case when the
 

00:41:22.280 --> 00:41:26.670 align:start position:0%
the case when so let's say case when the
total<00:41:23.280><c> sales</c><00:41:24.240><c> if</c><00:41:24.440><c> it's</c><00:41:24.720><c> higher</c><00:41:25.119><c> than</c><00:41:25.560><c> 100</c><00:41:26.440><c> then</c>

00:41:26.670 --> 00:41:26.680 align:start position:0%
total sales if it's higher than 100 then
 

00:41:26.680 --> 00:41:28.790 align:start position:0%
total sales if it's higher than 100 then
let's<00:41:26.880><c> say</c><00:41:27.560><c> the</c><00:41:27.760><c> customer</c><00:41:28.160><c> going</c><00:41:28.280><c> to</c><00:41:28.440><c> belong</c>

00:41:28.790 --> 00:41:28.800 align:start position:0%
let's say the customer going to belong
 

00:41:28.800 --> 00:41:32.390 align:start position:0%
let's say the customer going to belong
to<00:41:28.960><c> the</c><00:41:29.160><c> group</c><00:41:29.960><c> high</c><00:41:30.839><c> and</c><00:41:31.119><c> let's</c><00:41:31.359><c> go</c><00:41:31.640><c> and</c><00:41:32.079><c> add</c>

00:41:32.390 --> 00:41:32.400 align:start position:0%
to the group high and let's go and add
 

00:41:32.400 --> 00:41:35.390 align:start position:0%
to the group high and let's go and add
another<00:41:33.079><c> category</c><00:41:34.079><c> if</c><00:41:34.240><c> it's</c><00:41:34.480><c> not</c><00:41:34.800><c> higher</c><00:41:35.079><c> than</c>

00:41:35.390 --> 00:41:35.400 align:start position:0%
another category if it's not higher than
 

00:41:35.400 --> 00:41:40.030 align:start position:0%
another category if it's not higher than
100<00:41:35.920><c> if</c><00:41:36.079><c> it</c><00:41:36.280><c> is</c><00:41:36.920><c> higher</c><00:41:37.920><c> than</c>

00:41:40.030 --> 00:41:40.040 align:start position:0%
100 if it is higher than
 

00:41:40.040 --> 00:41:43.270 align:start position:0%
100 if it is higher than
50<00:41:41.040><c> then</c><00:41:41.480><c> the</c><00:41:41.680><c> customer</c><00:41:42.079><c> going</c><00:41:42.160><c> to</c><00:41:42.319><c> belong</c><00:41:42.599><c> to</c>

00:41:43.270 --> 00:41:43.280 align:start position:0%
50 then the customer going to belong to
 

00:41:43.280 --> 00:41:46.550 align:start position:0%
50 then the customer going to belong to
medium<00:41:44.280><c> and</c><00:41:44.560><c> if</c><00:41:44.720><c> the</c><00:41:44.880><c> total</c><00:41:45.160><c> sales</c><00:41:45.560><c> is</c><00:41:46.000><c> less</c><00:41:46.319><c> or</c>

00:41:46.550 --> 00:41:46.560 align:start position:0%
medium and if the total sales is less or
 

00:41:46.560 --> 00:41:49.109 align:start position:0%
medium and if the total sales is less or
equal<00:41:46.839><c> to</c><00:41:47.040><c> 50</c><00:41:48.000><c> so</c><00:41:48.400><c> what's</c><00:41:48.560><c> going</c><00:41:48.680><c> to</c><00:41:48.839><c> happen</c>

00:41:49.109 --> 00:41:49.119 align:start position:0%
equal to 50 so what's going to happen
 

00:41:49.119 --> 00:41:50.870 align:start position:0%
equal to 50 so what's going to happen
we're<00:41:49.240><c> going</c><00:41:49.319><c> to</c><00:41:49.440><c> say</c><00:41:49.680><c> else</c><00:41:50.280><c> the</c><00:41:50.480><c> customer</c>

00:41:50.870 --> 00:41:50.880 align:start position:0%
we're going to say else the customer
 

00:41:50.880 --> 00:41:54.870 align:start position:0%
we're going to say else the customer
belong<00:41:51.359><c> to</c><00:41:51.599><c> the</c><00:41:52.240><c> low</c><00:41:52.920><c> category</c><00:41:53.920><c> so</c><00:41:54.200><c> that's</c><00:41:54.400><c> it</c>

00:41:54.870 --> 00:41:54.880 align:start position:0%
belong to the low category so that's it
 

00:41:54.880 --> 00:41:56.430 align:start position:0%
belong to the low category so that's it
we're<00:41:55.000><c> going</c><00:41:55.119><c> to</c><00:41:55.240><c> have</c><00:41:55.400><c> an</c><00:41:55.560><c> end</c><00:41:56.079><c> and</c><00:41:56.240><c> let's</c>

00:41:56.430 --> 00:41:56.440 align:start position:0%
we're going to have an end and let's
 

00:41:56.440 --> 00:41:58.390 align:start position:0%
we're going to have an end and let's
call<00:41:56.640><c> it</c><00:41:56.839><c> custom</c><00:41:57.240><c> more</c>

00:41:58.390 --> 00:41:58.400 align:start position:0%
call it custom more
 

00:41:58.400 --> 00:42:00.990 align:start position:0%
call it custom more
segments<00:41:59.400><c> all</c><00:41:59.640><c> right</c><00:42:00.160><c> but</c><00:42:00.319><c> of</c><00:42:00.480><c> course</c><00:42:00.760><c> we</c><00:42:00.880><c> have</c>

00:42:00.990 --> 00:42:01.000 align:start position:0%
segments all right but of course we have
 

00:42:01.000 --> 00:42:03.390 align:start position:0%
segments all right but of course we have
to<00:42:01.160><c> go</c><00:42:01.280><c> and</c><00:42:01.480><c> select</c><00:42:01.839><c> it</c><00:42:02.000><c> from</c><00:42:02.200><c> a</c><00:42:02.400><c> table</c><00:42:03.040><c> and</c>

00:42:03.390 --> 00:42:03.400 align:start position:0%
to go and select it from a table and
 

00:42:03.400 --> 00:42:07.750 align:start position:0%
to go and select it from a table and
it's<00:42:03.520><c> going</c><00:42:03.640><c> to</c><00:42:03.800><c> be</c><00:42:04.000><c> our</c><00:42:04.400><c> CTE</c><00:42:04.960><c> so</c><00:42:05.920><c> total</c><00:42:06.760><c> sales</c>

00:42:07.750 --> 00:42:07.760 align:start position:0%
it's going to be our CTE so total sales
 

00:42:07.760 --> 00:42:10.230 align:start position:0%
it's going to be our CTE so total sales
and<00:42:08.079><c> let's</c><00:42:08.319><c> put</c><00:42:08.520><c> it</c><00:42:08.640><c> in</c><00:42:08.800><c> our</c><00:42:09.040><c> new</c><00:42:09.280><c> CD</c><00:42:10.000><c> and</c><00:42:10.160><c> I</c>

00:42:10.230 --> 00:42:10.240 align:start position:0%
and let's put it in our new CD and I
 

00:42:10.240 --> 00:42:11.870 align:start position:0%
and let's put it in our new CD and I
would<00:42:10.400><c> like</c><00:42:10.560><c> to</c><00:42:10.760><c> test</c><00:42:11.040><c> it</c><00:42:11.240><c> before</c><00:42:11.640><c> like</c>

00:42:11.870 --> 00:42:11.880 align:start position:0%
would like to test it before like
 

00:42:11.880 --> 00:42:14.349 align:start position:0%
would like to test it before like
putting<00:42:12.200><c> it</c><00:42:12.480><c> inside</c><00:42:12.880><c> our</c><00:42:13.160><c> main</c><00:42:13.359><c> query</c><00:42:14.119><c> that's</c>

00:42:14.349 --> 00:42:14.359 align:start position:0%
putting it inside our main query that's
 

00:42:14.359 --> 00:42:16.870 align:start position:0%
putting it inside our main query that's
why<00:42:14.599><c> I</c><00:42:14.720><c> will</c><00:42:14.960><c> put</c><00:42:15.319><c> everything</c><00:42:15.760><c> in</c><00:42:16.000><c> comments</c><00:42:16.680><c> in</c>

00:42:16.870 --> 00:42:16.880 align:start position:0%
why I will put everything in comments in
 

00:42:16.880 --> 00:42:20.790 align:start position:0%
why I will put everything in comments in
my<00:42:17.079><c> main</c><00:42:17.359><c> query</c><00:42:17.800><c> since</c><00:42:18.119><c> it</c><00:42:18.240><c> is</c><00:42:18.480><c> ined</c><00:42:19.200><c> CD</c><00:42:20.079><c> sadly</c>

00:42:20.790 --> 00:42:20.800 align:start position:0%
my main query since it is ined CD sadly
 

00:42:20.800 --> 00:42:24.309 align:start position:0%
my main query since it is ined CD sadly
and<00:42:20.960><c> we</c><00:42:21.040><c> will</c><00:42:21.280><c> just</c><00:42:21.440><c> go</c><00:42:21.599><c> and</c><00:42:21.800><c> select</c><00:42:22.359><c> our</c><00:42:22.680><c> new</c>

00:42:24.309 --> 00:42:24.319 align:start position:0%
and we will just go and select our new
 

00:42:24.319 --> 00:42:26.910 align:start position:0%
and we will just go and select our new
necessity<00:42:25.319><c> like</c><00:42:25.480><c> we</c><00:42:25.599><c> have</c><00:42:25.760><c> done</c><00:42:26.040><c> before</c><00:42:26.640><c> so</c>

00:42:26.910 --> 00:42:26.920 align:start position:0%
necessity like we have done before so
 

00:42:26.920 --> 00:42:29.470 align:start position:0%
necessity like we have done before so
let's<00:42:27.400><c> go</c><00:42:27.559><c> and</c><00:42:27.839><c> executed</c><00:42:28.760><c> now</c><00:42:29.000><c> as</c><00:42:29.079><c> you</c><00:42:29.160><c> can</c><00:42:29.280><c> see</c>

00:42:29.470 --> 00:42:29.480 align:start position:0%
let's go and executed now as you can see
 

00:42:29.480 --> 00:42:31.950 align:start position:0%
let's go and executed now as you can see
in<00:42:29.559><c> the</c><00:42:29.680><c> output</c><00:42:30.119><c> we</c><00:42:30.240><c> have</c><00:42:30.440><c> two</c><00:42:30.760><c> customers</c><00:42:31.760><c> with</c>

00:42:31.950 --> 00:42:31.960 align:start position:0%
in the output we have two customers with
 

00:42:31.960 --> 00:42:34.670 align:start position:0%
in the output we have two customers with
the<00:42:32.200><c> category</c><00:42:32.760><c> high</c><00:42:33.640><c> and</c><00:42:33.800><c> two</c><00:42:34.040><c> customers</c><00:42:34.559><c> with</c>

00:42:34.670 --> 00:42:34.680 align:start position:0%
the category high and two customers with
 

00:42:34.680 --> 00:42:36.510 align:start position:0%
the category high and two customers with
the<00:42:34.839><c> medium</c><00:42:35.559><c> but</c><00:42:35.720><c> in</c><00:42:35.800><c> order</c><00:42:36.040><c> to</c><00:42:36.200><c> make</c><00:42:36.319><c> sure</c>

00:42:36.510 --> 00:42:36.520 align:start position:0%
the medium but in order to make sure
 

00:42:36.520 --> 00:42:38.030 align:start position:0%
the medium but in order to make sure
that<00:42:36.720><c> everything</c><00:42:37.119><c> working</c><00:42:37.520><c> perfectly</c><00:42:37.960><c> I</c>

00:42:38.030 --> 00:42:38.040 align:start position:0%
that everything working perfectly I
 

00:42:38.040 --> 00:42:40.470 align:start position:0%
that everything working perfectly I
would<00:42:38.200><c> like</c><00:42:38.319><c> to</c><00:42:38.440><c> go</c><00:42:38.599><c> and</c><00:42:38.800><c> add</c><00:42:39.040><c> the</c><00:42:39.200><c> total</c><00:42:39.520><c> sales</c>

00:42:40.470 --> 00:42:40.480 align:start position:0%
would like to go and add the total sales
 

00:42:40.480 --> 00:42:42.430 align:start position:0%
would like to go and add the total sales
just<00:42:40.599><c> to</c><00:42:40.720><c> see</c><00:42:40.920><c> the</c><00:42:41.079><c> numbers</c><00:42:41.680><c> so</c><00:42:41.920><c> let's</c><00:42:42.119><c> go</c><00:42:42.240><c> and</c>

00:42:42.430 --> 00:42:42.440 align:start position:0%
just to see the numbers so let's go and
 

00:42:42.440 --> 00:42:44.390 align:start position:0%
just to see the numbers so let's go and
execute<00:42:42.800><c> it</c><00:42:43.160><c> well</c><00:42:43.480><c> you</c><00:42:43.599><c> can</c><00:42:43.760><c> see</c><00:42:44.079><c> everything</c>

00:42:44.390 --> 00:42:44.400 align:start position:0%
execute it well you can see everything
 

00:42:44.400 --> 00:42:47.270 align:start position:0%
execute it well you can see everything
is<00:42:44.599><c> correct</c><00:42:45.040><c> so</c><00:42:45.400><c> those</c><00:42:45.640><c> customers</c><00:42:46.280><c> having</c>

00:42:47.270 --> 00:42:47.280 align:start position:0%
is correct so those customers having
 

00:42:47.280 --> 00:42:49.750 align:start position:0%
is correct so those customers having
higher<00:42:47.640><c> than</c><00:42:48.119><c> 100</c><00:42:48.480><c> in</c><00:42:48.599><c> the</c><00:42:48.760><c> total</c><00:42:49.079><c> sales</c><00:42:49.599><c> and</c>

00:42:49.750 --> 00:42:49.760 align:start position:0%
higher than 100 in the total sales and
 

00:42:49.760 --> 00:42:52.030 align:start position:0%
higher than 100 in the total sales and
those<00:42:49.960><c> two</c><00:42:50.240><c> having</c><00:42:50.599><c> higher</c><00:42:50.920><c> than</c><00:42:51.240><c> 50</c><00:42:51.880><c> but</c>

00:42:52.030 --> 00:42:52.040 align:start position:0%
those two having higher than 50 but
 

00:42:52.040 --> 00:42:53.790 align:start position:0%
those two having higher than 50 but
let's<00:42:52.240><c> go</c><00:42:52.400><c> and</c><00:42:52.559><c> change</c><00:42:52.880><c> stuff</c><00:42:53.160><c> around</c><00:42:53.559><c> I</c><00:42:53.640><c> would</c>

00:42:53.790 --> 00:42:53.800 align:start position:0%
let's go and change stuff around I would
 

00:42:53.800 --> 00:42:56.349 align:start position:0%
let's go and change stuff around I would
like<00:42:53.920><c> to</c><00:42:54.079><c> have</c><00:42:54.200><c> it</c><00:42:54.400><c> like</c><00:42:54.720><c> 80</c><00:42:55.400><c> as</c><00:42:55.520><c> a</c><00:42:55.640><c> medium</c><00:42:56.240><c> just</c>

00:42:56.349 --> 00:42:56.359 align:start position:0%
like to have it like 80 as a medium just
 

00:42:56.359 --> 00:42:58.430 align:start position:0%
like to have it like 80 as a medium just
in<00:42:56.480><c> order</c><00:42:56.720><c> to</c><00:42:56.839><c> have</c><00:42:57.240><c> low</c><00:42:57.680><c> so</c><00:42:57.920><c> with</c><00:42:58.119><c> that</c><00:42:58.319><c> the</c>

00:42:58.430 --> 00:42:58.440 align:start position:0%
in order to have low so with that the
 

00:42:58.440 --> 00:43:00.710 align:start position:0%
in order to have low so with that the
customer<00:42:58.800><c> number</c><00:42:59.040><c> two</c><00:42:59.559><c> having</c><00:42:59.960><c> lower</c><00:43:00.240><c> sales</c>

00:43:00.710 --> 00:43:00.720 align:start position:0%
customer number two having lower sales
 

00:43:00.720 --> 00:43:02.790 align:start position:0%
customer number two having lower sales
than<00:43:01.079><c> 80</c><00:43:01.880><c> that's</c><00:43:02.040><c> why</c><00:43:02.200><c> we</c><00:43:02.280><c> are</c><00:43:02.400><c> getting</c><00:43:02.640><c> the</c>

00:43:02.790 --> 00:43:02.800 align:start position:0%
than 80 that's why we are getting the
 

00:43:02.800 --> 00:43:04.510 align:start position:0%
than 80 that's why we are getting the
segment<00:43:03.119><c> low</c><00:43:03.520><c> everything</c><00:43:03.839><c> is</c><00:43:03.960><c> done</c><00:43:04.280><c> and</c><00:43:04.400><c> we</c>

00:43:04.510 --> 00:43:04.520 align:start position:0%
segment low everything is done and we
 

00:43:04.520 --> 00:43:06.630 align:start position:0%
segment low everything is done and we
have<00:43:04.680><c> segmented</c><00:43:05.160><c> the</c><00:43:05.280><c> users</c><00:43:05.800><c> into</c><00:43:06.160><c> different</c>

00:43:06.630 --> 00:43:06.640 align:start position:0%
have segmented the users into different
 

00:43:06.640 --> 00:43:09.069 align:start position:0%
have segmented the users into different
categories<00:43:07.640><c> so</c><00:43:08.079><c> I</c><00:43:08.200><c> don't</c><00:43:08.400><c> need</c><00:43:08.559><c> to</c><00:43:08.720><c> test</c>

00:43:09.069 --> 00:43:09.079 align:start position:0%
categories so I don't need to test
 

00:43:09.079 --> 00:43:11.510 align:start position:0%
categories so I don't need to test
anymore<00:43:09.800><c> let's</c><00:43:10.040><c> go</c><00:43:10.280><c> integrate</c><00:43:10.720><c> it</c><00:43:10.920><c> in</c><00:43:11.119><c> our</c>

00:43:11.510 --> 00:43:11.520 align:start position:0%
anymore let's go integrate it in our
 

00:43:11.520 --> 00:43:13.510 align:start position:0%
anymore let's go integrate it in our
main<00:43:11.839><c> query</c><00:43:12.400><c> so</c><00:43:12.559><c> we're</c><00:43:12.680><c> going</c><00:43:12.800><c> to</c><00:43:12.920><c> do</c><00:43:13.160><c> the</c><00:43:13.280><c> same</c>

00:43:13.510 --> 00:43:13.520 align:start position:0%
main query so we're going to do the same
 

00:43:13.520 --> 00:43:15.549 align:start position:0%
main query so we're going to do the same
things<00:43:13.880><c> over</c><00:43:14.160><c> here</c><00:43:14.400><c> we're</c><00:43:14.520><c> going</c><00:43:14.640><c> to</c><00:43:14.800><c> say</c><00:43:15.119><c> Live</c>

00:43:15.549 --> 00:43:15.559 align:start position:0%
things over here we're going to say Live
 

00:43:15.559 --> 00:43:19.990 align:start position:0%
things over here we're going to say Live
join<00:43:16.559><c> and</c><00:43:16.680><c> we're</c><00:43:16.800><c> going</c><00:43:16.880><c> to</c><00:43:17.079><c> get</c><00:43:17.440><c> our</c><00:43:18.200><c> new</c><00:43:19.200><c> CTE</c>

00:43:19.990 --> 00:43:20.000 align:start position:0%
join and we're going to get our new CTE
 

00:43:20.000 --> 00:43:20.829 align:start position:0%
join and we're going to get our new CTE
so

00:43:20.829 --> 00:43:20.839 align:start position:0%
so
 

00:43:20.839 --> 00:43:26.230 align:start position:0%
so
ccs<00:43:21.839><c> and</c><00:43:22.599><c> we</c><00:43:22.720><c> have</c><00:43:22.839><c> to</c><00:43:23.040><c> do</c><00:43:23.640><c> the</c><00:43:24.400><c> join</c><00:43:25.240><c> condition</c>

00:43:26.230 --> 00:43:26.240 align:start position:0%
ccs and we have to do the join condition
 

00:43:26.240 --> 00:43:27.630 align:start position:0%
ccs and we have to do the join condition
don't<00:43:26.440><c> forget</c><00:43:26.720><c> to</c><00:43:26.839><c> change</c>

00:43:27.630 --> 00:43:27.640 align:start position:0%
don't forget to change
 

00:43:27.640 --> 00:43:30.190 align:start position:0%
don't forget to change
and<00:43:28.000><c> we</c><00:43:28.160><c> have</c><00:43:28.280><c> to</c><00:43:28.480><c> select</c><00:43:28.960><c> our</c><00:43:29.440><c> new</c><00:43:29.839><c> nice</c>

00:43:30.190 --> 00:43:30.200 align:start position:0%
and we have to select our new nice
 

00:43:30.200 --> 00:43:31.910 align:start position:0%
and we have to select our new nice
information<00:43:30.920><c> it's</c><00:43:31.040><c> going</c><00:43:31.160><c> to</c><00:43:31.319><c> be</c><00:43:31.680><c> the</c>

00:43:31.910 --> 00:43:31.920 align:start position:0%
information it's going to be the
 

00:43:31.920 --> 00:43:34.470 align:start position:0%
information it's going to be the
customer<00:43:32.400><c> segments</c><00:43:33.160><c> and</c><00:43:33.319><c> now</c><00:43:33.559><c> we</c><00:43:33.680><c> can</c><00:43:33.920><c> go</c><00:43:34.160><c> and</c>

00:43:34.470 --> 00:43:34.480 align:start position:0%
customer segments and now we can go and
 

00:43:34.480 --> 00:43:37.230 align:start position:0%
customer segments and now we can go and
execute<00:43:35.200><c> the</c><00:43:35.400><c> whole</c><00:43:35.760><c> thing</c><00:43:36.119><c> so</c><00:43:36.319><c> we</c><00:43:36.480><c> have</c><00:43:36.720><c> now</c>

00:43:37.230 --> 00:43:37.240 align:start position:0%
execute the whole thing so we have now
 

00:43:37.240 --> 00:43:39.790 align:start position:0%
execute the whole thing so we have now
like<00:43:37.599><c> four</c><00:43:38.160><c> different</c><00:43:38.440><c> CTE</c><00:43:39.079><c> and</c><00:43:39.280><c> one</c><00:43:39.480><c> main</c>

00:43:39.790 --> 00:43:39.800 align:start position:0%
like four different CTE and one main
 

00:43:39.800 --> 00:43:41.750 align:start position:0%
like four different CTE and one main
query<00:43:40.440><c> and</c><00:43:40.559><c> now</c><00:43:40.680><c> we</c><00:43:40.800><c> can</c><00:43:40.920><c> see</c><00:43:41.079><c> in</c><00:43:41.160><c> the</c><00:43:41.280><c> output</c>

00:43:41.750 --> 00:43:41.760 align:start position:0%
query and now we can see in the output
 

00:43:41.760 --> 00:43:43.430 align:start position:0%
query and now we can see in the output
we<00:43:41.880><c> got</c><00:43:42.119><c> all</c><00:43:42.359><c> three</c><00:43:42.559><c> informations</c><00:43:43.160><c> from</c><00:43:43.319><c> the</c>

00:43:43.430 --> 00:43:43.440 align:start position:0%
we got all three informations from the
 

00:43:43.440 --> 00:43:46.069 align:start position:0%
we got all three informations from the
table<00:43:43.800><c> customers</c><00:43:44.480><c> the</c><00:43:44.599><c> first</c><00:43:44.880><c> city</c><00:43:45.520><c> second</c>

00:43:46.069 --> 00:43:46.079 align:start position:0%
table customers the first city second
 

00:43:46.079 --> 00:43:48.470 align:start position:0%
table customers the first city second
third<00:43:46.640><c> and</c><00:43:46.839><c> this</c><00:43:46.960><c> is</c><00:43:47.119><c> our</c><00:43:47.359><c> new</c><00:43:47.839><c> column</c><00:43:48.200><c> that</c><00:43:48.319><c> we</c>

00:43:48.470 --> 00:43:48.480 align:start position:0%
third and this is our new column that we
 

00:43:48.480 --> 00:43:50.750 align:start position:0%
third and this is our new column that we
just<00:43:48.720><c> created</c><00:43:49.319><c> so</c><00:43:49.559><c> again</c><00:43:49.800><c> we</c><00:43:49.960><c> have</c><00:43:50.119><c> done</c><00:43:50.400><c> this</c>

00:43:50.750 --> 00:43:50.760 align:start position:0%
just created so again we have done this
 

00:43:50.760 --> 00:43:54.950 align:start position:0%
just created so again we have done this
using<00:43:51.760><c> a</c><00:43:52.280><c> necessity</c><00:43:53.280><c> like</c><00:43:53.599><c> this</c><00:43:54.160><c> let</c><00:43:54.280><c> me</c><00:43:54.520><c> just</c>

00:43:54.950 --> 00:43:54.960 align:start position:0%
using a necessity like this let me just
 

00:43:54.960 --> 00:43:57.670 align:start position:0%
using a necessity like this let me just
add<00:43:55.200><c> it</c>

00:43:57.670 --> 00:43:57.680 align:start position:0%
add it
 

00:43:57.680 --> 00:43:59.829 align:start position:0%
add it
and<00:43:57.880><c> it</c><00:43:58.040><c> was</c><00:43:58.280><c> really</c><00:43:58.520><c> easy</c><00:43:58.800><c> to</c><00:43:59.000><c> extend</c><00:43:59.480><c> and</c><00:43:59.640><c> to</c>

00:43:59.829 --> 00:43:59.839 align:start position:0%
and it was really easy to extend and to
 

00:43:59.839 --> 00:44:02.069 align:start position:0%
and it was really easy to extend and to
add<00:44:00.040><c> to</c><00:44:00.200><c> our</c><00:44:00.400><c> report</c><00:44:01.200><c> all</c><00:44:01.319><c> right</c><00:44:01.599><c> guys</c><00:44:01.720><c> so</c><00:44:01.920><c> with</c>

00:44:02.069 --> 00:44:02.079 align:start position:0%
add to our report all right guys so with
 

00:44:02.079 --> 00:44:04.109 align:start position:0%
add to our report all right guys so with
that<00:44:02.200><c> we</c><00:44:02.319><c> have</c><00:44:02.440><c> done</c><00:44:02.680><c> like</c><00:44:02.880><c> a</c><00:44:03.000><c> mini</c><00:44:03.359><c> project</c>

00:44:04.109 --> 00:44:04.119 align:start position:0%
that we have done like a mini project
 

00:44:04.119 --> 00:44:05.790 align:start position:0%
that we have done like a mini project
where<00:44:04.319><c> we</c><00:44:04.440><c> have</c><00:44:04.640><c> analyzed</c><00:44:05.160><c> the</c><00:44:05.319><c> customer</c>

00:44:05.790 --> 00:44:05.800 align:start position:0%
where we have analyzed the customer
 

00:44:05.800 --> 00:44:07.870 align:start position:0%
where we have analyzed the customer
information<00:44:06.640><c> based</c><00:44:06.960><c> on</c><00:44:07.119><c> different</c><00:44:07.520><c> aspects</c>

00:44:07.870 --> 00:44:07.880 align:start position:0%
information based on different aspects
 

00:44:07.880 --> 00:44:10.030 align:start position:0%
information based on different aspects
from<00:44:08.040><c> our</c><00:44:08.319><c> data</c><00:44:08.920><c> and</c><00:44:09.079><c> we</c><00:44:09.240><c> have</c><00:44:09.400><c> done</c><00:44:09.559><c> it</c><00:44:09.800><c> like</c>

00:44:10.030 --> 00:44:10.040 align:start position:0%
from our data and we have done it like
 

00:44:10.040 --> 00:44:11.990 align:start position:0%
from our data and we have done it like
step<00:44:10.400><c> by</c><00:44:10.680><c> step</c><00:44:11.160><c> and</c><00:44:11.280><c> now</c><00:44:11.440><c> you</c><00:44:11.559><c> have</c><00:44:11.720><c> like</c><00:44:11.880><c> a</c>

00:44:11.990 --> 00:44:12.000 align:start position:0%
step by step and now you have like a
 

00:44:12.000 --> 00:44:14.190 align:start position:0%
step by step and now you have like a
feeling<00:44:12.480><c> on</c><00:44:12.680><c> how</c><00:44:12.800><c> to</c><00:44:13.079><c> write</c><00:44:13.359><c> complex</c><00:44:13.760><c> SQL</c>

00:44:14.190 --> 00:44:14.200 align:start position:0%
feeling on how to write complex SQL
 

00:44:14.200 --> 00:44:16.910 align:start position:0%
feeling on how to write complex SQL
queries<00:44:15.000><c> using</c><00:44:15.359><c> the</c><00:44:15.520><c> help</c><00:44:15.720><c> of</c><00:44:15.839><c> the</c><00:44:15.960><c> CTE</c><00:44:16.680><c> and</c><00:44:16.800><c> we</c>

00:44:16.910 --> 00:44:16.920 align:start position:0%
queries using the help of the CTE and we
 

00:44:16.920 --> 00:44:18.910 align:start position:0%
queries using the help of the CTE and we
have<00:44:17.079><c> done</c><00:44:17.280><c> it</c><00:44:17.480><c> like</c><00:44:17.760><c> step</c><00:44:18.079><c> by</c><00:44:18.319><c> step</c><00:44:18.559><c> so</c><00:44:18.720><c> as</c><00:44:18.839><c> you</c>

00:44:18.910 --> 00:44:18.920 align:start position:0%
have done it like step by step so as you
 

00:44:18.920 --> 00:44:21.230 align:start position:0%
have done it like step by step so as you
can<00:44:19.079><c> see</c><00:44:19.720><c> if</c><00:44:19.800><c> you</c><00:44:19.960><c> go</c><00:44:20.160><c> through</c><00:44:20.440><c> the</c><00:44:20.640><c> scripts</c>

00:44:21.230 --> 00:44:21.240 align:start position:0%
can see if you go through the scripts
 

00:44:21.240 --> 00:44:23.190 align:start position:0%
can see if you go through the scripts
you<00:44:21.359><c> can</c><00:44:21.839><c> understand</c><00:44:22.079><c> okay</c><00:44:22.319><c> it</c><00:44:22.400><c> is</c><00:44:22.680><c> divided</c>

00:44:23.190 --> 00:44:23.200 align:start position:0%
you can understand okay it is divided
 

00:44:23.200 --> 00:44:25.829 align:start position:0%
you can understand okay it is divided
into<00:44:23.520><c> multiple</c><00:44:24.040><c> steps</c><00:44:24.640><c> and</c><00:44:24.880><c> each</c><00:44:25.119><c> block</c><00:44:25.480><c> is</c>

00:44:25.829 --> 00:44:25.839 align:start position:0%
into multiple steps and each block is
 

00:44:25.839 --> 00:44:28.430 align:start position:0%
into multiple steps and each block is
responsible<00:44:26.440><c> for</c><00:44:27.119><c> one</c><00:44:27.359><c> specific</c><00:44:27.839><c> problem</c><00:44:28.280><c> of</c>

00:44:28.430 --> 00:44:28.440 align:start position:0%
responsible for one specific problem of
 

00:44:28.440 --> 00:44:30.870 align:start position:0%
responsible for one specific problem of
the<00:44:28.640><c> whole</c><00:44:29.079><c> report</c><00:44:29.880><c> and</c><00:44:30.079><c> this</c><00:44:30.160><c> is</c><00:44:30.359><c> exactly</c><00:44:30.720><c> the</c>

00:44:30.870 --> 00:44:30.880 align:start position:0%
the whole report and this is exactly the
 

00:44:30.880 --> 00:44:34.030 align:start position:0%
the whole report and this is exactly the
power<00:44:31.079><c> of</c><00:44:31.200><c> the</c><00:44:31.319><c> CT</c><00:44:31.760><c> it</c><00:44:31.960><c> introduce</c><00:44:33.040><c> modularity</c>

00:44:34.030 --> 00:44:34.040 align:start position:0%
power of the CT it introduce modularity
 

00:44:34.040 --> 00:44:37.630 align:start position:0%
power of the CT it introduce modularity
so<00:44:34.520><c> each</c><00:44:34.800><c> CTE</c><00:44:35.480><c> is</c><00:44:35.880><c> self-contained</c><00:44:36.880><c> and</c><00:44:37.280><c> talk</c>

00:44:37.630 --> 00:44:37.640 align:start position:0%
so each CTE is self-contained and talk
 

00:44:37.640 --> 00:44:39.910 align:start position:0%
so each CTE is self-contained and talk
about<00:44:38.040><c> one</c><00:44:38.319><c> issue</c><00:44:38.839><c> and</c><00:44:38.960><c> this</c><00:44:39.079><c> is</c><00:44:39.359><c> amazing</c><00:44:39.760><c> way</c>

00:44:39.910 --> 00:44:39.920 align:start position:0%
about one issue and this is amazing way
 

00:44:39.920 --> 00:44:41.990 align:start position:0%
about one issue and this is amazing way
on<00:44:40.160><c> how</c><00:44:40.319><c> to</c><00:44:40.520><c> organize</c><00:44:41.119><c> your</c><00:44:41.359><c> project</c><00:44:41.680><c> using</c>

00:44:41.990 --> 00:44:42.000 align:start position:0%
on how to organize your project using
 

00:44:42.000 --> 00:44:47.549 align:start position:0%
on how to organize your project using
SQL<00:44:42.800><c> and</c><00:44:42.960><c> how</c><00:44:43.200><c> to</c><00:44:43.400><c> structure</c><00:44:43.839><c> your</c>

00:44:47.549 --> 00:44:47.559 align:start position:0%
 
 

00:44:47.559 --> 00:44:49.829 align:start position:0%
 
work<00:44:48.559><c> all</c><00:44:48.720><c> right</c><00:44:48.920><c> my</c><00:44:49.079><c> friends</c><00:44:49.319><c> so</c><00:44:49.480><c> now</c><00:44:49.640><c> let's</c>

00:44:49.829 --> 00:44:49.839 align:start position:0%
work all right my friends so now let's
 

00:44:49.839 --> 00:44:51.309 align:start position:0%
work all right my friends so now let's
have<00:44:50.000><c> little</c><00:44:50.280><c> break</c><00:44:50.559><c> in</c><00:44:50.640><c> order</c><00:44:50.880><c> to</c><00:44:51.079><c> have</c><00:44:51.200><c> a</c>

00:44:51.309 --> 00:44:51.319 align:start position:0%
have little break in order to have a
 

00:44:51.319 --> 00:44:54.670 align:start position:0%
have little break in order to have a
real<00:44:51.559><c> talk</c><00:44:51.800><c> about</c><00:44:52.000><c> the</c><00:44:52.160><c> CTE</c><00:44:52.880><c> but</c><00:44:53.079><c> first</c><00:44:53.400><c> some</c>

00:44:54.670 --> 00:44:54.680 align:start position:0%
real talk about the CTE but first some
 

00:44:54.680 --> 00:44:56.630 align:start position:0%
real talk about the CTE but first some
coffee<00:44:55.680><c> and</c><00:44:55.839><c> now</c><00:44:55.960><c> I</c><00:44:56.079><c> can</c><00:44:56.200><c> see</c><00:44:56.400><c> that</c><00:44:56.520><c> I'm</c>

00:44:56.630 --> 00:44:56.640 align:start position:0%
coffee and now I can see that I'm
 

00:44:56.640 --> 00:44:58.790 align:start position:0%
coffee and now I can see that I'm
working<00:44:56.920><c> with</c><00:44:57.079><c> with</c><00:44:57.200><c> SQL</c><00:44:57.720><c> since</c><00:44:58.200><c> really</c><00:44:58.520><c> long</c>

00:44:58.790 --> 00:44:58.800 align:start position:0%
working with with SQL since really long
 

00:44:58.800 --> 00:45:01.390 align:start position:0%
working with with SQL since really long
long<00:44:59.040><c> time</c><00:44:59.240><c> ago</c><00:44:59.760><c> over</c><00:45:00.040><c> 15</c><00:45:00.440><c> years</c><00:45:00.960><c> and</c><00:45:01.160><c> I</c><00:45:01.280><c> can</c>

00:45:01.390 --> 00:45:01.400 align:start position:0%
long time ago over 15 years and I can
 

00:45:01.400 --> 00:45:03.390 align:start position:0%
long time ago over 15 years and I can
say<00:45:01.599><c> as</c><00:45:01.760><c> well</c><00:45:01.960><c> I</c><00:45:02.079><c> have</c><00:45:02.240><c> met</c><00:45:02.520><c> a</c><00:45:02.680><c> lot</c><00:45:02.839><c> of</c><00:45:03.000><c> SQL</c>

00:45:03.390 --> 00:45:03.400 align:start position:0%
say as well I have met a lot of SQL
 

00:45:03.400 --> 00:45:05.510 align:start position:0%
say as well I have met a lot of SQL
developers<00:45:04.040><c> in</c><00:45:04.200><c> different</c><00:45:04.520><c> projects</c><00:45:05.200><c> and</c><00:45:05.400><c> if</c>

00:45:05.510 --> 00:45:05.520 align:start position:0%
developers in different projects and if
 

00:45:05.520 --> 00:45:07.670 align:start position:0%
developers in different projects and if
there<00:45:05.680><c> is</c><00:45:05.920><c> one</c><00:45:06.200><c> thing</c><00:45:06.480><c> that</c><00:45:06.760><c> all</c><00:45:07.000><c> those</c><00:45:07.240><c> SQL</c>

00:45:07.670 --> 00:45:07.680 align:start position:0%
there is one thing that all those SQL
 

00:45:07.680 --> 00:45:10.829 align:start position:0%
there is one thing that all those SQL
developers<00:45:08.280><c> love</c><00:45:08.800><c> is</c><00:45:09.280><c> the</c><00:45:09.480><c> CTE</c><00:45:10.400><c> they</c><00:45:10.599><c> love</c>

00:45:10.829 --> 00:45:10.839 align:start position:0%
developers love is the CTE they love
 

00:45:10.839 --> 00:45:12.870 align:start position:0%
developers love is the CTE they love
using<00:45:11.200><c> it</c><00:45:11.599><c> everywhere</c><00:45:12.160><c> like</c><00:45:12.359><c> each</c><00:45:12.559><c> time</c><00:45:12.720><c> they</c>

00:45:12.870 --> 00:45:12.880 align:start position:0%
using it everywhere like each time they
 

00:45:12.880 --> 00:45:15.150 align:start position:0%
using it everywhere like each time they
write<00:45:13.079><c> a</c><00:45:13.240><c> query</c><00:45:14.040><c> they</c><00:45:14.200><c> going</c><00:45:14.319><c> to</c><00:45:14.440><c> be</c><00:45:14.680><c> writing</c>

00:45:15.150 --> 00:45:15.160 align:start position:0%
write a query they going to be writing
 

00:45:15.160 --> 00:45:17.670 align:start position:0%
write a query they going to be writing
SQL<00:45:15.760><c> CTE</c><00:45:16.480><c> and</c><00:45:16.599><c> of</c><00:45:16.760><c> course</c><00:45:16.960><c> it's</c><00:45:17.160><c> fine</c><00:45:17.359><c> it's</c><00:45:17.520><c> not</c>

00:45:17.670 --> 00:45:17.680 align:start position:0%
SQL CTE and of course it's fine it's not
 

00:45:17.680 --> 00:45:19.790 align:start position:0%
SQL CTE and of course it's fine it's not
a<00:45:17.839><c> bad</c><00:45:18.079><c> thing</c><00:45:18.599><c> but</c><00:45:18.760><c> the</c><00:45:18.920><c> problem</c><00:45:19.200><c> with</c><00:45:19.400><c> that</c>

00:45:19.790 --> 00:45:19.800 align:start position:0%
a bad thing but the problem with that
 

00:45:19.800 --> 00:45:21.870 align:start position:0%
a bad thing but the problem with that
they<00:45:20.079><c> overuse</c><00:45:20.640><c> it</c><00:45:21.079><c> of</c><00:45:21.200><c> course</c><00:45:21.440><c> not</c><00:45:21.599><c> all</c><00:45:21.760><c> of</c>

00:45:21.870 --> 00:45:21.880 align:start position:0%
they overuse it of course not all of
 

00:45:21.880 --> 00:45:24.349 align:start position:0%
they overuse it of course not all of
them<00:45:22.280><c> pass</c><00:45:22.680><c> a</c><00:45:22.760><c> lot</c><00:45:22.960><c> of</c><00:45:23.240><c> skl</c><00:45:23.640><c> developers</c>

00:45:24.349 --> 00:45:24.359 align:start position:0%
them pass a lot of skl developers
 

00:45:24.359 --> 00:45:27.390 align:start position:0%
them pass a lot of skl developers
overuse<00:45:25.040><c> using</c><00:45:25.359><c> the</c><00:45:25.520><c> CTE</c><00:45:26.319><c> of</c><00:45:26.440><c> course</c><00:45:26.640><c> the</c><00:45:27.240><c> is</c>

00:45:27.390 --> 00:45:27.400 align:start position:0%
overuse using the CTE of course the is
 

00:45:27.400 --> 00:45:30.670 align:start position:0%
overuse using the CTE of course the is
very<00:45:27.640><c> powerful</c><00:45:28.319><c> but</c><00:45:28.599><c> with</c><00:45:28.920><c> power</c><00:45:29.319><c> comes</c><00:45:29.800><c> great</c>

00:45:30.670 --> 00:45:30.680 align:start position:0%
very powerful but with power comes great
 

00:45:30.680 --> 00:45:34.390 align:start position:0%
very powerful but with power comes great
responsibility<00:45:31.800><c> remember</c><00:45:32.800><c> with</c><00:45:33.040><c> great</c><00:45:33.400><c> power</c>

00:45:34.390 --> 00:45:34.400 align:start position:0%
responsibility remember with great power
 

00:45:34.400 --> 00:45:35.990 align:start position:0%
responsibility remember with great power
comes<00:45:34.720><c> great</c>

00:45:35.990 --> 00:45:36.000 align:start position:0%
comes great
 

00:45:36.000 --> 00:45:38.230 align:start position:0%
comes great
responsibility<00:45:37.000><c> so</c><00:45:37.200><c> my</c><00:45:37.400><c> advice</c><00:45:37.720><c> for</c><00:45:37.880><c> you</c>

00:45:38.230 --> 00:45:38.240 align:start position:0%
responsibility so my advice for you
 

00:45:38.240 --> 00:45:40.190 align:start position:0%
responsibility so my advice for you
especially<00:45:38.640><c> if</c><00:45:38.760><c> you</c><00:45:38.880><c> are</c><00:45:39.040><c> new</c><00:45:39.280><c> to</c><00:45:39.440><c> the</c><00:45:39.559><c> CTE</c>

00:45:40.190 --> 00:45:40.200 align:start position:0%
especially if you are new to the CTE
 

00:45:40.200 --> 00:45:43.309 align:start position:0%
especially if you are new to the CTE
that'ss<00:45:41.000><c> try</c><00:45:41.280><c> to</c><00:45:41.520><c> not</c><00:45:41.839><c> add</c><00:45:42.119><c> a</c><00:45:42.280><c> new</c><00:45:42.480><c> CTE</c><00:45:43.079><c> each</c>

00:45:43.309 --> 00:45:43.319 align:start position:0%
that'ss try to not add a new CTE each
 

00:45:43.319 --> 00:45:45.109 align:start position:0%
that'ss try to not add a new CTE each
time<00:45:43.480><c> you</c><00:45:43.599><c> are</c><00:45:43.760><c> doing</c><00:45:44.040><c> something</c><00:45:44.400><c> new</c><00:45:44.880><c> and</c><00:45:45.000><c> I</c>

00:45:45.109 --> 00:45:45.119 align:start position:0%
time you are doing something new and I
 

00:45:45.119 --> 00:45:46.829 align:start position:0%
time you are doing something new and I
saw<00:45:45.319><c> it</c><00:45:45.400><c> a</c><00:45:45.520><c> lot</c><00:45:45.800><c> like</c><00:45:46.000><c> for</c><00:45:46.280><c> each</c><00:45:46.559><c> new</c>

00:45:46.829 --> 00:45:46.839 align:start position:0%
saw it a lot like for each new
 

00:45:46.839 --> 00:45:49.190 align:start position:0%
saw it a lot like for each new
calculation<00:45:47.480><c> for</c><00:45:47.720><c> each</c><00:45:48.000><c> new</c><00:45:48.240><c> column</c><00:45:49.040><c> they</c>

00:45:49.190 --> 00:45:49.200 align:start position:0%
calculation for each new column they
 

00:45:49.200 --> 00:45:51.390 align:start position:0%
calculation for each new column they
jump<00:45:49.480><c> immediately</c><00:45:49.920><c> and</c><00:45:50.119><c> create</c><00:45:50.400><c> a</c><00:45:50.520><c> new</c><00:45:50.680><c> city</c>

00:45:51.390 --> 00:45:51.400 align:start position:0%
jump immediately and create a new city
 

00:45:51.400 --> 00:45:53.309 align:start position:0%
jump immediately and create a new city
and<00:45:51.559><c> what</c><00:45:51.760><c> happens</c><00:45:52.079><c> at</c><00:45:52.200><c> the</c><00:45:52.319><c> end</c><00:45:52.680><c> we</c><00:45:52.800><c> can</c><00:45:53.079><c> have</c>

00:45:53.309 --> 00:45:53.319 align:start position:0%
and what happens at the end we can have
 

00:45:53.319 --> 00:45:55.670 align:start position:0%
and what happens at the end we can have
like<00:45:53.680><c> massive</c><00:45:54.079><c> number</c><00:45:54.359><c> of</c><00:45:54.480><c> cdes</c><00:45:55.079><c> inside</c><00:45:55.440><c> one</c>

00:45:55.670 --> 00:45:55.680 align:start position:0%
like massive number of cdes inside one
 

00:45:55.680 --> 00:45:57.790 align:start position:0%
like massive number of cdes inside one
query<00:45:56.280><c> and</c><00:45:56.400><c> the</c><00:45:56.520><c> developer</c><00:45:57.079><c> thinks</c><00:45:57.480><c> now</c>

00:45:57.790 --> 00:45:57.800 align:start position:0%
query and the developer thinks now
 

00:45:57.800 --> 00:46:00.309 align:start position:0%
query and the developer thinks now
everything<00:45:58.119><c> is</c><00:45:58.280><c> organized</c><00:45:58.960><c> and</c><00:45:59.200><c> easy</c><00:45:59.480><c> to</c><00:45:59.640><c> read</c>

00:46:00.309 --> 00:46:00.319 align:start position:0%
everything is organized and easy to read
 

00:46:00.319 --> 00:46:02.950 align:start position:0%
everything is organized and easy to read
but<00:46:00.520><c> believe</c><00:46:00.839><c> me</c><00:46:01.440><c> it's</c><00:46:01.720><c> exactly</c><00:46:02.160><c> the</c><00:46:02.319><c> opposite</c>

00:46:02.950 --> 00:46:02.960 align:start position:0%
but believe me it's exactly the opposite
 

00:46:02.960 --> 00:46:04.870 align:start position:0%
but believe me it's exactly the opposite
if<00:46:03.079><c> you</c><00:46:03.200><c> open</c><00:46:03.440><c> any</c><00:46:03.680><c> code</c><00:46:04.040><c> and</c><00:46:04.160><c> you</c><00:46:04.319><c> have</c><00:46:04.520><c> a</c><00:46:04.680><c> lot</c>

00:46:04.870 --> 00:46:04.880 align:start position:0%
if you open any code and you have a lot
 

00:46:04.880 --> 00:46:07.190 align:start position:0%
if you open any code and you have a lot
of<00:46:05.079><c> CES</c><00:46:05.720><c> and</c><00:46:05.880><c> especially</c><00:46:06.359><c> if</c><00:46:06.480><c> they</c><00:46:06.599><c> are</c><00:46:06.839><c> Ned</c>

00:46:07.190 --> 00:46:07.200 align:start position:0%
of CES and especially if they are Ned
 

00:46:07.200 --> 00:46:09.990 align:start position:0%
of CES and especially if they are Ned
CES<00:46:08.119><c> it</c><00:46:08.240><c> is</c><00:46:08.520><c> impossible</c><00:46:09.079><c> to</c><00:46:09.559><c> understand</c><00:46:09.880><c> what</c>

00:46:09.990 --> 00:46:10.000 align:start position:0%
CES it is impossible to understand what
 

00:46:10.000 --> 00:46:12.109 align:start position:0%
CES it is impossible to understand what
is<00:46:10.200><c> going</c><00:46:10.400><c> on</c><00:46:10.839><c> even</c><00:46:11.079><c> if</c><00:46:11.240><c> the</c><00:46:11.400><c> developer</c><00:46:11.839><c> like</c>

00:46:12.109 --> 00:46:12.119 align:start position:0%
is going on even if the developer like
 

00:46:12.119 --> 00:46:14.150 align:start position:0%
is going on even if the developer like
describe<00:46:12.599><c> each</c><00:46:12.839><c> CTE</c><00:46:13.359><c> and</c><00:46:13.520><c> the</c><00:46:13.680><c> task</c><00:46:13.960><c> of</c><00:46:14.040><c> the</c>

00:46:14.150 --> 00:46:14.160 align:start position:0%
describe each CTE and the task of the
 

00:46:14.160 --> 00:46:16.430 align:start position:0%
describe each CTE and the task of the
CTE<00:46:14.880><c> it's</c><00:46:15.040><c> going</c><00:46:15.160><c> to</c><00:46:15.319><c> be</c><00:46:15.559><c> really</c><00:46:15.800><c> hard</c><00:46:16.000><c> to</c>

00:46:16.430 --> 00:46:16.440 align:start position:0%
CTE it's going to be really hard to
 

00:46:16.440 --> 00:46:18.230 align:start position:0%
CTE it's going to be really hard to
understand<00:46:16.680><c> and</c><00:46:16.880><c> as</c><00:46:17.000><c> well</c><00:46:17.160><c> to</c><00:46:17.359><c> read</c><00:46:18.040><c> if</c>

00:46:18.230 --> 00:46:18.240 align:start position:0%
understand and as well to read if
 

00:46:18.240 --> 00:46:19.990 align:start position:0%
understand and as well to read if
everything<00:46:18.599><c> is</c><00:46:18.760><c> like</c><00:46:18.960><c> nested</c><00:46:19.480><c> and</c><00:46:19.599><c> you</c><00:46:19.760><c> have</c>

00:46:19.990 --> 00:46:20.000 align:start position:0%
everything is like nested and you have
 

00:46:20.000 --> 00:46:22.950 align:start position:0%
everything is like nested and you have
like<00:46:20.200><c> I</c><00:46:20.280><c> don't</c><00:46:20.440><c> know</c><00:46:20.680><c> 20</c><00:46:21.200><c> CD</c><00:46:21.680><c> in</c><00:46:21.839><c> one</c><00:46:22.040><c> query</c><00:46:22.800><c> so</c>

00:46:22.950 --> 00:46:22.960 align:start position:0%
like I don't know 20 CD in one query so
 

00:46:22.960 --> 00:46:24.630 align:start position:0%
like I don't know 20 CD in one query so
it's<00:46:23.079><c> going</c><00:46:23.200><c> to</c><00:46:23.319><c> be</c><00:46:23.480><c> impossible</c><00:46:24.000><c> to</c><00:46:24.160><c> read</c><00:46:24.520><c> and</c>

00:46:24.630 --> 00:46:24.640 align:start position:0%
it's going to be impossible to read and
 

00:46:24.640 --> 00:46:26.270 align:start position:0%
it's going to be impossible to read and
to<00:46:25.119><c> understand</c><00:46:25.480><c> and</c><00:46:25.680><c> as</c><00:46:25.839><c> well</c><00:46:26.040><c> you're</c><00:46:26.160><c> going</c>

00:46:26.270 --> 00:46:26.280 align:start position:0%
to understand and as well you're going
 

00:46:26.280 --> 00:46:28.390 align:start position:0%
to understand and as well you're going
to<00:46:26.359><c> be</c><00:46:26.440><c> using</c><00:46:26.720><c> a</c><00:46:26.920><c> a</c><00:46:26.960><c> lot</c><00:46:27.119><c> of</c><00:46:27.280><c> memory</c><00:46:28.079><c> and</c><00:46:28.240><c> you</c>

00:46:28.390 --> 00:46:28.400 align:start position:0%
to be using a a lot of memory and you
 

00:46:28.400 --> 00:46:30.829 align:start position:0%
to be using a a lot of memory and you
might<00:46:28.640><c> get</c><00:46:28.920><c> bad</c><00:46:29.200><c> performance</c><00:46:30.040><c> so</c><00:46:30.319><c> my</c><00:46:30.520><c> advice</c>

00:46:30.829 --> 00:46:30.839 align:start position:0%
might get bad performance so my advice
 

00:46:30.839 --> 00:46:33.069 align:start position:0%
might get bad performance so my advice
for<00:46:31.040><c> you</c><00:46:31.559><c> try</c><00:46:31.880><c> always</c><00:46:32.280><c> as</c><00:46:32.400><c> you</c><00:46:32.480><c> are</c><00:46:32.680><c> creating</c>

00:46:33.069 --> 00:46:33.079 align:start position:0%
for you try always as you are creating
 

00:46:33.079 --> 00:46:35.230 align:start position:0%
for you try always as you are creating
new<00:46:33.240><c> cdes</c><00:46:33.720><c> to</c><00:46:33.920><c> think</c><00:46:34.119><c> about</c><00:46:34.559><c> how</c><00:46:34.800><c> about</c><00:46:35.079><c> to</c>

00:46:35.230 --> 00:46:35.240 align:start position:0%
new cdes to think about how about to
 

00:46:35.240 --> 00:46:37.990 align:start position:0%
new cdes to think about how about to
merge<00:46:35.720><c> two</c><00:46:35.960><c> cdes</c><00:46:36.480><c> in</c><00:46:36.680><c> one</c><00:46:37.200><c> so</c><00:46:37.400><c> it</c><00:46:37.520><c> is</c><00:46:37.720><c> really</c>

00:46:37.990 --> 00:46:38.000 align:start position:0%
merge two cdes in one so it is really
 

00:46:38.000 --> 00:46:40.510 align:start position:0%
merge two cdes in one so it is really
always<00:46:38.359><c> important</c><00:46:38.720><c> to</c><00:46:39.000><c> rethink</c><00:46:39.559><c> and</c><00:46:39.800><c> refactor</c>

00:46:40.510 --> 00:46:40.520 align:start position:0%
always important to rethink and refactor
 

00:46:40.520 --> 00:46:43.230 align:start position:0%
always important to rethink and refactor
your<00:46:40.680><c> cdes</c><00:46:41.280><c> in</c><00:46:41.440><c> order</c><00:46:41.720><c> to</c><00:46:41.880><c> merge</c><00:46:42.200><c> it</c><00:46:42.640><c> into</c><00:46:43.000><c> one</c>

00:46:43.230 --> 00:46:43.240 align:start position:0%
your cdes in order to merge it into one
 

00:46:43.240 --> 00:46:45.589 align:start position:0%
your cdes in order to merge it into one
and<00:46:43.400><c> to</c><00:46:43.559><c> reduce</c><00:46:44.040><c> the</c><00:46:44.200><c> number</c><00:46:44.440><c> of</c><00:46:44.559><c> CTE</c><00:46:45.319><c> but</c><00:46:45.480><c> now</c>

00:46:45.589 --> 00:46:45.599 align:start position:0%
and to reduce the number of CTE but now
 

00:46:45.599 --> 00:46:48.069 align:start position:0%
and to reduce the number of CTE but now
if<00:46:45.720><c> you</c><00:46:45.880><c> ask</c><00:46:46.079><c> me</c><00:46:46.359><c> how</c><00:46:46.520><c> many</c><00:46:46.760><c> ctes</c><00:46:47.359><c> are</c><00:46:47.640><c> okay</c><00:46:47.920><c> in</c>

00:46:48.069 --> 00:46:48.079 align:start position:0%
if you ask me how many ctes are okay in
 

00:46:48.079 --> 00:46:50.230 align:start position:0%
if you ask me how many ctes are okay in
one<00:46:48.319><c> query</c><00:46:49.200><c> well</c><00:46:49.400><c> I</c><00:46:49.480><c> don't</c><00:46:49.680><c> have</c><00:46:49.800><c> a</c><00:46:49.960><c> magic</c>

00:46:50.230 --> 00:46:50.240 align:start position:0%
one query well I don't have a magic
 

00:46:50.240 --> 00:46:52.349 align:start position:0%
one query well I don't have a magic
number<00:46:50.480><c> for</c><00:46:50.680><c> that</c><00:46:51.119><c> but</c><00:46:51.440><c> normally</c><00:46:51.880><c> I</c><00:46:52.000><c> tend</c><00:46:52.200><c> to</c>

00:46:52.349 --> 00:46:52.359 align:start position:0%
number for that but normally I tend to
 

00:46:52.359 --> 00:46:55.710 align:start position:0%
number for that but normally I tend to
say<00:46:53.000><c> between</c><00:46:53.400><c> three</c><00:46:53.680><c> and</c><00:46:53.920><c> five</c><00:46:54.160><c> CTE</c><00:46:54.880><c> it's</c><00:46:55.200><c> fine</c>

00:46:55.710 --> 00:46:55.720 align:start position:0%
say between three and five CTE it's fine
 

00:46:55.720 --> 00:46:57.670 align:start position:0%
say between three and five CTE it's fine
so<00:46:55.960><c> it's</c><00:46:56.079><c> going</c><00:46:56.200><c> to</c><00:46:56.280><c> be</c><00:46:56.520><c> easy</c><00:46:57.040><c> to</c><00:46:57.440><c> understand</c>

00:46:57.670 --> 00:46:57.680 align:start position:0%
so it's going to be easy to understand
 

00:46:57.680 --> 00:47:00.109 align:start position:0%
so it's going to be easy to understand
and<00:46:57.839><c> to</c><00:46:58.040><c> read</c><00:46:58.359><c> and</c><00:46:58.520><c> so</c><00:46:58.720><c> on</c><00:46:59.200><c> but</c><00:46:59.400><c> once</c><00:46:59.599><c> you</c><00:46:59.800><c> get</c>

00:47:00.109 --> 00:47:00.119 align:start position:0%
and to read and so on but once you get
 

00:47:00.119 --> 00:47:02.430 align:start position:0%
and to read and so on but once you get
more<00:47:00.359><c> than</c><00:47:00.559><c> five</c><00:47:00.800><c> CTE</c><00:47:01.800><c> then</c><00:47:01.920><c> you</c><00:47:02.079><c> have</c><00:47:02.200><c> to</c>

00:47:02.430 --> 00:47:02.440 align:start position:0%
more than five CTE then you have to
 

00:47:02.440 --> 00:47:04.549 align:start position:0%
more than five CTE then you have to
rethink<00:47:03.160><c> your</c><00:47:03.440><c> code</c><00:47:03.960><c> maybe</c><00:47:04.200><c> you</c><00:47:04.280><c> have</c><00:47:04.400><c> to</c>

00:47:04.549 --> 00:47:04.559 align:start position:0%
rethink your code maybe you have to
 

00:47:04.559 --> 00:47:06.670 align:start position:0%
rethink your code maybe you have to
create<00:47:05.119><c> another</c><00:47:05.559><c> complete</c><00:47:06.000><c> query</c><00:47:06.440><c> so</c><00:47:06.599><c> you</c>

00:47:06.670 --> 00:47:06.680 align:start position:0%
create another complete query so you
 

00:47:06.680 --> 00:47:08.270 align:start position:0%
create another complete query so you
don't<00:47:06.880><c> have</c><00:47:07.000><c> to</c><00:47:07.119><c> put</c><00:47:07.400><c> everything</c><00:47:07.839><c> in</c><00:47:08.000><c> one</c>

00:47:08.270 --> 00:47:08.280 align:start position:0%
don't have to put everything in one
 

00:47:08.280 --> 00:47:10.549 align:start position:0%
don't have to put everything in one
query<00:47:08.960><c> so</c><00:47:09.200><c> this</c><00:47:09.319><c> is</c><00:47:09.440><c> my</c><00:47:09.640><c> advice</c><00:47:09.920><c> for</c><00:47:10.079><c> you</c><00:47:10.280><c> try</c>

00:47:10.549 --> 00:47:10.559 align:start position:0%
query so this is my advice for you try
 

00:47:10.559 --> 00:47:13.309 align:start position:0%
query so this is my advice for you try
to<00:47:10.760><c> not</c><00:47:11.079><c> overuse</c><00:47:11.640><c> the</c><00:47:11.800><c> CTE</c><00:47:12.280><c> in</c><00:47:12.400><c> your</c><00:47:12.599><c> projects</c>

00:47:13.309 --> 00:47:13.319 align:start position:0%
to not overuse the CTE in your projects
 

00:47:13.319 --> 00:47:15.790 align:start position:0%
to not overuse the CTE in your projects
not<00:47:13.480><c> for</c><00:47:13.720><c> each</c><00:47:13.920><c> step</c><00:47:14.240><c> to</c><00:47:14.480><c> always</c><00:47:15.000><c> refactor</c><00:47:15.640><c> the</c>

00:47:15.790 --> 00:47:15.800 align:start position:0%
not for each step to always refactor the
 

00:47:15.800 --> 00:47:18.870 align:start position:0%
not for each step to always refactor the
CTE<00:47:16.680><c> consolidate</c><00:47:17.400><c> them</c><00:47:17.839><c> and</c><00:47:18.000><c> try</c><00:47:18.240><c> to</c><00:47:18.440><c> not</c><00:47:18.680><c> have</c>

00:47:18.870 --> 00:47:18.880 align:start position:0%
CTE consolidate them and try to not have
 

00:47:18.880 --> 00:47:21.270 align:start position:0%
CTE consolidate them and try to not have
more<00:47:19.079><c> than</c><00:47:19.319><c> five</c><00:47:19.520><c> ctes</c><00:47:20.000><c> in</c><00:47:20.119><c> one</c><00:47:20.359><c> query</c><00:47:20.960><c> so</c>

00:47:21.270 --> 00:47:21.280 align:start position:0%
more than five ctes in one query so
 

00:47:21.280 --> 00:47:23.150 align:start position:0%
more than five ctes in one query so
that's<00:47:21.480><c> my</c><00:47:21.680><c> advice</c><00:47:21.960><c> for</c><00:47:22.160><c> you</c><00:47:22.400><c> be</c><00:47:22.640><c> responsible</c>

00:47:23.150 --> 00:47:23.160 align:start position:0%
that's my advice for you be responsible
 

00:47:23.160 --> 00:47:25.510 align:start position:0%
that's my advice for you be responsible
using<00:47:23.440><c> the</c><00:47:23.599><c> Cs</c><00:47:24.319><c> and</c><00:47:24.680><c> let's</c><00:47:24.880><c> go</c><00:47:25.079><c> back</c><00:47:25.200><c> to</c><00:47:25.319><c> our</c>

00:47:25.510 --> 00:47:25.520 align:start position:0%
using the Cs and let's go back to our
 

00:47:25.520 --> 00:47:30.069 align:start position:0%
using the Cs and let's go back to our
course

00:47:30.069 --> 00:47:30.079 align:start position:0%
 
 

00:47:30.079 --> 00:47:31.349 align:start position:0%
 
so<00:47:30.280><c> with</c><00:47:30.440><c> that</c><00:47:30.599><c> we</c><00:47:30.720><c> have</c><00:47:30.839><c> learned</c><00:47:31.240><c> the</c>

00:47:31.349 --> 00:47:31.359 align:start position:0%
so with that we have learned the
 

00:47:31.359 --> 00:47:34.510 align:start position:0%
so with that we have learned the
Standalone<00:47:31.920><c> CTE</c><00:47:32.480><c> and</c><00:47:32.680><c> the</c><00:47:32.880><c> N</c><00:47:33.280><c> CTE</c><00:47:33.960><c> and</c><00:47:34.200><c> both</c><00:47:34.359><c> of</c>

00:47:34.510 --> 00:47:34.520 align:start position:0%
Standalone CTE and the N CTE and both of
 

00:47:34.520 --> 00:47:36.710 align:start position:0%
Standalone CTE and the N CTE and both of
them<00:47:34.680><c> belongs</c><00:47:35.240><c> to</c><00:47:35.440><c> a</c><00:47:35.640><c> type</c><00:47:36.000><c> called</c>

00:47:36.710 --> 00:47:36.720 align:start position:0%
them belongs to a type called
 

00:47:36.720 --> 00:47:39.150 align:start position:0%
them belongs to a type called
nonrecursive<00:47:37.599><c> CTE</c><00:47:38.599><c> so</c><00:47:38.760><c> what</c><00:47:38.880><c> is</c><00:47:39.040><c> a</c>

00:47:39.150 --> 00:47:39.160 align:start position:0%
nonrecursive CTE so what is a
 

00:47:39.160 --> 00:47:41.870 align:start position:0%
nonrecursive CTE so what is a
non-recursive<00:47:39.680><c> CTE</c><00:47:40.559><c> it</c><00:47:40.640><c> means</c><00:47:41.000><c> it</c><00:47:41.119><c> is</c><00:47:41.280><c> a</c><00:47:41.400><c> CTE</c>

00:47:41.870 --> 00:47:41.880 align:start position:0%
non-recursive CTE it means it is a CTE
 

00:47:41.880 --> 00:47:44.430 align:start position:0%
non-recursive CTE it means it is a CTE
that<00:47:42.040><c> is</c><00:47:42.280><c> executed</c><00:47:42.960><c> only</c><00:47:43.319><c> once</c><00:47:43.920><c> so</c><00:47:44.119><c> there</c><00:47:44.240><c> is</c>

00:47:44.430 --> 00:47:44.440 align:start position:0%
that is executed only once so there is
 

00:47:44.440 --> 00:47:47.069 align:start position:0%
that is executed only once so there is
no<00:47:44.680><c> repetitions</c><00:47:45.280><c> or</c><00:47:45.480><c> looping</c><00:47:45.960><c> or</c><00:47:46.200><c> anything</c><00:47:46.839><c> so</c>

00:47:47.069 --> 00:47:47.079 align:start position:0%
no repetitions or looping or anything so
 

00:47:47.079 --> 00:47:49.190 align:start position:0%
no repetitions or looping or anything so
the<00:47:47.240><c> SQL</c><00:47:47.599><c> can</c><00:47:47.839><c> execute</c><00:47:48.200><c> it</c><00:47:48.319><c> in</c><00:47:48.480><c> one</c><00:47:48.720><c> go</c><00:47:49.040><c> and</c>

00:47:49.190 --> 00:47:49.200 align:start position:0%
the SQL can execute it in one go and
 

00:47:49.200 --> 00:47:51.069 align:start position:0%
the SQL can execute it in one go and
that's<00:47:49.400><c> it</c><00:47:49.839><c> but</c><00:47:50.000><c> in</c><00:47:50.200><c> the</c><00:47:50.359><c> other</c><00:47:50.599><c> hand</c><00:47:50.880><c> the</c>

00:47:51.069 --> 00:47:51.079 align:start position:0%
that's it but in the other hand the
 

00:47:51.079 --> 00:47:53.750 align:start position:0%
that's it but in the other hand the
recursive<00:47:51.520><c> CTE</c><00:47:52.079><c> is</c><00:47:52.319><c> exactly</c><00:47:52.760><c> the</c><00:47:52.920><c> opposite</c><00:47:53.559><c> so</c>

00:47:53.750 --> 00:47:53.760 align:start position:0%
recursive CTE is exactly the opposite so
 

00:47:53.760 --> 00:47:56.950 align:start position:0%
recursive CTE is exactly the opposite so
a<00:47:53.920><c> recursive</c><00:47:54.400><c> CTE</c><00:47:54.880><c> it</c><00:47:55.040><c> is</c><00:47:55.520><c> a</c><00:47:55.760><c> self</c><00:47:56.359><c> reference</c>

00:47:56.950 --> 00:47:56.960 align:start position:0%
a recursive CTE it is a self reference
 

00:47:56.960 --> 00:47:59.910 align:start position:0%
a recursive CTE it is a self reference
ing<00:47:57.240><c> query</c><00:47:58.000><c> that</c><00:47:58.319><c> repeatedly</c><00:47:59.160><c> processing</c><00:47:59.720><c> the</c>

00:47:59.910 --> 00:47:59.920 align:start position:0%
ing query that repeatedly processing the
 

00:47:59.920 --> 00:48:02.829 align:start position:0%
ing query that repeatedly processing the
data<00:48:00.640><c> until</c><00:48:01.119><c> a</c><00:48:01.280><c> certain</c><00:48:01.880><c> condition</c><00:48:02.160><c> is</c><00:48:02.319><c> met</c>

00:48:02.829 --> 00:48:02.839 align:start position:0%
data until a certain condition is met
 

00:48:02.839 --> 00:48:05.190 align:start position:0%
data until a certain condition is met
and<00:48:03.000><c> we</c><00:48:03.200><c> usually</c><00:48:03.520><c> use</c><00:48:03.800><c> the</c><00:48:03.960><c> recursive</c><00:48:04.400><c> CTE</c><00:48:05.079><c> if</c>

00:48:05.190 --> 00:48:05.200 align:start position:0%
and we usually use the recursive CTE if
 

00:48:05.200 --> 00:48:07.470 align:start position:0%
and we usually use the recursive CTE if
we<00:48:05.319><c> have</c><00:48:05.520><c> like</c><00:48:05.839><c> hierarchical</c><00:48:06.640><c> structure</c><00:48:07.319><c> and</c>

00:48:07.470 --> 00:48:07.480 align:start position:0%
we have like hierarchical structure and
 

00:48:07.480 --> 00:48:09.670 align:start position:0%
we have like hierarchical structure and
we<00:48:07.599><c> want</c><00:48:07.800><c> to</c><00:48:08.000><c> navigate</c><00:48:08.559><c> and</c><00:48:08.720><c> travel</c><00:48:09.400><c> through</c>

00:48:09.670 --> 00:48:09.680 align:start position:0%
we want to navigate and travel through
 

00:48:09.680 --> 00:48:11.430 align:start position:0%
we want to navigate and travel through
the<00:48:09.839><c> hierarchy</c><00:48:10.559><c> I</c><00:48:10.680><c> know</c><00:48:10.880><c> this</c><00:48:11.040><c> might</c><00:48:11.240><c> be</c>

00:48:11.430 --> 00:48:11.440 align:start position:0%
the hierarchy I know this might be
 

00:48:11.440 --> 00:48:12.870 align:start position:0%
the hierarchy I know this might be
confusing<00:48:11.920><c> but</c><00:48:12.079><c> don't</c><00:48:12.240><c> worry</c><00:48:12.440><c> about</c><00:48:12.599><c> it</c><00:48:12.800><c> we're</c>

00:48:12.870 --> 00:48:12.880 align:start position:0%
confusing but don't worry about it we're
 

00:48:12.880 --> 00:48:14.750 align:start position:0%
confusing but don't worry about it we're
going<00:48:12.960><c> to</c><00:48:13.040><c> have</c><00:48:13.240><c> very</c><00:48:13.400><c> simple</c><00:48:13.720><c> examples</c><00:48:14.520><c> now</c>

00:48:14.750 --> 00:48:14.760 align:start position:0%
going to have very simple examples now
 

00:48:14.760 --> 00:48:17.069 align:start position:0%
going to have very simple examples now
again<00:48:14.920><c> we</c><00:48:15.079><c> have</c><00:48:15.200><c> our</c><00:48:15.440><c> tables</c><00:48:15.880><c> in</c><00:48:16.000><c> the</c><00:48:16.200><c> database</c>

00:48:17.069 --> 00:48:17.079 align:start position:0%
again we have our tables in the database
 

00:48:17.079 --> 00:48:19.390 align:start position:0%
again we have our tables in the database
and<00:48:17.240><c> we</c><00:48:17.359><c> have</c><00:48:17.559><c> a</c><00:48:17.720><c> CTE</c><00:48:18.520><c> now</c><00:48:18.680><c> the</c><00:48:18.839><c> query</c><00:48:19.160><c> of</c><00:48:19.280><c> the</c>

00:48:19.390 --> 00:48:19.400 align:start position:0%
and we have a CTE now the query of the
 

00:48:19.400 --> 00:48:21.349 align:start position:0%
and we have a CTE now the query of the
CTE<00:48:19.800><c> going</c><00:48:19.920><c> to</c><00:48:20.040><c> be</c><00:48:20.200><c> executed</c><00:48:20.640><c> for</c><00:48:20.880><c> the</c><00:48:21.079><c> first</c>

00:48:21.349 --> 00:48:21.359 align:start position:0%
CTE going to be executed for the first
 

00:48:21.359 --> 00:48:23.150 align:start position:0%
CTE going to be executed for the first
time<00:48:21.880><c> and</c><00:48:22.079><c> in</c><00:48:22.200><c> the</c><00:48:22.400><c> results</c><00:48:22.800><c> we're</c><00:48:22.920><c> going</c><00:48:23.040><c> to</c>

00:48:23.150 --> 00:48:23.160 align:start position:0%
time and in the results we're going to
 

00:48:23.160 --> 00:48:26.069 align:start position:0%
time and in the results we're going to
have<00:48:23.720><c> the</c><00:48:23.920><c> initial</c><00:48:24.440><c> data</c><00:48:24.760><c> from</c><00:48:24.960><c> the</c><00:48:25.119><c> CTE</c><00:48:25.839><c> but</c>

00:48:26.069 --> 00:48:26.079 align:start position:0%
have the initial data from the CTE but
 

00:48:26.079 --> 00:48:28.109 align:start position:0%
have the initial data from the CTE but
it<00:48:26.200><c> is</c><00:48:26.400><c> not</c><00:48:26.880><c> everything</c><00:48:27.359><c> yet</c><00:48:27.760><c> now</c><00:48:28.000><c> this</c>

00:48:28.109 --> 00:48:28.119 align:start position:0%
it is not everything yet now this
 

00:48:28.119 --> 00:48:30.630 align:start position:0%
it is not everything yet now this
intermittent<00:48:28.760><c> result</c><00:48:29.119><c> is</c><00:48:29.319><c> not</c><00:48:29.559><c> ready</c><00:48:30.000><c> yet</c><00:48:30.440><c> for</c>

00:48:30.630 --> 00:48:30.640 align:start position:0%
intermittent result is not ready yet for
 

00:48:30.640 --> 00:48:33.510 align:start position:0%
intermittent result is not ready yet for
the<00:48:30.800><c> main</c><00:48:31.079><c> query</c><00:48:32.000><c> but</c><00:48:32.240><c> instead</c><00:48:32.599><c> of</c><00:48:32.839><c> that</c><00:48:33.359><c> it's</c>

00:48:33.510 --> 00:48:33.520 align:start position:0%
the main query but instead of that it's
 

00:48:33.520 --> 00:48:36.309 align:start position:0%
the main query but instead of that it's
going<00:48:33.640><c> to</c><00:48:33.800><c> go</c><00:48:34.000><c> back</c><00:48:34.200><c> to</c><00:48:34.400><c> the</c><00:48:34.760><c> CTE</c><00:48:35.599><c> and</c><00:48:35.839><c> CTE</c>

00:48:36.309 --> 00:48:36.319 align:start position:0%
going to go back to the CTE and CTE
 

00:48:36.319 --> 00:48:38.349 align:start position:0%
going to go back to the CTE and CTE
going<00:48:36.440><c> to</c><00:48:36.640><c> check</c><00:48:37.040><c> whether</c><00:48:37.720><c> the</c><00:48:37.960><c> current</c>

00:48:38.349 --> 00:48:38.359 align:start position:0%
going to check whether the current
 

00:48:38.359 --> 00:48:41.390 align:start position:0%
going to check whether the current
results<00:48:38.880><c> is</c><00:48:39.079><c> meeting</c><00:48:39.760><c> a</c><00:48:39.960><c> specific</c><00:48:40.880><c> condition</c>

00:48:41.390 --> 00:48:41.400 align:start position:0%
results is meeting a specific condition
 

00:48:41.400 --> 00:48:43.990 align:start position:0%
results is meeting a specific condition
so<00:48:41.599><c> now</c><00:48:41.920><c> if</c><00:48:42.079><c> the</c><00:48:42.280><c> check</c><00:48:42.520><c> says</c><00:48:43.240><c> no</c><00:48:43.599><c> it's</c><00:48:43.800><c> not</c>

00:48:43.990 --> 00:48:44.000 align:start position:0%
so now if the check says no it's not
 

00:48:44.000 --> 00:48:45.750 align:start position:0%
so now if the check says no it's not
meeting<00:48:44.359><c> the</c><00:48:44.720><c> condition</c><00:48:45.240><c> what</c><00:48:45.440><c> going</c><00:48:45.559><c> to</c>

00:48:45.750 --> 00:48:45.760 align:start position:0%
meeting the condition what going to
 

00:48:45.760 --> 00:48:47.829 align:start position:0%
meeting the condition what going to
happen<00:48:46.280><c> the</c><00:48:46.559><c> city</c><00:48:47.040><c> query</c><00:48:47.359><c> going</c><00:48:47.480><c> to</c><00:48:47.599><c> be</c>

00:48:47.829 --> 00:48:47.839 align:start position:0%
happen the city query going to be
 

00:48:47.839 --> 00:48:50.349 align:start position:0%
happen the city query going to be
executed<00:48:48.680><c> for</c><00:48:48.920><c> the</c><00:48:49.119><c> second</c><00:48:49.559><c> time</c><00:48:50.000><c> so</c><00:48:50.160><c> as</c><00:48:50.240><c> you</c>

00:48:50.349 --> 00:48:50.359 align:start position:0%
executed for the second time so as you
 

00:48:50.359 --> 00:48:52.829 align:start position:0%
executed for the second time so as you
can<00:48:50.480><c> see</c><00:48:50.760><c> we</c><00:48:50.920><c> are</c><00:48:51.119><c> looping</c><00:48:51.799><c> through</c><00:48:52.000><c> the</c><00:48:52.160><c> CTE</c>

00:48:52.829 --> 00:48:52.839 align:start position:0%
can see we are looping through the CTE
 

00:48:52.839 --> 00:48:55.270 align:start position:0%
can see we are looping through the CTE
now<00:48:53.079><c> the</c><00:48:53.319><c> result</c><00:48:53.720><c> of</c><00:48:53.920><c> the</c><00:48:54.160><c> second</c><00:48:54.559><c> iteration</c>

00:48:55.270 --> 00:48:55.280 align:start position:0%
now the result of the second iteration
 

00:48:55.280 --> 00:48:58.150 align:start position:0%
now the result of the second iteration
the<00:48:55.520><c> second</c><00:48:56.000><c> execution</c><00:48:56.960><c> will</c><00:48:57.200><c> be</c><00:48:57.480><c> added</c><00:48:57.960><c> to</c>

00:48:58.150 --> 00:48:58.160 align:start position:0%
the second execution will be added to
 

00:48:58.160 --> 00:49:00.270 align:start position:0%
the second execution will be added to
the<00:48:58.599><c> intermediate</c><00:48:59.240><c> result</c><00:48:59.760><c> so</c><00:48:59.920><c> now</c><00:49:00.119><c> the</c>

00:49:00.270 --> 00:49:00.280 align:start position:0%
the intermediate result so now the
 

00:49:00.280 --> 00:49:03.109 align:start position:0%
the intermediate result so now the
intermediate<00:49:00.960><c> result</c><00:49:01.440><c> has</c><00:49:02.000><c> more</c><00:49:02.319><c> data</c><00:49:02.880><c> and</c>

00:49:03.109 --> 00:49:03.119 align:start position:0%
intermediate result has more data and
 

00:49:03.119 --> 00:49:04.990 align:start position:0%
intermediate result has more data and
again<00:49:03.440><c> before</c><00:49:03.799><c> we</c><00:49:03.960><c> can</c><00:49:04.160><c> use</c><00:49:04.319><c> it</c><00:49:04.480><c> from</c><00:49:04.599><c> the</c><00:49:04.760><c> main</c>

00:49:04.990 --> 00:49:05.000 align:start position:0%
again before we can use it from the main
 

00:49:05.000 --> 00:49:07.190 align:start position:0%
again before we can use it from the main
query<00:49:05.720><c> it</c><00:49:05.880><c> going</c><00:49:06.000><c> to</c><00:49:06.119><c> be</c><00:49:06.240><c> checked</c><00:49:06.799><c> from</c><00:49:07.000><c> the</c>

00:49:07.190 --> 00:49:07.200 align:start position:0%
query it going to be checked from the
 

00:49:07.200 --> 00:49:09.990 align:start position:0%
query it going to be checked from the
CTE<00:49:08.000><c> does</c><00:49:08.359><c> the</c><00:49:08.599><c> result</c><00:49:09.119><c> fulfill</c><00:49:09.640><c> the</c>

00:49:09.990 --> 00:49:10.000 align:start position:0%
CTE does the result fulfill the
 

00:49:10.000 --> 00:49:12.510 align:start position:0%
CTE does the result fulfill the
condition<00:49:10.480><c> if</c><00:49:10.640><c> it's</c><00:49:10.880><c> still</c><00:49:11.200><c> no</c><00:49:11.799><c> then</c><00:49:12.119><c> go</c><00:49:12.280><c> and</c>

00:49:12.510 --> 00:49:12.520 align:start position:0%
condition if it's still no then go and
 

00:49:12.520 --> 00:49:14.750 align:start position:0%
condition if it's still no then go and
execute<00:49:13.079><c> the</c><00:49:13.240><c> CTE</c><00:49:13.720><c> again</c><00:49:14.160><c> so</c><00:49:14.359><c> we're</c><00:49:14.480><c> going</c><00:49:14.599><c> to</c>

00:49:14.750 --> 00:49:14.760 align:start position:0%
execute the CTE again so we're going to
 

00:49:14.760 --> 00:49:17.230 align:start position:0%
execute the CTE again so we're going to
have<00:49:14.960><c> a</c><00:49:15.200><c> third</c><00:49:15.599><c> iteration</c><00:49:16.400><c> and</c><00:49:16.760><c> new</c><00:49:17.000><c> data</c>

00:49:17.230 --> 00:49:17.240 align:start position:0%
have a third iteration and new data
 

00:49:17.240 --> 00:49:19.349 align:start position:0%
have a third iteration and new data
going<00:49:17.359><c> to</c><00:49:17.480><c> be</c><00:49:17.680><c> added</c><00:49:18.359><c> to</c><00:49:18.599><c> the</c><00:49:18.760><c> intermediate</c>

00:49:19.349 --> 00:49:19.359 align:start position:0%
going to be added to the intermediate
 

00:49:19.359 --> 00:49:21.870 align:start position:0%
going to be added to the intermediate
result<00:49:19.920><c> so</c><00:49:20.200><c> this</c><00:49:20.319><c> is</c><00:49:20.480><c> our</c><00:49:20.799><c> third</c><00:49:21.119><c> iteration</c>

00:49:21.870 --> 00:49:21.880 align:start position:0%
result so this is our third iteration
 

00:49:21.880 --> 00:49:23.190 align:start position:0%
result so this is our third iteration
now<00:49:22.040><c> it's</c><00:49:22.160><c> going</c><00:49:22.280><c> to</c><00:49:22.400><c> be</c><00:49:22.480><c> checked</c><00:49:22.839><c> again</c><00:49:23.000><c> from</c>

00:49:23.190 --> 00:49:23.200 align:start position:0%
now it's going to be checked again from
 

00:49:23.200 --> 00:49:26.270 align:start position:0%
now it's going to be checked again from
the<00:49:23.319><c> CTE</c><00:49:24.119><c> did</c><00:49:24.319><c> we</c><00:49:24.520><c> fulfill</c><00:49:25.119><c> the</c><00:49:25.480><c> condition</c><00:49:26.119><c> if</c>

00:49:26.270 --> 00:49:26.280 align:start position:0%
the CTE did we fulfill the condition if
 

00:49:26.280 --> 00:49:28.549 align:start position:0%
the CTE did we fulfill the condition if
the<00:49:26.480><c> as</c><00:49:26.760><c> answer</c><00:49:27.040><c> is</c><00:49:27.319><c> yes</c><00:49:27.839><c> then</c><00:49:28.040><c> the</c><00:49:28.160><c> loop</c><00:49:28.440><c> going</c>

00:49:28.549 --> 00:49:28.559 align:start position:0%
the as answer is yes then the loop going
 

00:49:28.559 --> 00:49:30.589 align:start position:0%
the as answer is yes then the loop going
to<00:49:28.680><c> break</c><00:49:28.960><c> and</c><00:49:29.160><c> everything</c><00:49:29.559><c> ends</c><00:49:30.240><c> so</c><00:49:30.480><c> there</c>

00:49:30.589 --> 00:49:30.599 align:start position:0%
to break and everything ends so there
 

00:49:30.599 --> 00:49:33.069 align:start position:0%
to break and everything ends so there
will<00:49:30.799><c> be</c><00:49:30.960><c> no</c><00:49:31.160><c> fourth</c><00:49:31.559><c> iteration</c><00:49:32.079><c> of</c><00:49:32.240><c> the</c><00:49:32.400><c> CTE</c>

00:49:33.069 --> 00:49:33.079 align:start position:0%
will be no fourth iteration of the CTE
 

00:49:33.079 --> 00:49:35.789 align:start position:0%
will be no fourth iteration of the CTE
so<00:49:33.319><c> with</c><00:49:33.520><c> that</c><00:49:33.680><c> the</c><00:49:33.799><c> CTE</c><00:49:34.200><c> says</c><00:49:34.520><c> okay</c><00:49:35.040><c> I'm</c><00:49:35.240><c> done</c>

00:49:35.789 --> 00:49:35.799 align:start position:0%
so with that the CTE says okay I'm done
 

00:49:35.799 --> 00:49:38.150 align:start position:0%
so with that the CTE says okay I'm done
this<00:49:35.960><c> is</c><00:49:36.319><c> the</c><00:49:36.559><c> final</c><00:49:37.000><c> result</c><00:49:37.680><c> of</c><00:49:37.880><c> the</c>

00:49:38.150 --> 00:49:38.160 align:start position:0%
this is the final result of the
 

00:49:38.160 --> 00:49:40.309 align:start position:0%
this is the final result of the
intermediate<00:49:39.040><c> result</c><00:49:39.680><c> then</c><00:49:39.839><c> the</c><00:49:39.960><c> loop</c><00:49:40.200><c> going</c>

00:49:40.309 --> 00:49:40.319 align:start position:0%
intermediate result then the loop going
 

00:49:40.319 --> 00:49:43.270 align:start position:0%
intermediate result then the loop going
to<00:49:40.480><c> break</c><00:49:40.799><c> and</c><00:49:41.000><c> everything</c><00:49:41.400><c> ends</c><00:49:42.200><c> and</c><00:49:42.559><c> the</c><00:49:42.799><c> CTE</c>

00:49:43.270 --> 00:49:43.280 align:start position:0%
to break and everything ends and the CTE
 

00:49:43.280 --> 00:49:45.589 align:start position:0%
to break and everything ends and the CTE
will<00:49:43.440><c> not</c><00:49:43.599><c> be</c><00:49:43.839><c> executed</c><00:49:44.400><c> for</c><00:49:44.680><c> the</c><00:49:44.799><c> first</c><00:49:45.200><c> time</c>

00:49:45.589 --> 00:49:45.599 align:start position:0%
will not be executed for the first time
 

00:49:45.599 --> 00:49:47.549 align:start position:0%
will not be executed for the first time
and<00:49:45.720><c> now</c><00:49:45.880><c> the</c><00:49:46.000><c> CTE</c><00:49:46.319><c> going</c><00:49:46.440><c> to</c><00:49:46.559><c> say</c><00:49:46.920><c> okay</c><00:49:47.400><c> I'm</c>

00:49:47.549 --> 00:49:47.559 align:start position:0%
and now the CTE going to say okay I'm
 

00:49:47.559 --> 00:49:49.950 align:start position:0%
and now the CTE going to say okay I'm
done<00:49:48.079><c> now</c><00:49:48.319><c> my</c><00:49:48.559><c> intermediate</c><00:49:49.160><c> result</c><00:49:49.480><c> is</c><00:49:49.680><c> ready</c>

00:49:49.950 --> 00:49:49.960 align:start position:0%
done now my intermediate result is ready
 

00:49:49.960 --> 00:49:52.349 align:start position:0%
done now my intermediate result is ready
to<00:49:50.119><c> be</c><00:49:50.280><c> used</c><00:49:50.680><c> from</c><00:49:50.880><c> the</c><00:49:51.079><c> main</c><00:49:51.400><c> query</c><00:49:52.000><c> and</c><00:49:52.160><c> now</c>

00:49:52.349 --> 00:49:52.359 align:start position:0%
to be used from the main query and now
 

00:49:52.359 --> 00:49:53.990 align:start position:0%
to be used from the main query and now
nothing<00:49:52.640><c> new</c><00:49:52.880><c> happens</c><00:49:53.319><c> the</c><00:49:53.400><c> main</c><00:49:53.599><c> query</c><00:49:53.920><c> going</c>

00:49:53.990 --> 00:49:54.000 align:start position:0%
nothing new happens the main query going
 

00:49:54.000 --> 00:49:55.910 align:start position:0%
nothing new happens the main query going
to<00:49:54.160><c> go</c><00:49:54.440><c> and</c><00:49:54.799><c> retrieve</c><00:49:55.200><c> the</c><00:49:55.359><c> data</c><00:49:55.599><c> from</c><00:49:55.799><c> the</c>

00:49:55.910 --> 00:49:55.920 align:start position:0%
to go and retrieve the data from the
 

00:49:55.920 --> 00:49:58.109 align:start position:0%
to go and retrieve the data from the
intermediate<00:49:56.400><c> result</c><00:49:57.079><c> and</c><00:49:57.200><c> do</c><00:49:57.440><c> some</c><00:49:57.680><c> magic</c><00:49:58.000><c> in</c>

00:49:58.109 --> 00:49:58.119 align:start position:0%
intermediate result and do some magic in
 

00:49:58.119 --> 00:50:00.430 align:start position:0%
intermediate result and do some magic in
order<00:49:58.359><c> to</c><00:49:58.559><c> prepare</c><00:49:59.000><c> the</c><00:49:59.200><c> final</c><00:49:59.720><c> results</c><00:50:00.280><c> so</c>

00:50:00.430 --> 00:50:00.440 align:start position:0%
order to prepare the final results so
 

00:50:00.440 --> 00:50:02.030 align:start position:0%
order to prepare the final results so
this<00:50:00.599><c> means</c><00:50:00.839><c> there</c><00:50:00.920><c> will</c><00:50:01.079><c> be</c><00:50:01.200><c> no</c><00:50:01.400><c> iterations</c>

00:50:02.030 --> 00:50:02.040 align:start position:0%
this means there will be no iterations
 

00:50:02.040 --> 00:50:04.510 align:start position:0%
this means there will be no iterations
or<00:50:02.319><c> looping</c><00:50:03.000><c> inside</c><00:50:03.359><c> the</c><00:50:03.520><c> main</c><00:50:03.760><c> query</c><00:50:04.359><c> the</c>

00:50:04.510 --> 00:50:04.520 align:start position:0%
or looping inside the main query the
 

00:50:04.520 --> 00:50:06.230 align:start position:0%
or looping inside the main query the
looping<00:50:04.960><c> going</c><00:50:05.079><c> to</c><00:50:05.160><c> be</c><00:50:05.319><c> happen</c><00:50:05.640><c> only</c><00:50:05.920><c> in</c><00:50:06.079><c> the</c>

00:50:06.230 --> 00:50:06.240 align:start position:0%
looping going to be happen only in the
 

00:50:06.240 --> 00:50:08.990 align:start position:0%
looping going to be happen only in the
CTE<00:50:07.000><c> and</c><00:50:07.160><c> that's</c><00:50:07.400><c> why</c><00:50:07.559><c> we</c><00:50:07.720><c> call</c><00:50:07.920><c> it</c><00:50:08.240><c> recursive</c>

00:50:08.990 --> 00:50:09.000 align:start position:0%
CTE and that's why we call it recursive
 

00:50:09.000 --> 00:50:10.950 align:start position:0%
CTE and that's why we call it recursive
CTE<00:50:09.640><c> so</c><00:50:09.799><c> now</c><00:50:09.960><c> if</c><00:50:10.040><c> you</c><00:50:10.160><c> compare</c><00:50:10.440><c> it</c><00:50:10.640><c> with</c><00:50:10.799><c> the</c>

00:50:10.950 --> 00:50:10.960 align:start position:0%
CTE so now if you compare it with the
 

00:50:10.960 --> 00:50:13.390 align:start position:0%
CTE so now if you compare it with the
other<00:50:11.240><c> types</c><00:50:11.839><c> all</c><00:50:12.079><c> other</c><00:50:12.319><c> types</c><00:50:12.720><c> are</c><00:50:12.960><c> always</c>

00:50:13.390 --> 00:50:13.400 align:start position:0%
other types all other types are always
 

00:50:13.400 --> 00:50:15.710 align:start position:0%
other types all other types are always
in<00:50:13.559><c> One</c><00:50:13.880><c> Direction</c><00:50:14.680><c> and</c><00:50:14.839><c> all</c><00:50:15.040><c> the</c><00:50:15.160><c> CTE</c><00:50:15.599><c> going</c>

00:50:15.710 --> 00:50:15.720 align:start position:0%
in One Direction and all the CTE going
 

00:50:15.720 --> 00:50:18.069 align:start position:0%
in One Direction and all the CTE going
to<00:50:15.839><c> be</c><00:50:16.000><c> executed</c><00:50:16.599><c> only</c><00:50:17.079><c> once</c><00:50:17.640><c> but</c><00:50:17.880><c> the</c>

00:50:18.069 --> 00:50:18.079 align:start position:0%
to be executed only once but the
 

00:50:18.079 --> 00:50:20.710 align:start position:0%
to be executed only once but the
recursive<00:50:18.559><c> CTE</c><00:50:19.319><c> going</c><00:50:19.440><c> to</c><00:50:19.559><c> be</c><00:50:19.760><c> keep</c><00:50:20.000><c> looping</c>

00:50:20.710 --> 00:50:20.720 align:start position:0%
recursive CTE going to be keep looping
 

00:50:20.720 --> 00:50:23.510 align:start position:0%
recursive CTE going to be keep looping
until<00:50:21.119><c> the</c><00:50:21.520><c> condition</c><00:50:21.960><c> is</c><00:50:22.160><c> met</c><00:50:22.680><c> and</c><00:50:22.920><c> only</c><00:50:23.280><c> then</c>

00:50:23.510 --> 00:50:23.520 align:start position:0%
until the condition is met and only then
 

00:50:23.520 --> 00:50:25.030 align:start position:0%
until the condition is met and only then
it's<00:50:23.640><c> going</c><00:50:23.799><c> to</c><00:50:23.880><c> forward</c><00:50:24.280><c> the</c><00:50:24.440><c> data</c><00:50:24.720><c> to</c><00:50:24.880><c> the</c>

00:50:25.030 --> 00:50:25.040 align:start position:0%
it's going to forward the data to the
 

00:50:25.040 --> 00:50:27.109 align:start position:0%
it's going to forward the data to the
main<00:50:25.359><c> query</c><00:50:25.880><c> and</c><00:50:26.040><c> normally</c><00:50:26.400><c> we</c><00:50:26.720><c> use</c><00:50:26.960><c> the</c>

00:50:27.109 --> 00:50:27.119 align:start position:0%
main query and normally we use the
 

00:50:27.119 --> 00:50:29.710 align:start position:0%
main query and normally we use the
recursive<00:50:27.599><c> CTE</c><00:50:28.599><c> if</c><00:50:28.680><c> you</c><00:50:28.839><c> are</c><00:50:29.079><c> navigating</c>

00:50:29.710 --> 00:50:29.720 align:start position:0%
recursive CTE if you are navigating
 

00:50:29.720 --> 00:50:31.670 align:start position:0%
recursive CTE if you are navigating
through<00:50:30.040><c> hierarchical</c><00:50:30.680><c> structure</c><00:50:31.319><c> so</c><00:50:31.480><c> if</c><00:50:31.559><c> you</c>

00:50:31.670 --> 00:50:31.680 align:start position:0%
through hierarchical structure so if you
 

00:50:31.680 --> 00:50:33.349 align:start position:0%
through hierarchical structure so if you
have<00:50:31.839><c> in</c><00:50:31.960><c> your</c><00:50:32.160><c> data</c><00:50:32.480><c> like</c><00:50:32.760><c> hierarchical</c>

00:50:33.349 --> 00:50:33.359 align:start position:0%
have in your data like hierarchical
 

00:50:33.359 --> 00:50:35.470 align:start position:0%
have in your data like hierarchical
structures<00:50:34.160><c> you</c><00:50:34.280><c> can</c><00:50:34.440><c> go</c><00:50:34.559><c> and</c><00:50:34.760><c> use</c><00:50:35.079><c> recursive</c>

00:50:35.470 --> 00:50:35.480 align:start position:0%
structures you can go and use recursive
 

00:50:35.480 --> 00:50:38.270 align:start position:0%
structures you can go and use recursive
CTE<00:50:36.200><c> in</c><00:50:36.359><c> order</c><00:50:36.680><c> to</c><00:50:36.839><c> navigate</c><00:50:37.319><c> through</c><00:50:37.520><c> it</c><00:50:37.960><c> so</c>

00:50:38.270 --> 00:50:38.280 align:start position:0%
CTE in order to navigate through it so
 

00:50:38.280 --> 00:50:40.510 align:start position:0%
CTE in order to navigate through it so
this<00:50:38.440><c> is</c><00:50:38.799><c> the</c><00:50:39.040><c> recursive</c><00:50:39.520><c> CTE</c><00:50:40.160><c> okay</c><00:50:40.280><c> so</c><00:50:40.400><c> now</c>

00:50:40.510 --> 00:50:40.520 align:start position:0%
this is the recursive CTE okay so now
 

00:50:40.520 --> 00:50:42.030 align:start position:0%
this is the recursive CTE okay so now
let's<00:50:40.680><c> check</c><00:50:40.880><c> the</c><00:50:41.000><c> syntax</c><00:50:41.400><c> of</c><00:50:41.520><c> the</c><00:50:41.640><c> recursive</c>

00:50:42.030 --> 00:50:42.040 align:start position:0%
let's check the syntax of the recursive
 

00:50:42.040 --> 00:50:44.109 align:start position:0%
let's check the syntax of the recursive
CTE<00:50:42.760><c> it</c><00:50:42.880><c> is</c><00:50:42.960><c> a</c><00:50:43.079><c> little</c><00:50:43.240><c> bit</c><00:50:43.440><c> complicated</c><00:50:44.000><c> but</c>

00:50:44.109 --> 00:50:44.119 align:start position:0%
CTE it is a little bit complicated but
 

00:50:44.119 --> 00:50:45.870 align:start position:0%
CTE it is a little bit complicated but
we're<00:50:44.240><c> going</c><00:50:44.319><c> to</c><00:50:44.480><c> do</c><00:50:44.599><c> it</c><00:50:44.760><c> step</c><00:50:45.000><c> by</c><00:50:45.240><c> step</c><00:50:45.640><c> so</c>

00:50:45.870 --> 00:50:45.880 align:start position:0%
we're going to do it step by step so
 

00:50:45.880 --> 00:50:48.030 align:start position:0%
we're going to do it step by step so
what<00:50:46.000><c> do</c><00:50:46.119><c> we</c><00:50:46.319><c> have</c><00:50:46.640><c> we</c><00:50:46.799><c> have</c><00:50:46.960><c> a</c><00:50:47.200><c> query</c><00:50:47.839><c> and</c><00:50:47.960><c> we</c>

00:50:48.030 --> 00:50:48.040 align:start position:0%
what do we have we have a query and we
 

00:50:48.040 --> 00:50:50.190 align:start position:0%
what do we have we have a query and we
would<00:50:48.200><c> like</c><00:50:48.359><c> to</c><00:50:48.520><c> put</c><00:50:48.680><c> it</c><00:50:48.839><c> in</c><00:50:49.119><c> a</c><00:50:49.799><c> so</c><00:50:50.000><c> we're</c><00:50:50.119><c> going</c>

00:50:50.190 --> 00:50:50.200 align:start position:0%
would like to put it in a so we're going
 

00:50:50.200 --> 00:50:52.829 align:start position:0%
would like to put it in a so we're going
to<00:50:50.359><c> have</c><00:50:50.680><c> the</c><00:50:50.839><c> usual</c><00:50:51.160><c> stuff</c><00:50:51.839><c> with</c><00:50:52.119><c> Cloud</c><00:50:52.680><c> the</c>

00:50:52.829 --> 00:50:52.839 align:start position:0%
to have the usual stuff with Cloud the
 

00:50:52.839 --> 00:50:55.549 align:start position:0%
to have the usual stuff with Cloud the
name<00:50:53.040><c> of</c><00:50:53.200><c> the</c><00:50:53.319><c> CTE</c><00:50:54.200><c> and</c><00:50:54.440><c> ask</c><00:50:54.839><c> and</c><00:50:55.000><c> then</c><00:50:55.240><c> the</c>

00:50:55.549 --> 00:50:55.559 align:start position:0%
name of the CTE and ask and then the
 

00:50:55.559 --> 00:50:57.750 align:start position:0%
name of the CTE and ask and then the
query<00:50:56.200><c> so</c><00:50:56.520><c> this</c><00:50:56.680><c> this</c><00:50:56.799><c> is</c><00:50:57.000><c> the</c><00:50:57.200><c> definition</c><00:50:57.599><c> of</c>

00:50:57.750 --> 00:50:57.760 align:start position:0%
query so this this is the definition of
 

00:50:57.760 --> 00:50:59.829 align:start position:0%
query so this this is the definition of
our<00:50:58.079><c> C</c><00:50:58.640><c> but</c><00:50:58.760><c> now</c><00:50:58.920><c> if</c><00:50:59.000><c> you</c><00:50:59.119><c> leave</c><00:50:59.280><c> it</c><00:50:59.440><c> like</c><00:50:59.640><c> this</c>

00:50:59.829 --> 00:50:59.839 align:start position:0%
our C but now if you leave it like this
 

00:50:59.839 --> 00:51:02.190 align:start position:0%
our C but now if you leave it like this
SQL<00:51:00.240><c> can</c><00:51:00.480><c> execute</c><00:51:00.839><c> it</c><00:51:01.040><c> only</c><00:51:01.359><c> once</c><00:51:01.960><c> but</c><00:51:02.079><c> we</c>

00:51:02.190 --> 00:51:02.200 align:start position:0%
SQL can execute it only once but we
 

00:51:02.200 --> 00:51:04.230 align:start position:0%
SQL can execute it only once but we
would<00:51:02.359><c> like</c><00:51:02.480><c> to</c><00:51:02.599><c> make</c><00:51:02.760><c> a</c><00:51:02.920><c> Lube</c><00:51:03.319><c> iteration</c><00:51:04.079><c> so</c>

00:51:04.230 --> 00:51:04.240 align:start position:0%
would like to make a Lube iteration so
 

00:51:04.240 --> 00:51:06.030 align:start position:0%
would like to make a Lube iteration so
in<00:51:04.359><c> order</c><00:51:04.680><c> to</c><00:51:04.799><c> do</c><00:51:05.000><c> that</c><00:51:05.200><c> we</c><00:51:05.319><c> have</c><00:51:05.440><c> to</c><00:51:05.599><c> go</c><00:51:05.760><c> and</c>

00:51:06.030 --> 00:51:06.040 align:start position:0%
in order to do that we have to go and
 

00:51:06.040 --> 00:51:09.069 align:start position:0%
in order to do that we have to go and
Define<00:51:06.880><c> a</c><00:51:07.079><c> second</c><00:51:07.559><c> select</c><00:51:08.000><c> statement</c><00:51:08.720><c> inside</c>

00:51:09.069 --> 00:51:09.079 align:start position:0%
Define a second select statement inside
 

00:51:09.079 --> 00:51:11.870 align:start position:0%
Define a second select statement inside
our<00:51:09.359><c> CTE</c><00:51:10.160><c> like</c><00:51:10.400><c> this</c><00:51:10.799><c> so</c><00:51:11.040><c> we</c><00:51:11.160><c> are</c><00:51:11.400><c> selecting</c>

00:51:11.870 --> 00:51:11.880 align:start position:0%
our CTE like this so we are selecting
 

00:51:11.880 --> 00:51:14.349 align:start position:0%
our CTE like this so we are selecting
the<00:51:12.119><c> data</c><00:51:12.880><c> and</c><00:51:13.079><c> here</c><00:51:13.200><c> we</c><00:51:13.319><c> have</c><00:51:13.440><c> to</c><00:51:13.640><c> define</c><00:51:14.160><c> a</c>

00:51:14.349 --> 00:51:14.359 align:start position:0%
the data and here we have to define a
 

00:51:14.359 --> 00:51:16.430 align:start position:0%
the data and here we have to define a
breaking<00:51:15.079><c> condition</c><00:51:15.559><c> so</c><00:51:15.760><c> here</c><00:51:15.880><c> in</c><00:51:16.000><c> the</c><00:51:16.160><c> second</c>

00:51:16.430 --> 00:51:16.440 align:start position:0%
breaking condition so here in the second
 

00:51:16.440 --> 00:51:18.430 align:start position:0%
breaking condition so here in the second
query<00:51:16.799><c> we</c><00:51:16.920><c> are</c><00:51:17.119><c> defining</c><00:51:17.599><c> a</c><00:51:18.000><c> condition</c><00:51:18.280><c> in</c>

00:51:18.430 --> 00:51:18.440 align:start position:0%
query we are defining a condition in
 

00:51:18.440 --> 00:51:21.069 align:start position:0%
query we are defining a condition in
order<00:51:18.839><c> to</c><00:51:19.079><c> break</c><00:51:19.440><c> the</c><00:51:19.599><c> lube</c><00:51:20.359><c> otherwise</c><00:51:20.920><c> it's</c>

00:51:21.069 --> 00:51:21.079 align:start position:0%
order to break the lube otherwise it's
 

00:51:21.079 --> 00:51:22.829 align:start position:0%
order to break the lube otherwise it's
going<00:51:21.160><c> to</c><00:51:21.280><c> Loop</c><00:51:21.520><c> for</c><00:51:21.720><c> infinite</c><00:51:22.160><c> or</c><00:51:22.440><c> the</c><00:51:22.559><c> system</c>

00:51:22.829 --> 00:51:22.839 align:start position:0%
going to Loop for infinite or the system
 

00:51:22.839 --> 00:51:24.430 align:start position:0%
going to Loop for infinite or the system
going<00:51:22.960><c> to</c><00:51:23.119><c> break</c><00:51:23.599><c> you</c><00:51:23.680><c> could</c><00:51:23.839><c> use</c><00:51:24.000><c> it</c><00:51:24.160><c> in</c><00:51:24.280><c> the</c>

00:51:24.430 --> 00:51:24.440 align:start position:0%
going to break you could use it in the
 

00:51:24.440 --> 00:51:26.710 align:start position:0%
going to break you could use it in the
work<00:51:24.760><c> clouds</c><00:51:25.160><c> or</c><00:51:25.319><c> you</c><00:51:25.400><c> can</c><00:51:25.599><c> use</c><00:51:25.760><c> it</c><00:51:25.920><c> even</c><00:51:26.240><c> in</c><00:51:26.599><c> an</c>

00:51:26.710 --> 00:51:26.720 align:start position:0%
work clouds or you can use it even in an
 

00:51:26.720 --> 00:51:28.470 align:start position:0%
work clouds or you can use it even in an
inner<00:51:27.000><c> join</c><00:51:27.559><c> because</c><00:51:27.880><c> both</c><00:51:28.040><c> of</c><00:51:28.160><c> them</c><00:51:28.319><c> are</c>

00:51:28.470 --> 00:51:28.480 align:start position:0%
inner join because both of them are
 

00:51:28.480 --> 00:51:30.109 align:start position:0%
inner join because both of them are
filtering<00:51:28.960><c> the</c><00:51:29.119><c> data</c><00:51:29.400><c> and</c><00:51:29.520><c> you</c><00:51:29.640><c> can</c><00:51:29.760><c> use</c><00:51:29.880><c> it</c><00:51:30.040><c> in</c>

00:51:30.109 --> 00:51:30.119 align:start position:0%
filtering the data and you can use it in
 

00:51:30.119 --> 00:51:32.030 align:start position:0%
filtering the data and you can use it in
order<00:51:30.359><c> to</c><00:51:30.480><c> break</c><00:51:30.880><c> the</c><00:51:31.240><c> condition</c><00:51:31.760><c> all</c><00:51:31.880><c> right</c>

00:51:32.030 --> 00:51:32.040 align:start position:0%
order to break the condition all right
 

00:51:32.040 --> 00:51:34.190 align:start position:0%
order to break the condition all right
so<00:51:32.240><c> now</c><00:51:32.599><c> still</c><00:51:33.200><c> there</c><00:51:33.280><c> is</c><00:51:33.440><c> something</c><00:51:33.760><c> missing</c>

00:51:34.190 --> 00:51:34.200 align:start position:0%
so now still there is something missing
 

00:51:34.200 --> 00:51:36.589 align:start position:0%
so now still there is something missing
how<00:51:34.359><c> we</c><00:51:34.559><c> going</c><00:51:34.640><c> to</c><00:51:34.799><c> make</c><00:51:35.160><c> like</c><00:51:35.440><c> things</c><00:51:35.760><c> looping</c>

00:51:36.589 --> 00:51:36.599 align:start position:0%
how we going to make like things looping
 

00:51:36.599 --> 00:51:38.750 align:start position:0%
how we going to make like things looping
well<00:51:36.760><c> we</c><00:51:36.920><c> have</c><00:51:37.040><c> to</c><00:51:37.240><c> reference</c><00:51:37.920><c> this</c><00:51:38.119><c> CTE</c><00:51:38.559><c> to</c>

00:51:38.750 --> 00:51:38.760 align:start position:0%
well we have to reference this CTE to
 

00:51:38.760 --> 00:51:40.430 align:start position:0%
well we have to reference this CTE to
itself<00:51:39.480><c> so</c><00:51:39.680><c> what</c><00:51:39.799><c> we're</c><00:51:39.920><c> going</c><00:51:40.040><c> to</c><00:51:40.160><c> do</c><00:51:40.319><c> we're</c>

00:51:40.430 --> 00:51:40.440 align:start position:0%
itself so what we're going to do we're
 

00:51:40.440 --> 00:51:42.710 align:start position:0%
itself so what we're going to do we're
going<00:51:40.559><c> to</c><00:51:40.680><c> say</c><00:51:41.559><c> the</c><00:51:41.720><c> second</c><00:51:42.079><c> query</c><00:51:42.440><c> going</c><00:51:42.559><c> to</c>

00:51:42.710 --> 00:51:42.720 align:start position:0%
going to say the second query going to
 

00:51:42.720 --> 00:51:45.870 align:start position:0%
going to say the second query going to
select<00:51:43.040><c> the</c><00:51:43.240><c> data</c><00:51:43.760><c> from</c><00:51:44.280><c> the</c><00:51:44.520><c> same</c><00:51:44.799><c> CTE</c><00:51:45.640><c> so</c>

00:51:45.870 --> 00:51:45.880 align:start position:0%
select the data from the same CTE so
 

00:51:45.880 --> 00:51:47.630 align:start position:0%
select the data from the same CTE so
that<00:51:46.040><c> means</c><00:51:46.280><c> we</c><00:51:46.400><c> have</c><00:51:46.559><c> now</c><00:51:46.720><c> a</c><00:51:46.880><c> query</c><00:51:47.319><c> that</c><00:51:47.440><c> is</c>

00:51:47.630 --> 00:51:47.640 align:start position:0%
that means we have now a query that is
 

00:51:47.640 --> 00:51:49.589 align:start position:0%
that means we have now a query that is
querying<00:51:48.160><c> itself</c><00:51:48.799><c> and</c><00:51:48.920><c> this</c><00:51:49.040><c> is</c><00:51:49.160><c> of</c><00:51:49.359><c> course</c>

00:51:49.589 --> 00:51:49.599 align:start position:0%
querying itself and this is of course
 

00:51:49.599 --> 00:51:52.030 align:start position:0%
querying itself and this is of course
what<00:51:49.720><c> we</c><00:51:49.880><c> want</c><00:51:50.319><c> we</c><00:51:50.559><c> want</c><00:51:50.760><c> to</c><00:51:50.920><c> make</c><00:51:51.119><c> iterations</c>

00:51:52.030 --> 00:51:52.040 align:start position:0%
what we want we want to make iterations
 

00:51:52.040 --> 00:51:53.910 align:start position:0%
what we want we want to make iterations
and<00:51:52.200><c> we</c><00:51:52.280><c> want</c><00:51:52.480><c> to</c><00:51:52.640><c> make</c><00:51:52.799><c> a</c><00:51:52.880><c> loop</c><00:51:53.480><c> that's</c><00:51:53.680><c> why</c><00:51:53.799><c> we</c>

00:51:53.910 --> 00:51:53.920 align:start position:0%
and we want to make a loop that's why we
 

00:51:53.920 --> 00:51:55.910 align:start position:0%
and we want to make a loop that's why we
have<00:51:54.040><c> to</c><00:51:54.160><c> go</c><00:51:54.319><c> and</c><00:51:54.520><c> reference</c><00:51:54.960><c> it</c><00:51:55.160><c> to</c><00:51:55.359><c> itself</c>

00:51:55.910 --> 00:51:55.920 align:start position:0%
have to go and reference it to itself
 

00:51:55.920 --> 00:51:58.150 align:start position:0%
have to go and reference it to itself
and<00:51:56.040><c> now</c><00:51:56.200><c> in</c><00:51:56.839><c> you</c><00:51:56.920><c> cannot</c><00:51:57.240><c> have</c><00:51:57.359><c> it</c><00:51:57.680><c> like</c><00:51:57.960><c> this</c>

00:51:58.150 --> 00:51:58.160 align:start position:0%
and now in you cannot have it like this
 

00:51:58.160 --> 00:51:59.750 align:start position:0%
and now in you cannot have it like this
you<00:51:58.280><c> cannot</c><00:51:58.559><c> have</c><00:51:58.760><c> like</c><00:51:58.960><c> two</c><00:51:59.280><c> select</c>

00:51:59.750 --> 00:51:59.760 align:start position:0%
you cannot have like two select
 

00:51:59.760 --> 00:52:01.710 align:start position:0%
you cannot have like two select
statements<00:52:00.319><c> in</c><00:52:00.440><c> one</c><00:52:00.720><c> query</c><00:52:01.280><c> you</c><00:52:01.400><c> have</c><00:52:01.559><c> to</c>

00:52:01.710 --> 00:52:01.720 align:start position:0%
statements in one query you have to
 

00:52:01.720 --> 00:52:03.589 align:start position:0%
statements in one query you have to
connect<00:52:02.040><c> it</c><00:52:02.240><c> somehow</c><00:52:02.839><c> that's</c><00:52:03.000><c> why</c><00:52:03.200><c> we</c><00:52:03.280><c> can</c><00:52:03.440><c> go</c>

00:52:03.589 --> 00:52:03.599 align:start position:0%
connect it somehow that's why we can go
 

00:52:03.599 --> 00:52:06.270 align:start position:0%
connect it somehow that's why we can go
and<00:52:03.760><c> use</c><00:52:04.079><c> the</c><00:52:04.200><c> union</c><00:52:04.640><c> all</c><00:52:04.960><c> or</c><00:52:05.240><c> Union</c><00:52:05.839><c> depend</c><00:52:06.200><c> if</c>

00:52:06.270 --> 00:52:06.280 align:start position:0%
and use the union all or Union depend if
 

00:52:06.280 --> 00:52:08.069 align:start position:0%
and use the union all or Union depend if
you<00:52:06.400><c> want</c><00:52:06.520><c> to</c><00:52:06.640><c> have</c><00:52:06.799><c> duplicates</c><00:52:07.319><c> or</c><00:52:07.480><c> not</c><00:52:07.920><c> so</c>

00:52:08.069 --> 00:52:08.079 align:start position:0%
you want to have duplicates or not so
 

00:52:08.079 --> 00:52:10.589 align:start position:0%
you want to have duplicates or not so
now<00:52:08.280><c> we</c><00:52:08.480><c> call</c><00:52:08.760><c> the</c><00:52:08.960><c> first</c><00:52:09.280><c> query</c><00:52:09.839><c> the</c><00:52:10.079><c> anchor</c>

00:52:10.589 --> 00:52:10.599 align:start position:0%
now we call the first query the anchor
 

00:52:10.599 --> 00:52:12.670 align:start position:0%
now we call the first query the anchor
query<00:52:11.240><c> the</c><00:52:11.359><c> anchor</c><00:52:11.760><c> query</c><00:52:12.079><c> going</c><00:52:12.160><c> to</c><00:52:12.280><c> be</c><00:52:12.480><c> the</c>

00:52:12.670 --> 00:52:12.680 align:start position:0%
query the anchor query going to be the
 

00:52:12.680 --> 00:52:14.430 align:start position:0%
query the anchor query going to be the
first<00:52:13.000><c> query</c><00:52:13.400><c> that</c><00:52:13.599><c> interacts</c><00:52:14.160><c> with</c><00:52:14.280><c> the</c>

00:52:14.430 --> 00:52:14.440 align:start position:0%
first query that interacts with the
 

00:52:14.440 --> 00:52:17.630 align:start position:0%
first query that interacts with the
database<00:52:15.240><c> and</c><00:52:15.480><c> provide</c><00:52:15.920><c> us</c><00:52:16.520><c> the</c><00:52:16.720><c> initial</c>

00:52:17.630 --> 00:52:17.640 align:start position:0%
database and provide us the initial
 

00:52:17.640 --> 00:52:19.950 align:start position:0%
database and provide us the initial
intermediate<00:52:18.319><c> results</c><00:52:18.960><c> so</c><00:52:19.200><c> it</c><00:52:19.319><c> is</c><00:52:19.680><c> the</c>

00:52:19.950 --> 00:52:19.960 align:start position:0%
intermediate results so it is the
 

00:52:19.960 --> 00:52:22.109 align:start position:0%
intermediate results so it is the
starting<00:52:20.480><c> point</c><00:52:20.799><c> of</c><00:52:20.920><c> the</c><00:52:21.079><c> iteration</c><00:52:21.880><c> and</c><00:52:22.040><c> we</c>

00:52:22.109 --> 00:52:22.119 align:start position:0%
starting point of the iteration and we
 

00:52:22.119 --> 00:52:24.589 align:start position:0%
starting point of the iteration and we
can<00:52:22.280><c> say</c><00:52:22.559><c> it</c><00:52:22.720><c> is</c><00:52:23.079><c> the</c><00:52:23.319><c> first</c><00:52:23.720><c> step</c><00:52:24.160><c> in</c><00:52:24.359><c> the</c>

00:52:24.589 --> 00:52:24.599 align:start position:0%
can say it is the first step in the
 

00:52:24.599 --> 00:52:26.789 align:start position:0%
can say it is the first step in the
process<00:52:25.240><c> so</c><00:52:25.520><c> this</c><00:52:25.680><c> going</c><00:52:25.799><c> to</c><00:52:25.920><c> be</c><00:52:26.079><c> executed</c><00:52:26.599><c> it</c>

00:52:26.789 --> 00:52:26.799 align:start position:0%
process so this going to be executed it
 

00:52:26.799 --> 00:52:28.829 align:start position:0%
process so this going to be executed it
only<00:52:27.160><c> once</c><00:52:27.520><c> and</c><00:52:27.680><c> it's</c><00:52:27.799><c> going</c><00:52:27.960><c> to</c><00:52:28.119><c> provide</c><00:52:28.480><c> us</c>

00:52:28.829 --> 00:52:28.839 align:start position:0%
only once and it's going to provide us
 

00:52:28.839 --> 00:52:30.710 align:start position:0%
only once and it's going to provide us
the<00:52:29.040><c> initial</c><00:52:29.520><c> step</c><00:52:29.839><c> the</c><00:52:29.960><c> first</c><00:52:30.200><c> step</c><00:52:30.400><c> in</c><00:52:30.520><c> the</c>

00:52:30.710 --> 00:52:30.720 align:start position:0%
the initial step the first step in the
 

00:52:30.720 --> 00:52:33.390 align:start position:0%
the initial step the first step in the
process<00:52:31.359><c> now</c><00:52:31.559><c> we</c><00:52:31.720><c> call</c><00:52:32.079><c> the</c><00:52:32.319><c> Second</c><00:52:32.720><c> Step</c><00:52:33.040><c> as</c><00:52:33.280><c> a</c>

00:52:33.390 --> 00:52:33.400 align:start position:0%
process now we call the Second Step as a
 

00:52:33.400 --> 00:52:35.789 align:start position:0%
process now we call the Second Step as a
recursive<00:52:34.000><c> query</c><00:52:34.760><c> and</c><00:52:34.880><c> we</c><00:52:35.040><c> call</c><00:52:35.200><c> it</c><00:52:35.400><c> like</c><00:52:35.559><c> this</c>

00:52:35.789 --> 00:52:35.799 align:start position:0%
recursive query and we call it like this
 

00:52:35.799 --> 00:52:38.109 align:start position:0%
recursive query and we call it like this
because<00:52:36.319><c> this</c><00:52:36.520><c> query</c><00:52:36.880><c> can</c><00:52:37.000><c> to</c><00:52:37.119><c> be</c><00:52:37.359><c> executed</c>

00:52:38.109 --> 00:52:38.119 align:start position:0%
because this query can to be executed
 

00:52:38.119 --> 00:52:40.309 align:start position:0%
because this query can to be executed
multiple<00:52:38.680><c> times</c><00:52:39.319><c> and</c><00:52:39.520><c> it</c><00:52:39.640><c> will</c><00:52:39.960><c> keep</c>

00:52:40.309 --> 00:52:40.319 align:start position:0%
multiple times and it will keep
 

00:52:40.319 --> 00:52:42.390 align:start position:0%
multiple times and it will keep
repeating<00:52:41.000><c> and</c><00:52:41.280><c> add</c><00:52:41.640><c> data</c><00:52:42.000><c> to</c><00:52:42.200><c> the</c>

00:52:42.390 --> 00:52:42.400 align:start position:0%
repeating and add data to the
 

00:52:42.400 --> 00:52:45.309 align:start position:0%
repeating and add data to the
intermediate<00:52:42.960><c> results</c><00:52:43.920><c> until</c><00:52:44.559><c> the</c><00:52:44.960><c> condition</c>

00:52:45.309 --> 00:52:45.319 align:start position:0%
intermediate results until the condition
 

00:52:45.319 --> 00:52:47.470 align:start position:0%
intermediate results until the condition
is<00:52:45.559><c> met</c><00:52:46.119><c> or</c><00:52:46.359><c> let's</c><00:52:46.559><c> say</c><00:52:46.799><c> there</c><00:52:46.920><c> will</c><00:52:47.119><c> be</c><00:52:47.319><c> no</c>

00:52:47.470 --> 00:52:47.480 align:start position:0%
is met or let's say there will be no
 

00:52:47.480 --> 00:52:49.670 align:start position:0%
is met or let's say there will be no
more<00:52:47.760><c> data</c><00:52:48.079><c> that</c><00:52:48.200><c> is</c><00:52:48.440><c> available</c><00:52:49.240><c> to</c><00:52:49.400><c> be</c>

00:52:49.670 --> 00:52:49.680 align:start position:0%
more data that is available to be
 

00:52:49.680 --> 00:52:52.030 align:start position:0%
more data that is available to be
processed<00:52:50.240><c> so</c><00:52:50.680><c> this</c><00:52:50.799><c> is</c><00:52:51.160><c> the</c><00:52:51.400><c> syntax</c><00:52:51.839><c> of</c><00:52:51.920><c> the</c>

00:52:52.030 --> 00:52:52.040 align:start position:0%
processed so this is the syntax of the
 

00:52:52.040 --> 00:52:54.230 align:start position:0%
processed so this is the syntax of the
CTE<00:52:52.480><c> query</c><00:52:52.960><c> for</c><00:52:53.119><c> the</c><00:52:53.240><c> main</c><00:52:53.480><c> query</c><00:52:53.799><c> nothing</c><00:52:54.040><c> is</c>

00:52:54.230 --> 00:52:54.240 align:start position:0%
CTE query for the main query nothing is
 

00:52:54.240 --> 00:52:57.150 align:start position:0%
CTE query for the main query nothing is
changed<00:52:54.880><c> so</c><00:52:55.040><c> we</c><00:52:55.200><c> have</c><00:52:55.319><c> to</c><00:52:55.480><c> go</c><00:52:55.680><c> and</c><00:52:55.920><c> use</c><00:52:56.559><c> the</c><00:52:56.720><c> CTE</c>

00:52:57.150 --> 00:52:57.160 align:start position:0%
changed so we have to go and use the CTE
 

00:52:57.160 --> 00:53:00.270 align:start position:0%
changed so we have to go and use the CTE
name<00:52:57.799><c> in</c><00:52:57.960><c> the</c><00:52:58.119><c> main</c><00:52:58.440><c> query</c><00:52:59.280><c> so</c><00:52:59.720><c> this</c><00:52:59.839><c> is</c><00:53:00.119><c> the</c>

00:53:00.270 --> 00:53:00.280 align:start position:0%
name in the main query so this is the
 

00:53:00.280 --> 00:53:02.829 align:start position:0%
name in the main query so this is the
syntax<00:53:00.760><c> of</c><00:53:00.920><c> the</c><00:53:01.160><c> recursive</c><00:53:01.720><c> CTE</c><00:53:02.400><c> so</c><00:53:02.640><c> think</c>

00:53:02.829 --> 00:53:02.839 align:start position:0%
syntax of the recursive CTE so think
 

00:53:02.839 --> 00:53:04.470 align:start position:0%
syntax of the recursive CTE so think
about<00:53:03.040><c> it</c><00:53:03.200><c> like</c><00:53:03.400><c> this</c><00:53:03.599><c> isq</c><00:53:04.000><c> gonna</c><00:53:04.200><c> go</c><00:53:04.319><c> and</c>

00:53:04.470 --> 00:53:04.480 align:start position:0%
about it like this isq gonna go and
 

00:53:04.480 --> 00:53:07.950 align:start position:0%
about it like this isq gonna go and
execute<00:53:05.319><c> the</c><00:53:05.520><c> anchor</c><00:53:06.000><c> query</c><00:53:06.559><c> only</c><00:53:07.040><c> once</c><00:53:07.839><c> and</c>

00:53:07.950 --> 00:53:07.960 align:start position:0%
execute the anchor query only once and
 

00:53:07.960 --> 00:53:10.150 align:start position:0%
execute the anchor query only once and
then<00:53:08.119><c> after</c><00:53:08.359><c> that</c><00:53:08.880><c> going</c><00:53:09.000><c> to</c><00:53:09.119><c> go</c><00:53:09.359><c> through</c><00:53:09.720><c> the</c>

00:53:10.150 --> 00:53:10.160 align:start position:0%
then after that going to go through the
 

00:53:10.160 --> 00:53:12.670 align:start position:0%
then after that going to go through the
recursive<00:53:10.839><c> query</c><00:53:11.280><c> and</c><00:53:11.520><c> keep</c><00:53:11.880><c> looping</c><00:53:12.480><c> and</c>

00:53:12.670 --> 00:53:12.680 align:start position:0%
recursive query and keep looping and
 

00:53:12.680 --> 00:53:15.750 align:start position:0%
recursive query and keep looping and
looping<00:53:13.200><c> and</c><00:53:13.599><c> iterating</c><00:53:14.599><c> until</c><00:53:15.000><c> a</c><00:53:15.160><c> certain</c>

00:53:15.750 --> 00:53:15.760 align:start position:0%
looping and iterating until a certain
 

00:53:15.760 --> 00:53:17.829 align:start position:0%
looping and iterating until a certain
condition<00:53:16.000><c> is</c><00:53:16.200><c> met</c><00:53:16.680><c> and</c><00:53:16.920><c> then</c><00:53:17.200><c> isql</c><00:53:17.640><c> going</c><00:53:17.720><c> to</c>

00:53:17.829 --> 00:53:17.839 align:start position:0%
condition is met and then isql going to
 

00:53:17.839 --> 00:53:20.150 align:start position:0%
condition is met and then isql going to
go<00:53:18.000><c> out</c><00:53:18.359><c> from</c><00:53:18.559><c> the</c><00:53:18.680><c> CTE</c><00:53:19.400><c> so</c><00:53:19.640><c> this</c><00:53:19.760><c> is</c><00:53:19.920><c> actually</c>

00:53:20.150 --> 00:53:20.160 align:start position:0%
go out from the CTE so this is actually
 

00:53:20.160 --> 00:53:21.630 align:start position:0%
go out from the CTE so this is actually
what<00:53:20.319><c> we</c><00:53:20.480><c> mean</c><00:53:20.680><c> with</c><00:53:20.839><c> the</c><00:53:20.960><c> anchor</c><00:53:21.359><c> and</c>

00:53:21.630 --> 00:53:21.640 align:start position:0%
what we mean with the anchor and
 

00:53:21.640 --> 00:53:23.789 align:start position:0%
what we mean with the anchor and
recursive<00:53:22.359><c> queries</c><00:53:23.040><c> all</c><00:53:23.160><c> right</c><00:53:23.319><c> so</c><00:53:23.440><c> now</c><00:53:23.599><c> let's</c>

00:53:23.789 --> 00:53:23.799 align:start position:0%
recursive queries all right so now let's
 

00:53:23.799 --> 00:53:25.430 align:start position:0%
recursive queries all right so now let's
have<00:53:23.920><c> a</c><00:53:24.079><c> simple</c><00:53:24.400><c> task</c><00:53:24.640><c> in</c><00:53:24.799><c> order</c><00:53:25.040><c> to</c>

00:53:25.430 --> 00:53:25.440 align:start position:0%
have a simple task in order to
 

00:53:25.440 --> 00:53:27.230 align:start position:0%
have a simple task in order to
understand<00:53:25.559><c> the</c><00:53:25.720><c> recursive</c><00:53:26.200><c> City</c><00:53:26.839><c> so</c><00:53:27.079><c> the</c>

00:53:27.230 --> 00:53:27.240 align:start position:0%
understand the recursive City so the
 

00:53:27.240 --> 00:53:30.150 align:start position:0%
understand the recursive City so the
task<00:53:27.559><c> says</c><00:53:28.119><c> generate</c><00:53:28.599><c> a</c><00:53:28.760><c> sequence</c><00:53:29.200><c> of</c><00:53:29.359><c> numbers</c>

00:53:30.150 --> 00:53:30.160 align:start position:0%
task says generate a sequence of numbers
 

00:53:30.160 --> 00:53:32.870 align:start position:0%
task says generate a sequence of numbers
from<00:53:30.359><c> 1</c><00:53:30.640><c> to</c><00:53:30.880><c> 20</c><00:53:31.480><c> so</c><00:53:31.680><c> now</c><00:53:31.880><c> let's</c><00:53:32.079><c> do</c><00:53:32.240><c> it</c><00:53:32.440><c> step</c><00:53:32.680><c> by</c>

00:53:32.870 --> 00:53:32.880 align:start position:0%
from 1 to 20 so now let's do it step by
 

00:53:32.880 --> 00:53:34.589 align:start position:0%
from 1 to 20 so now let's do it step by
step<00:53:33.359><c> so</c><00:53:33.559><c> this</c><00:53:33.680><c> means</c><00:53:33.880><c> we</c><00:53:33.960><c> have</c><00:53:34.079><c> to</c><00:53:34.200><c> create</c><00:53:34.440><c> a</c>

00:53:34.589 --> 00:53:34.599 align:start position:0%
step so this means we have to create a
 

00:53:34.599 --> 00:53:38.230 align:start position:0%
step so this means we have to create a
loop<00:53:35.079><c> from</c><00:53:35.280><c> 1</c><00:53:35.559><c> to</c><00:53:35.839><c> 20</c><00:53:36.799><c> and</c><00:53:37.040><c> after</c><00:53:37.319><c> 20</c><00:53:37.839><c> the</c><00:53:37.960><c> loop</c>

00:53:38.230 --> 00:53:38.240 align:start position:0%
loop from 1 to 20 and after 20 the loop
 

00:53:38.240 --> 00:53:40.789 align:start position:0%
loop from 1 to 20 and after 20 the loop
should<00:53:38.559><c> stop</c><00:53:39.079><c> so</c><00:53:39.280><c> let's</c><00:53:39.480><c> go</c><00:53:39.640><c> and</c><00:53:39.839><c> do</c><00:53:40.040><c> it</c><00:53:40.520><c> now</c>

00:53:40.789 --> 00:53:40.799 align:start position:0%
should stop so let's go and do it now
 

00:53:40.799 --> 00:53:43.069 align:start position:0%
should stop so let's go and do it now
the<00:53:40.920><c> first</c><00:53:41.240><c> step</c><00:53:41.480><c> of</c><00:53:41.599><c> the</c><00:53:41.760><c> recursive</c><00:53:42.160><c> CTE</c><00:53:42.920><c> is</c>

00:53:43.069 --> 00:53:43.079 align:start position:0%
the first step of the recursive CTE is
 

00:53:43.079 --> 00:53:45.549 align:start position:0%
the first step of the recursive CTE is
to<00:53:43.280><c> build</c><00:53:43.720><c> the</c><00:53:43.880><c> anchor</c><00:53:44.319><c> query</c><00:53:44.880><c> so</c><00:53:45.119><c> the</c><00:53:45.240><c> anchor</c>

00:53:45.549 --> 00:53:45.559 align:start position:0%
to build the anchor query so the anchor
 

00:53:45.559 --> 00:53:47.710 align:start position:0%
to build the anchor query so the anchor
query<00:53:45.920><c> is</c><00:53:46.160><c> responsible</c><00:53:46.760><c> for</c><00:53:47.040><c> the</c><00:53:47.280><c> first</c>

00:53:47.710 --> 00:53:47.720 align:start position:0%
query is responsible for the first
 

00:53:47.720 --> 00:53:50.150 align:start position:0%
query is responsible for the first
iteration<00:53:48.520><c> so</c><00:53:48.720><c> this</c><00:53:48.839><c> means</c><00:53:49.240><c> the</c><00:53:49.440><c> first</c><00:53:49.760><c> row</c><00:53:50.040><c> of</c>

00:53:50.150 --> 00:53:50.160 align:start position:0%
iteration so this means the first row of
 

00:53:50.160 --> 00:53:52.710 align:start position:0%
iteration so this means the first row of
the<00:53:50.319><c> output</c><00:53:51.079><c> so</c><00:53:51.319><c> what</c><00:53:51.440><c> is</c><00:53:51.720><c> the</c><00:53:51.960><c> first</c><00:53:52.359><c> value</c>

00:53:52.710 --> 00:53:52.720 align:start position:0%
the output so what is the first value
 

00:53:52.720 --> 00:53:55.230 align:start position:0%
the output so what is the first value
between<00:53:53.040><c> one</c><00:53:53.319><c> and</c><00:53:53.480><c> 20</c><00:53:53.960><c> it</c><00:53:54.079><c> is</c><00:53:54.440><c> the</c><00:53:54.599><c> one</c><00:53:55.040><c> so</c>

00:53:55.230 --> 00:53:55.240 align:start position:0%
between one and 20 it is the one so
 

00:53:55.240 --> 00:53:57.390 align:start position:0%
between one and 20 it is the one so
let's<00:53:55.440><c> go</c><00:53:55.680><c> and</c><00:53:55.839><c> write</c><00:53:56.040><c> a</c><00:53:56.160><c> query</c><00:53:56.599><c> that</c><00:53:56.799><c> generate</c>

00:53:57.390 --> 00:53:57.400 align:start position:0%
let's go and write a query that generate
 

00:53:57.400 --> 00:54:00.750 align:start position:0%
let's go and write a query that generate
the<00:53:57.599><c> value</c><00:53:57.960><c> one</c><00:53:58.799><c> so</c><00:53:59.280><c> select</c><00:54:00.079><c> and</c><00:54:00.520><c> we're</c><00:54:00.640><c> going</c>

00:54:00.750 --> 00:54:00.760 align:start position:0%
the value one so select and we're going
 

00:54:00.760 --> 00:54:03.309 align:start position:0%
the value one so select and we're going
to<00:54:00.880><c> say</c><00:54:01.200><c> one</c><00:54:02.040><c> as</c><00:54:02.559><c> I'm</c><00:54:02.680><c> going</c><00:54:02.799><c> to</c><00:54:02.920><c> give</c><00:54:03.040><c> it</c><00:54:03.160><c> the</c>

00:54:03.309 --> 00:54:03.319 align:start position:0%
to say one as I'm going to give it the
 

00:54:03.319 --> 00:54:07.710 align:start position:0%
to say one as I'm going to give it the
name<00:54:04.119><c> my</c><00:54:04.880><c> number</c><00:54:05.880><c> so</c><00:54:06.640><c> that's</c><00:54:06.839><c> it</c><00:54:07.160><c> let's</c><00:54:07.319><c> go</c><00:54:07.559><c> and</c>

00:54:07.710 --> 00:54:07.720 align:start position:0%
name my number so that's it let's go and
 

00:54:07.720 --> 00:54:09.670 align:start position:0%
name my number so that's it let's go and
execute<00:54:08.119><c> it</c><00:54:08.400><c> now</c><00:54:08.559><c> you</c><00:54:08.640><c> can</c><00:54:08.799><c> see</c><00:54:08.960><c> in</c><00:54:09.079><c> the</c><00:54:09.240><c> output</c>

00:54:09.670 --> 00:54:09.680 align:start position:0%
execute it now you can see in the output
 

00:54:09.680 --> 00:54:12.549 align:start position:0%
execute it now you can see in the output
we<00:54:09.799><c> have</c><00:54:10.000><c> the</c><00:54:10.240><c> first</c><00:54:10.640><c> member</c><00:54:11.400><c> of</c><00:54:11.559><c> our</c><00:54:11.799><c> sequence</c>

00:54:12.549 --> 00:54:12.559 align:start position:0%
we have the first member of our sequence
 

00:54:12.559 --> 00:54:14.670 align:start position:0%
we have the first member of our sequence
and<00:54:12.760><c> this</c><00:54:12.880><c> is</c><00:54:13.240><c> exactly</c><00:54:13.760><c> the</c><00:54:13.960><c> task</c><00:54:14.319><c> of</c><00:54:14.480><c> the</c>

00:54:14.670 --> 00:54:14.680 align:start position:0%
and this is exactly the task of the
 

00:54:14.680 --> 00:54:17.630 align:start position:0%
and this is exactly the task of the
anchor<00:54:15.160><c> query</c><00:54:15.760><c> it</c><00:54:15.960><c> retrieves</c><00:54:16.880><c> the</c><00:54:17.079><c> first</c><00:54:17.400><c> step</c>

00:54:17.630 --> 00:54:17.640 align:start position:0%
anchor query it retrieves the first step
 

00:54:17.640 --> 00:54:20.950 align:start position:0%
anchor query it retrieves the first step
in<00:54:17.799><c> the</c><00:54:18.000><c> iteration</c><00:54:18.839><c> so</c><00:54:19.079><c> let's</c><00:54:19.280><c> go</c><00:54:19.480><c> and</c><00:54:19.640><c> call</c>

00:54:20.950 --> 00:54:20.960 align:start position:0%
in the iteration so let's go and call
 

00:54:20.960 --> 00:54:22.870 align:start position:0%
in the iteration so let's go and call
it

00:54:22.870 --> 00:54:22.880 align:start position:0%
it
 

00:54:22.880 --> 00:54:25.670 align:start position:0%
it
anchor<00:54:23.880><c> query</c><00:54:24.640><c> now</c><00:54:24.880><c> the</c><00:54:25.000><c> next</c><00:54:25.200><c> step</c><00:54:25.359><c> it</c><00:54:25.480><c> does</c>

00:54:25.670 --> 00:54:25.680 align:start position:0%
anchor query now the next step it does
 

00:54:25.680 --> 00:54:27.710 align:start position:0%
anchor query now the next step it does
we<00:54:25.760><c> have</c><00:54:25.880><c> to</c><00:54:26.000><c> go</c><00:54:26.119><c> and</c><00:54:26.400><c> build</c><00:54:26.680><c> the</c><00:54:26.839><c> iteration</c><00:54:27.559><c> so</c>

00:54:27.710 --> 00:54:27.720 align:start position:0%
we have to go and build the iteration so
 

00:54:27.720 --> 00:54:30.710 align:start position:0%
we have to go and build the iteration so
we<00:54:27.839><c> need</c><00:54:28.079><c> a</c><00:54:28.280><c> CTE</c><00:54:29.240><c> so</c><00:54:29.720><c> I</c><00:54:29.839><c> will</c><00:54:30.040><c> build</c><00:54:30.359><c> now</c><00:54:30.559><c> the</c>

00:54:30.710 --> 00:54:30.720 align:start position:0%
we need a CTE so I will build now the
 

00:54:30.720 --> 00:54:33.030 align:start position:0%
we need a CTE so I will build now the
CTE<00:54:31.319><c> so</c><00:54:31.520><c> we're</c><00:54:31.640><c> going</c><00:54:31.720><c> to</c><00:54:31.839><c> say</c><00:54:32.160><c> with</c><00:54:32.920><c> we're</c>

00:54:33.030 --> 00:54:33.040 align:start position:0%
CTE so we're going to say with we're
 

00:54:33.040 --> 00:54:35.589 align:start position:0%
CTE so we're going to say with we're
going<00:54:33.160><c> to</c><00:54:33.280><c> call</c><00:54:33.480><c> it</c><00:54:33.720><c> serus</c><00:54:34.720><c> and</c><00:54:34.920><c> then</c><00:54:35.440><c> we're</c>

00:54:35.589 --> 00:54:35.599 align:start position:0%
going to call it serus and then we're
 

00:54:35.599 --> 00:54:38.270 align:start position:0%
going to call it serus and then we're
going<00:54:35.720><c> to</c><00:54:35.920><c> put</c><00:54:36.280><c> everything</c><00:54:36.720><c> in</c><00:54:37.280><c> parenthesis</c>

00:54:38.270 --> 00:54:38.280 align:start position:0%
going to put everything in parenthesis
 

00:54:38.280 --> 00:54:39.470 align:start position:0%
going to put everything in parenthesis
and<00:54:38.400><c> then</c><00:54:38.520><c> we're</c><00:54:38.640><c> going</c><00:54:38.760><c> to</c><00:54:38.839><c> go</c><00:54:38.960><c> to</c><00:54:39.079><c> the</c><00:54:39.200><c> main</c>

00:54:39.470 --> 00:54:39.480 align:start position:0%
and then we're going to go to the main
 

00:54:39.480 --> 00:54:42.470 align:start position:0%
and then we're going to go to the main
query<00:54:40.240><c> so</c><00:54:40.559><c> this</c><00:54:40.680><c> is</c><00:54:40.880><c> the</c><00:54:41.000><c> main</c><00:54:41.280><c> query</c><00:54:42.160><c> and</c><00:54:42.359><c> we</c>

00:54:42.470 --> 00:54:42.480 align:start position:0%
query so this is the main query and we
 

00:54:42.480 --> 00:54:46.589 align:start position:0%
query so this is the main query and we
will<00:54:42.680><c> go</c><00:54:42.839><c> and</c><00:54:43.240><c> select</c><00:54:43.880><c> everything</c><00:54:44.760><c> from</c><00:54:45.760><c> the</c>

00:54:46.589 --> 00:54:46.599 align:start position:0%
will go and select everything from the
 

00:54:46.599 --> 00:54:49.630 align:start position:0%
will go and select everything from the
serus<00:54:47.200><c> the</c><00:54:47.359><c> CTE</c><00:54:48.119><c> so</c><00:54:48.400><c> let's</c><00:54:48.599><c> go</c><00:54:48.799><c> and</c><00:54:49.079><c> execute</c><00:54:49.440><c> it</c>

00:54:49.630 --> 00:54:49.640 align:start position:0%
serus the CTE so let's go and execute it
 

00:54:49.640 --> 00:54:50.990 align:start position:0%
serus the CTE so let's go and execute it
just<00:54:49.760><c> to</c><00:54:49.920><c> make</c><00:54:50.040><c> sure</c><00:54:50.280><c> that</c><00:54:50.520><c> everything</c><00:54:50.839><c> is</c>

00:54:50.990 --> 00:54:51.000 align:start position:0%
just to make sure that everything is
 

00:54:51.000 --> 00:54:52.950 align:start position:0%
just to make sure that everything is
working<00:54:51.400><c> fine</c><00:54:51.799><c> so</c><00:54:52.000><c> we</c><00:54:52.119><c> didn't</c><00:54:52.440><c> create</c><00:54:52.760><c> any</c>

00:54:52.950 --> 00:54:52.960 align:start position:0%
working fine so we didn't create any
 

00:54:52.960 --> 00:54:55.430 align:start position:0%
working fine so we didn't create any
Loop<00:54:53.280><c> or</c><00:54:53.480><c> anything</c><00:54:54.119><c> we</c><00:54:54.240><c> have</c><00:54:54.480><c> just</c><00:54:54.720><c> created</c><00:54:55.240><c> a</c>

00:54:55.430 --> 00:54:55.440 align:start position:0%
Loop or anything we have just created a
 

00:54:55.440 --> 00:54:58.190 align:start position:0%
Loop or anything we have just created a
city<00:54:56.400><c> on</c><00:54:56.520><c> top</c><00:54:56.720><c> on</c><00:54:56.920><c> the</c><00:54:57.119><c> anchor</c><00:54:57.520><c> query</c><00:54:57.920><c> and</c><00:54:58.040><c> we</c>

00:54:58.190 --> 00:54:58.200 align:start position:0%
city on top on the anchor query and we
 

00:54:58.200 --> 00:55:00.510 align:start position:0%
city on top on the anchor query and we
just<00:54:58.400><c> call</c><00:54:58.640><c> it</c><00:54:58.880><c> from</c><00:54:59.200><c> the</c><00:54:59.359><c> main</c><00:54:59.640><c> query</c><00:55:00.160><c> so</c><00:55:00.319><c> now</c>

00:55:00.510 --> 00:55:00.520 align:start position:0%
just call it from the main query so now
 

00:55:00.520 --> 00:55:02.630 align:start position:0%
just call it from the main query so now
we<00:55:00.640><c> come</c><00:55:00.839><c> to</c><00:55:01.040><c> the</c><00:55:01.319><c> second</c><00:55:01.760><c> step</c><00:55:02.079><c> of</c><00:55:02.240><c> building</c>

00:55:02.630 --> 00:55:02.640 align:start position:0%
we come to the second step of building
 

00:55:02.640 --> 00:55:05.109 align:start position:0%
we come to the second step of building
the<00:55:02.799><c> recursive</c><00:55:03.240><c> CTE</c><00:55:04.000><c> we</c><00:55:04.160><c> have</c><00:55:04.359><c> to</c><00:55:04.520><c> build</c><00:55:04.920><c> the</c>

00:55:05.109 --> 00:55:05.119 align:start position:0%
the recursive CTE we have to build the
 

00:55:05.119 --> 00:55:07.510 align:start position:0%
the recursive CTE we have to build the
recursive<00:55:05.839><c> query</c><00:55:06.480><c> so</c><00:55:06.680><c> let's</c><00:55:06.920><c> do</c><00:55:07.079><c> it</c><00:55:07.240><c> I</c><00:55:07.319><c> will</c>

00:55:07.510 --> 00:55:07.520 align:start position:0%
recursive query so let's do it I will
 

00:55:07.520 --> 00:55:09.270 align:start position:0%
recursive query so let's do it I will
just<00:55:07.720><c> make</c><00:55:07.960><c> this</c><00:55:08.119><c> a</c><00:55:08.200><c> little</c><00:55:08.400><c> bit</c><00:55:08.599><c> smaller</c><00:55:09.160><c> and</c>

00:55:09.270 --> 00:55:09.280 align:start position:0%
just make this a little bit smaller and
 

00:55:09.280 --> 00:55:11.390 align:start position:0%
just make this a little bit smaller and
now<00:55:09.440><c> before</c><00:55:09.640><c> we</c><00:55:09.799><c> start</c><00:55:10.040><c> writing</c><00:55:10.440><c> the</c><00:55:10.640><c> query</c><00:55:11.240><c> we</c>

00:55:11.390 --> 00:55:11.400 align:start position:0%
now before we start writing the query we
 

00:55:11.400 --> 00:55:13.549 align:start position:0%
now before we start writing the query we
have<00:55:11.559><c> to</c><00:55:11.680><c> go</c><00:55:11.880><c> and</c><00:55:12.040><c> use</c><00:55:12.520><c> Union</c>

00:55:13.549 --> 00:55:13.559 align:start position:0%
have to go and use Union
 

00:55:13.559 --> 00:55:16.109 align:start position:0%
have to go and use Union
all<00:55:14.559><c> in</c><00:55:14.680><c> order</c><00:55:14.960><c> to</c><00:55:15.119><c> go</c><00:55:15.240><c> and</c><00:55:15.480><c> connect</c><00:55:15.960><c> the</c>

00:55:16.109 --> 00:55:16.119 align:start position:0%
all in order to go and connect the
 

00:55:16.119 --> 00:55:18.510 align:start position:0%
all in order to go and connect the
anchor<00:55:16.480><c> query</c><00:55:16.799><c> with</c><00:55:16.920><c> the</c><00:55:17.079><c> recursive</c><00:55:17.559><c> query</c>

00:55:18.510 --> 00:55:18.520 align:start position:0%
anchor query with the recursive query
 

00:55:18.520 --> 00:55:21.109 align:start position:0%
anchor query with the recursive query
and<00:55:18.680><c> let</c><00:55:18.799><c> me</c><00:55:19.040><c> say</c><00:55:19.440><c> this</c><00:55:19.640><c> is</c><00:55:19.920><c> the</c>

00:55:21.109 --> 00:55:21.119 align:start position:0%
and let me say this is the
 

00:55:21.119 --> 00:55:23.349 align:start position:0%
and let me say this is the
recursive<00:55:22.119><c> query</c><00:55:22.720><c> so</c><00:55:22.920><c> how</c><00:55:23.039><c> we're</c><00:55:23.160><c> going</c><00:55:23.280><c> to</c>

00:55:23.349 --> 00:55:23.359 align:start position:0%
recursive query so how we're going to
 

00:55:23.359 --> 00:55:25.430 align:start position:0%
recursive query so how we're going to
build<00:55:23.599><c> it</c><00:55:24.280><c> let's</c><00:55:24.480><c> go</c><00:55:24.720><c> and</c><00:55:24.880><c> start</c><00:55:25.119><c> with</c><00:55:25.240><c> the</c>

00:55:25.430 --> 00:55:25.440 align:start position:0%
build it let's go and start with the
 

00:55:25.440 --> 00:55:27.750 align:start position:0%
build it let's go and start with the
select<00:55:26.039><c> and</c><00:55:26.160><c> now</c><00:55:26.440><c> next</c><00:55:26.640><c> what</c><00:55:26.760><c> I</c><00:55:26.880><c> usually</c><00:55:27.160><c> do</c><00:55:27.520><c> I</c>

00:55:27.750 --> 00:55:27.760 align:start position:0%
select and now next what I usually do I
 

00:55:27.760 --> 00:55:29.589 align:start position:0%
select and now next what I usually do I
just<00:55:28.000><c> make</c><00:55:28.160><c> sure</c><00:55:28.520><c> that</c><00:55:28.760><c> we</c><00:55:28.920><c> are</c><00:55:29.119><c> making</c><00:55:29.440><c> a</c>

00:55:29.589 --> 00:55:29.599 align:start position:0%
just make sure that we are making a
 

00:55:29.599 --> 00:55:33.109 align:start position:0%
just make sure that we are making a
recursive<00:55:30.039><c> CD</c><00:55:30.799><c> so</c><00:55:31.000><c> I</c><00:55:31.119><c> go</c><00:55:31.359><c> with</c><00:55:31.599><c> selecting</c><00:55:32.160><c> from</c>

00:55:33.109 --> 00:55:33.119 align:start position:0%
recursive CD so I go with selecting from
 

00:55:33.119 --> 00:55:34.870 align:start position:0%
recursive CD so I go with selecting from
and<00:55:33.319><c> then</c><00:55:33.480><c> we're</c><00:55:33.640><c> going</c><00:55:33.720><c> to</c><00:55:33.839><c> use</c><00:55:34.160><c> the</c><00:55:34.400><c> name</c><00:55:34.720><c> of</c>

00:55:34.870 --> 00:55:34.880 align:start position:0%
and then we're going to use the name of
 

00:55:34.880 --> 00:55:36.829 align:start position:0%
and then we're going to use the name of
the<00:55:35.079><c> current</c><00:55:35.359><c> CTE</c><00:55:36.079><c> so</c><00:55:36.280><c> that</c><00:55:36.480><c> we</c><00:55:36.599><c> are</c>

00:55:36.829 --> 00:55:36.839 align:start position:0%
the current CTE so that we are
 

00:55:36.839 --> 00:55:39.190 align:start position:0%
the current CTE so that we are
referencing<00:55:37.559><c> the</c><00:55:37.680><c> CTE</c><00:55:38.079><c> to</c><00:55:38.280><c> itself</c><00:55:38.760><c> in</c><00:55:38.880><c> order</c>

00:55:39.190 --> 00:55:39.200 align:start position:0%
referencing the CTE to itself in order
 

00:55:39.200 --> 00:55:42.349 align:start position:0%
referencing the CTE to itself in order
to<00:55:39.440><c> make</c><00:55:39.880><c> the</c><00:55:40.079><c> CTE</c><00:55:40.920><c> recursive</c><00:55:41.599><c> and</c><00:55:41.880><c> to</c><00:55:42.039><c> do</c><00:55:42.280><c> the</c>

00:55:42.349 --> 00:55:42.359 align:start position:0%
to make the CTE recursive and to do the
 

00:55:42.359 --> 00:55:45.109 align:start position:0%
to make the CTE recursive and to do the
looping<00:55:42.920><c> now</c><00:55:43.119><c> here</c><00:55:43.280><c> comes</c><00:55:43.720><c> the</c><00:55:43.920><c> tricky</c><00:55:44.359><c> part</c>

00:55:45.109 --> 00:55:45.119 align:start position:0%
looping now here comes the tricky part
 

00:55:45.119 --> 00:55:47.549 align:start position:0%
looping now here comes the tricky part
so<00:55:45.359><c> we</c><00:55:45.440><c> need</c><00:55:45.640><c> to</c><00:55:45.839><c> create</c><00:55:46.440><c> like</c><00:55:46.680><c> the</c><00:55:46.839><c> sequence</c>

00:55:47.549 --> 00:55:47.559 align:start position:0%
so we need to create like the sequence
 

00:55:47.559 --> 00:55:49.150 align:start position:0%
so we need to create like the sequence
now<00:55:47.799><c> what</c><00:55:47.960><c> is</c><00:55:48.240><c> the</c><00:55:48.400><c> current</c><00:55:48.760><c> value</c><00:55:49.039><c> the</c>

00:55:49.150 --> 00:55:49.160 align:start position:0%
now what is the current value the
 

00:55:49.160 --> 00:55:51.069 align:start position:0%
now what is the current value the
current<00:55:49.440><c> value</c><00:55:49.680><c> is</c><00:55:49.839><c> one</c><00:55:50.160><c> right</c><00:55:50.680><c> now</c><00:55:50.839><c> what</c><00:55:50.960><c> do</c>

00:55:51.069 --> 00:55:51.079 align:start position:0%
current value is one right now what do
 

00:55:51.079 --> 00:55:53.230 align:start position:0%
current value is one right now what do
we<00:55:51.200><c> need</c><00:55:51.400><c> we</c><00:55:51.520><c> need</c><00:55:51.799><c> the</c><00:55:51.960><c> second</c><00:55:52.520><c> value</c><00:55:52.880><c> in</c><00:55:53.039><c> the</c>

00:55:53.230 --> 00:55:53.240 align:start position:0%
we need we need the second value in the
 

00:55:53.240 --> 00:55:56.349 align:start position:0%
we need we need the second value in the
sequence<00:55:54.000><c> which</c><00:55:54.200><c> is</c><00:55:54.480><c> two</c><00:55:55.000><c> so</c><00:55:55.200><c> we</c><00:55:55.319><c> can</c><00:55:55.480><c> do</c><00:55:55.640><c> it</c><00:55:55.880><c> by</c>

00:55:56.349 --> 00:55:56.359 align:start position:0%
sequence which is two so we can do it by
 

00:55:56.359 --> 00:55:59.029 align:start position:0%
sequence which is two so we can do it by
1<00:55:56.799><c> +</c><00:55:57.280><c> 1</c><00:55:57.799><c> so</c><00:55:57.960><c> if</c><00:55:58.039><c> you</c><00:55:58.160><c> do</c><00:55:58.280><c> it</c><00:55:58.440><c> like</c><00:55:58.640><c> this</c><00:55:58.760><c> you</c><00:55:58.839><c> will</c>

00:55:59.029 --> 00:55:59.039 align:start position:0%
1 + 1 so if you do it like this you will
 

00:55:59.039 --> 00:56:01.230 align:start position:0%
1 + 1 so if you do it like this you will
get<00:55:59.359><c> the</c><00:55:59.480><c> output</c><00:55:59.960><c> two</c><00:56:00.480><c> but</c><00:56:00.680><c> actually</c><00:56:01.000><c> what</c><00:56:01.119><c> we</c>

00:56:01.230 --> 00:56:01.240 align:start position:0%
get the output two but actually what we
 

00:56:01.240 --> 00:56:03.270 align:start position:0%
get the output two but actually what we
are<00:56:01.359><c> doing</c><00:56:01.680><c> here</c><00:56:01.880><c> we</c><00:56:02.000><c> are</c><00:56:02.160><c> always</c><00:56:02.520><c> taking</c><00:56:02.960><c> the</c>

00:56:03.270 --> 00:56:03.280 align:start position:0%
are doing here we are always taking the
 

00:56:03.280 --> 00:56:06.309 align:start position:0%
are doing here we are always taking the
current<00:56:03.760><c> value</c><00:56:04.440><c> and</c><00:56:04.599><c> we</c><00:56:04.680><c> are</c><00:56:04.839><c> saying</c><00:56:05.359><c> plus</c><00:56:05.640><c> one</c>

00:56:06.309 --> 00:56:06.319 align:start position:0%
current value and we are saying plus one
 

00:56:06.319 --> 00:56:08.750 align:start position:0%
current value and we are saying plus one
in<00:56:06.440><c> order</c><00:56:06.760><c> to</c><00:56:06.960><c> generate</c><00:56:07.559><c> the</c><00:56:07.720><c> next</c><00:56:08.119><c> value</c><00:56:08.599><c> so</c>

00:56:08.750 --> 00:56:08.760 align:start position:0%
in order to generate the next value so
 

00:56:08.760 --> 00:56:10.549 align:start position:0%
in order to generate the next value so
in<00:56:08.880><c> order</c><00:56:09.160><c> to</c><00:56:09.280><c> do</c><00:56:09.480><c> that</c><00:56:09.720><c> instead</c><00:56:10.039><c> of</c><00:56:10.200><c> saying</c>

00:56:10.549 --> 00:56:10.559 align:start position:0%
in order to do that instead of saying
 

00:56:10.559 --> 00:56:12.910 align:start position:0%
in order to do that instead of saying
one<00:56:11.240><c> we're</c><00:56:11.359><c> going</c><00:56:11.480><c> to</c><00:56:11.640><c> take</c><00:56:11.960><c> the</c><00:56:12.280><c> my</c><00:56:12.480><c> number</c>

00:56:12.910 --> 00:56:12.920 align:start position:0%
one we're going to take the my number
 

00:56:12.920 --> 00:56:15.150 align:start position:0%
one we're going to take the my number
the<00:56:13.240><c> current</c><00:56:13.720><c> value</c><00:56:14.280><c> and</c><00:56:14.400><c> we</c><00:56:14.520><c> going</c><00:56:14.640><c> to</c><00:56:14.839><c> add</c><00:56:15.000><c> to</c>

00:56:15.150 --> 00:56:15.160 align:start position:0%
the current value and we going to add to
 

00:56:15.160 --> 00:56:18.109 align:start position:0%
the current value and we going to add to
it<00:56:15.559><c> plus</c><00:56:15.839><c> one</c><00:56:16.240><c> in</c><00:56:16.400><c> order</c><00:56:16.720><c> to</c><00:56:16.960><c> generate</c><00:56:17.839><c> the</c>

00:56:18.109 --> 00:56:18.119 align:start position:0%
it plus one in order to generate the
 

00:56:18.119 --> 00:56:20.109 align:start position:0%
it plus one in order to generate the
second<00:56:18.599><c> value</c><00:56:18.839><c> in</c><00:56:18.960><c> the</c><00:56:19.079><c> sequence</c><00:56:19.720><c> so</c><00:56:19.960><c> that</c>

00:56:20.109 --> 00:56:20.119 align:start position:0%
second value in the sequence so that
 

00:56:20.119 --> 00:56:23.150 align:start position:0%
second value in the sequence so that
means<00:56:20.599><c> my</c><00:56:20.799><c> number</c><00:56:21.240><c> always</c><00:56:21.680><c> holds</c><00:56:22.599><c> the</c><00:56:22.760><c> current</c>

00:56:23.150 --> 00:56:23.160 align:start position:0%
means my number always holds the current
 

00:56:23.160 --> 00:56:25.549 align:start position:0%
means my number always holds the current
value<00:56:23.960><c> and</c><00:56:24.200><c> we</c><00:56:24.319><c> do</c><00:56:24.520><c> the</c><00:56:24.680><c> operation</c><00:56:25.079><c> plus</c><00:56:25.280><c> one</c>

00:56:25.549 --> 00:56:25.559 align:start position:0%
value and we do the operation plus one
 

00:56:25.559 --> 00:56:28.069 align:start position:0%
value and we do the operation plus one
in<00:56:25.680><c> order</c><00:56:26.039><c> to</c><00:56:26.319><c> to</c><00:56:26.520><c> generate</c><00:56:27.400><c> the</c><00:56:27.599><c> next</c>

00:56:28.069 --> 00:56:28.079 align:start position:0%
in order to to generate the next
 

00:56:28.079 --> 00:56:30.270 align:start position:0%
in order to to generate the next
sequence<00:56:28.799><c> so</c><00:56:29.039><c> having</c><00:56:29.280><c> it</c><00:56:29.520><c> like</c><00:56:29.720><c> this</c><00:56:30.079><c> what</c><00:56:30.200><c> we</c>

00:56:30.270 --> 00:56:30.280 align:start position:0%
sequence so having it like this what we
 

00:56:30.280 --> 00:56:32.549 align:start position:0%
sequence so having it like this what we
are<00:56:30.440><c> doing</c><00:56:30.760><c> we</c><00:56:30.880><c> are</c><00:56:31.160><c> generating</c><00:56:31.880><c> the</c><00:56:32.079><c> sequence</c>

00:56:32.549 --> 00:56:32.559 align:start position:0%
are doing we are generating the sequence
 

00:56:32.559 --> 00:56:34.750 align:start position:0%
are doing we are generating the sequence
of<00:56:32.799><c> numbers</c><00:56:33.480><c> now</c><00:56:33.599><c> if</c><00:56:33.720><c> you</c><00:56:33.839><c> go</c><00:56:34.000><c> and</c><00:56:34.280><c> execute</c><00:56:34.599><c> it</c>

00:56:34.750 --> 00:56:34.760 align:start position:0%
of numbers now if you go and execute it
 

00:56:34.760 --> 00:56:37.470 align:start position:0%
of numbers now if you go and execute it
like<00:56:34.960><c> this</c><00:56:35.160><c> let</c><00:56:35.280><c> me</c><00:56:35.559><c> just</c><00:56:36.160><c> execute</c><00:56:36.599><c> it</c><00:56:37.319><c> what</c>

00:56:37.470 --> 00:56:37.480 align:start position:0%
like this let me just execute it what
 

00:56:37.480 --> 00:56:39.190 align:start position:0%
like this let me just execute it what
will<00:56:37.760><c> happen</c><00:56:38.039><c> it</c><00:56:38.160><c> going</c><00:56:38.280><c> to</c><00:56:38.440><c> breaks</c><00:56:38.880><c> because</c>

00:56:39.190 --> 00:56:39.200 align:start position:0%
will happen it going to breaks because
 

00:56:39.200 --> 00:56:42.150 align:start position:0%
will happen it going to breaks because
SQL<00:56:39.599><c> will</c><00:56:39.760><c> not</c><00:56:39.960><c> allow</c><00:56:40.319><c> it</c><00:56:40.640><c> and</c><00:56:40.880><c> SQL</c><00:56:41.319><c> set</c><00:56:41.520><c> it</c><00:56:41.680><c> to</c>

00:56:42.150 --> 00:56:42.160 align:start position:0%
SQL will not allow it and SQL set it to
 

00:56:42.160 --> 00:56:44.950 align:start position:0%
SQL will not allow it and SQL set it to
100<00:56:42.480><c> iterations</c><00:56:43.160><c> so</c><00:56:43.359><c> more</c><00:56:43.599><c> than</c><00:56:44.039><c> 100</c><00:56:44.520><c> isql</c>

00:56:44.950 --> 00:56:44.960 align:start position:0%
100 iterations so more than 100 isql
 

00:56:44.960 --> 00:56:46.630 align:start position:0%
100 iterations so more than 100 isql
going<00:56:45.039><c> to</c><00:56:45.160><c> break</c><00:56:45.359><c> the</c><00:56:45.520><c> query</c><00:56:46.079><c> so</c><00:56:46.280><c> that</c><00:56:46.480><c> we</c>

00:56:46.630 --> 00:56:46.640 align:start position:0%
going to break the query so that we
 

00:56:46.640 --> 00:56:49.430 align:start position:0%
going to break the query so that we
don't<00:56:46.960><c> have</c><00:56:47.319><c> infinite</c><00:56:47.720><c> number</c><00:56:48.160><c> of</c><00:56:48.440><c> looping</c><00:56:49.119><c> so</c>

00:56:49.430 --> 00:56:49.440 align:start position:0%
don't have infinite number of looping so
 

00:56:49.440 --> 00:56:51.630 align:start position:0%
don't have infinite number of looping so
this<00:56:49.559><c> is</c><00:56:49.760><c> bad</c><00:56:50.039><c> because</c><00:56:50.400><c> we</c><00:56:50.520><c> didn't</c><00:56:50.880><c> Define</c><00:56:51.400><c> the</c>

00:56:51.630 --> 00:56:51.640 align:start position:0%
this is bad because we didn't Define the
 

00:56:51.640 --> 00:56:53.910 align:start position:0%
this is bad because we didn't Define the
breaking<00:56:52.200><c> mechanism</c><00:56:52.760><c> of</c><00:56:52.920><c> the</c><00:56:53.039><c> looping</c><00:56:53.640><c> so</c><00:56:53.760><c> now</c>

00:56:53.910 --> 00:56:53.920 align:start position:0%
breaking mechanism of the looping so now
 

00:56:53.920 --> 00:56:55.309 align:start position:0%
breaking mechanism of the looping so now
we<00:56:54.000><c> have</c><00:56:54.160><c> to</c><00:56:54.359><c> Define</c><00:56:54.760><c> as</c><00:56:54.880><c> well</c><00:56:55.079><c> in</c><00:56:55.200><c> the</c>

00:56:55.309 --> 00:56:55.319 align:start position:0%
we have to Define as well in the
 

00:56:55.319 --> 00:56:56.829 align:start position:0%
we have to Define as well in the
recursive<00:56:55.839><c> query</c>

00:56:56.829 --> 00:56:56.839 align:start position:0%
recursive query
 

00:56:56.839 --> 00:56:58.589 align:start position:0%
recursive query
how<00:56:57.079><c> the</c><00:56:57.200><c> loop</c><00:56:57.480><c> going</c><00:56:57.559><c> to</c><00:56:57.720><c> ends</c><00:56:58.319><c> and</c><00:56:58.480><c> we</c>

00:56:58.589 --> 00:56:58.599 align:start position:0%
how the loop going to ends and we
 

00:56:58.599 --> 00:57:00.589 align:start position:0%
how the loop going to ends and we
usually<00:56:58.960><c> use</c><00:56:59.200><c> a</c><00:56:59.559><c> condition</c><00:56:59.880><c> for</c><00:57:00.079><c> example</c><00:57:00.480><c> we</c>

00:57:00.589 --> 00:57:00.599 align:start position:0%
usually use a condition for example we
 

00:57:00.599 --> 00:57:03.109 align:start position:0%
usually use a condition for example we
can<00:57:00.799><c> go</c><00:57:00.920><c> and</c><00:57:01.119><c> use</c><00:57:01.440><c> the</c><00:57:01.640><c> we</c><00:57:02.039><c> cloud</c><00:57:02.640><c> and</c><00:57:02.799><c> we</c><00:57:02.920><c> can</c>

00:57:03.109 --> 00:57:03.119 align:start position:0%
can go and use the we cloud and we can
 

00:57:03.119 --> 00:57:04.990 align:start position:0%
can go and use the we cloud and we can
say<00:57:03.720><c> okay</c><00:57:03.920><c> keep</c><00:57:04.200><c> looping</c><00:57:04.599><c> and</c><00:57:04.760><c> keep</c>

00:57:04.990 --> 00:57:05.000 align:start position:0%
say okay keep looping and keep
 

00:57:05.000 --> 00:57:07.510 align:start position:0%
say okay keep looping and keep
generating<00:57:05.640><c> but</c><00:57:05.839><c> always</c><00:57:06.200><c> check</c><00:57:06.520><c> whether</c><00:57:07.319><c> the</c>

00:57:07.510 --> 00:57:07.520 align:start position:0%
generating but always check whether the
 

00:57:07.520 --> 00:57:09.390 align:start position:0%
generating but always check whether the
value<00:57:07.839><c> of</c><00:57:08.119><c> the</c><00:57:08.480><c> my</c>

00:57:09.390 --> 00:57:09.400 align:start position:0%
value of the my
 

00:57:09.400 --> 00:57:14.109 align:start position:0%
value of the my
number<00:57:10.400><c> is</c><00:57:11.240><c> less</c><00:57:11.720><c> than</c><00:57:12.280><c> 20</c><00:57:13.280><c> and</c><00:57:13.400><c> you</c><00:57:13.520><c> might</c><00:57:13.799><c> ask</c>

00:57:14.109 --> 00:57:14.119 align:start position:0%
number is less than 20 and you might ask
 

00:57:14.119 --> 00:57:16.549 align:start position:0%
number is less than 20 and you might ask
okay<00:57:14.319><c> it</c><00:57:14.440><c> should</c><00:57:14.680><c> be</c><00:57:14.960><c> less</c><00:57:15.240><c> or</c><00:57:15.520><c> equal</c><00:57:15.880><c> to</c><00:57:16.079><c> 20</c>

00:57:16.549 --> 00:57:16.559 align:start position:0%
okay it should be less or equal to 20
 

00:57:16.559 --> 00:57:18.829 align:start position:0%
okay it should be less or equal to 20
right<00:57:17.039><c> well</c><00:57:17.319><c> no</c><00:57:17.680><c> because</c><00:57:18.000><c> if</c><00:57:18.119><c> you</c><00:57:18.200><c> are</c><00:57:18.400><c> making</c>

00:57:18.829 --> 00:57:18.839 align:start position:0%
right well no because if you are making
 

00:57:18.839 --> 00:57:20.870 align:start position:0%
right well no because if you are making
less<00:57:19.079><c> and</c><00:57:19.359><c> equal</c><00:57:19.640><c> to</c><00:57:19.839><c> 20</c><00:57:20.440><c> what</c><00:57:20.559><c> going</c><00:57:20.720><c> to</c>

00:57:20.870 --> 00:57:20.880 align:start position:0%
less and equal to 20 what going to
 

00:57:20.880 --> 00:57:23.670 align:start position:0%
less and equal to 20 what going to
happen<00:57:21.240><c> once</c><00:57:21.599><c> the</c><00:57:21.760><c> my</c><00:57:22.000><c> number</c><00:57:22.280><c> is</c><00:57:22.480><c> equal</c><00:57:22.760><c> to</c><00:57:22.920><c> 20</c>

00:57:23.670 --> 00:57:23.680 align:start position:0%
happen once the my number is equal to 20
 

00:57:23.680 --> 00:57:25.829 align:start position:0%
happen once the my number is equal to 20
you<00:57:23.799><c> are</c><00:57:24.039><c> allowing</c><00:57:24.640><c> one</c><00:57:24.839><c> more</c><00:57:25.079><c> iterations</c>

00:57:25.829 --> 00:57:25.839 align:start position:0%
you are allowing one more iterations
 

00:57:25.839 --> 00:57:28.549 align:start position:0%
you are allowing one more iterations
where<00:57:26.000><c> you</c><00:57:26.240><c> will</c><00:57:26.400><c> get</c><00:57:26.520><c> in</c><00:57:26.720><c> the</c><00:57:26.920><c> output</c><00:57:27.520><c> 21</c><00:57:28.359><c> so</c>

00:57:28.549 --> 00:57:28.559 align:start position:0%
where you will get in the output 21 so
 

00:57:28.559 --> 00:57:31.109 align:start position:0%
where you will get in the output 21 so
that's<00:57:28.799><c> why</c><00:57:29.000><c> we</c><00:57:29.119><c> are</c><00:57:29.280><c> making</c><00:57:29.599><c> it</c><00:57:29.839><c> with</c><00:57:30.160><c> 20</c><00:57:30.880><c> so</c>

00:57:31.109 --> 00:57:31.119 align:start position:0%
that's why we are making it with 20 so
 

00:57:31.119 --> 00:57:33.789 align:start position:0%
that's why we are making it with 20 so
now<00:57:31.839><c> let's</c><00:57:32.039><c> go</c><00:57:32.280><c> and</c><00:57:32.520><c> execute</c><00:57:32.960><c> it</c><00:57:33.400><c> and</c><00:57:33.599><c> let's</c>

00:57:33.789 --> 00:57:33.799 align:start position:0%
now let's go and execute it and let's
 

00:57:33.799 --> 00:57:35.990 align:start position:0%
now let's go and execute it and let's
check<00:57:34.000><c> the</c><00:57:34.200><c> sequence</c><00:57:34.640><c> it</c><00:57:34.760><c> starts</c><00:57:35.079><c> with</c><00:57:35.280><c> 1</c><00:57:35.480><c> 2</c><00:57:35.760><c> 3</c>

00:57:35.990 --> 00:57:36.000 align:start position:0%
check the sequence it starts with 1 2 3
 

00:57:36.000 --> 00:57:39.109 align:start position:0%
check the sequence it starts with 1 2 3
4<00:57:36.400><c> 5</c><00:57:36.960><c> and</c><00:57:37.240><c> until</c><00:57:37.520><c> we</c><00:57:37.680><c> reach</c><00:57:37.960><c> the</c><00:57:38.119><c> 20</c><00:57:38.720><c> so</c><00:57:38.960><c> with</c>

00:57:39.109 --> 00:57:39.119 align:start position:0%
4 5 and until we reach the 20 so with
 

00:57:39.119 --> 00:57:41.029 align:start position:0%
4 5 and until we reach the 20 so with
that<00:57:39.319><c> you</c><00:57:39.400><c> have</c><00:57:39.520><c> solved</c><00:57:39.799><c> the</c><00:57:39.960><c> task</c><00:57:40.559><c> again</c><00:57:40.799><c> here</c>

00:57:41.029 --> 00:57:41.039 align:start position:0%
that you have solved the task again here
 

00:57:41.039 --> 00:57:43.390 align:start position:0%
that you have solved the task again here
it's<00:57:41.200><c> not</c><00:57:41.480><c> that</c><00:57:41.760><c> hard</c><00:57:42.160><c> right</c><00:57:42.400><c> we</c><00:57:42.520><c> are</c><00:57:42.760><c> just</c>

00:57:43.390 --> 00:57:43.400 align:start position:0%
it's not that hard right we are just
 

00:57:43.400 --> 00:57:45.829 align:start position:0%
it's not that hard right we are just
providing<00:57:44.000><c> the</c><00:57:44.200><c> initial</c><00:57:44.680><c> step</c><00:57:45.359><c> and</c><00:57:45.520><c> then</c><00:57:45.720><c> we</c>

00:57:45.829 --> 00:57:45.839 align:start position:0%
providing the initial step and then we
 

00:57:45.839 --> 00:57:47.829 align:start position:0%
providing the initial step and then we
are<00:57:46.000><c> providing</c><00:57:46.520><c> the</c><00:57:46.680><c> loop</c><00:57:47.319><c> where</c><00:57:47.480><c> we</c><00:57:47.599><c> are</c>

00:57:47.829 --> 00:57:47.839 align:start position:0%
are providing the loop where we are
 

00:57:47.839 --> 00:57:49.910 align:start position:0%
are providing the loop where we are
defining<00:57:48.319><c> inside</c><00:57:48.680><c> it</c><00:57:49.000><c> how</c><00:57:49.240><c> the</c><00:57:49.400><c> loop</c><00:57:49.680><c> going</c><00:57:49.799><c> to</c>

00:57:49.910 --> 00:57:49.920 align:start position:0%
defining inside it how the loop going to
 

00:57:49.920 --> 00:57:51.670 align:start position:0%
defining inside it how the loop going to
ends<00:57:50.559><c> now</c><00:57:50.760><c> there</c><00:57:50.880><c> is</c><00:57:51.039><c> one</c><00:57:51.160><c> more</c><00:57:51.359><c> thing</c><00:57:51.559><c> that</c>

00:57:51.670 --> 00:57:51.680 align:start position:0%
ends now there is one more thing that
 

00:57:51.680 --> 00:57:53.870 align:start position:0%
ends now there is one more thing that
you<00:57:51.799><c> can</c><00:57:51.920><c> do</c><00:57:52.079><c> with</c><00:57:52.240><c> the</c><00:57:52.359><c> recursive</c><00:57:52.799><c> CTE</c><00:57:53.480><c> is</c><00:57:53.640><c> to</c>

00:57:53.870 --> 00:57:53.880 align:start position:0%
you can do with the recursive CTE is to
 

00:57:53.880 --> 00:57:56.710 align:start position:0%
you can do with the recursive CTE is to
define<00:57:54.559><c> the</c><00:57:54.839><c> limit</c><00:57:55.200><c> of</c><00:57:55.400><c> iterations</c><00:57:56.319><c> so</c><00:57:56.520><c> for</c>

00:57:56.710 --> 00:57:56.720 align:start position:0%
define the limit of iterations so for
 

00:57:56.720 --> 00:57:58.829 align:start position:0%
define the limit of iterations so for
example<00:57:57.160><c> in</c><00:57:57.280><c> your</c><00:57:57.480><c> code</c><00:57:57.760><c> if</c><00:57:57.880><c> you</c><00:57:58.000><c> say</c><00:57:58.359><c> okay</c><00:57:58.599><c> if</c>

00:57:58.829 --> 00:57:58.839 align:start position:0%
example in your code if you say okay if
 

00:57:58.839 --> 00:58:02.190 align:start position:0%
example in your code if you say okay if
this<00:57:59.039><c> iterates</c><00:57:59.680><c> more</c><00:58:00.000><c> than</c><00:58:00.520><c> 10</c><00:58:00.920><c> times</c><00:58:01.920><c> then</c>

00:58:02.190 --> 00:58:02.200 align:start position:0%
this iterates more than 10 times then
 

00:58:02.200 --> 00:58:04.910 align:start position:0%
this iterates more than 10 times then
the<00:58:02.400><c> SQL</c><00:58:02.880><c> should</c><00:58:03.359><c> breakes</c><00:58:03.880><c> and</c><00:58:04.160><c> stops</c><00:58:04.640><c> so</c><00:58:04.799><c> you</c>

00:58:04.910 --> 00:58:04.920 align:start position:0%
the SQL should breakes and stops so you
 

00:58:04.920 --> 00:58:07.109 align:start position:0%
the SQL should breakes and stops so you
can<00:58:05.079><c> Define</c><00:58:05.400><c> for</c><00:58:05.559><c> the</c><00:58:05.680><c> SQL</c><00:58:06.440><c> the</c><00:58:06.680><c> maximum</c>

00:58:07.109 --> 00:58:07.119 align:start position:0%
can Define for the SQL the maximum
 

00:58:07.119 --> 00:58:09.510 align:start position:0%
can Define for the SQL the maximum
number<00:58:07.440><c> of</c><00:58:07.720><c> recursions</c><00:58:08.680><c> so</c><00:58:08.880><c> how</c><00:58:09.000><c> we</c><00:58:09.119><c> can</c><00:58:09.319><c> do</c>

00:58:09.510 --> 00:58:09.520 align:start position:0%
number of recursions so how we can do
 

00:58:09.520 --> 00:58:12.150 align:start position:0%
number of recursions so how we can do
that<00:58:09.799><c> we</c><00:58:09.880><c> can</c><00:58:10.039><c> do</c><00:58:10.240><c> that</c><00:58:10.480><c> in</c><00:58:10.640><c> the</c><00:58:10.839><c> main</c><00:58:11.240><c> query</c><00:58:11.920><c> so</c>

00:58:12.150 --> 00:58:12.160 align:start position:0%
that we can do that in the main query so
 

00:58:12.160 --> 00:58:14.950 align:start position:0%
that we can do that in the main query so
if<00:58:12.280><c> you</c><00:58:12.400><c> go</c><00:58:12.559><c> over</c><00:58:12.799><c> here</c><00:58:13.000><c> and</c><00:58:13.200><c> say</c><00:58:13.839><c> option</c><00:58:14.760><c> then</c>

00:58:14.950 --> 00:58:14.960 align:start position:0%
if you go over here and say option then
 

00:58:14.960 --> 00:58:18.270 align:start position:0%
if you go over here and say option then
two<00:58:15.240><c> parenthesis</c><00:58:16.200><c> and</c><00:58:16.319><c> then</c><00:58:16.520><c> Max</c>

00:58:18.270 --> 00:58:18.280 align:start position:0%
two parenthesis and then Max
 

00:58:18.280 --> 00:58:20.670 align:start position:0%
two parenthesis and then Max
recursion<00:58:19.280><c> and</c><00:58:19.440><c> after</c><00:58:19.720><c> that</c><00:58:19.880><c> you</c><00:58:20.000><c> can</c><00:58:20.280><c> Define</c>

00:58:20.670 --> 00:58:20.680 align:start position:0%
recursion and after that you can Define
 

00:58:20.680 --> 00:58:22.750 align:start position:0%
recursion and after that you can Define
the<00:58:20.920><c> limit</c><00:58:21.520><c> so</c><00:58:21.680><c> for</c><00:58:21.880><c> example</c><00:58:22.160><c> let's</c><00:58:22.359><c> go</c><00:58:22.559><c> with</c>

00:58:22.750 --> 00:58:22.760 align:start position:0%
the limit so for example let's go with
 

00:58:22.760 --> 00:58:24.829 align:start position:0%
the limit so for example let's go with
the<00:58:23.000><c> 10</c><00:58:23.599><c> now</c><00:58:23.760><c> of</c><00:58:23.880><c> course</c><00:58:24.079><c> we</c><00:58:24.160><c> are</c><00:58:24.319><c> iterating</c><00:58:24.720><c> in</c>

00:58:24.829 --> 00:58:24.839 align:start position:0%
the 10 now of course we are iterating in
 

00:58:24.839 --> 00:58:27.430 align:start position:0%
the 10 now of course we are iterating in
our<00:58:25.079><c> code</c><00:58:25.359><c> now</c><00:58:25.559><c> more</c><00:58:25.799><c> than</c><00:58:26.200><c> 20</c><00:58:27.039><c> but</c><00:58:27.200><c> here</c><00:58:27.359><c> we</c>

00:58:27.430 --> 00:58:27.440 align:start position:0%
our code now more than 20 but here we
 

00:58:27.440 --> 00:58:29.630 align:start position:0%
our code now more than 20 but here we
are<00:58:27.599><c> making</c><00:58:27.920><c> the</c><00:58:28.079><c> rule</c><00:58:28.480><c> it</c><00:58:28.640><c> should</c><00:58:28.839><c> not</c><00:58:29.200><c> trade</c>

00:58:29.630 --> 00:58:29.640 align:start position:0%
are making the rule it should not trade
 

00:58:29.640 --> 00:58:32.150 align:start position:0%
are making the rule it should not trade
more<00:58:29.839><c> than</c><00:58:30.039><c> 10</c><00:58:30.520><c> so</c><00:58:30.799><c> let's</c><00:58:31.000><c> go</c><00:58:31.200><c> and</c><00:58:31.400><c> execute</c><00:58:31.799><c> it</c>

00:58:32.150 --> 00:58:32.160 align:start position:0%
more than 10 so let's go and execute it
 

00:58:32.160 --> 00:58:34.190 align:start position:0%
more than 10 so let's go and execute it
so<00:58:32.319><c> now</c><00:58:32.440><c> we</c><00:58:32.559><c> can</c><00:58:32.680><c> see</c><00:58:32.880><c> that</c><00:58:33.039><c> our</c><00:58:33.240><c> SQL</c><00:58:33.680><c> breaks</c>

00:58:34.190 --> 00:58:34.200 align:start position:0%
so now we can see that our SQL breaks
 

00:58:34.200 --> 00:58:37.309 align:start position:0%
so now we can see that our SQL breaks
and<00:58:34.400><c> it</c><00:58:34.520><c> says</c><00:58:35.160><c> the</c><00:58:35.319><c> maximum</c><00:58:35.760><c> recursion</c><00:58:36.400><c> is</c><00:58:36.760><c> 10</c>

00:58:37.309 --> 00:58:37.319 align:start position:0%
and it says the maximum recursion is 10
 

00:58:37.319 --> 00:58:38.670 align:start position:0%
and it says the maximum recursion is 10
so<00:58:37.480><c> as</c><00:58:37.599><c> you</c><00:58:37.680><c> can</c><00:58:37.799><c> see</c><00:58:37.920><c> now</c><00:58:38.079><c> in</c><00:58:38.160><c> the</c><00:58:38.280><c> output</c><00:58:38.599><c> we</c>

00:58:38.670 --> 00:58:38.680 align:start position:0%
so as you can see now in the output we
 

00:58:38.680 --> 00:58:40.549 align:start position:0%
so as you can see now in the output we
are<00:58:38.799><c> getting</c><00:58:39.039><c> the</c><00:58:39.160><c> error</c><00:58:39.480><c> of</c><00:58:39.720><c> having</c><00:58:40.319><c> more</c>

00:58:40.549 --> 00:58:40.559 align:start position:0%
are getting the error of having more
 

00:58:40.559 --> 00:58:42.910 align:start position:0%
are getting the error of having more
than<00:58:40.720><c> 10</c><00:58:40.960><c> iterations</c><00:58:41.880><c> which</c><00:58:42.160><c> is</c><00:58:42.319><c> not</c><00:58:42.520><c> allowed</c>

00:58:42.910 --> 00:58:42.920 align:start position:0%
than 10 iterations which is not allowed
 

00:58:42.920 --> 00:58:44.589 align:start position:0%
than 10 iterations which is not allowed
so<00:58:43.079><c> with</c><00:58:43.240><c> that</c><00:58:43.359><c> you</c><00:58:43.440><c> can</c><00:58:43.640><c> control</c><00:58:44.200><c> how</c><00:58:44.319><c> many</c>

00:58:44.589 --> 00:58:44.599 align:start position:0%
so with that you can control how many
 

00:58:44.599 --> 00:58:46.510 align:start position:0%
so with that you can control how many
recursions<00:58:45.200><c> you</c><00:58:45.319><c> can</c><00:58:45.559><c> have</c><00:58:46.039><c> let's</c><00:58:46.200><c> say</c><00:58:46.400><c> that</c>

00:58:46.510 --> 00:58:46.520 align:start position:0%
recursions you can have let's say that
 

00:58:46.520 --> 00:58:48.150 align:start position:0%
recursions you can have let's say that
you<00:58:46.599><c> would</c><00:58:46.760><c> like</c><00:58:46.920><c> to</c><00:58:47.119><c> have</c><00:58:47.359><c> like</c><00:58:47.680><c> thousand</c>

00:58:48.150 --> 00:58:48.160 align:start position:0%
you would like to have like thousand
 

00:58:48.160 --> 00:58:50.349 align:start position:0%
you would like to have like thousand
iteration<00:58:49.079><c> so</c><00:58:49.200><c> if</c><00:58:49.319><c> you</c><00:58:49.440><c> go</c><00:58:49.599><c> over</c><00:58:49.799><c> here</c><00:58:49.920><c> and</c><00:58:50.119><c> say</c>

00:58:50.349 --> 00:58:50.359 align:start position:0%
iteration so if you go over here and say
 

00:58:50.359 --> 00:58:51.549 align:start position:0%
iteration so if you go over here and say
you<00:58:50.480><c> know</c><00:58:50.640><c> what</c><00:58:50.839><c> I</c><00:58:50.920><c> would</c><00:58:51.039><c> like</c><00:58:51.200><c> to</c><00:58:51.319><c> have</c><00:58:51.440><c> a</c>

00:58:51.549 --> 00:58:51.559 align:start position:0%
you know what I would like to have a
 

00:58:51.559 --> 00:58:54.950 align:start position:0%
you know what I would like to have a
sequence<00:58:51.920><c> of</c><00:58:52.440><c> 1000s</c><00:58:53.440><c> if</c><00:58:53.599><c> you</c><00:58:54.000><c> let</c><00:58:54.119><c> me</c><00:58:54.359><c> just</c>

00:58:54.950 --> 00:58:54.960 align:start position:0%
sequence of 1000s if you let me just
 

00:58:54.960 --> 00:58:57.349 align:start position:0%
sequence of 1000s if you let me just
comment<00:58:55.359><c> this</c><00:58:55.559><c> out</c><00:58:56.119><c> so</c><00:58:56.280><c> if</c><00:58:56.359><c> you</c><00:58:56.520><c> execute</c><00:58:56.960><c> it</c>

00:58:57.349 --> 00:58:57.359 align:start position:0%
comment this out so if you execute it
 

00:58:57.359 --> 00:58:58.750 align:start position:0%
comment this out so if you execute it
you<00:58:57.440><c> will</c><00:58:57.640><c> get</c><00:58:57.760><c> an</c><00:58:57.880><c> error</c><00:58:58.280><c> because</c><00:58:58.599><c> the</c>

00:58:58.750 --> 00:58:58.760 align:start position:0%
you will get an error because the
 

00:58:58.760 --> 00:59:01.150 align:start position:0%
you will get an error because the
default<00:58:59.160><c> is</c><00:58:59.480><c> 100</c><00:59:00.200><c> but</c><00:59:00.359><c> of</c><00:59:00.520><c> course</c><00:59:00.680><c> you</c><00:59:00.799><c> can</c><00:59:01.000><c> go</c>

00:59:01.150 --> 00:59:01.160 align:start position:0%
default is 100 but of course you can go
 

00:59:01.160 --> 00:59:03.750 align:start position:0%
default is 100 but of course you can go
and<00:59:01.400><c> increase</c><00:59:02.400><c> the</c><00:59:02.559><c> maximum</c><00:59:03.000><c> recursion</c><00:59:03.599><c> for</c>

00:59:03.750 --> 00:59:03.760 align:start position:0%
and increase the maximum recursion for
 

00:59:03.760 --> 00:59:06.230 align:start position:0%
and increase the maximum recursion for
example<00:59:04.160><c> let's</c><00:59:04.319><c> go</c><00:59:04.520><c> with</c><00:59:04.880><c> 5000s</c><00:59:05.880><c> in</c><00:59:06.039><c> the</c>

00:59:06.230 --> 00:59:06.240 align:start position:0%
example let's go with 5000s in the
 

00:59:06.240 --> 00:59:08.309 align:start position:0%
example let's go with 5000s in the
output<00:59:06.839><c> it</c><00:59:06.960><c> will</c><00:59:07.200><c> work</c><00:59:07.559><c> and</c><00:59:07.680><c> you</c><00:59:07.760><c> will</c><00:59:07.960><c> get</c><00:59:08.160><c> a</c>

00:59:08.309 --> 00:59:08.319 align:start position:0%
output it will work and you will get a
 

00:59:08.319 --> 00:59:10.750 align:start position:0%
output it will work and you will get a
sequence<00:59:08.799><c> of</c><00:59:09.079><c> 1,000</c><00:59:09.960><c> so</c><00:59:10.160><c> with</c><00:59:10.319><c> this</c><00:59:10.440><c> you</c><00:59:10.559><c> can</c>

00:59:10.750 --> 00:59:10.760 align:start position:0%
sequence of 1,000 so with this you can
 

00:59:10.760 --> 00:59:12.789 align:start position:0%
sequence of 1,000 so with this you can
control<00:59:11.280><c> how</c><00:59:11.400><c> many</c><00:59:11.640><c> iterations</c><00:59:12.240><c> are</c><00:59:12.440><c> allowed</c>

00:59:12.789 --> 00:59:12.799 align:start position:0%
control how many iterations are allowed
 

00:59:12.799 --> 00:59:14.589 align:start position:0%
control how many iterations are allowed
in<00:59:12.920><c> your</c><00:59:13.079><c> query</c><00:59:13.680><c> so</c><00:59:13.880><c> with</c><00:59:14.000><c> that</c><00:59:14.160><c> you</c><00:59:14.240><c> have</c><00:59:14.400><c> like</c>

00:59:14.589 --> 00:59:14.599 align:start position:0%
in your query so with that you have like
 

00:59:14.599 --> 00:59:16.829 align:start position:0%
in your query so with that you have like
a<00:59:14.760><c> control</c><00:59:15.160><c> on</c><00:59:15.319><c> it</c><00:59:15.839><c> okay</c><00:59:16.000><c> so</c><00:59:16.119><c> now</c><00:59:16.240><c> we</c><00:59:16.359><c> can</c>

00:59:16.829 --> 00:59:16.839 align:start position:0%
a control on it okay so now we can
 

00:59:16.839 --> 00:59:19.230 align:start position:0%
a control on it okay so now we can
understand<00:59:17.119><c> step</c><00:59:17.359><c> by</c><00:59:17.640><c> step</c><00:59:17.960><c> how</c><00:59:18.160><c> SQL</c><00:59:18.680><c> executed</c>

00:59:19.230 --> 00:59:19.240 align:start position:0%
understand step by step how SQL executed
 

00:59:19.240 --> 00:59:20.990 align:start position:0%
understand step by step how SQL executed
the<00:59:19.400><c> recursive</c><00:59:19.880><c> query</c><00:59:20.440><c> and</c><00:59:20.559><c> here</c><00:59:20.720><c> we</c><00:59:20.839><c> have</c>

00:59:20.990 --> 00:59:21.000 align:start position:0%
the recursive query and here we have
 

00:59:21.000 --> 00:59:23.309 align:start position:0%
the recursive query and here we have
like<00:59:21.240><c> flow</c><00:59:21.559><c> diagram</c><00:59:22.280><c> in</c><00:59:22.400><c> order</c><00:59:22.640><c> to</c><00:59:23.119><c> understand</c>

00:59:23.309 --> 00:59:23.319 align:start position:0%
like flow diagram in order to understand
 

00:59:23.319 --> 00:59:25.589 align:start position:0%
like flow diagram in order to understand
the<00:59:23.559><c> process</c><00:59:24.000><c> the</c><00:59:24.200><c> steps</c><00:59:24.640><c> of</c><00:59:24.960><c> executing</c><00:59:25.440><c> the</c>

00:59:25.589 --> 00:59:25.599 align:start position:0%
the process the steps of executing the
 

00:59:25.599 --> 00:59:27.990 align:start position:0%
the process the steps of executing the
recursive<00:59:26.119><c> query</c><00:59:26.599><c> so</c><00:59:26.839><c> let's</c><00:59:27.039><c> go</c><00:59:27.200><c> and</c><00:59:27.400><c> do</c><00:59:27.559><c> it</c>

00:59:27.990 --> 00:59:28.000 align:start position:0%
recursive query so let's go and do it
 

00:59:28.000 --> 00:59:30.029 align:start position:0%
recursive query so let's go and do it
now<00:59:28.280><c> in</c><00:59:28.440><c> the</c><00:59:28.599><c> start</c><00:59:29.000><c> we</c><00:59:29.119><c> have</c><00:59:29.319><c> the</c><00:59:29.480><c> first</c><00:59:29.720><c> step</c>

00:59:30.029 --> 00:59:30.039 align:start position:0%
now in the start we have the first step
 

00:59:30.039 --> 00:59:33.230 align:start position:0%
now in the start we have the first step
is<00:59:30.559><c> to</c><00:59:30.799><c> run</c><00:59:31.119><c> the</c><00:59:31.319><c> anchor</c><00:59:31.799><c> query</c><00:59:32.440><c> so</c><00:59:32.640><c> our</c><00:59:32.880><c> anchor</c>

00:59:33.230 --> 00:59:33.240 align:start position:0%
is to run the anchor query so our anchor
 

00:59:33.240 --> 00:59:35.950 align:start position:0%
is to run the anchor query so our anchor
query<00:59:33.599><c> is</c><00:59:33.720><c> just</c><00:59:33.960><c> a</c><00:59:34.160><c> select</c><00:59:34.599><c> for</c><00:59:34.839><c> the</c><00:59:35.039><c> value</c><00:59:35.359><c> one</c>

00:59:35.950 --> 00:59:35.960 align:start position:0%
query is just a select for the value one
 

00:59:35.960 --> 00:59:38.190 align:start position:0%
query is just a select for the value one
so<00:59:36.200><c> in</c><00:59:36.319><c> the</c><00:59:36.480><c> output</c><00:59:37.000><c> we</c><00:59:37.079><c> will</c><00:59:37.319><c> get</c><00:59:37.640><c> the</c><00:59:37.839><c> value</c>

00:59:38.190 --> 00:59:38.200 align:start position:0%
so in the output we will get the value
 

00:59:38.200 --> 00:59:40.589 align:start position:0%
so in the output we will get the value
one<00:59:38.799><c> in</c><00:59:38.960><c> my</c><00:59:39.119><c> number</c><00:59:39.720><c> and</c><00:59:39.880><c> as</c><00:59:39.960><c> you</c><00:59:40.079><c> can</c><00:59:40.240><c> see</c><00:59:40.480><c> the</c>

00:59:40.589 --> 00:59:40.599 align:start position:0%
one in my number and as you can see the
 

00:59:40.599 --> 00:59:42.910 align:start position:0%
one in my number and as you can see the
anchor<00:59:41.000><c> query</c><00:59:41.400><c> going</c><00:59:41.520><c> to</c><00:59:41.640><c> be</c><00:59:41.839><c> executed</c><00:59:42.520><c> only</c>

00:59:42.910 --> 00:59:42.920 align:start position:0%
anchor query going to be executed only
 

00:59:42.920 --> 00:59:45.390 align:start position:0%
anchor query going to be executed only
once<00:59:43.799><c> so</c><00:59:44.039><c> there</c><00:59:44.160><c> is</c><00:59:44.319><c> no</c><00:59:44.520><c> iterations</c><00:59:45.160><c> or</c>

00:59:45.390 --> 00:59:45.400 align:start position:0%
once so there is no iterations or
 

00:59:45.400 --> 00:59:48.069 align:start position:0%
once so there is no iterations or
anything<00:59:46.079><c> SQL</c><00:59:46.520><c> executed</c><00:59:47.000><c> once</c><00:59:47.359><c> and</c><00:59:47.559><c> then</c><00:59:47.799><c> goes</c>

00:59:48.069 --> 00:59:48.079 align:start position:0%
anything SQL executed once and then goes
 

00:59:48.079 --> 00:59:50.150 align:start position:0%
anything SQL executed once and then goes
to<00:59:48.280><c> the</c><00:59:48.440><c> next</c><00:59:48.720><c> step</c><00:59:49.280><c> so</c><00:59:49.480><c> what</c><00:59:49.599><c> is</c><00:59:49.720><c> the</c><00:59:49.839><c> next</c>

00:59:50.150 --> 00:59:50.160 align:start position:0%
to the next step so what is the next
 

00:59:50.160 --> 00:59:52.510 align:start position:0%
to the next step so what is the next
step<00:59:50.440><c> is</c><00:59:50.839><c> going</c><00:59:50.960><c> to</c><00:59:51.119><c> execute</c><00:59:51.680><c> the</c><00:59:51.920><c> recursive</c>

00:59:52.510 --> 00:59:52.520 align:start position:0%
step is going to execute the recursive
 

00:59:52.520 --> 00:59:54.750 align:start position:0%
step is going to execute the recursive
query<00:59:53.079><c> so</c><00:59:53.480><c> it's</c><00:59:53.599><c> going</c><00:59:53.720><c> to</c><00:59:53.839><c> go</c><00:59:53.960><c> over</c><00:59:54.280><c> here</c><00:59:54.680><c> and</c>

00:59:54.750 --> 00:59:54.760 align:start position:0%
query so it's going to go over here and
 

00:59:54.760 --> 00:59:56.349 align:start position:0%
query so it's going to go over here and
now<00:59:54.920><c> what's</c><00:59:55.079><c> going</c><00:59:55.160><c> to</c><00:59:55.319><c> happen</c><00:59:55.599><c> we</c><00:59:55.680><c> will</c><00:59:55.839><c> get</c>

00:59:56.349 --> 00:59:56.359 align:start position:0%
now what's going to happen we will get
 

00:59:56.359 --> 00:59:58.430 align:start position:0%
now what's going to happen we will get
the<00:59:56.520><c> current</c><00:59:56.960><c> value</c><00:59:57.400><c> of</c><00:59:57.640><c> my</c><00:59:57.839><c> number</c><00:59:58.319><c> the</c>

00:59:58.430 --> 00:59:58.440 align:start position:0%
the current value of my number the
 

00:59:58.440 --> 01:00:00.549 align:start position:0%
the current value of my number the
current<00:59:58.760><c> value</c><00:59:59.039><c> is</c><00:59:59.200><c> one</c><00:59:59.920><c> and</c><01:00:00.119><c> then</c><01:00:00.319><c> we</c><01:00:00.440><c> going</c>

01:00:00.549 --> 01:00:00.559 align:start position:0%
current value is one and then we going
 

01:00:00.559 --> 01:00:04.230 align:start position:0%
current value is one and then we going
to<01:00:00.720><c> add</c><01:00:00.880><c> to</c><01:00:01.079><c> it</c><01:00:01.520><c> one</c><01:00:02.160><c> so</c><01:00:02.400><c> 1</c><01:00:02.680><c> +</c><01:00:02.960><c> 1</c><01:00:03.720><c> we</c><01:00:03.920><c> will</c><01:00:04.119><c> get</c>

01:00:04.230 --> 01:00:04.240 align:start position:0%
to add to it one so 1 + 1 we will get
 

01:00:04.240 --> 01:00:06.950 align:start position:0%
to add to it one so 1 + 1 we will get
from<01:00:04.400><c> the</c><01:00:04.559><c> recursive</c><01:00:05.079><c> query</c><01:00:06.039><c> the</c><01:00:06.319><c> two</c><01:00:06.799><c> which</c>

01:00:06.950 --> 01:00:06.960 align:start position:0%
from the recursive query the two which
 

01:00:06.960 --> 01:00:09.710 align:start position:0%
from the recursive query the two which
is<01:00:07.200><c> added</c><01:00:07.640><c> to</c><01:00:07.960><c> our</c><01:00:08.359><c> results</c><01:00:09.000><c> now</c><01:00:09.200><c> it's</c><01:00:09.640><c> going</c>

01:00:09.710 --> 01:00:09.720 align:start position:0%
is added to our results now it's going
 

01:00:09.720 --> 01:00:12.750 align:start position:0%
is added to our results now it's going
to<01:00:09.839><c> check</c><01:00:10.039><c> the</c><01:00:10.359><c> condition</c><01:00:10.839><c> is</c><01:00:11.200><c> my</c><01:00:11.480><c> number</c><01:00:12.079><c> now</c>

01:00:12.750 --> 01:00:12.760 align:start position:0%
to check the condition is my number now
 

01:00:12.760 --> 01:00:15.309 align:start position:0%
to check the condition is my number now
smaller<01:00:13.240><c> than</c><01:00:13.440><c> 20</c><01:00:14.119><c> well</c><01:00:14.480><c> yes</c><01:00:14.760><c> it's</c><01:00:14.920><c> smaller</c>

01:00:15.309 --> 01:00:15.319 align:start position:0%
smaller than 20 well yes it's smaller
 

01:00:15.319 --> 01:00:17.990 align:start position:0%
smaller than 20 well yes it's smaller
than<01:00:15.520><c> 20</c><01:00:16.440><c> and</c><01:00:16.839><c> what's</c><01:00:17.039><c> going</c><01:00:17.160><c> to</c><01:00:17.359><c> happen</c><01:00:17.720><c> since</c>

01:00:17.990 --> 01:00:18.000 align:start position:0%
than 20 and what's going to happen since
 

01:00:18.000 --> 01:00:20.190 align:start position:0%
than 20 and what's going to happen since
it's<01:00:18.200><c> true</c><01:00:18.799><c> a</c><01:00:19.039><c> scale</c><01:00:19.280><c> going</c><01:00:19.359><c> to</c><01:00:19.520><c> go</c><01:00:19.799><c> and</c>

01:00:20.190 --> 01:00:20.200 align:start position:0%
it's true a scale going to go and
 

01:00:20.200 --> 01:00:22.990 align:start position:0%
it's true a scale going to go and
reexecute<01:00:20.920><c> the</c><01:00:21.559><c> recursive</c><01:00:22.039><c> query</c><01:00:22.559><c> so</c><01:00:22.760><c> now</c><01:00:22.920><c> we</c>

01:00:22.990 --> 01:00:23.000 align:start position:0%
reexecute the recursive query so now we
 

01:00:23.000 --> 01:00:25.470 align:start position:0%
reexecute the recursive query so now we
are<01:00:23.200><c> doing</c><01:00:23.559><c> the</c><01:00:23.799><c> second</c><01:00:24.240><c> iteration</c><01:00:25.039><c> so</c><01:00:25.280><c> again</c>

01:00:25.470 --> 01:00:25.480 align:start position:0%
are doing the second iteration so again
 

01:00:25.480 --> 01:00:27.630 align:start position:0%
are doing the second iteration so again
is<01:00:25.640><c> going</c><01:00:25.799><c> going</c><01:00:26.119><c> go</c><01:00:26.319><c> to</c><01:00:26.520><c> the</c><01:00:26.799><c> recursive</c><01:00:27.319><c> query</c>

01:00:27.630 --> 01:00:27.640 align:start position:0%
is going going go to the recursive query
 

01:00:27.640 --> 01:00:29.150 align:start position:0%
is going going go to the recursive query
and<01:00:27.720><c> I'm</c><01:00:27.839><c> going</c><01:00:27.960><c> to</c><01:00:28.079><c> say</c><01:00:28.400><c> okay</c><01:00:28.640><c> what</c><01:00:28.760><c> is</c><01:00:28.960><c> the</c>

01:00:29.150 --> 01:00:29.160 align:start position:0%
and I'm going to say okay what is the
 

01:00:29.160 --> 01:00:31.870 align:start position:0%
and I'm going to say okay what is the
current<01:00:29.559><c> value</c><01:00:29.839><c> of</c><01:00:30.000><c> my</c><01:00:30.160><c> number</c><01:00:30.640><c> it</c><01:00:30.760><c> is</c><01:00:30.960><c> two</c><01:00:31.640><c> so</c>

01:00:31.870 --> 01:00:31.880 align:start position:0%
current value of my number it is two so
 

01:00:31.880 --> 01:00:35.470 align:start position:0%
current value of my number it is two so
2<01:00:32.160><c> +</c><01:00:32.440><c> 1</c><01:00:33.319><c> the</c><01:00:33.480><c> second</c><01:00:33.799><c> iteration</c><01:00:34.760><c> will</c><01:00:35.000><c> give</c><01:00:35.200><c> us</c>

01:00:35.470 --> 01:00:35.480 align:start position:0%
2 + 1 the second iteration will give us
 

01:00:35.480 --> 01:00:37.589 align:start position:0%
2 + 1 the second iteration will give us
the<01:00:35.680><c> value</c><01:00:35.960><c> three</c><01:00:36.440><c> so</c><01:00:36.640><c> as</c><01:00:36.720><c> you</c><01:00:36.839><c> can</c><01:00:37.000><c> see</c><01:00:37.319><c> each</c>

01:00:37.589 --> 01:00:37.599 align:start position:0%
the value three so as you can see each
 

01:00:37.599 --> 01:00:40.270 align:start position:0%
the value three so as you can see each
time<01:00:37.839><c> the</c><01:00:38.000><c> recursive</c><01:00:38.559><c> query</c><01:00:38.960><c> is</c><01:00:39.160><c> executed</c><01:00:40.160><c> it</c>

01:00:40.270 --> 01:00:40.280 align:start position:0%
time the recursive query is executed it
 

01:00:40.280 --> 01:00:43.870 align:start position:0%
time the recursive query is executed it
is<01:00:40.599><c> adding</c><01:00:41.079><c> more</c><01:00:41.440><c> values</c><01:00:42.200><c> to</c><01:00:42.480><c> our</c><01:00:43.039><c> results</c><01:00:43.640><c> so</c>

01:00:43.870 --> 01:00:43.880 align:start position:0%
is adding more values to our results so
 

01:00:43.880 --> 01:00:46.470 align:start position:0%
is adding more values to our results so
the<01:00:44.000><c> same</c><01:00:44.280><c> question</c><01:00:44.559><c> can</c><01:00:44.720><c> be</c><01:00:44.960><c> asked</c><01:00:45.680><c> is</c><01:00:45.880><c> now</c><01:00:46.280><c> my</c>

01:00:46.470 --> 01:00:46.480 align:start position:0%
the same question can be asked is now my
 

01:00:46.480 --> 01:00:49.150 align:start position:0%
the same question can be asked is now my
number<01:00:47.039><c> smaller</c><01:00:47.440><c> than</c><01:00:47.640><c> 20</c><01:00:48.240><c> well</c><01:00:48.559><c> yes</c><01:00:48.839><c> it</c><01:00:49.000><c> is</c>

01:00:49.150 --> 01:00:49.160 align:start position:0%
number smaller than 20 well yes it is
 

01:00:49.160 --> 01:00:51.789 align:start position:0%
number smaller than 20 well yes it is
smaller<01:00:50.160><c> well</c><01:00:50.359><c> what's</c><01:00:50.520><c> going</c><01:00:50.599><c> to</c><01:00:50.799><c> happen</c><01:00:51.400><c> is</c>

01:00:51.789 --> 01:00:51.799 align:start position:0%
smaller well what's going to happen is
 

01:00:51.799 --> 01:00:54.470 align:start position:0%
smaller well what's going to happen is
going<01:00:51.880><c> to</c><01:00:52.119><c> reexecute</c><01:00:52.720><c> the</c><01:00:53.359><c> recursive</c><01:00:53.960><c> query</c>

01:00:54.470 --> 01:00:54.480 align:start position:0%
going to reexecute the recursive query
 

01:00:54.480 --> 01:00:56.230 align:start position:0%
going to reexecute the recursive query
so<01:00:54.680><c> ISC</c><01:00:55.039><c> going</c><01:00:55.160><c> to</c><01:00:55.280><c> keep</c><01:00:55.480><c> looping</c><01:00:56.079><c> and</c>

01:00:56.230 --> 01:00:56.240 align:start position:0%
so ISC going to keep looping and
 

01:00:56.240 --> 01:00:59.029 align:start position:0%
so ISC going to keep looping and
iterating<01:00:56.960><c> and</c><01:00:57.240><c> adding</c><01:00:57.680><c> values</c><01:00:58.480><c> to</c><01:00:58.720><c> the</c>

01:00:59.029 --> 01:00:59.039 align:start position:0%
iterating and adding values to the
 

01:00:59.039 --> 01:01:02.589 align:start position:0%
iterating and adding values to the
output<01:01:00.039><c> until</c><01:01:00.359><c> we</c><01:01:00.520><c> reach</c><01:01:00.920><c> the</c><01:01:01.160><c> value</c><01:01:01.680><c> 20</c><01:01:02.440><c> so</c>

01:01:02.589 --> 01:01:02.599 align:start position:0%
output until we reach the value 20 so
 

01:01:02.599 --> 01:01:06.230 align:start position:0%
output until we reach the value 20 so
now<01:01:02.799><c> isq</c><01:01:03.200><c> going</c><01:01:03.319><c> to</c><01:01:03.480><c> ask</c><01:01:03.799><c> is</c><01:01:04.480><c> 20</c><01:01:05.039><c> my</c><01:01:05.240><c> number</c><01:01:05.640><c> now</c>

01:01:06.230 --> 01:01:06.240 align:start position:0%
now isq going to ask is 20 my number now
 

01:01:06.240 --> 01:01:10.230 align:start position:0%
now isq going to ask is 20 my number now
smaller<01:01:06.720><c> than</c><01:01:06.920><c> 20</c><01:01:07.680><c> well</c><01:01:08.039><c> no</c><01:01:08.680><c> so</c><01:01:09.240><c> it</c><01:01:09.400><c> is</c><01:01:09.599><c> false</c>

01:01:10.230 --> 01:01:10.240 align:start position:0%
smaller than 20 well no so it is false
 

01:01:10.240 --> 01:01:11.950 align:start position:0%
smaller than 20 well no so it is false
and<01:01:10.359><c> what</c><01:01:10.520><c> going</c><01:01:10.640><c> to</c><01:01:10.799><c> happen</c><01:01:11.200><c> the</c><01:01:11.400><c> chain</c><01:01:11.680><c> will</c>

01:01:11.950 --> 01:01:11.960 align:start position:0%
and what going to happen the chain will
 

01:01:11.960 --> 01:01:15.109 align:start position:0%
and what going to happen the chain will
break<01:01:12.680><c> and</c><01:01:12.839><c> we</c><01:01:12.960><c> will</c><01:01:13.200><c> not</c><01:01:13.520><c> Loop</c><01:01:13.920><c> anymore</c><01:01:14.720><c> so</c>

01:01:15.109 --> 01:01:15.119 align:start position:0%
break and we will not Loop anymore so
 

01:01:15.119 --> 01:01:17.589 align:start position:0%
break and we will not Loop anymore so
it's<01:01:15.280><c> going</c><01:01:15.359><c> to</c><01:01:15.480><c> be</c><01:01:15.680><c> the</c><01:01:15.839><c> end</c><01:01:16.359><c> of</c><01:01:16.599><c> the</c><01:01:16.799><c> C</c><01:01:17.440><c> and</c>

01:01:17.589 --> 01:01:17.599 align:start position:0%
it's going to be the end of the C and
 

01:01:17.599 --> 01:01:19.150 align:start position:0%
it's going to be the end of the C and
this<01:01:17.760><c> going</c><01:01:17.839><c> to</c><01:01:17.960><c> be</c><01:01:18.119><c> the</c><01:01:18.280><c> final</c><01:01:18.640><c> results</c>

01:01:19.150 --> 01:01:19.160 align:start position:0%
this going to be the final results
 

01:01:19.160 --> 01:01:21.109 align:start position:0%
this going to be the final results
that's<01:01:19.359><c> going</c><01:01:19.480><c> to</c><01:01:19.599><c> be</c><01:01:19.760><c> used</c><01:01:20.319><c> from</c><01:01:20.599><c> the</c><01:01:20.799><c> main</c>

01:01:21.109 --> 01:01:21.119 align:start position:0%
that's going to be used from the main
 

01:01:21.119 --> 01:01:24.029 align:start position:0%
that's going to be used from the main
query<01:01:21.760><c> so</c><01:01:22.119><c> this</c><01:01:22.200><c> is</c><01:01:22.359><c> how</c><01:01:22.520><c> SQL</c><01:01:23.079><c> executed</c><01:01:23.880><c> this</c>

01:01:24.029 --> 01:01:24.039 align:start position:0%
query so this is how SQL executed this
 

01:01:24.039 --> 01:01:26.109 align:start position:0%
query so this is how SQL executed this
recursive<01:01:24.520><c> City</c><01:01:25.280><c> okay</c><01:01:25.400><c> so</c><01:01:25.520><c> now</c><01:01:25.640><c> let's</c><01:01:25.960><c> have</c>

01:01:26.109 --> 01:01:26.119 align:start position:0%
recursive City okay so now let's have
 

01:01:26.119 --> 01:01:28.470 align:start position:0%
recursive City okay so now let's have
another<01:01:26.440><c> task</c><01:01:26.680><c> for</c><01:01:26.880><c> the</c><01:01:27.079><c> recursive</c><01:01:27.559><c> CTE</c><01:01:28.319><c> this</c>

01:01:28.470 --> 01:01:28.480 align:start position:0%
another task for the recursive CTE this
 

01:01:28.480 --> 01:01:29.589 align:start position:0%
another task for the recursive CTE this
time<01:01:28.640><c> it's</c><01:01:28.720><c> going</c><01:01:28.839><c> to</c><01:01:28.920><c> be</c><01:01:29.000><c> a</c><01:01:29.079><c> little</c><01:01:29.240><c> bit</c><01:01:29.400><c> more</c>

01:01:29.589 --> 01:01:29.599 align:start position:0%
time it's going to be a little bit more
 

01:01:29.599 --> 01:01:31.990 align:start position:0%
time it's going to be a little bit more
advanced<01:01:30.240><c> so</c><01:01:30.440><c> the</c><01:01:30.599><c> task</c><01:01:30.839><c> says</c><01:01:31.440><c> show</c><01:01:31.799><c> the</c>

01:01:31.990 --> 01:01:32.000 align:start position:0%
advanced so the task says show the
 

01:01:32.000 --> 01:01:34.549 align:start position:0%
advanced so the task says show the
employee<01:01:32.480><c> hierarchy</c><01:01:33.280><c> by</c><01:01:33.480><c> displaying</c><01:01:34.280><c> each</c>

01:01:34.549 --> 01:01:34.559 align:start position:0%
employee hierarchy by displaying each
 

01:01:34.559 --> 01:01:37.150 align:start position:0%
employee hierarchy by displaying each
employees<01:01:35.160><c> level</c><01:01:35.760><c> within</c><01:01:36.079><c> the</c><01:01:36.240><c> organization</c>

01:01:37.150 --> 01:01:37.160 align:start position:0%
employees level within the organization
 

01:01:37.160 --> 01:01:38.750 align:start position:0%
employees level within the organization
so<01:01:37.359><c> that</c><01:01:37.480><c> means</c><01:01:37.720><c> we</c><01:01:37.799><c> have</c><01:01:37.920><c> to</c><01:01:38.039><c> show</c><01:01:38.240><c> for</c><01:01:38.480><c> each</c>

01:01:38.750 --> 01:01:38.760 align:start position:0%
so that means we have to show for each
 

01:01:38.760 --> 01:01:41.750 align:start position:0%
so that means we have to show for each
employee<01:01:39.240><c> for</c><01:01:39.440><c> each</c><01:01:39.640><c> row</c><01:01:40.359><c> a</c><01:01:40.559><c> level</c><01:01:41.280><c> that</c><01:01:41.480><c> tells</c>

01:01:41.750 --> 01:01:41.760 align:start position:0%
employee for each row a level that tells
 

01:01:41.760 --> 01:01:44.309 align:start position:0%
employee for each row a level that tells
us<01:01:42.079><c> the</c><01:01:42.240><c> hierarchy</c><01:01:42.760><c> of</c><01:01:42.920><c> the</c><01:01:43.200><c> employee</c><01:01:44.039><c> so</c>

01:01:44.309 --> 01:01:44.319 align:start position:0%
us the hierarchy of the employee so
 

01:01:44.319 --> 01:01:46.670 align:start position:0%
us the hierarchy of the employee so
first<01:01:44.640><c> let's</c><01:01:44.839><c> go</c><01:01:45.000><c> and</c><01:01:45.200><c> explore</c><01:01:45.559><c> the</c><01:01:45.720><c> table</c>

01:01:46.670 --> 01:01:46.680 align:start position:0%
first let's go and explore the table
 

01:01:46.680 --> 01:01:48.630 align:start position:0%
first let's go and explore the table
employees<01:01:47.599><c> so</c><01:01:47.839><c> let's</c><01:01:48.039><c> go</c><01:01:48.160><c> and</c><01:01:48.280><c> select</c>

01:01:48.630 --> 01:01:48.640 align:start position:0%
employees so let's go and select
 

01:01:48.640 --> 01:01:52.190 align:start position:0%
employees so let's go and select
everything<01:01:49.640><c> from</c><01:01:50.160><c> sales</c>

01:01:52.190 --> 01:01:52.200 align:start position:0%
everything from sales
 

01:01:52.200 --> 01:01:54.829 align:start position:0%
everything from sales
employees<01:01:53.200><c> okay</c><01:01:53.480><c> let's</c><01:01:53.680><c> go</c><01:01:53.880><c> executed</c><01:01:54.520><c> so</c><01:01:54.680><c> now</c>

01:01:54.829 --> 01:01:54.839 align:start position:0%
employees okay let's go executed so now
 

01:01:54.839 --> 01:01:56.230 align:start position:0%
employees okay let's go executed so now
by<01:01:54.960><c> looking</c><01:01:55.160><c> to</c><01:01:55.319><c> the</c><01:01:55.400><c> results</c><01:01:55.680><c> we</c><01:01:55.960><c> have</c><01:01:56.079><c> like</c>

01:01:56.230 --> 01:01:56.240 align:start position:0%
by looking to the results we have like
 

01:01:56.240 --> 01:01:58.390 align:start position:0%
by looking to the results we have like
few<01:01:56.480><c> informations</c><01:01:57.119><c> about</c><01:01:57.359><c> the</c><01:01:57.520><c> employee</c><01:01:58.279><c> we</c>

01:01:58.390 --> 01:01:58.400 align:start position:0%
few informations about the employee we
 

01:01:58.400 --> 01:02:00.549 align:start position:0%
few informations about the employee we
have<01:01:58.599><c> information</c><01:01:59.079><c> about</c><01:01:59.400><c> which</c><01:01:59.720><c> department</c>

01:02:00.549 --> 01:02:00.559 align:start position:0%
have information about which department
 

01:02:00.559 --> 01:02:02.549 align:start position:0%
have information about which department
the<01:02:00.720><c> gender</c><01:02:01.200><c> salaries</c><01:02:01.720><c> but</c><01:02:01.920><c> here</c><01:02:02.079><c> we</c><01:02:02.200><c> have</c><01:02:02.359><c> the</c>

01:02:02.549 --> 01:02:02.559 align:start position:0%
the gender salaries but here we have the
 

01:02:02.559 --> 01:02:05.750 align:start position:0%
the gender salaries but here we have the
key<01:02:03.119><c> it</c><01:02:03.240><c> is</c><01:02:03.520><c> the</c><01:02:03.640><c> manager</c><01:02:04.160><c> ID</c><01:02:04.720><c> so</c><01:02:05.000><c> this</c><01:02:05.160><c> is</c><01:02:05.400><c> like</c>

01:02:05.750 --> 01:02:05.760 align:start position:0%
key it is the manager ID so this is like
 

01:02:05.760 --> 01:02:08.309 align:start position:0%
key it is the manager ID so this is like
self<01:02:06.279><c> referencing</c><01:02:06.960><c> to</c><01:02:07.119><c> the</c><01:02:07.279><c> same</c><01:02:07.640><c> table</c><01:02:08.160><c> so</c>

01:02:08.309 --> 01:02:08.319 align:start position:0%
self referencing to the same table so
 

01:02:08.319 --> 01:02:10.470 align:start position:0%
self referencing to the same table so
for<01:02:08.559><c> example</c><01:02:08.960><c> the</c><01:02:09.079><c> first</c><01:02:09.400><c> employee</c><01:02:10.000><c> the</c><01:02:10.160><c> value</c>

01:02:10.470 --> 01:02:10.480 align:start position:0%
for example the first employee the value
 

01:02:10.480 --> 01:02:13.309 align:start position:0%
for example the first employee the value
is<01:02:10.640><c> null</c><01:02:11.319><c> that</c><01:02:11.480><c> means</c><01:02:12.039><c> this</c><01:02:12.240><c> employee</c><01:02:12.839><c> has</c><01:02:13.079><c> no</c>

01:02:13.309 --> 01:02:13.319 align:start position:0%
is null that means this employee has no
 

01:02:13.319 --> 01:02:15.549 align:start position:0%
is null that means this employee has no
manager<01:02:14.039><c> which</c><01:02:14.200><c> makes</c><01:02:14.599><c> this</c><01:02:14.799><c> employee</c><01:02:15.359><c> like</c>

01:02:15.549 --> 01:02:15.559 align:start position:0%
manager which makes this employee like
 

01:02:15.559 --> 01:02:18.549 align:start position:0%
manager which makes this employee like
the<01:02:15.720><c> big</c><01:02:15.960><c> boss</c><01:02:16.359><c> the</c><01:02:16.599><c> CEO</c><01:02:17.480><c> then</c><01:02:17.720><c> now</c><01:02:18.000><c> by</c><01:02:18.200><c> looking</c>

01:02:18.549 --> 01:02:18.559 align:start position:0%
the big boss the CEO then now by looking
 

01:02:18.559 --> 01:02:20.829 align:start position:0%
the big boss the CEO then now by looking
to<01:02:18.760><c> the</c><01:02:18.920><c> next</c><01:02:19.160><c> two</c><01:02:19.359><c> employees</c><01:02:20.319><c> they</c><01:02:20.520><c> have</c><01:02:20.720><c> a</c>

01:02:20.829 --> 01:02:20.839 align:start position:0%
to the next two employees they have a
 

01:02:20.839 --> 01:02:23.829 align:start position:0%
to the next two employees they have a
manager<01:02:21.279><c> ID</c><01:02:21.720><c> one</c><01:02:22.200><c> so</c><01:02:22.480><c> who</c><01:02:22.680><c> is</c><01:02:23.039><c> the</c><01:02:23.160><c> manager</c><01:02:23.599><c> of</c>

01:02:23.829 --> 01:02:23.839 align:start position:0%
manager ID one so who is the manager of
 

01:02:23.839 --> 01:02:26.430 align:start position:0%
manager ID one so who is the manager of
those<01:02:24.039><c> two</c><01:02:24.680><c> it's</c><01:02:24.839><c> going</c><01:02:24.960><c> to</c><01:02:25.119><c> be</c><01:02:25.279><c> the</c><01:02:25.440><c> first</c><01:02:26.319><c> the</c>

01:02:26.430 --> 01:02:26.440 align:start position:0%
those two it's going to be the first the
 

01:02:26.440 --> 01:02:28.950 align:start position:0%
those two it's going to be the first the
manager<01:02:26.920><c> ID</c><01:02:27.240><c> number</c><01:02:27.520><c> one</c><01:02:27.920><c> so</c><01:02:28.240><c> the</c><01:02:28.359><c> manager</c><01:02:28.680><c> ID</c>

01:02:28.950 --> 01:02:28.960 align:start position:0%
manager ID number one so the manager ID
 

01:02:28.960 --> 01:02:30.910 align:start position:0%
manager ID number one so the manager ID
number<01:02:29.160><c> one</c><01:02:29.480><c> is</c><01:02:29.839><c> the</c><01:02:30.000><c> post</c><01:02:30.319><c> of</c><01:02:30.520><c> those</c><01:02:30.680><c> two</c>

01:02:30.910 --> 01:02:30.920 align:start position:0%
number one is the post of those two
 

01:02:30.920 --> 01:02:33.269 align:start position:0%
number one is the post of those two
employees<01:02:31.799><c> and</c><01:02:31.960><c> then</c><01:02:32.079><c> for</c><01:02:32.319><c> the</c><01:02:32.480><c> fourth</c><01:02:32.839><c> one</c><01:02:33.119><c> we</c>

01:02:33.269 --> 01:02:33.279 align:start position:0%
employees and then for the fourth one we
 

01:02:33.279 --> 01:02:36.150 align:start position:0%
employees and then for the fourth one we
can<01:02:33.440><c> see</c><01:02:33.760><c> the</c><01:02:34.039><c> manager</c><01:02:34.559><c> ID</c><01:02:34.960><c> number</c><01:02:35.319><c> two</c><01:02:35.839><c> so</c><01:02:36.039><c> the</c>

01:02:36.150 --> 01:02:36.160 align:start position:0%
can see the manager ID number two so the
 

01:02:36.160 --> 01:02:39.069 align:start position:0%
can see the manager ID number two so the
manager<01:02:36.480><c> of</c><01:02:36.680><c> Michael</c><01:02:37.240><c> is</c><01:02:37.760><c> actually</c><01:02:38.279><c> Kevin</c><01:02:38.920><c> the</c>

01:02:39.069 --> 01:02:39.079 align:start position:0%
manager of Michael is actually Kevin the
 

01:02:39.079 --> 01:02:41.789 align:start position:0%
manager of Michael is actually Kevin the
second<01:02:39.400><c> draw</c><01:02:39.880><c> and</c><01:02:40.039><c> for</c><01:02:40.319><c> Carl</c><01:02:41.000><c> the</c><01:02:41.119><c> manager</c><01:02:41.520><c> ID</c>

01:02:41.789 --> 01:02:41.799 align:start position:0%
second draw and for Carl the manager ID
 

01:02:41.799 --> 01:02:44.789 align:start position:0%
second draw and for Carl the manager ID
is<01:02:42.000><c> three</c><01:02:42.480><c> that</c><01:02:42.640><c> means</c><01:02:43.000><c> Mary</c><01:02:43.480><c> is</c><01:02:44.079><c> the</c><01:02:44.319><c> manager</c>

01:02:44.789 --> 01:02:44.799 align:start position:0%
is three that means Mary is the manager
 

01:02:44.799 --> 01:02:47.029 align:start position:0%
is three that means Mary is the manager
of<01:02:45.079><c> Carl</c><01:02:45.720><c> and</c><01:02:45.880><c> this</c><01:02:46.000><c> is</c><01:02:46.240><c> exactly</c><01:02:46.680><c> what</c><01:02:46.799><c> we</c><01:02:46.920><c> can</c>

01:02:47.029 --> 01:02:47.039 align:start position:0%
of Carl and this is exactly what we can
 

01:02:47.039 --> 01:02:49.269 align:start position:0%
of Carl and this is exactly what we can
do<01:02:47.200><c> with</c><01:02:47.359><c> the</c><01:02:47.480><c> recursive</c><01:02:47.880><c> ctes</c><01:02:48.640><c> we</c><01:02:48.760><c> can</c><01:02:48.960><c> use</c>

01:02:49.269 --> 01:02:49.279 align:start position:0%
do with the recursive ctes we can use
 

01:02:49.279 --> 01:02:51.190 align:start position:0%
do with the recursive ctes we can use
such<01:02:49.520><c> informations</c><01:02:50.200><c> in</c><01:02:50.319><c> order</c><01:02:50.599><c> to</c><01:02:50.799><c> create</c>

01:02:51.190 --> 01:02:51.200 align:start position:0%
such informations in order to create
 

01:02:51.200 --> 01:02:53.549 align:start position:0%
such informations in order to create
like<01:02:51.359><c> a</c><01:02:51.520><c> loop</c><01:02:52.079><c> so</c><01:02:52.400><c> let's</c><01:02:52.640><c> go</c><01:02:52.799><c> and</c><01:02:53.000><c> do</c><01:02:53.119><c> it</c><01:02:53.279><c> step</c>

01:02:53.549 --> 01:02:53.559 align:start position:0%
like a loop so let's go and do it step
 

01:02:53.559 --> 01:02:55.470 align:start position:0%
like a loop so let's go and do it step
by<01:02:53.760><c> step</c><01:02:54.319><c> first</c><01:02:54.559><c> we're</c><01:02:54.680><c> going</c><01:02:54.799><c> to</c><01:02:54.960><c> start</c><01:02:55.279><c> with</c>

01:02:55.470 --> 01:02:55.480 align:start position:0%
by step first we're going to start with
 

01:02:55.480 --> 01:02:58.390 align:start position:0%
by step first we're going to start with
the<01:02:55.880><c> anchor</c><01:02:56.279><c> query</c><01:02:56.799><c> as</c><01:02:56.960><c> usual</c>

01:02:58.390 --> 01:02:58.400 align:start position:0%
the anchor query as usual
 

01:02:58.400 --> 01:03:02.029 align:start position:0%
the anchor query as usual
so<01:02:59.400><c> this</c><01:02:59.559><c> is</c><01:02:59.799><c> the</c><01:02:59.960><c> anchor</c><01:03:00.799><c> query</c><01:03:01.480><c> and</c><01:03:01.640><c> here</c><01:03:01.880><c> the</c>

01:03:02.029 --> 01:03:02.039 align:start position:0%
so this is the anchor query and here the
 

01:03:02.039 --> 01:03:04.069 align:start position:0%
so this is the anchor query and here the
first<01:03:02.319><c> step</c><01:03:02.640><c> or</c><01:03:03.000><c> the</c><01:03:03.119><c> first</c><01:03:03.400><c> record</c><01:03:03.839><c> going</c><01:03:03.960><c> to</c>

01:03:04.069 --> 01:03:04.079 align:start position:0%
first step or the first record going to
 

01:03:04.079 --> 01:03:07.430 align:start position:0%
first step or the first record going to
be<01:03:04.640><c> the</c><01:03:04.839><c> highest</c><01:03:05.279><c> manager</c><01:03:05.960><c> which</c><01:03:06.160><c> is</c><01:03:06.440><c> the</c><01:03:06.680><c> CEO</c>

01:03:07.430 --> 01:03:07.440 align:start position:0%
be the highest manager which is the CEO
 

01:03:07.440 --> 01:03:10.230 align:start position:0%
be the highest manager which is the CEO
right<01:03:07.760><c> the</c><01:03:07.920><c> first</c><01:03:08.279><c> record</c><01:03:09.200><c> so</c><01:03:09.599><c> in</c><01:03:09.720><c> order</c><01:03:10.039><c> to</c>

01:03:10.230 --> 01:03:10.240 align:start position:0%
right the first record so in order to
 

01:03:10.240 --> 01:03:12.630 align:start position:0%
right the first record so in order to
select<01:03:10.760><c> now</c><01:03:11.079><c> the</c><01:03:11.359><c> only</c><01:03:11.640><c> the</c><01:03:11.799><c> first</c><01:03:12.119><c> record</c>

01:03:12.630 --> 01:03:12.640 align:start position:0%
select now the only the first record
 

01:03:12.640 --> 01:03:17.029 align:start position:0%
select now the only the first record
what<01:03:12.760><c> we</c><01:03:12.880><c> can</c><01:03:13.079><c> say</c><01:03:13.799><c> we</c><01:03:13.960><c> can</c><01:03:14.160><c> say</c><01:03:14.799><c> where</c><01:03:16.039><c> manager</c>

01:03:17.029 --> 01:03:17.039 align:start position:0%
what we can say we can say where manager
 

01:03:17.039 --> 01:03:21.470 align:start position:0%
what we can say we can say where manager
ID<01:03:17.760><c> is</c><01:03:18.520><c> null</c><01:03:19.520><c> so</c><01:03:20.079><c> let's</c><01:03:20.319><c> go</c><01:03:20.440><c> and</c><01:03:20.680><c> execute</c><01:03:21.079><c> it</c>

01:03:21.470 --> 01:03:21.480 align:start position:0%
ID is null so let's go and execute it
 

01:03:21.480 --> 01:03:23.309 align:start position:0%
ID is null so let's go and execute it
and<01:03:21.680><c> with</c><01:03:21.880><c> that</c><01:03:22.039><c> we</c><01:03:22.200><c> have</c><01:03:22.359><c> now</c><01:03:22.559><c> the</c><01:03:22.720><c> first</c><01:03:23.000><c> row</c>

01:03:23.309 --> 01:03:23.319 align:start position:0%
and with that we have now the first row
 

01:03:23.319 --> 01:03:25.309 align:start position:0%
and with that we have now the first row
and<01:03:23.480><c> we</c><01:03:23.599><c> can</c><01:03:23.760><c> use</c><01:03:24.079><c> this</c><01:03:24.359><c> as</c><01:03:24.640><c> the</c><01:03:24.760><c> first</c><01:03:25.000><c> step</c><01:03:25.200><c> in</c>

01:03:25.309 --> 01:03:25.319 align:start position:0%
and we can use this as the first step in
 

01:03:25.319 --> 01:03:27.069 align:start position:0%
and we can use this as the first step in
our<01:03:25.480><c> iteration</c><01:03:26.160><c> so</c><01:03:26.319><c> now</c><01:03:26.440><c> let's</c><01:03:26.599><c> go</c><01:03:26.720><c> and</c><01:03:26.880><c> pick</c>

01:03:27.069 --> 01:03:27.079 align:start position:0%
our iteration so now let's go and pick
 

01:03:27.079 --> 01:03:29.190 align:start position:0%
our iteration so now let's go and pick
few<01:03:27.319><c> informations</c><01:03:28.000><c> in</c><01:03:28.119><c> the</c><01:03:28.319><c> select</c><01:03:28.880><c> like</c><01:03:29.039><c> the</c>

01:03:29.190 --> 01:03:29.200 align:start position:0%
few informations in the select like the
 

01:03:29.200 --> 01:03:30.190 align:start position:0%
few informations in the select like the
employee

01:03:30.190 --> 01:03:30.200 align:start position:0%
employee
 

01:03:30.200 --> 01:03:33.470 align:start position:0%
employee
ID<01:03:31.200><c> and</c><01:03:31.440><c> the</c><01:03:31.599><c> first</c><01:03:31.960><c> name</c><01:03:32.839><c> and</c><01:03:33.000><c> as</c><01:03:33.160><c> well</c><01:03:33.319><c> let's</c>

01:03:33.470 --> 01:03:33.480 align:start position:0%
ID and the first name and as well let's
 

01:03:33.480 --> 01:03:35.710 align:start position:0%
ID and the first name and as well let's
go<01:03:33.599><c> and</c><01:03:33.799><c> get</c><01:03:33.960><c> the</c><01:03:34.079><c> manager</c><01:03:34.480><c> ID</c><01:03:35.359><c> and</c><01:03:35.480><c> now</c><01:03:35.599><c> we</c>

01:03:35.710 --> 01:03:35.720 align:start position:0%
go and get the manager ID and now we
 

01:03:35.720 --> 01:03:37.990 align:start position:0%
go and get the manager ID and now we
have<01:03:35.839><c> to</c><01:03:35.960><c> start</c><01:03:36.240><c> creating</c><01:03:36.720><c> the</c><01:03:36.880><c> levels</c><01:03:37.400><c> right</c>

01:03:37.990 --> 01:03:38.000 align:start position:0%
have to start creating the levels right
 

01:03:38.000 --> 01:03:40.470 align:start position:0%
have to start creating the levels right
so<01:03:38.559><c> this</c><01:03:38.760><c> is</c><01:03:39.160><c> the</c><01:03:39.359><c> first</c><01:03:39.720><c> level</c><01:03:40.079><c> so</c><01:03:40.279><c> I'm</c><01:03:40.359><c> going</c>

01:03:40.470 --> 01:03:40.480 align:start position:0%
so this is the first level so I'm going
 

01:03:40.480 --> 01:03:42.990 align:start position:0%
so this is the first level so I'm going
to<01:03:40.599><c> have</c><01:03:40.720><c> the</c><01:03:40.880><c> value</c><01:03:41.160><c> one</c><01:03:41.559><c> as</c><01:03:42.480><c> let's</c><01:03:42.720><c> have</c><01:03:42.839><c> it</c>

01:03:42.990 --> 01:03:43.000 align:start position:0%
to have the value one as let's have it
 

01:03:43.000 --> 01:03:46.230 align:start position:0%
to have the value one as let's have it
like<01:03:43.279><c> level</c><01:03:43.880><c> so</c><01:03:44.119><c> our</c><01:03:44.400><c> CEO</c><01:03:45.000><c> has</c><01:03:45.520><c> the</c><01:03:45.839><c> level</c>

01:03:46.230 --> 01:03:46.240 align:start position:0%
like level so our CEO has the level
 

01:03:46.240 --> 01:03:49.150 align:start position:0%
like level so our CEO has the level
number<01:03:46.559><c> one</c><01:03:47.119><c> so</c><01:03:47.640><c> let's</c><01:03:47.799><c> go</c><01:03:47.960><c> and</c><01:03:48.200><c> excuse</c><01:03:48.599><c> it</c><01:03:49.000><c> so</c>

01:03:49.150 --> 01:03:49.160 align:start position:0%
number one so let's go and excuse it so
 

01:03:49.160 --> 01:03:52.109 align:start position:0%
number one so let's go and excuse it so
now<01:03:49.359><c> as</c><01:03:49.440><c> you</c><01:03:49.520><c> can</c><01:03:49.680><c> see</c><01:03:50.079><c> Frank</c><01:03:50.680><c> is</c><01:03:51.000><c> the</c><01:03:51.200><c> CEO</c><01:03:51.880><c> and</c>

01:03:52.109 --> 01:03:52.119 align:start position:0%
now as you can see Frank is the CEO and
 

01:03:52.119 --> 01:03:55.029 align:start position:0%
now as you can see Frank is the CEO and
he<01:03:52.279><c> is</c><01:03:52.480><c> in</c><01:03:52.680><c> the</c><01:03:52.880><c> level</c><01:03:53.400><c> number</c><01:03:53.680><c> one</c><01:03:54.200><c> so</c><01:03:54.640><c> this</c><01:03:54.799><c> is</c>

01:03:55.029 --> 01:03:55.039 align:start position:0%
he is in the level number one so this is
 

01:03:55.039 --> 01:03:57.390 align:start position:0%
he is in the level number one so this is
our<01:03:55.279><c> anchor</c><01:03:55.920><c> query</c><01:03:56.440><c> now</c><01:03:56.640><c> we</c><01:03:56.760><c> have</c><01:03:56.880><c> to</c><01:03:57.039><c> do</c><01:03:57.240><c> the</c>

01:03:57.390 --> 01:03:57.400 align:start position:0%
our anchor query now we have to do the
 

01:03:57.400 --> 01:03:59.309 align:start position:0%
our anchor query now we have to do the
iteration<01:03:58.160><c> right</c><01:03:58.400><c> so</c><01:03:58.599><c> we</c><01:03:58.720><c> have</c><01:03:58.839><c> to</c><01:03:59.000><c> go</c><01:03:59.160><c> and</c>

01:03:59.309 --> 01:03:59.319 align:start position:0%
iteration right so we have to go and
 

01:03:59.319 --> 01:04:02.190 align:start position:0%
iteration right so we have to go and
start<01:03:59.680><c> creating</c><01:04:00.200><c> the</c><01:04:00.359><c> CTE</c><01:04:01.319><c> so</c><01:04:01.559><c> let's</c><01:04:01.760><c> call</c><01:04:01.960><c> it</c>

01:04:02.190 --> 01:04:02.200 align:start position:0%
start creating the CTE so let's call it
 

01:04:02.200 --> 01:04:06.069 align:start position:0%
start creating the CTE so let's call it
with<01:04:03.079><c> CTE</c><01:04:04.160><c> employee</c>

01:04:06.069 --> 01:04:06.079 align:start position:0%
with CTE employee
 

01:04:06.079 --> 01:04:09.630 align:start position:0%
with CTE employee
hierarchy<01:04:07.079><c> and</c><01:04:07.200><c> then</c><01:04:07.440><c> as</c><01:04:07.920><c> and</c><01:04:08.119><c> then</c><01:04:09.079><c> this</c><01:04:09.279><c> is</c>

01:04:09.630 --> 01:04:09.640 align:start position:0%
hierarchy and then as and then this is
 

01:04:09.640 --> 01:04:12.990 align:start position:0%
hierarchy and then as and then this is
the<01:04:09.839><c> definition</c><01:04:10.440><c> of</c><01:04:10.760><c> our</c><01:04:11.760><c> CD</c><01:04:12.319><c> so</c><01:04:12.559><c> let</c><01:04:12.680><c> me</c><01:04:12.839><c> just</c>

01:04:12.990 --> 01:04:13.000 align:start position:0%
the definition of our CD so let me just
 

01:04:13.000 --> 01:04:15.150 align:start position:0%
the definition of our CD so let me just
make<01:04:13.160><c> it</c><01:04:13.359><c> like</c><01:04:13.599><c> this</c><01:04:14.440><c> and</c><01:04:14.599><c> of</c><01:04:14.720><c> course</c><01:04:14.960><c> what</c><01:04:15.079><c> do</c>

01:04:15.150 --> 01:04:15.160 align:start position:0%
make it like this and of course what do
 

01:04:15.160 --> 01:04:18.190 align:start position:0%
make it like this and of course what do
we<01:04:15.319><c> need</c><01:04:15.520><c> we</c><01:04:15.640><c> need</c><01:04:15.880><c> the</c><01:04:16.160><c> main</c><01:04:16.480><c> query</c>

01:04:18.190 --> 01:04:18.200 align:start position:0%
we need we need the main query
 

01:04:18.200 --> 01:04:20.029 align:start position:0%
we need we need the main query
so<01:04:19.200><c> main</c>

01:04:20.029 --> 01:04:20.039 align:start position:0%
so main
 

01:04:20.039 --> 01:04:23.029 align:start position:0%
so main
query<01:04:21.039><c> we</c><01:04:21.160><c> will</c><01:04:21.359><c> select</c>

01:04:23.029 --> 01:04:23.039 align:start position:0%
query we will select
 

01:04:23.039 --> 01:04:26.510 align:start position:0%
query we will select
everything<01:04:24.039><c> from</c><01:04:24.359><c> our</c><01:04:24.640><c> new</c><01:04:24.839><c> city</c><01:04:25.720><c> like</c><01:04:25.960><c> this</c>

01:04:26.510 --> 01:04:26.520 align:start position:0%
everything from our new city like this
 

01:04:26.520 --> 01:04:29.630 align:start position:0%
everything from our new city like this
so<01:04:26.920><c> let's</c><01:04:27.119><c> go</c><01:04:27.319><c> and</c><01:04:27.559><c> test</c><01:04:28.039><c> it</c><01:04:29.039><c> all</c><01:04:29.160><c> right</c><01:04:29.319><c> so</c><01:04:29.480><c> now</c>

01:04:29.630 --> 01:04:29.640 align:start position:0%
so let's go and test it all right so now
 

01:04:29.640 --> 01:04:31.670 align:start position:0%
so let's go and test it all right so now
we<01:04:29.760><c> have</c><01:04:29.880><c> prepared</c><01:04:30.359><c> the</c><01:04:30.480><c> CTE</c><01:04:31.039><c> and</c><01:04:31.279><c> the</c><01:04:31.400><c> main</c>

01:04:31.670 --> 01:04:31.680 align:start position:0%
we have prepared the CTE and the main
 

01:04:31.680 --> 01:04:33.470 align:start position:0%
we have prepared the CTE and the main
query<01:04:32.240><c> and</c><01:04:32.359><c> of</c><01:04:32.480><c> course</c><01:04:32.760><c> the</c><01:04:32.880><c> next</c><01:04:33.000><c> step</c><01:04:33.200><c> it</c><01:04:33.319><c> do</c>

01:04:33.470 --> 01:04:33.480 align:start position:0%
query and of course the next step it do
 

01:04:33.480 --> 01:04:34.950 align:start position:0%
query and of course the next step it do
we're<01:04:33.559><c> going</c><01:04:33.640><c> to</c><01:04:33.720><c> go</c><01:04:33.880><c> and</c><01:04:34.039><c> build</c><01:04:34.720><c> the</c>

01:04:34.950 --> 01:04:34.960 align:start position:0%
we're going to go and build the
 

01:04:34.960 --> 01:04:37.670 align:start position:0%
we're going to go and build the
recursive<01:04:35.640><c> query</c><01:04:36.200><c> but</c><01:04:36.400><c> first</c><01:04:36.640><c> we</c><01:04:36.799><c> need</c><01:04:37.319><c> the</c>

01:04:37.670 --> 01:04:37.680 align:start position:0%
recursive query but first we need the
 

01:04:37.680 --> 01:04:40.589 align:start position:0%
recursive query but first we need the
union<01:04:38.480><c> all</c><01:04:39.480><c> in</c><01:04:39.599><c> order</c><01:04:39.839><c> to</c><01:04:40.000><c> connect</c><01:04:40.279><c> the</c><01:04:40.400><c> two</c>

01:04:40.589 --> 01:04:40.599 align:start position:0%
union all in order to connect the two
 

01:04:40.599 --> 01:04:44.750 align:start position:0%
union all in order to connect the two
queries<01:04:41.400><c> and</c><01:04:42.480><c> precursive</c><01:04:43.480><c> query</c><01:04:44.440><c> and</c><01:04:44.559><c> now</c><01:04:44.680><c> we</c>

01:04:44.750 --> 01:04:44.760 align:start position:0%
queries and precursive query and now we
 

01:04:44.760 --> 01:04:46.549 align:start position:0%
queries and precursive query and now we
can<01:04:44.920><c> start</c><01:04:45.119><c> building</c><01:04:45.440><c> the</c><01:04:45.599><c> logic</c><01:04:46.160><c> so</c><01:04:46.279><c> now</c><01:04:46.440><c> we</c>

01:04:46.549 --> 01:04:46.559 align:start position:0%
can start building the logic so now we
 

01:04:46.559 --> 01:04:48.710 align:start position:0%
can start building the logic so now we
want<01:04:46.680><c> to</c><01:04:46.839><c> find</c><01:04:47.160><c> all</c><01:04:47.359><c> the</c><01:04:47.520><c> employees</c><01:04:48.440><c> where</c>

01:04:48.710 --> 01:04:48.720 align:start position:0%
want to find all the employees where
 

01:04:48.720 --> 01:04:51.430 align:start position:0%
want to find all the employees where
their<01:04:49.000><c> manager</c><01:04:49.680><c> is</c><01:04:50.240><c> the</c><01:04:50.400><c> employee</c><01:04:50.880><c> ID</c><01:04:51.160><c> number</c>

01:04:51.430 --> 01:04:51.440 align:start position:0%
their manager is the employee ID number
 

01:04:51.440 --> 01:04:53.670 align:start position:0%
their manager is the employee ID number
one<01:04:51.880><c> right</c><01:04:52.279><c> because</c><01:04:52.680><c> they</c><01:04:52.839><c> can</c><01:04:53.000><c> to</c><01:04:53.160><c> have</c><01:04:53.400><c> the</c>

01:04:53.670 --> 01:04:53.680 align:start position:0%
one right because they can to have the
 

01:04:53.680 --> 01:04:55.750 align:start position:0%
one right because they can to have the
second<01:04:54.079><c> level</c><01:04:54.400><c> in</c><01:04:54.520><c> the</c><01:04:54.680><c> hierarchy</c><01:04:55.279><c> so</c><01:04:55.400><c> what</c>

01:04:55.750 --> 01:04:55.760 align:start position:0%
second level in the hierarchy so what
 

01:04:55.760 --> 01:04:57.269 align:start position:0%
second level in the hierarchy so what
going<01:04:55.839><c> to</c><01:04:55.920><c> do</c><01:04:56.039><c> we're</c><01:04:56.119><c> going</c><01:04:56.200><c> to</c><01:04:56.319><c> go</c><01:04:56.440><c> and</c>

01:04:57.269 --> 01:04:57.279 align:start position:0%
going to do we're going to go and
 

01:04:57.279 --> 01:04:59.910 align:start position:0%
going to do we're going to go and
select<01:04:58.279><c> and</c><01:04:58.440><c> we</c><01:04:58.559><c> need</c><01:04:58.720><c> the</c><01:04:58.880><c> same</c><01:04:59.160><c> stuff</c><01:04:59.559><c> so</c><01:04:59.799><c> we</c>

01:04:59.910 --> 01:04:59.920 align:start position:0%
select and we need the same stuff so we
 

01:04:59.920 --> 01:05:01.589 align:start position:0%
select and we need the same stuff so we
would<01:05:00.079><c> like</c><01:05:00.200><c> to</c><01:05:00.319><c> get</c><01:05:00.480><c> the</c><01:05:00.599><c> employee</c><01:05:01.039><c> ID</c><01:05:01.440><c> the</c>

01:05:01.589 --> 01:05:01.599 align:start position:0%
would like to get the employee ID the
 

01:05:01.599 --> 01:05:03.910 align:start position:0%
would like to get the employee ID the
first<01:05:01.920><c> name</c><01:05:02.400><c> and</c><01:05:02.559><c> the</c><01:05:02.680><c> manager</c><01:05:03.039><c> ID</c><01:05:03.599><c> and</c><01:05:03.799><c> we</c>

01:05:03.910 --> 01:05:03.920 align:start position:0%
first name and the manager ID and we
 

01:05:03.920 --> 01:05:05.670 align:start position:0%
first name and the manager ID and we
need<01:05:04.079><c> the</c><01:05:04.240><c> level</c><01:05:04.720><c> so</c><01:05:05.039><c> this</c><01:05:05.200><c> going</c><01:05:05.279><c> to</c><01:05:05.400><c> be</c><01:05:05.559><c> the</c>

01:05:05.670 --> 01:05:05.680 align:start position:0%
need the level so this going to be the
 

01:05:05.680 --> 01:05:07.990 align:start position:0%
need the level so this going to be the
level<01:05:06.000><c> number</c><01:05:06.240><c> two</c><01:05:07.000><c> it's</c><01:05:07.160><c> not</c><01:05:07.400><c> correct</c><01:05:07.799><c> yet</c>

01:05:07.990 --> 01:05:08.000 align:start position:0%
level number two it's not correct yet
 

01:05:08.000 --> 01:05:10.109 align:start position:0%
level number two it's not correct yet
I'm<01:05:08.200><c> must</c><01:05:08.400><c> I</c><01:05:08.520><c> just</c><01:05:08.680><c> want</c><01:05:08.880><c> to</c><01:05:09.039><c> show</c><01:05:09.839><c> what</c><01:05:10.000><c> this</c>

01:05:10.109 --> 01:05:10.119 align:start position:0%
I'm must I just want to show what this
 

01:05:10.119 --> 01:05:11.789 align:start position:0%
I'm must I just want to show what this
means<01:05:10.799><c> because</c><01:05:11.039><c> we</c><01:05:11.119><c> need</c><01:05:11.279><c> to</c><01:05:11.440><c> get</c><01:05:11.680><c> the</c>

01:05:11.789 --> 01:05:11.799 align:start position:0%
means because we need to get the
 

01:05:11.799 --> 01:05:14.230 align:start position:0%
means because we need to get the
employee<01:05:12.200><c> ID</c><01:05:12.559><c> and</c><01:05:12.680><c> the</c><01:05:12.760><c> first</c><01:05:12.960><c> name</c><01:05:13.160><c> and</c><01:05:13.279><c> so</c><01:05:13.440><c> on</c>

01:05:14.230 --> 01:05:14.240 align:start position:0%
employee ID and the first name and so on
 

01:05:14.240 --> 01:05:16.230 align:start position:0%
employee ID and the first name and so on
we<01:05:14.400><c> cannot</c><01:05:14.760><c> get</c><01:05:14.880><c> it</c><01:05:15.119><c> yet</c><01:05:15.359><c> from</c><01:05:15.559><c> the</c><01:05:15.720><c> CTE</c>

01:05:16.230 --> 01:05:16.240 align:start position:0%
we cannot get it yet from the CTE
 

01:05:16.240 --> 01:05:17.789 align:start position:0%
we cannot get it yet from the CTE
because<01:05:16.520><c> in</c><01:05:16.640><c> the</c><01:05:16.760><c> CTE</c><01:05:17.119><c> we</c><01:05:17.200><c> have</c><01:05:17.359><c> only</c><01:05:17.599><c> one</c>

01:05:17.789 --> 01:05:17.799 align:start position:0%
because in the CTE we have only one
 

01:05:17.799 --> 01:05:19.789 align:start position:0%
because in the CTE we have only one
employee<01:05:18.400><c> so</c><01:05:18.640><c> we</c><01:05:18.799><c> still</c><01:05:19.039><c> have</c><01:05:19.200><c> to</c><01:05:19.319><c> go</c><01:05:19.440><c> to</c><01:05:19.599><c> the</c>

01:05:19.789 --> 01:05:19.799 align:start position:0%
employee so we still have to go to the
 

01:05:19.799 --> 01:05:23.029 align:start position:0%
employee so we still have to go to the
database<01:05:20.319><c> and</c><01:05:20.559><c> grab</c><01:05:21.440><c> the</c><01:05:21.640><c> next</c><01:05:22.160><c> employees</c><01:05:22.880><c> so</c>

01:05:23.029 --> 01:05:23.039 align:start position:0%
database and grab the next employees so
 

01:05:23.039 --> 01:05:26.190 align:start position:0%
database and grab the next employees so
now<01:05:23.200><c> we'll</c><01:05:23.400><c> give</c><01:05:23.640><c> this</c><01:05:23.880><c> as</c><01:05:24.039><c> an</c><01:05:24.240><c> alas</c><01:05:24.960><c> like</c><01:05:25.200><c> e</c>

01:05:26.190 --> 01:05:26.200 align:start position:0%
now we'll give this as an alas like e
 

01:05:26.200 --> 01:05:28.670 align:start position:0%
now we'll give this as an alas like e
and<01:05:26.400><c> I</c><01:05:26.480><c> will</c><01:05:26.680><c> select</c><01:05:27.000><c> it</c><01:05:27.319><c> as</c><01:05:27.480><c> well</c><01:05:28.200><c> from</c><01:05:28.440><c> those</c>

01:05:28.670 --> 01:05:28.680 align:start position:0%
and I will select it as well from those
 

01:05:28.680 --> 01:05:31.190 align:start position:0%
and I will select it as well from those
employees<01:05:29.440><c> so</c><01:05:29.599><c> so</c><01:05:29.799><c> far</c><01:05:30.000><c> we</c><01:05:30.079><c> are</c><01:05:30.319><c> not</c><01:05:30.640><c> doing</c><01:05:30.960><c> any</c>

01:05:31.190 --> 01:05:31.200 align:start position:0%
employees so so far we are not doing any
 

01:05:31.200 --> 01:05:33.470 align:start position:0%
employees so so far we are not doing any
recursive<01:05:31.760><c> yet</c><01:05:32.240><c> right</c><01:05:32.760><c> in</c><01:05:32.920><c> the</c><01:05:33.039><c> recursive</c>

01:05:33.470 --> 01:05:33.480 align:start position:0%
recursive yet right in the recursive
 

01:05:33.480 --> 01:05:35.950 align:start position:0%
recursive yet right in the recursive
query<01:05:34.160><c> we're</c><01:05:34.359><c> still</c><01:05:34.640><c> quering</c><01:05:35.039><c> the</c><01:05:35.200><c> database</c>

01:05:35.950 --> 01:05:35.960 align:start position:0%
query we're still quering the database
 

01:05:35.960 --> 01:05:38.109 align:start position:0%
query we're still quering the database
but<01:05:36.119><c> now</c><01:05:36.279><c> we</c><01:05:36.440><c> don't</c><01:05:36.680><c> need</c><01:05:36.960><c> all</c><01:05:37.160><c> the</c><01:05:37.279><c> employees</c>

01:05:38.109 --> 01:05:38.119 align:start position:0%
but now we don't need all the employees
 

01:05:38.119 --> 01:05:39.950 align:start position:0%
but now we don't need all the employees
from<01:05:38.359><c> this</c><01:05:38.559><c> table</c><01:05:39.200><c> we</c><01:05:39.319><c> need</c><01:05:39.599><c> all</c><01:05:39.839><c> the</c>

01:05:39.950 --> 01:05:39.960 align:start position:0%
from this table we need all the
 

01:05:39.960 --> 01:05:42.870 align:start position:0%
from this table we need all the
employees<01:05:40.559><c> where</c><01:05:40.920><c> the</c><01:05:41.520><c> manager</c><01:05:42.000><c> ID</c><01:05:42.400><c> equal</c><01:05:42.720><c> to</c>

01:05:42.870 --> 01:05:42.880 align:start position:0%
employees where the manager ID equal to
 

01:05:42.880 --> 01:05:44.750 align:start position:0%
employees where the manager ID equal to
one<01:05:43.279><c> right</c><01:05:43.640><c> now</c><01:05:43.760><c> of</c><01:05:43.880><c> course</c><01:05:44.039><c> in</c><01:05:44.160><c> order</c><01:05:44.400><c> to</c><01:05:44.520><c> get</c>

01:05:44.750 --> 01:05:44.760 align:start position:0%
one right now of course in order to get
 

01:05:44.760 --> 01:05:47.309 align:start position:0%
one right now of course in order to get
those<01:05:45.160><c> employees</c><01:05:46.160><c> where</c><01:05:46.400><c> the</c><01:05:46.520><c> manager</c><01:05:47.000><c> equal</c>

01:05:47.309 --> 01:05:47.319 align:start position:0%
those employees where the manager equal
 

01:05:47.319 --> 01:05:49.430 align:start position:0%
those employees where the manager equal
to<01:05:47.559><c> one</c><01:05:48.079><c> so</c><01:05:48.279><c> we</c><01:05:48.400><c> can</c><01:05:48.559><c> do</c><01:05:48.720><c> it</c><01:05:48.920><c> with</c><01:05:49.039><c> the</c><01:05:49.160><c> work</c>

01:05:49.430 --> 01:05:49.440 align:start position:0%
to one so we can do it with the work
 

01:05:49.440 --> 01:05:53.190 align:start position:0%
to one so we can do it with the work
clouds<01:05:49.839><c> for</c><01:05:50.079><c> example</c><01:05:50.599><c> and</c><01:05:51.160><c> say</c><01:05:52.160><c> manager</c><01:05:52.680><c> ID</c>

01:05:53.190 --> 01:05:53.200 align:start position:0%
clouds for example and say manager ID
 

01:05:53.200 --> 01:05:55.230 align:start position:0%
clouds for example and say manager ID
equal<01:05:53.520><c> to</c><01:05:53.720><c> one</c><01:05:54.000><c> let</c><01:05:54.119><c> me</c><01:05:54.279><c> just</c><01:05:54.440><c> select</c><01:05:54.799><c> this</c><01:05:54.960><c> and</c>

01:05:55.230 --> 01:05:55.240 align:start position:0%
equal to one let me just select this and
 

01:05:55.240 --> 01:05:57.630 align:start position:0%
equal to one let me just select this and
query<01:05:56.039><c> now</c><01:05:56.200><c> we</c><01:05:56.279><c> will</c><01:05:56.480><c> get</c><01:05:56.880><c> those</c><01:05:57.160><c> two</c>

01:05:57.630 --> 01:05:57.640 align:start position:0%
query now we will get those two
 

01:05:57.640 --> 01:06:00.549 align:start position:0%
query now we will get those two
employees<01:05:58.520><c> where</c><01:05:58.720><c> their</c><01:05:58.920><c> manager</c><01:05:59.400><c> is</c><01:05:59.640><c> the</c><01:05:59.799><c> CEO</c>

01:06:00.549 --> 01:06:00.559 align:start position:0%
employees where their manager is the CEO
 

01:06:00.559 --> 01:06:02.510 align:start position:0%
employees where their manager is the CEO
the<01:06:00.760><c> top</c><01:06:01.000><c> manager</c><01:06:01.599><c> but</c><01:06:01.760><c> of</c><01:06:01.880><c> course</c><01:06:02.079><c> we</c><01:06:02.200><c> cannot</c>

01:06:02.510 --> 01:06:02.520 align:start position:0%
the top manager but of course we cannot
 

01:06:02.520 --> 01:06:04.510 align:start position:0%
the top manager but of course we cannot
do<01:06:02.680><c> it</c><01:06:02.880><c> like</c><01:06:03.119><c> this</c><01:06:03.599><c> what</c><01:06:03.760><c> we're</c><01:06:03.839><c> going</c><01:06:03.960><c> to</c><01:06:04.079><c> do</c>

01:06:04.510 --> 01:06:04.520 align:start position:0%
do it like this what we're going to do
 

01:06:04.520 --> 01:06:06.870 align:start position:0%
do it like this what we're going to do
we're<01:06:04.640><c> going</c><01:06:04.760><c> to</c><01:06:05.000><c> join</c><01:06:05.640><c> this</c><01:06:05.880><c> table</c><01:06:06.400><c> with</c><01:06:06.599><c> our</c>

01:06:06.870 --> 01:06:06.880 align:start position:0%
we're going to join this table with our
 

01:06:06.880 --> 01:06:09.670 align:start position:0%
we're going to join this table with our
Curren<01:06:07.240><c> CTE</c><01:06:08.079><c> in</c><01:06:08.240><c> order</c><01:06:08.559><c> to</c><01:06:08.720><c> make</c><01:06:08.920><c> a</c><01:06:09.079><c> loop</c><01:06:09.520><c> so</c>

01:06:09.670 --> 01:06:09.680 align:start position:0%
Curren CTE in order to make a loop so
 

01:06:09.680 --> 01:06:11.230 align:start position:0%
Curren CTE in order to make a loop so
let<01:06:09.760><c> me</c><01:06:09.880><c> show</c><01:06:10.079><c> you</c><01:06:10.200><c> what</c><01:06:10.359><c> I</c><01:06:10.480><c> mean</c><01:06:10.799><c> we</c><01:06:10.880><c> will</c>

01:06:11.230 --> 01:06:11.240 align:start position:0%
let me show you what I mean we will
 

01:06:11.240 --> 01:06:14.630 align:start position:0%
let me show you what I mean we will
remove<01:06:11.720><c> this</c><01:06:12.440><c> we're</c><01:06:12.559><c> going</c><01:06:12.680><c> to</c><01:06:12.799><c> use</c><01:06:13.079><c> the</c><01:06:13.240><c> inner</c>

01:06:14.630 --> 01:06:14.640 align:start position:0%
remove this we're going to use the inner
 

01:06:14.640 --> 01:06:17.349 align:start position:0%
remove this we're going to use the inner
join<01:06:15.640><c> and</c><01:06:15.799><c> we're</c><01:06:15.920><c> going</c><01:06:16.039><c> to</c><01:06:16.240><c> reference</c><01:06:16.760><c> it</c>

01:06:17.349 --> 01:06:17.359 align:start position:0%
join and we're going to reference it
 

01:06:17.359 --> 01:06:18.230 align:start position:0%
join and we're going to reference it
from<01:06:17.559><c> the</c>

01:06:18.230 --> 01:06:18.240 align:start position:0%
from the
 

01:06:18.240 --> 01:06:22.109 align:start position:0%
from the
CTE<01:06:19.240><c> and</c><01:06:19.400><c> let's</c><01:06:19.640><c> give</c><01:06:19.839><c> this</c><01:06:20.000><c> the</c><01:06:20.200><c> name</c><01:06:20.480><c> c</c><01:06:21.359><c> h</c><01:06:22.000><c> and</c>

01:06:22.109 --> 01:06:22.119 align:start position:0%
CTE and let's give this the name c h and
 

01:06:22.119 --> 01:06:24.510 align:start position:0%
CTE and let's give this the name c h and
we<01:06:22.279><c> connect</c><01:06:22.599><c> it</c><01:06:22.799><c> like</c><01:06:23.000><c> this</c><01:06:23.319><c> so</c><01:06:23.680><c> on</c><01:06:24.359><c> we're</c>

01:06:24.510 --> 01:06:24.520 align:start position:0%
we connect it like this so on we're
 

01:06:24.520 --> 01:06:26.589 align:start position:0%
we connect it like this so on we're
going<01:06:24.599><c> to</c><01:06:24.760><c> say</c><01:06:25.200><c> the</c><01:06:25.359><c> m</c><01:06:25.599><c> manager</c><01:06:26.000><c> ID</c><01:06:26.319><c> of</c><01:06:26.480><c> the</c>

01:06:26.589 --> 01:06:26.599 align:start position:0%
going to say the m manager ID of the
 

01:06:26.599 --> 01:06:28.390 align:start position:0%
going to say the m manager ID of the
employee<01:06:27.319><c> should</c><01:06:27.599><c> be</c>

01:06:28.390 --> 01:06:28.400 align:start position:0%
employee should be
 

01:06:28.400 --> 01:06:32.109 align:start position:0%
employee should be
equal<01:06:29.400><c> to</c><01:06:29.640><c> the</c><01:06:29.880><c> employee</c><01:06:30.400><c> ID</c><01:06:31.039><c> so</c><01:06:31.599><c> the</c><01:06:31.720><c> employee</c>

01:06:32.109 --> 01:06:32.119 align:start position:0%
equal to the employee ID so the employee
 

01:06:32.119 --> 01:06:33.950 align:start position:0%
equal to the employee ID so the employee
ID<01:06:32.440><c> at</c><01:06:32.559><c> the</c><01:06:32.720><c> start</c><01:06:33.000><c> going</c><01:06:33.119><c> to</c><01:06:33.279><c> be</c><01:06:33.599><c> the</c><01:06:33.720><c> number</c>

01:06:33.950 --> 01:06:33.960 align:start position:0%
ID at the start going to be the number
 

01:06:33.960 --> 01:06:36.069 align:start position:0%
ID at the start going to be the number
one<01:06:34.440><c> so</c><01:06:34.720><c> it's</c><01:06:34.839><c> going</c><01:06:34.960><c> to</c><01:06:35.079><c> be</c><01:06:35.279><c> like</c>

01:06:36.069 --> 01:06:36.079 align:start position:0%
one so it's going to be like
 

01:06:36.079 --> 01:06:39.829 align:start position:0%
one so it's going to be like
this<01:06:37.079><c> employee</c><01:06:37.559><c> ID</c><01:06:38.240><c> now</c><01:06:38.480><c> we</c><01:06:38.599><c> are</c><01:06:38.880><c> connecting</c>

01:06:39.829 --> 01:06:39.839 align:start position:0%
this employee ID now we are connecting
 

01:06:39.839 --> 01:06:42.470 align:start position:0%
this employee ID now we are connecting
the<01:06:40.000><c> manager</c><01:06:40.440><c> ID</c><01:06:40.920><c> with</c><01:06:41.079><c> the</c><01:06:41.200><c> employee</c><01:06:41.680><c> ID</c><01:06:42.279><c> and</c>

01:06:42.470 --> 01:06:42.480 align:start position:0%
the manager ID with the employee ID and
 

01:06:42.480 --> 01:06:45.549 align:start position:0%
the manager ID with the employee ID and
we<01:06:42.680><c> are</c><01:06:43.000><c> as</c><01:06:43.160><c> well</c><01:06:43.760><c> reusing</c><01:06:44.400><c> the</c><01:06:44.559><c> CD</c><01:06:45.119><c> inside</c>

01:06:45.549 --> 01:06:45.559 align:start position:0%
we are as well reusing the CD inside
 

01:06:45.559 --> 01:06:48.109 align:start position:0%
we are as well reusing the CD inside
itself<01:06:46.000><c> in</c><01:06:46.119><c> order</c><01:06:46.359><c> to</c><01:06:46.559><c> make</c><01:06:47.079><c> the</c><01:06:47.279><c> iterations</c>

01:06:48.109 --> 01:06:48.119 align:start position:0%
itself in order to make the iterations
 

01:06:48.119 --> 01:06:50.309 align:start position:0%
itself in order to make the iterations
and<01:06:48.319><c> here</c><01:06:48.480><c> we</c><01:06:48.599><c> don't</c><01:06:48.839><c> need</c><01:06:49.039><c> the</c><01:06:49.200><c> work</c><01:06:49.640><c> clouds</c>

01:06:50.309 --> 01:06:50.319 align:start position:0%
and here we don't need the work clouds
 

01:06:50.319 --> 01:06:52.029 align:start position:0%
and here we don't need the work clouds
because<01:06:50.760><c> the</c><01:06:50.880><c> inner</c><01:06:51.200><c> joint</c><01:06:51.520><c> going</c><01:06:51.599><c> to</c><01:06:51.720><c> filter</c>

01:06:52.029 --> 01:06:52.039 align:start position:0%
because the inner joint going to filter
 

01:06:52.039 --> 01:06:54.069 align:start position:0%
because the inner joint going to filter
the<01:06:52.200><c> data</c><01:06:52.480><c> automatically</c><01:06:53.240><c> as</c><01:06:53.359><c> we</c><01:06:53.480><c> learned</c><01:06:53.960><c> the</c>

01:06:54.069 --> 01:06:54.079 align:start position:0%
the data automatically as we learned the
 

01:06:54.079 --> 01:06:55.829 align:start position:0%
the data automatically as we learned the
inner<01:06:54.359><c> joint</c><01:06:54.760><c> going</c><01:06:54.880><c> to</c><01:06:55.000><c> show</c><01:06:55.200><c> only</c><01:06:55.720><c> the</c>

01:06:55.829 --> 01:06:55.839 align:start position:0%
inner joint going to show only the
 

01:06:55.839 --> 01:06:57.829 align:start position:0%
inner joint going to show only the
matching<01:06:56.200><c> rows</c><01:06:56.640><c> from</c><01:06:56.799><c> the</c><01:06:56.960><c> left</c><01:06:57.240><c> and</c><01:06:57.480><c> to</c><01:06:57.640><c> the</c>

01:06:57.829 --> 01:06:57.839 align:start position:0%
matching rows from the left and to the
 

01:06:57.839 --> 01:06:59.349 align:start position:0%
matching rows from the left and to the
right<01:06:58.240><c> so</c><01:06:58.440><c> that</c><01:06:58.599><c> means</c><01:06:58.880><c> there</c><01:06:59.000><c> will</c><01:06:59.160><c> be</c>

01:06:59.349 --> 01:06:59.359 align:start position:0%
right so that means there will be
 

01:06:59.359 --> 01:07:01.589 align:start position:0%
right so that means there will be
filtering<01:07:00.119><c> so</c><01:07:00.319><c> we</c><01:07:00.400><c> are</c><01:07:00.640><c> almost</c><01:07:01.079><c> there</c><01:07:01.279><c> but</c><01:07:01.440><c> of</c>

01:07:01.589 --> 01:07:01.599 align:start position:0%
filtering so we are almost there but of
 

01:07:01.599 --> 01:07:03.829 align:start position:0%
filtering so we are almost there but of
course<01:07:01.880><c> we</c><01:07:02.000><c> don't</c><01:07:02.240><c> want</c><01:07:02.359><c> to</c><01:07:02.480><c> show</c><01:07:02.680><c> it</c><01:07:02.880><c> as</c><01:07:03.039><c> a</c><01:07:03.200><c> two</c>

01:07:03.829 --> 01:07:03.839 align:start position:0%
course we don't want to show it as a two
 

01:07:03.839 --> 01:07:05.029 align:start position:0%
course we don't want to show it as a two
what<01:07:03.960><c> we're</c><01:07:04.079><c> going</c><01:07:04.200><c> to</c><01:07:04.319><c> do</c><01:07:04.720><c> we're</c><01:07:04.839><c> going</c><01:07:04.960><c> to</c>

01:07:05.029 --> 01:07:05.039 align:start position:0%
what we're going to do we're going to
 

01:07:05.039 --> 01:07:08.309 align:start position:0%
what we're going to do we're going to
show<01:07:05.200><c> it</c><01:07:05.359><c> like</c><01:07:05.559><c> this</c><01:07:06.000><c> level</c><01:07:07.000><c> +</c><01:07:07.520><c> one</c><01:07:08.000><c> so</c><01:07:08.160><c> the</c>

01:07:08.309 --> 01:07:08.319 align:start position:0%
show it like this level + one so the
 

01:07:08.319 --> 01:07:09.910 align:start position:0%
show it like this level + one so the
current<01:07:08.599><c> level</c><01:07:08.880><c> is</c><01:07:09.079><c> one</c><01:07:09.480><c> the</c><01:07:09.599><c> second</c>

01:07:09.910 --> 01:07:09.920 align:start position:0%
current level is one the second
 

01:07:09.920 --> 01:07:11.789 align:start position:0%
current level is one the second
iteration<01:07:10.400><c> going</c><01:07:10.520><c> to</c><01:07:10.640><c> be</c><01:07:10.799><c> two</c><01:07:11.240><c> and</c><01:07:11.359><c> the</c><01:07:11.559><c> third</c>

01:07:11.789 --> 01:07:11.799 align:start position:0%
iteration going to be two and the third
 

01:07:11.799 --> 01:07:13.950 align:start position:0%
iteration going to be two and the third
iteration<01:07:12.279><c> going</c><01:07:12.400><c> to</c><01:07:12.520><c> be</c><01:07:12.680><c> three</c><01:07:13.160><c> so</c><01:07:13.520><c> I</c><01:07:13.640><c> think</c>

01:07:13.950 --> 01:07:13.960 align:start position:0%
iteration going to be three so I think
 

01:07:13.960 --> 01:07:17.069 align:start position:0%
iteration going to be three so I think
we<01:07:14.160><c> have</c><01:07:14.880><c> everything</c><01:07:15.880><c> for</c><01:07:16.119><c> our</c><01:07:16.400><c> iteration</c><01:07:16.960><c> let</c>

01:07:17.069 --> 01:07:17.079 align:start position:0%
we have everything for our iteration let
 

01:07:17.079 --> 01:07:19.750 align:start position:0%
we have everything for our iteration let
me<01:07:17.279><c> just</c><01:07:17.520><c> check</c><01:07:17.960><c> and</c><01:07:18.160><c> make</c><01:07:18.400><c> this</c><01:07:18.799><c> smaller</c><01:07:19.480><c> now</c>

01:07:19.750 --> 01:07:19.760 align:start position:0%
me just check and make this smaller now
 

01:07:19.760 --> 01:07:21.789 align:start position:0%
me just check and make this smaller now
again<01:07:20.039><c> we</c><01:07:20.200><c> have</c><01:07:20.359><c> here</c><01:07:20.520><c> our</c><01:07:20.760><c> anchor</c><01:07:21.160><c> query</c><01:07:21.680><c> this</c>

01:07:21.789 --> 01:07:21.799 align:start position:0%
again we have here our anchor query this
 

01:07:21.799 --> 01:07:24.430 align:start position:0%
again we have here our anchor query this
is<01:07:22.160><c> only</c><01:07:22.440><c> for</c><01:07:22.720><c> the</c><01:07:23.000><c> top</c><01:07:23.279><c> level</c><01:07:23.520><c> manager</c><01:07:24.279><c> and</c>

01:07:24.430 --> 01:07:24.440 align:start position:0%
is only for the top level manager and
 

01:07:24.440 --> 01:07:26.430 align:start position:0%
is only for the top level manager and
then<01:07:24.680><c> here</c><01:07:24.880><c> we</c><01:07:25.000><c> are</c><01:07:25.279><c> just</c><01:07:25.720><c> connecting</c><01:07:26.319><c> the</c>

01:07:26.430 --> 01:07:26.440 align:start position:0%
then here we are just connecting the
 

01:07:26.440 --> 01:07:28.710 align:start position:0%
then here we are just connecting the
managers<01:07:27.000><c> with</c><01:07:27.160><c> the</c><01:07:27.279><c> employees</c><01:07:28.160><c> and</c><01:07:28.359><c> we</c><01:07:28.480><c> are</c>

01:07:28.710 --> 01:07:28.720 align:start position:0%
managers with the employees and we are
 

01:07:28.720 --> 01:07:32.029 align:start position:0%
managers with the employees and we are
reusing<01:07:29.720><c> the</c><01:07:30.079><c> CTE</c><01:07:31.079><c> in</c><01:07:31.200><c> order</c><01:07:31.480><c> to</c><01:07:31.599><c> make</c><01:07:31.799><c> the</c>

01:07:32.029 --> 01:07:32.039 align:start position:0%
reusing the CTE in order to make the
 

01:07:32.039 --> 01:07:34.150 align:start position:0%
reusing the CTE in order to make the
effect<01:07:32.480><c> of</c><01:07:32.720><c> the</c><01:07:32.880><c> loop</c><01:07:33.480><c> and</c><01:07:33.640><c> as</c><01:07:33.760><c> well</c><01:07:33.920><c> we</c><01:07:34.039><c> are</c>

01:07:34.150 --> 01:07:34.160 align:start position:0%
effect of the loop and as well we are
 

01:07:34.160 --> 01:07:36.430 align:start position:0%
effect of the loop and as well we are
using<01:07:34.400><c> the</c><01:07:34.520><c> inner</c><01:07:34.799><c> joint</c><01:07:35.160><c> in</c><01:07:35.279><c> order</c><01:07:35.640><c> to</c><01:07:35.920><c> break</c>

01:07:36.430 --> 01:07:36.440 align:start position:0%
using the inner joint in order to break
 

01:07:36.440 --> 01:07:38.789 align:start position:0%
using the inner joint in order to break
the<01:07:36.559><c> loop</c><01:07:37.079><c> once</c><01:07:37.400><c> there</c><01:07:37.520><c> are</c><01:07:37.720><c> no</c><01:07:37.880><c> more</c><01:07:38.119><c> rows</c><01:07:38.559><c> to</c>

01:07:38.789 --> 01:07:38.799 align:start position:0%
the loop once there are no more rows to
 

01:07:38.799 --> 01:07:41.750 align:start position:0%
the loop once there are no more rows to
process<01:07:39.480><c> so</c><01:07:39.960><c> let's</c><01:07:40.200><c> go</c><01:07:40.400><c> and</c><01:07:40.720><c> excuse</c><01:07:41.160><c> it</c><01:07:41.599><c> now</c>

01:07:41.750 --> 01:07:41.760 align:start position:0%
process so let's go and excuse it now
 

01:07:41.760 --> 01:07:43.750 align:start position:0%
process so let's go and excuse it now
let's<01:07:41.920><c> check</c><01:07:42.119><c> the</c><01:07:42.279><c> output</c><01:07:42.960><c> this</c><01:07:43.119><c> is</c><01:07:43.279><c> our</c><01:07:43.520><c> top</c>

01:07:43.750 --> 01:07:43.760 align:start position:0%
let's check the output this is our top
 

01:07:43.760 --> 01:07:46.029 align:start position:0%
let's check the output this is our top
manager<01:07:44.279><c> so</c><01:07:44.559><c> level</c><01:07:44.839><c> one</c><01:07:45.359><c> this</c><01:07:45.520><c> information</c>

01:07:46.029 --> 01:07:46.039 align:start position:0%
manager so level one this information
 

01:07:46.039 --> 01:07:48.230 align:start position:0%
manager so level one this information
comes<01:07:46.319><c> from</c><01:07:46.520><c> the</c><01:07:46.680><c> anchor</c><01:07:47.079><c> query</c><01:07:47.760><c> then</c><01:07:47.960><c> the</c>

01:07:48.230 --> 01:07:48.240 align:start position:0%
comes from the anchor query then the
 

01:07:48.240 --> 01:07:50.710 align:start position:0%
comes from the anchor query then the
second<01:07:48.599><c> iteration</c><01:07:49.279><c> it</c><01:07:49.520><c> is</c><01:07:49.960><c> the</c><01:07:50.079><c> employees</c>

01:07:50.710 --> 01:07:50.720 align:start position:0%
second iteration it is the employees
 

01:07:50.720 --> 01:07:53.910 align:start position:0%
second iteration it is the employees
where<01:07:51.200><c> the</c><01:07:51.359><c> manager</c><01:07:51.799><c> ID</c><01:07:52.200><c> equal</c><01:07:52.559><c> to</c><01:07:52.760><c> one</c><01:07:53.680><c> so</c>

01:07:53.910 --> 01:07:53.920 align:start position:0%
where the manager ID equal to one so
 

01:07:53.920 --> 01:07:56.109 align:start position:0%
where the manager ID equal to one so
it's<01:07:54.079><c> going</c><01:07:54.160><c> to</c><01:07:54.279><c> be</c><01:07:54.520><c> those</c><01:07:54.720><c> two</c><01:07:54.920><c> employees</c><01:07:55.839><c> so</c>

01:07:56.109 --> 01:07:56.119 align:start position:0%
it's going to be those two employees so
 

01:07:56.119 --> 01:07:58.630 align:start position:0%
it's going to be those two employees so
those<01:07:56.319><c> employees</c><01:07:56.799><c> in</c><01:07:56.960><c> our</c><01:07:57.240><c> hierarchy</c><01:07:57.799><c> are</c><01:07:58.279><c> the</c>

01:07:58.630 --> 01:07:58.640 align:start position:0%
those employees in our hierarchy are the
 

01:07:58.640 --> 01:08:01.069 align:start position:0%
those employees in our hierarchy are the
second<01:07:59.000><c> level</c><01:07:59.440><c> in</c><01:07:59.599><c> our</c><01:07:59.960><c> organization</c><01:08:00.960><c> and</c>

01:08:01.069 --> 01:08:01.079 align:start position:0%
second level in our organization and
 

01:08:01.079 --> 01:08:03.029 align:start position:0%
second level in our organization and
then<01:08:01.200><c> we're</c><01:08:01.319><c> going</c><01:08:01.400><c> to</c><01:08:01.559><c> search</c><01:08:01.839><c> for</c><01:08:02.079><c> employees</c>

01:08:03.029 --> 01:08:03.039 align:start position:0%
then we're going to search for employees
 

01:08:03.039 --> 01:08:05.789 align:start position:0%
then we're going to search for employees
where<01:08:03.319><c> their</c><01:08:03.640><c> manager</c><01:08:04.160><c> ID</c><01:08:04.880><c> is</c><01:08:05.160><c> equal</c><01:08:05.520><c> to</c>

01:08:05.789 --> 01:08:05.799 align:start position:0%
where their manager ID is equal to
 

01:08:05.799 --> 01:08:08.309 align:start position:0%
where their manager ID is equal to
either<01:08:06.119><c> two</c><01:08:06.400><c> or</c><01:08:06.680><c> three</c><01:08:07.279><c> and</c><01:08:07.440><c> this</c><01:08:07.680><c> going</c><01:08:07.799><c> to</c><01:08:07.960><c> be</c>

01:08:08.309 --> 01:08:08.319 align:start position:0%
either two or three and this going to be
 

01:08:08.319 --> 01:08:10.829 align:start position:0%
either two or three and this going to be
those<01:08:08.480><c> two</c><01:08:08.720><c> employees</c><01:08:09.480><c> Carl</c><01:08:09.880><c> and</c><01:08:10.079><c> Michel</c><01:08:10.720><c> and</c>

01:08:10.829 --> 01:08:10.839 align:start position:0%
those two employees Carl and Michel and
 

01:08:10.839 --> 01:08:12.750 align:start position:0%
those two employees Carl and Michel and
now<01:08:11.000><c> to</c><01:08:11.160><c> the</c><01:08:11.279><c> third</c><01:08:11.680><c> iteration</c><01:08:12.480><c> we're</c><01:08:12.640><c> going</c>

01:08:12.750 --> 01:08:12.760 align:start position:0%
now to the third iteration we're going
 

01:08:12.760 --> 01:08:14.789 align:start position:0%
now to the third iteration we're going
to<01:08:12.880><c> search</c><01:08:13.200><c> for</c><01:08:13.440><c> all</c><01:08:13.680><c> employees</c><01:08:14.359><c> where</c><01:08:14.599><c> their</c>

01:08:14.789 --> 01:08:14.799 align:start position:0%
to search for all employees where their
 

01:08:14.799 --> 01:08:17.990 align:start position:0%
to search for all employees where their
manager<01:08:15.319><c> ID</c><01:08:15.720><c> equal</c><01:08:16.159><c> to</c><01:08:16.799><c> either</c><01:08:17.080><c> two</c><01:08:17.319><c> or</c><01:08:17.520><c> three</c>

01:08:17.990 --> 01:08:18.000 align:start position:0%
manager ID equal to either two or three
 

01:08:18.000 --> 01:08:19.669 align:start position:0%
manager ID equal to either two or three
and<01:08:18.159><c> now</c><01:08:18.359><c> to</c><01:08:18.520><c> the</c><01:08:18.679><c> third</c><01:08:19.000><c> iteration</c><01:08:19.560><c> we're</c>

01:08:19.669 --> 01:08:19.679 align:start position:0%
and now to the third iteration we're
 

01:08:19.679 --> 01:08:21.829 align:start position:0%
and now to the third iteration we're
going<01:08:19.759><c> to</c><01:08:19.920><c> search</c><01:08:20.159><c> for</c><01:08:20.400><c> all</c><01:08:20.640><c> employees</c><01:08:21.600><c> where</c>

01:08:21.829 --> 01:08:21.839 align:start position:0%
going to search for all employees where
 

01:08:21.839 --> 01:08:24.390 align:start position:0%
going to search for all employees where
their<01:08:22.040><c> manager</c><01:08:22.520><c> ID</c><01:08:22.920><c> equal</c><01:08:23.239><c> to</c><01:08:23.520><c> either</c><01:08:23.839><c> two</c><01:08:24.159><c> or</c>

01:08:24.390 --> 01:08:24.400 align:start position:0%
their manager ID equal to either two or
 

01:08:24.400 --> 01:08:26.550 align:start position:0%
their manager ID equal to either two or
three<01:08:24.920><c> and</c><01:08:25.040><c> this</c><01:08:25.199><c> going</c><01:08:25.279><c> to</c><01:08:25.560><c> results</c><01:08:26.120><c> having</c>

01:08:26.550 --> 01:08:26.560 align:start position:0%
three and this going to results having
 

01:08:26.560 --> 01:08:28.630 align:start position:0%
three and this going to results having
those<01:08:26.960><c> two</c><01:08:27.279><c> employees</c><01:08:28.159><c> because</c><01:08:28.480><c> their</c>

01:08:28.630 --> 01:08:28.640 align:start position:0%
those two employees because their
 

01:08:28.640 --> 01:08:31.390 align:start position:0%
those two employees because their
manager<01:08:29.040><c> ID</c><01:08:29.319><c> is</c><01:08:29.520><c> equal</c><01:08:29.759><c> to</c><01:08:29.960><c> three</c><01:08:30.239><c> or</c><01:08:30.560><c> two</c><01:08:31.239><c> and</c>

01:08:31.390 --> 01:08:31.400 align:start position:0%
manager ID is equal to three or two and
 

01:08:31.400 --> 01:08:33.030 align:start position:0%
manager ID is equal to three or two and
they're<01:08:31.560><c> going</c><01:08:31.679><c> to</c><01:08:31.799><c> get</c><01:08:31.960><c> the</c><01:08:32.080><c> level</c><01:08:32.400><c> of</c><01:08:32.560><c> three</c>

01:08:33.030 --> 01:08:33.040 align:start position:0%
they're going to get the level of three
 

01:08:33.040 --> 01:08:34.749 align:start position:0%
they're going to get the level of three
and<01:08:33.159><c> then</c><01:08:33.279><c> after</c><01:08:33.600><c> that</c><01:08:33.799><c> SQL</c><01:08:34.159><c> going</c><01:08:34.239><c> to</c><01:08:34.400><c> try</c><01:08:34.560><c> to</c>

01:08:34.749 --> 01:08:34.759 align:start position:0%
and then after that SQL going to try to
 

01:08:34.759 --> 01:08:37.669 align:start position:0%
and then after that SQL going to try to
search<01:08:35.120><c> for</c><01:08:35.520><c> employees</c><01:08:36.520><c> where</c><01:08:37.040><c> their</c><01:08:37.239><c> manager</c>

01:08:37.669 --> 01:08:37.679 align:start position:0%
search for employees where their manager
 

01:08:37.679 --> 01:08:40.229 align:start position:0%
search for employees where their manager
ID<01:08:37.960><c> equal</c><01:08:38.199><c> to</c><01:08:38.400><c> five</c><01:08:38.640><c> and</c><01:08:38.880><c> four</c><01:08:39.520><c> and</c><01:08:39.679><c> SQL</c><01:08:40.080><c> will</c>

01:08:40.229 --> 01:08:40.239 align:start position:0%
ID equal to five and four and SQL will
 

01:08:40.239 --> 01:08:42.269 align:start position:0%
ID equal to five and four and SQL will
not<01:08:40.440><c> find</c><01:08:40.719><c> anything</c><01:08:41.199><c> and</c><01:08:41.359><c> that's</c><01:08:41.679><c> why</c><01:08:41.960><c> it</c><01:08:42.120><c> kind</c>

01:08:42.269 --> 01:08:42.279 align:start position:0%
not find anything and that's why it kind
 

01:08:42.279 --> 01:08:44.269 align:start position:0%
not find anything and that's why it kind
of<01:08:42.400><c> breaks</c><01:08:43.000><c> so</c><01:08:43.359><c> with</c><01:08:43.560><c> that</c><01:08:43.719><c> we</c><01:08:43.880><c> have</c><01:08:44.000><c> solved</c>

01:08:44.269 --> 01:08:44.279 align:start position:0%
of breaks so with that we have solved
 

01:08:44.279 --> 01:08:46.430 align:start position:0%
of breaks so with that we have solved
the<01:08:44.440><c> task</c><01:08:45.000><c> all</c><01:08:45.159><c> right</c><01:08:45.480><c> I</c><01:08:45.640><c> totally</c><01:08:46.239><c> understand</c>

01:08:46.430 --> 01:08:46.440 align:start position:0%
the task all right I totally understand
 

01:08:46.440 --> 01:08:48.030 align:start position:0%
the task all right I totally understand
if<01:08:46.600><c> this</c><01:08:46.719><c> is</c><01:08:46.880><c> complicated</c><01:08:47.679><c> but</c><01:08:47.839><c> now</c><01:08:47.960><c> we're</c>

01:08:48.030 --> 01:08:48.040 align:start position:0%
if this is complicated but now we're
 

01:08:48.040 --> 01:08:50.189 align:start position:0%
if this is complicated but now we're
going<01:08:48.159><c> to</c><01:08:48.279><c> do</c><01:08:48.400><c> it</c><01:08:48.640><c> step</c><01:08:48.960><c> by</c><01:08:49.199><c> step</c><01:08:49.440><c> in</c><01:08:49.560><c> order</c><01:08:49.759><c> to</c>

01:08:50.189 --> 01:08:50.199 align:start position:0%
going to do it step by step in order to
 

01:08:50.199 --> 01:08:52.590 align:start position:0%
going to do it step by step in order to
understand<01:08:50.759><c> how</c><01:08:50.960><c> is</c><01:08:51.159><c> scale</c><01:08:51.480><c> executed</c><01:08:52.120><c> this</c>

01:08:52.590 --> 01:08:52.600 align:start position:0%
understand how is scale executed this
 

01:08:52.600 --> 01:08:54.510 align:start position:0%
understand how is scale executed this
and<01:08:52.839><c> why</c><01:08:53.000><c> we</c><01:08:53.120><c> have</c><01:08:53.279><c> done</c><01:08:53.440><c> it</c><01:08:53.600><c> in</c><01:08:53.799><c> this</c><01:08:53.960><c> way</c><01:08:54.319><c> so</c>

01:08:54.510 --> 01:08:54.520 align:start position:0%
and why we have done it in this way so
 

01:08:54.520 --> 01:08:57.189 align:start position:0%
and why we have done it in this way so
again<01:08:54.839><c> we</c><01:08:54.960><c> have</c><01:08:55.120><c> our</c><01:08:55.440><c> flow</c><01:08:55.679><c> diagram</c><01:08:56.600><c> we</c><01:08:56.799><c> start</c>

01:08:57.189 --> 01:08:57.199 align:start position:0%
again we have our flow diagram we start
 

01:08:57.199 --> 01:08:59.309 align:start position:0%
again we have our flow diagram we start
by<01:08:57.440><c> running</c><01:08:57.799><c> the</c><01:08:57.960><c> anchor</c><01:08:58.359><c> query</c><01:08:58.960><c> then</c><01:08:59.159><c> the</c>

01:08:59.309 --> 01:08:59.319 align:start position:0%
by running the anchor query then the
 

01:08:59.319 --> 01:09:01.950 align:start position:0%
by running the anchor query then the
recursive<01:08:59.880><c> query</c><01:09:00.600><c> and</c><01:09:00.759><c> then</c><01:09:00.920><c> we</c><01:09:01.159><c> have</c><01:09:01.319><c> a</c><01:09:01.480><c> check</c>

01:09:01.950 --> 01:09:01.960 align:start position:0%
recursive query and then we have a check
 

01:09:01.960 --> 01:09:04.630 align:start position:0%
recursive query and then we have a check
if<01:09:02.080><c> the</c><01:09:02.239><c> check</c><01:09:02.440><c> fails</c><01:09:02.799><c> we</c><01:09:02.920><c> iterate</c><01:09:03.839><c> otherwise</c>

01:09:04.630 --> 01:09:04.640 align:start position:0%
if the check fails we iterate otherwise
 

01:09:04.640 --> 01:09:06.910 align:start position:0%
if the check fails we iterate otherwise
we<01:09:04.799><c> end</c><01:09:05.319><c> so</c><01:09:05.560><c> let's</c><01:09:05.719><c> do</c><01:09:05.880><c> it</c><01:09:06.000><c> step</c><01:09:06.239><c> by</c><01:09:06.440><c> step</c><01:09:06.719><c> here</c>

01:09:06.910 --> 01:09:06.920 align:start position:0%
we end so let's do it step by step here
 

01:09:06.920 --> 01:09:09.390 align:start position:0%
we end so let's do it step by step here
we<01:09:07.120><c> have</c><01:09:07.359><c> the</c><01:09:07.560><c> table</c><01:09:07.920><c> employees</c><01:09:08.719><c> and</c><01:09:09.120><c> beneath</c>

01:09:09.390 --> 01:09:09.400 align:start position:0%
we have the table employees and beneath
 

01:09:09.400 --> 01:09:11.669 align:start position:0%
we have the table employees and beneath
it<01:09:09.600><c> we</c><01:09:09.719><c> have</c><01:09:09.839><c> the</c><01:09:10.000><c> result</c><01:09:10.319><c> of</c><01:09:10.480><c> the</c><01:09:10.640><c> CTE</c><01:09:11.400><c> so</c><01:09:11.600><c> the</c>

01:09:11.669 --> 01:09:11.679 align:start position:0%
it we have the result of the CTE so the
 

01:09:11.679 --> 01:09:13.550 align:start position:0%
it we have the result of the CTE so the
first<01:09:11.920><c> tip</c><01:09:12.120><c> it</c><01:09:12.239><c> says</c><01:09:12.600><c> we</c><01:09:12.759><c> run</c><01:09:13.000><c> the</c><01:09:13.159><c> anchor</c>

01:09:13.550 --> 01:09:13.560 align:start position:0%
first tip it says we run the anchor
 

01:09:13.560 --> 01:09:16.349 align:start position:0%
first tip it says we run the anchor
query<01:09:14.000><c> and</c><01:09:14.159><c> we</c><01:09:14.319><c> run</c><01:09:14.560><c> it</c><01:09:14.839><c> only</c><01:09:15.199><c> once</c><01:09:15.799><c> so</c><01:09:16.000><c> SQL</c>

01:09:16.349 --> 01:09:16.359 align:start position:0%
query and we run it only once so SQL
 

01:09:16.359 --> 01:09:17.829 align:start position:0%
query and we run it only once so SQL
going<01:09:16.480><c> to</c><01:09:16.560><c> go</c><01:09:16.679><c> to</c><01:09:16.759><c> the</c><01:09:16.880><c> Anchor</c><01:09:17.239><c> query</c><01:09:17.679><c> and</c>

01:09:17.829 --> 01:09:17.839 align:start position:0%
going to go to the Anchor query and
 

01:09:17.839 --> 01:09:19.630 align:start position:0%
going to go to the Anchor query and
start<01:09:18.199><c> executing</c><01:09:18.719><c> it</c><01:09:19.040><c> so</c><01:09:19.239><c> here</c><01:09:19.400><c> we</c><01:09:19.480><c> are</c>

01:09:19.630 --> 01:09:19.640 align:start position:0%
start executing it so here we are
 

01:09:19.640 --> 01:09:22.390 align:start position:0%
start executing it so here we are
selecting<01:09:20.159><c> from</c><01:09:20.400><c> the</c><01:09:20.719><c> table</c><01:09:21.239><c> employees</c><01:09:22.239><c> but</c>

01:09:22.390 --> 01:09:22.400 align:start position:0%
selecting from the table employees but
 

01:09:22.400 --> 01:09:24.590 align:start position:0%
selecting from the table employees but
we<01:09:22.480><c> are</c><01:09:22.640><c> making</c><01:09:22.920><c> a</c><01:09:23.080><c> filter</c><01:09:23.400><c> on</c><01:09:23.600><c> the</c><01:09:23.799><c> manager</c><01:09:24.199><c> ID</c>

01:09:24.590 --> 01:09:24.600 align:start position:0%
we are making a filter on the manager ID
 

01:09:24.600 --> 01:09:26.990 align:start position:0%
we are making a filter on the manager ID
so<01:09:24.799><c> the</c><01:09:24.920><c> managerid</c><01:09:25.600><c> should</c><01:09:25.799><c> be</c><01:09:25.920><c> null</c><01:09:26.640><c> so</c><01:09:26.839><c> that</c>

01:09:26.990 --> 01:09:27.000 align:start position:0%
so the managerid should be null so that
 

01:09:27.000 --> 01:09:30.510 align:start position:0%
so the managerid should be null so that
means<01:09:27.400><c> we</c><01:09:27.520><c> will</c><01:09:27.759><c> get</c><01:09:28.199><c> the</c><01:09:28.480><c> record</c><01:09:29.080><c> of</c><01:09:29.520><c> Frank</c>

01:09:30.510 --> 01:09:30.520 align:start position:0%
means we will get the record of Frank
 

01:09:30.520 --> 01:09:32.789 align:start position:0%
means we will get the record of Frank
and<01:09:30.719><c> Frank</c><01:09:31.080><c> going</c><01:09:31.199><c> to</c><01:09:31.359><c> be</c><01:09:31.640><c> at</c><01:09:31.839><c> the</c><01:09:31.960><c> output</c><01:09:32.679><c> and</c>

01:09:32.789 --> 01:09:32.799 align:start position:0%
and Frank going to be at the output and
 

01:09:32.799 --> 01:09:35.309 align:start position:0%
and Frank going to be at the output and
we<01:09:32.880><c> are</c><01:09:33.000><c> saying</c><01:09:33.600><c> the</c><01:09:33.799><c> level</c><01:09:34.400><c> of</c><01:09:34.640><c> this</c><01:09:34.839><c> employee</c>

01:09:35.309 --> 01:09:35.319 align:start position:0%
we are saying the level of this employee
 

01:09:35.319 --> 01:09:37.910 align:start position:0%
we are saying the level of this employee
is<01:09:35.520><c> one</c><01:09:36.080><c> so</c><01:09:36.359><c> we</c><01:09:36.480><c> will</c><01:09:36.679><c> have</c><01:09:36.880><c> here</c><01:09:37.040><c> at</c><01:09:37.199><c> the</c><01:09:37.359><c> level</c>

01:09:37.910 --> 01:09:37.920 align:start position:0%
is one so we will have here at the level
 

01:09:37.920 --> 01:09:40.870 align:start position:0%
is one so we will have here at the level
one<01:09:38.440><c> so</c><01:09:38.839><c> this</c><01:09:39.000><c> is</c><01:09:39.199><c> the</c><01:09:39.400><c> output</c><01:09:39.839><c> of</c><01:09:40.080><c> the</c><01:09:40.480><c> anchor</c>

01:09:40.870 --> 01:09:40.880 align:start position:0%
one so this is the output of the anchor
 

01:09:40.880 --> 01:09:43.070 align:start position:0%
one so this is the output of the anchor
query<01:09:41.440><c> and</c><01:09:41.640><c> that's</c><01:09:41.839><c> it</c><01:09:42.239><c> this</c><01:09:42.359><c> will</c><01:09:42.560><c> never</c><01:09:42.839><c> be</c>

01:09:43.070 --> 01:09:43.080 align:start position:0%
query and that's it this will never be
 

01:09:43.080 --> 01:09:45.789 align:start position:0%
query and that's it this will never be
executed<01:09:43.880><c> now</c><01:09:44.080><c> we</c><01:09:44.239><c> go</c><01:09:44.400><c> to</c><01:09:44.600><c> the</c><01:09:44.839><c> next</c><01:09:45.120><c> step</c><01:09:45.640><c> now</c>

01:09:45.789 --> 01:09:45.799 align:start position:0%
executed now we go to the next step now
 

01:09:45.799 --> 01:09:48.229 align:start position:0%
executed now we go to the next step now
we<01:09:45.920><c> will</c><01:09:46.080><c> run</c><01:09:46.520><c> the</c><01:09:46.759><c> recursive</c><01:09:47.359><c> query</c><01:09:47.960><c> so</c>

01:09:48.229 --> 01:09:48.239 align:start position:0%
we will run the recursive query so
 

01:09:48.239 --> 01:09:49.990 align:start position:0%
we will run the recursive query so
what's<01:09:48.400><c> going</c><01:09:48.520><c> to</c><01:09:48.679><c> happen</c><01:09:49.400><c> in</c><01:09:49.480><c> the</c><01:09:49.600><c> recursive</c>

01:09:49.990 --> 01:09:50.000 align:start position:0%
what's going to happen in the recursive
 

01:09:50.000 --> 01:09:51.550 align:start position:0%
what's going to happen in the recursive
query<01:09:50.279><c> we</c><01:09:50.359><c> are</c><01:09:50.480><c> saying</c><01:09:50.880><c> okay</c><01:09:51.040><c> I</c><01:09:51.159><c> would</c><01:09:51.279><c> like</c><01:09:51.440><c> to</c>

01:09:51.550 --> 01:09:51.560 align:start position:0%
query we are saying okay I would like to
 

01:09:51.560 --> 01:09:53.870 align:start position:0%
query we are saying okay I would like to
select<01:09:51.880><c> as</c><01:09:52.040><c> well</c><01:09:52.319><c> data</c><01:09:52.679><c> from</c><01:09:52.839><c> the</c><01:09:53.000><c> employees</c>

01:09:53.870 --> 01:09:53.880 align:start position:0%
select as well data from the employees
 

01:09:53.880 --> 01:09:56.510 align:start position:0%
select as well data from the employees
and<01:09:54.080><c> join</c><01:09:54.400><c> it</c><01:09:54.679><c> with</c><01:09:54.880><c> the</c><01:09:55.040><c> city</c><01:09:55.760><c> results</c><01:09:56.360><c> but</c>

01:09:56.510 --> 01:09:56.520 align:start position:0%
and join it with the city results but
 

01:09:56.520 --> 01:09:58.990 align:start position:0%
and join it with the city results but
the<01:09:56.679><c> join</c><01:09:57.000><c> should</c><01:09:57.199><c> be</c><01:09:57.400><c> an</c><01:09:57.560><c> inner</c><01:09:57.920><c> join</c><01:09:58.440><c> so</c><01:09:58.679><c> only</c>

01:09:58.990 --> 01:09:59.000 align:start position:0%
the join should be an inner join so only
 

01:09:59.000 --> 01:10:01.070 align:start position:0%
the join should be an inner join so only
the<01:09:59.199><c> matching</c><01:09:59.640><c> data</c><01:09:59.960><c> between</c><01:10:00.280><c> the</c><01:10:00.400><c> CTE</c><01:10:00.920><c> and</c>

01:10:01.070 --> 01:10:01.080 align:start position:0%
the matching data between the CTE and
 

01:10:01.080 --> 01:10:03.590 align:start position:0%
the matching data between the CTE and
the<01:10:01.199><c> employees</c><01:10:02.040><c> and</c><01:10:02.199><c> now</c><01:10:02.400><c> comes</c><01:10:02.840><c> the</c><01:10:03.000><c> join</c>

01:10:03.590 --> 01:10:03.600 align:start position:0%
the employees and now comes the join
 

01:10:03.600 --> 01:10:05.550 align:start position:0%
the employees and now comes the join
condition<01:10:03.920><c> and</c><01:10:04.120><c> this</c><01:10:04.239><c> is</c><01:10:04.560><c> the</c><01:10:04.800><c> key</c><01:10:05.080><c> for</c><01:10:05.360><c> this</c>

01:10:05.550 --> 01:10:05.560 align:start position:0%
condition and this is the key for this
 

01:10:05.560 --> 01:10:08.270 align:start position:0%
condition and this is the key for this
iteration<01:10:06.520><c> we</c><01:10:06.600><c> are</c><01:10:06.760><c> saying</c><01:10:07.239><c> the</c><01:10:07.440><c> manager</c><01:10:07.960><c> ID</c>

01:10:08.270 --> 01:10:08.280 align:start position:0%
iteration we are saying the manager ID
 

01:10:08.280 --> 01:10:10.630 align:start position:0%
iteration we are saying the manager ID
of<01:10:08.400><c> the</c><01:10:08.560><c> employee</c><01:10:09.440><c> should</c><01:10:09.719><c> be</c><01:10:09.960><c> matching</c><01:10:10.440><c> to</c>

01:10:10.630 --> 01:10:10.640 align:start position:0%
of the employee should be matching to
 

01:10:10.640 --> 01:10:13.590 align:start position:0%
of the employee should be matching to
the<01:10:10.800><c> employee</c><01:10:11.360><c> ID</c><01:10:11.760><c> from</c><01:10:11.960><c> the</c><01:10:12.120><c> CTE</c><01:10:12.920><c> so</c><01:10:13.159><c> SQL</c>

01:10:13.590 --> 01:10:13.600 align:start position:0%
the employee ID from the CTE so SQL
 

01:10:13.600 --> 01:10:15.669 align:start position:0%
the employee ID from the CTE so SQL
going<01:10:13.679><c> to</c><01:10:13.800><c> go</c><01:10:13.960><c> and</c><01:10:14.159><c> join</c><01:10:14.840><c> the</c><01:10:15.000><c> table</c><01:10:15.400><c> with</c><01:10:15.520><c> the</c>

01:10:15.669 --> 01:10:15.679 align:start position:0%
going to go and join the table with the
 

01:10:15.679 --> 01:10:18.030 align:start position:0%
going to go and join the table with the
CTE<01:10:16.320><c> so</c><01:10:16.480><c> now</c><01:10:16.679><c> we</c><01:10:16.800><c> have</c><01:10:17.040><c> here</c><01:10:17.320><c> only</c><01:10:17.600><c> employee</c>

01:10:18.030 --> 01:10:18.040 align:start position:0%
CTE so now we have here only employee
 

01:10:18.040 --> 01:10:20.669 align:start position:0%
CTE so now we have here only employee
number<01:10:18.280><c> ID</c><01:10:18.640><c> one</c><01:10:19.080><c> so</c><01:10:19.679><c> going</c><01:10:19.760><c> to</c><01:10:19.880><c> do</c><01:10:20.000><c> it</c><01:10:20.199><c> step</c><01:10:20.480><c> by</c>

01:10:20.669 --> 01:10:20.679 align:start position:0%
number ID one so going to do it step by
 

01:10:20.679 --> 01:10:23.510 align:start position:0%
number ID one so going to do it step by
step<01:10:20.920><c> searching</c><01:10:21.719><c> for</c><01:10:21.960><c> any</c><01:10:22.239><c> matches</c><01:10:23.120><c> so</c><01:10:23.320><c> for</c>

01:10:23.510 --> 01:10:23.520 align:start position:0%
step searching for any matches so for
 

01:10:23.520 --> 01:10:25.390 align:start position:0%
step searching for any matches so for
the<01:10:23.679><c> first</c><01:10:23.920><c> one</c><01:10:24.199><c> we</c><01:10:24.360><c> don't</c><01:10:24.600><c> have</c><01:10:24.719><c> a</c><01:10:24.880><c> match</c>

01:10:25.390 --> 01:10:25.400 align:start position:0%
the first one we don't have a match
 

01:10:25.400 --> 01:10:27.790 align:start position:0%
the first one we don't have a match
because<01:10:25.840><c> the</c><01:10:25.960><c> manager</c><01:10:26.400><c> ID</c><01:10:26.760><c> is</c><01:10:26.920><c> not</c><01:10:27.239><c> equal</c><01:10:27.600><c> to</c>

01:10:27.790 --> 01:10:27.800 align:start position:0%
because the manager ID is not equal to
 

01:10:27.800 --> 01:10:29.550 align:start position:0%
because the manager ID is not equal to
one<01:10:28.320><c> so</c><01:10:28.600><c> that's</c><01:10:28.800><c> why</c><01:10:28.960><c> it</c><01:10:29.040><c> will</c><01:10:29.239><c> not</c><01:10:29.400><c> be</c>

01:10:29.550 --> 01:10:29.560 align:start position:0%
one so that's why it will not be
 

01:10:29.560 --> 01:10:31.830 align:start position:0%
one so that's why it will not be
included<01:10:29.960><c> in</c><01:10:30.080><c> the</c><01:10:30.239><c> result</c><01:10:31.000><c> that</c><01:10:31.199><c> the</c><01:10:31.440><c> second</c>

01:10:31.830 --> 01:10:31.840 align:start position:0%
included in the result that the second
 

01:10:31.840 --> 01:10:34.790 align:start position:0%
included in the result that the second
row<01:10:32.520><c> here</c><01:10:32.760><c> the</c><01:10:32.920><c> manager</c><01:10:33.400><c> ID</c><01:10:33.719><c> is</c><01:10:33.920><c> equal</c><01:10:34.159><c> to</c><01:10:34.360><c> one</c>

01:10:34.790 --> 01:10:34.800 align:start position:0%
row here the manager ID is equal to one
 

01:10:34.800 --> 01:10:37.270 align:start position:0%
row here the manager ID is equal to one
and<01:10:35.000><c> this</c><01:10:35.120><c> is</c><01:10:35.280><c> a</c><01:10:35.480><c> match</c><01:10:35.840><c> with</c><01:10:35.960><c> the</c><01:10:36.080><c> employee</c><01:10:36.560><c> ID</c>

01:10:37.270 --> 01:10:37.280 align:start position:0%
and this is a match with the employee ID
 

01:10:37.280 --> 01:10:39.750 align:start position:0%
and this is a match with the employee ID
so<01:10:37.600><c> SQL</c><01:10:38.040><c> going</c><01:10:38.120><c> to</c><01:10:38.320><c> take</c><01:10:38.480><c> it</c><01:10:38.800><c> and</c><01:10:39.080><c> put</c><01:10:39.280><c> it</c><01:10:39.560><c> at</c>

01:10:39.750 --> 01:10:39.760 align:start position:0%
so SQL going to take it and put it at
 

01:10:39.760 --> 01:10:42.229 align:start position:0%
so SQL going to take it and put it at
the<01:10:39.920><c> output</c><01:10:40.719><c> not</c><01:10:40.920><c> only</c><01:10:41.320><c> that</c><01:10:41.640><c> is</c><01:10:42.000><c> going</c><01:10:42.080><c> to</c>

01:10:42.229 --> 01:10:42.239 align:start position:0%
the output not only that is going to
 

01:10:42.239 --> 01:10:44.390 align:start position:0%
the output not only that is going to
increase<01:10:42.880><c> the</c><01:10:43.120><c> level</c><01:10:43.560><c> so</c><01:10:43.719><c> we</c><01:10:43.840><c> have</c><01:10:44.000><c> here</c><01:10:44.239><c> the</c>

01:10:44.390 --> 01:10:44.400 align:start position:0%
increase the level so we have here the
 

01:10:44.400 --> 01:10:47.910 align:start position:0%
increase the level so we have here the
current<01:10:44.880><c> value</c><01:10:45.159><c> is</c><01:10:45.360><c> one</c><01:10:46.040><c> so</c><01:10:46.320><c> level</c><01:10:46.760><c> +</c><01:10:47.080><c> one</c><01:10:47.800><c> what</c>

01:10:47.910 --> 01:10:47.920 align:start position:0%
current value is one so level + one what
 

01:10:47.920 --> 01:10:50.149 align:start position:0%
current value is one so level + one what
can<01:10:48.040><c> to</c><01:10:48.199><c> happen</c><01:10:48.480><c> we</c><01:10:48.560><c> will</c><01:10:48.800><c> get</c><01:10:49.120><c> the</c><01:10:49.360><c> value</c><01:10:49.679><c> two</c>

01:10:50.149 --> 01:10:50.159 align:start position:0%
can to happen we will get the value two
 

01:10:50.159 --> 01:10:51.830 align:start position:0%
can to happen we will get the value two
we<01:10:50.280><c> are</c><01:10:50.480><c> still</c><01:10:50.719><c> in</c><01:10:50.880><c> the</c><01:10:51.040><c> same</c><01:10:51.280><c> iteration</c><01:10:51.719><c> we</c>

01:10:51.830 --> 01:10:51.840 align:start position:0%
we are still in the same iteration we
 

01:10:51.840 --> 01:10:53.950 align:start position:0%
we are still in the same iteration we
are<01:10:52.000><c> not</c><01:10:52.159><c> iterating</c><01:10:52.719><c> yet</c><01:10:53.080><c> so</c><01:10:53.360><c> this</c><01:10:53.480><c> is</c><01:10:53.679><c> the</c>

01:10:53.950 --> 01:10:53.960 align:start position:0%
are not iterating yet so this is the
 

01:10:53.960 --> 01:10:57.229 align:start position:0%
are not iterating yet so this is the
first<01:10:54.400><c> iteration</c><01:10:54.960><c> of</c><01:10:55.400><c> the</c><01:10:55.760><c> recursive</c><01:10:56.280><c> query</c>

01:10:57.229 --> 01:10:57.239 align:start position:0%
first iteration of the recursive query
 

01:10:57.239 --> 01:10:59.910 align:start position:0%
first iteration of the recursive query
so<01:10:57.719><c> until</c><01:10:58.199><c> the</c><01:10:58.320><c> whole</c><01:10:58.560><c> join</c><01:10:58.840><c> is</c><01:10:59.000><c> done</c><01:10:59.600><c> to</c><01:10:59.760><c> the</c>

01:10:59.910 --> 01:10:59.920 align:start position:0%
so until the whole join is done to the
 

01:10:59.920 --> 01:11:02.950 align:start position:0%
so until the whole join is done to the
next<01:11:00.199><c> Ru</c><01:11:00.760><c> we</c><01:11:00.920><c> have</c><01:11:01.040><c> a</c><01:11:01.239><c> match</c><01:11:01.640><c> as</c><01:11:01.800><c> well</c><01:11:02.600><c> because</c>

01:11:02.950 --> 01:11:02.960 align:start position:0%
next Ru we have a match as well because
 

01:11:02.960 --> 01:11:05.830 align:start position:0%
next Ru we have a match as well because
the<01:11:03.080><c> manager</c><01:11:03.520><c> ID</c><01:11:03.840><c> is</c><01:11:04.040><c> equal</c><01:11:04.360><c> to</c><01:11:04.600><c> one</c><01:11:05.280><c> and</c><01:11:05.679><c> we're</c>

01:11:05.830 --> 01:11:05.840 align:start position:0%
the manager ID is equal to one and we're
 

01:11:05.840 --> 01:11:07.430 align:start position:0%
the manager ID is equal to one and we're
going<01:11:05.920><c> to</c><01:11:06.040><c> have</c><01:11:06.199><c> the</c><01:11:06.360><c> same</c><01:11:06.600><c> thing</c><01:11:06.960><c> the</c><01:11:07.120><c> level</c>

01:11:07.430 --> 01:11:07.440 align:start position:0%
going to have the same thing the level
 

01:11:07.440 --> 01:11:09.110 align:start position:0%
going to have the same thing the level
going<01:11:07.520><c> to</c><01:11:07.640><c> be</c><01:11:07.840><c> as</c><01:11:08.000><c> well</c><01:11:08.239><c> two</c><01:11:08.719><c> because</c><01:11:08.960><c> the</c>

01:11:09.110 --> 01:11:09.120 align:start position:0%
going to be as well two because the
 

01:11:09.120 --> 01:11:10.870 align:start position:0%
going to be as well two because the
value<01:11:09.360><c> of</c><01:11:09.520><c> the</c><01:11:09.640><c> level</c><01:11:09.920><c> didn't</c><01:11:10.199><c> change</c><01:11:10.679><c> it's</c>

01:11:10.870 --> 01:11:10.880 align:start position:0%
value of the level didn't change it's
 

01:11:10.880 --> 01:11:12.950 align:start position:0%
value of the level didn't change it's
still<01:11:11.280><c> the</c><01:11:11.400><c> current</c><01:11:11.719><c> value</c><01:11:12.000><c> is</c><01:11:12.159><c> equal</c><01:11:12.400><c> to</c><01:11:12.560><c> one</c>

01:11:12.950 --> 01:11:12.960 align:start position:0%
still the current value is equal to one
 

01:11:12.960 --> 01:11:15.310 align:start position:0%
still the current value is equal to one
andq<01:11:13.480><c> going</c><01:11:13.560><c> to</c><01:11:13.640><c> keep</c><01:11:13.800><c> going</c><01:11:14.199><c> so</c><01:11:14.440><c> two</c><01:11:14.800><c> three</c><01:11:15.199><c> we</c>

01:11:15.310 --> 01:11:15.320 align:start position:0%
andq going to keep going so two three we
 

01:11:15.320 --> 01:11:18.310 align:start position:0%
andq going to keep going so two three we
don't<01:11:15.560><c> have</c><01:11:15.719><c> any</c><01:11:15.920><c> matches</c><01:11:16.600><c> and</c><01:11:16.960><c> with</c><01:11:17.199><c> that</c><01:11:17.840><c> SQL</c>

01:11:18.310 --> 01:11:18.320 align:start position:0%
don't have any matches and with that SQL
 

01:11:18.320 --> 01:11:20.910 align:start position:0%
don't have any matches and with that SQL
is<01:11:18.440><c> done</c><01:11:18.800><c> executing</c><01:11:19.600><c> the</c><01:11:19.800><c> recursive</c><01:11:20.320><c> query</c>

01:11:20.910 --> 01:11:20.920 align:start position:0%
is done executing the recursive query
 

01:11:20.920 --> 01:11:22.750 align:start position:0%
is done executing the recursive query
all<01:11:21.080><c> right</c><01:11:21.239><c> so</c><01:11:21.400><c> now</c><01:11:21.600><c> the</c><01:11:21.760><c> SQL</c><01:11:22.199><c> going</c><01:11:22.280><c> to</c><01:11:22.400><c> say</c>

01:11:22.750 --> 01:11:22.760 align:start position:0%
all right so now the SQL going to say
 

01:11:22.760 --> 01:11:25.750 align:start position:0%
all right so now the SQL going to say
okay<01:11:22.960><c> did</c><01:11:23.159><c> we</c><01:11:23.480><c> process</c><01:11:24.239><c> everything</c><01:11:25.320><c> well</c><01:11:25.480><c> no</c>

01:11:25.750 --> 01:11:25.760 align:start position:0%
okay did we process everything well no
 

01:11:25.760 --> 01:11:27.870 align:start position:0%
okay did we process everything well no
we<01:11:25.920><c> still</c><01:11:26.159><c> have</c><01:11:26.360><c> missing</c><01:11:26.960><c> output</c><01:11:27.520><c> we</c><01:11:27.640><c> still</c>

01:11:27.870 --> 01:11:27.880 align:start position:0%
we still have missing output we still
 

01:11:27.880 --> 01:11:30.030 align:start position:0%
we still have missing output we still
have<01:11:28.040><c> missing</c><01:11:28.440><c> employees</c><01:11:29.239><c> that's</c><01:11:29.520><c> why</c><01:11:29.920><c> we</c>

01:11:30.030 --> 01:11:30.040 align:start position:0%
have missing employees that's why we
 

01:11:30.040 --> 01:11:31.830 align:start position:0%
have missing employees that's why we
didn't<01:11:30.360><c> fulfill</c><01:11:30.760><c> the</c><01:11:31.120><c> condition</c><01:11:31.480><c> and</c><01:11:31.640><c> we're</c>

01:11:31.830 --> 01:11:31.840 align:start position:0%
didn't fulfill the condition and we're
 

01:11:31.840 --> 01:11:34.110 align:start position:0%
didn't fulfill the condition and we're
going<01:11:31.960><c> to</c><01:11:32.159><c> run</c><01:11:32.520><c> this</c><01:11:32.920><c> again</c><01:11:33.400><c> so</c><01:11:33.600><c> now</c><01:11:33.760><c> in</c><01:11:33.920><c> the</c>

01:11:34.110 --> 01:11:34.120 align:start position:0%
going to run this again so now in the
 

01:11:34.120 --> 01:11:36.270 align:start position:0%
going to run this again so now in the
second<01:11:34.480><c> iteration</c><01:11:35.080><c> isql</c><01:11:35.480><c> going</c><01:11:35.600><c> to</c><01:11:35.760><c> join</c><01:11:36.120><c> as</c>

01:11:36.270 --> 01:11:36.280 align:start position:0%
second iteration isql going to join as
 

01:11:36.280 --> 01:11:38.629 align:start position:0%
second iteration isql going to join as
well<01:11:36.600><c> again</c><01:11:37.040><c> the</c><01:11:37.199><c> city</c><01:11:37.800><c> result</c><01:11:38.280><c> with</c><01:11:38.440><c> the</c>

01:11:38.629 --> 01:11:38.639 align:start position:0%
well again the city result with the
 

01:11:38.639 --> 01:11:41.430 align:start position:0%
well again the city result with the
employees<01:11:39.440><c> by</c><01:11:39.639><c> matching</c><01:11:40.000><c> the</c><01:11:40.159><c> manager</c><01:11:40.639><c> ID</c><01:11:41.280><c> and</c>

01:11:41.430 --> 01:11:41.440 align:start position:0%
employees by matching the manager ID and
 

01:11:41.440 --> 01:11:43.270 align:start position:0%
employees by matching the manager ID and
the<01:11:41.560><c> employee</c><01:11:42.000><c> ID</c><01:11:42.480><c> but</c><01:11:42.719><c> this</c><01:11:42.880><c> time</c><01:11:43.040><c> it's</c><01:11:43.199><c> going</c>

01:11:43.270 --> 01:11:43.280 align:start position:0%
the employee ID but this time it's going
 

01:11:43.280 --> 01:11:46.310 align:start position:0%
the employee ID but this time it's going
to<01:11:43.440><c> focus</c><01:11:43.840><c> only</c><01:11:44.120><c> on</c><01:11:44.400><c> those</c><01:11:44.600><c> two</c><01:11:44.840><c> IDs</c><01:11:45.800><c> so</c><01:11:46.120><c> the</c>

01:11:46.310 --> 01:11:46.320 align:start position:0%
to focus only on those two IDs so the
 

01:11:46.320 --> 01:11:48.470 align:start position:0%
to focus only on those two IDs so the
two<01:11:46.639><c> and</c><01:11:46.920><c> three</c><01:11:47.360><c> so</c><01:11:47.560><c> SQL</c><01:11:47.920><c> going</c><01:11:48.000><c> to</c><01:11:48.159><c> go</c><01:11:48.280><c> and</c>

01:11:48.470 --> 01:11:48.480 align:start position:0%
two and three so SQL going to go and
 

01:11:48.480 --> 01:11:51.270 align:start position:0%
two and three so SQL going to go and
find<01:11:48.800><c> any</c><01:11:49.120><c> matching</c><01:11:50.000><c> where</c><01:11:50.280><c> the</c><01:11:50.440><c> manager</c><01:11:50.920><c> ID</c>

01:11:51.270 --> 01:11:51.280 align:start position:0%
find any matching where the manager ID
 

01:11:51.280 --> 01:11:54.350 align:start position:0%
find any matching where the manager ID
equal<01:11:51.600><c> to</c><01:11:52.199><c> two</c><01:11:52.600><c> or</c><01:11:53.040><c> three</c><01:11:53.520><c> so</c><01:11:53.719><c> isq</c><01:11:54.080><c> going</c><01:11:54.159><c> to</c><01:11:54.280><c> do</c>

01:11:54.350 --> 01:11:54.360 align:start position:0%
equal to two or three so isq going to do
 

01:11:54.360 --> 01:11:56.430 align:start position:0%
equal to two or three so isq going to do
it<01:11:54.480><c> step</c><01:11:54.679><c> by</c><01:11:54.840><c> step</c><01:11:55.040><c> the</c><01:11:55.320><c> first</c><01:11:55.520><c> one</c><01:11:55.719><c> is</c><01:11:55.880><c> not</c><01:11:56.239><c> the</c>

01:11:56.430 --> 01:11:56.440 align:start position:0%
it step by step the first one is not the
 

01:11:56.440 --> 01:11:59.310 align:start position:0%
it step by step the first one is not the
second<01:11:56.800><c> one</c><01:11:57.080><c> is</c><01:11:57.280><c> as</c><01:11:57.440><c> well</c><01:11:57.679><c> not</c><01:11:58.320><c> the</c><01:11:58.520><c> third</c><01:11:58.800><c> one</c>

01:11:59.310 --> 01:11:59.320 align:start position:0%
second one is as well not the third one
 

01:11:59.320 --> 01:12:02.149 align:start position:0%
second one is as well not the third one
is<01:11:59.480><c> not</c><01:12:00.040><c> because</c><01:12:00.280><c> the</c><01:12:00.400><c> maor</c><01:12:00.800><c> ID</c><01:12:01.080><c> is</c><01:12:01.280><c> one</c><01:12:01.920><c> but</c>

01:12:02.149 --> 01:12:02.159 align:start position:0%
is not because the maor ID is one but
 

01:12:02.159 --> 01:12:05.350 align:start position:0%
is not because the maor ID is one but
now<01:12:02.800><c> to</c><01:12:03.040><c> the</c><01:12:03.440><c> employee</c><01:12:04.080><c> number</c><01:12:04.520><c> four</c><01:12:05.120><c> we</c><01:12:05.239><c> have</c>

01:12:05.350 --> 01:12:05.360 align:start position:0%
now to the employee number four we have
 

01:12:05.360 --> 01:12:08.669 align:start position:0%
now to the employee number four we have
a<01:12:05.560><c> match</c><01:12:06.080><c> so</c><01:12:06.320><c> it's</c><01:12:06.760><c> going</c><01:12:06.840><c> to</c><01:12:07.040><c> take</c><01:12:07.320><c> this</c><01:12:07.679><c> one</c>

01:12:08.669 --> 01:12:08.679 align:start position:0%
a match so it's going to take this one
 

01:12:08.679 --> 01:12:11.629 align:start position:0%
a match so it's going to take this one
and<01:12:09.199><c> put</c><01:12:09.400><c> it</c><01:12:09.880><c> in</c><01:12:10.040><c> the</c><01:12:10.239><c> output</c><01:12:10.920><c> like</c><01:12:11.120><c> this</c><01:12:11.560><c> and</c>

01:12:11.629 --> 01:12:11.639 align:start position:0%
and put it in the output like this and
 

01:12:11.639 --> 01:12:13.430 align:start position:0%
and put it in the output like this and
now<01:12:11.800><c> in</c><01:12:11.920><c> this</c><01:12:12.080><c> iteration</c><01:12:12.639><c> what</c><01:12:12.800><c> is</c><01:12:13.199><c> the</c>

01:12:13.430 --> 01:12:13.440 align:start position:0%
now in this iteration what is the
 

01:12:13.440 --> 01:12:16.229 align:start position:0%
now in this iteration what is the
current<01:12:13.800><c> level</c><01:12:14.159><c> it</c><01:12:14.280><c> is</c><01:12:14.440><c> two</c><01:12:15.199><c> but</c><01:12:15.400><c> we</c><01:12:15.560><c> add</c><01:12:15.800><c> to</c><01:12:16.000><c> it</c>

01:12:16.229 --> 01:12:16.239 align:start position:0%
current level it is two but we add to it
 

01:12:16.239 --> 01:12:19.189 align:start position:0%
current level it is two but we add to it
one<01:12:16.880><c> that's</c><01:12:17.120><c> why</c><01:12:17.320><c> we</c><01:12:17.440><c> will</c><01:12:17.719><c> get</c><01:12:18.159><c> in</c><01:12:18.320><c> the</c><01:12:18.480><c> output</c>

01:12:19.189 --> 01:12:19.199 align:start position:0%
one that's why we will get in the output
 

01:12:19.199 --> 01:12:21.669 align:start position:0%
one that's why we will get in the output
three<01:12:19.719><c> and</c><01:12:19.840><c> then</c><01:12:20.000><c> SQL</c><01:12:20.480><c> keep</c><01:12:20.679><c> going</c><01:12:21.080><c> so</c><01:12:21.360><c> we</c><01:12:21.480><c> have</c>

01:12:21.669 --> 01:12:21.679 align:start position:0%
three and then SQL keep going so we have
 

01:12:21.679 --> 01:12:23.870 align:start position:0%
three and then SQL keep going so we have
here<01:12:21.880><c> the</c><01:12:22.000><c> employee</c><01:12:22.800><c> number</c><01:12:23.199><c> five</c><01:12:23.639><c> and</c><01:12:23.800><c> the</c>

01:12:23.870 --> 01:12:23.880 align:start position:0%
here the employee number five and the
 

01:12:23.880 --> 01:12:26.149 align:start position:0%
here the employee number five and the
manager<01:12:24.280><c> ID</c><01:12:24.560><c> is</c><01:12:24.719><c> equal</c><01:12:25.000><c> to</c><01:12:25.239><c> three</c><01:12:25.679><c> so</c><01:12:26.000><c> what</c>

01:12:26.149 --> 01:12:26.159 align:start position:0%
manager ID is equal to three so what
 

01:12:26.159 --> 01:12:28.550 align:start position:0%
manager ID is equal to three so what
happens<01:12:26.560><c> SQL</c><01:12:27.040><c> takes</c><01:12:27.239><c> it</c><01:12:27.480><c> as</c><01:12:27.639><c> well</c><01:12:27.920><c> and</c><01:12:28.159><c> put</c><01:12:28.360><c> it</c>

01:12:28.550 --> 01:12:28.560 align:start position:0%
happens SQL takes it as well and put it
 

01:12:28.560 --> 01:12:29.550 align:start position:0%
happens SQL takes it as well and put it
in<01:12:28.760><c> the</c>

01:12:29.550 --> 01:12:29.560 align:start position:0%
in the
 

01:12:29.560 --> 01:12:32.990 align:start position:0%
in the
output<01:12:30.560><c> as</c><01:12:31.120><c> the</c><01:12:31.360><c> result</c><01:12:31.639><c> of</c><01:12:31.800><c> the</c><01:12:31.920><c> CTE</c><01:12:32.679><c> and</c><01:12:32.840><c> as</c>

01:12:32.990 --> 01:12:33.000 align:start position:0%
output as the result of the CTE and as
 

01:12:33.000 --> 01:12:36.310 align:start position:0%
output as the result of the CTE and as
well<01:12:33.480><c> the</c><01:12:33.840><c> current</c><01:12:34.199><c> level</c><01:12:34.560><c> is</c><01:12:34.760><c> 2</c><01:12:35.239><c> +</c><01:12:35.600><c> 1</c><01:12:36.080><c> we</c><01:12:36.199><c> can</c>

01:12:36.310 --> 01:12:36.320 align:start position:0%
well the current level is 2 + 1 we can
 

01:12:36.320 --> 01:12:38.870 align:start position:0%
well the current level is 2 + 1 we can
to<01:12:36.440><c> have</c><01:12:36.600><c> as</c><01:12:36.760><c> well</c><01:12:37.000><c> three</c><01:12:37.560><c> so</c><01:12:37.920><c> with</c><01:12:38.120><c> that</c><01:12:38.400><c> isql</c>

01:12:38.870 --> 01:12:38.880 align:start position:0%
to have as well three so with that isql
 

01:12:38.880 --> 01:12:41.310 align:start position:0%
to have as well three so with that isql
done<01:12:39.239><c> joining</c><01:12:39.760><c> the</c><01:12:40.000><c> tables</c><01:12:40.719><c> and</c><01:12:41.080><c> you're</c><01:12:41.199><c> going</c>

01:12:41.310 --> 01:12:41.320 align:start position:0%
done joining the tables and you're going
 

01:12:41.320 --> 01:12:43.310 align:start position:0%
done joining the tables and you're going
to<01:12:41.440><c> ask</c><01:12:41.679><c> again</c><01:12:42.080><c> did</c><01:12:42.239><c> we</c><01:12:42.440><c> process</c><01:12:43.000><c> all</c>

01:12:43.310 --> 01:12:43.320 align:start position:0%
to ask again did we process all
 

01:12:43.320 --> 01:12:46.550 align:start position:0%
to ask again did we process all
employees<01:12:44.280><c> well</c><01:12:44.920><c> yes</c><01:12:45.239><c> it's</c><01:12:45.480><c> true</c><01:12:46.000><c> that</c><01:12:46.159><c> means</c>

01:12:46.550 --> 01:12:46.560 align:start position:0%
employees well yes it's true that means
 

01:12:46.560 --> 01:12:48.870 align:start position:0%
employees well yes it's true that means
we<01:12:46.679><c> don't</c><01:12:46.920><c> have</c><01:12:47.040><c> to</c><01:12:47.199><c> do</c><01:12:47.520><c> any</c><01:12:47.760><c> more</c><01:12:48.000><c> iterations</c>

01:12:48.870 --> 01:12:48.880 align:start position:0%
we don't have to do any more iterations
 

01:12:48.880 --> 01:12:51.149 align:start position:0%
we don't have to do any more iterations
because<01:12:49.159><c> if</c><01:12:49.239><c> you</c><01:12:49.360><c> do</c><01:12:49.520><c> any</c><01:12:49.760><c> iterations</c><01:12:50.760><c> isql</c>

01:12:51.149 --> 01:12:51.159 align:start position:0%
because if you do any iterations isql
 

01:12:51.159 --> 01:12:53.470 align:start position:0%
because if you do any iterations isql
will<01:12:51.320><c> not</c><01:12:51.520><c> find</c><01:12:51.800><c> anything</c><01:12:52.440><c> so</c><01:12:52.679><c> for</c><01:12:52.920><c> example</c><01:12:53.400><c> if</c>

01:12:53.470 --> 01:12:53.480 align:start position:0%
will not find anything so for example if
 

01:12:53.480 --> 01:12:55.830 align:start position:0%
will not find anything so for example if
you<01:12:53.639><c> go</c><01:12:53.800><c> over</c><01:12:54.080><c> here</c><01:12:54.440><c> let</c><01:12:54.520><c> me</c><01:12:54.679><c> just</c><01:12:54.840><c> remove</c><01:12:55.440><c> this</c>

01:12:55.830 --> 01:12:55.840 align:start position:0%
you go over here let me just remove this
 

01:12:55.840 --> 01:12:57.629 align:start position:0%
you go over here let me just remove this
and<01:12:56.080><c> let's</c><01:12:56.320><c> say</c><01:12:56.520><c> we</c><01:12:56.639><c> are</c><01:12:56.840><c> joining</c><01:12:57.280><c> with</c><01:12:57.400><c> the</c>

01:12:57.629 --> 01:12:57.639 align:start position:0%
and let's say we are joining with the
 

01:12:57.639 --> 01:12:59.709 align:start position:0%
and let's say we are joining with the
four<01:12:58.080><c> and</c><01:12:58.400><c> five</c><01:12:59.000><c> so</c><01:12:59.159><c> what</c><01:12:59.320><c> going</c><01:12:59.400><c> to</c><01:12:59.520><c> happen</c>

01:12:59.709 --> 01:12:59.719 align:start position:0%
four and five so what going to happen
 

01:12:59.719 --> 01:13:02.030 align:start position:0%
four and five so what going to happen
isq<01:13:00.159><c> going</c><01:13:00.280><c> to</c><01:13:00.440><c> search</c><01:13:00.840><c> in</c><01:13:00.960><c> the</c><01:13:01.080><c> manager</c><01:13:01.600><c> ID</c>

01:13:02.030 --> 01:13:02.040 align:start position:0%
isq going to search in the manager ID
 

01:13:02.040 --> 01:13:04.470 align:start position:0%
isq going to search in the manager ID
for<01:13:02.239><c> four</c><01:13:02.520><c> and</c><01:13:02.760><c> five</c><01:13:03.239><c> and</c><01:13:03.760><c> it</c><01:13:03.880><c> will</c><01:13:04.040><c> not</c><01:13:04.239><c> find</c>

01:13:04.470 --> 01:13:04.480 align:start position:0%
for four and five and it will not find
 

01:13:04.480 --> 01:13:06.390 align:start position:0%
for four and five and it will not find
anything<01:13:04.960><c> so</c><01:13:05.159><c> that</c><01:13:05.360><c> means</c><01:13:05.679><c> we</c><01:13:05.800><c> will</c><01:13:06.000><c> not</c><01:13:06.199><c> be</c>

01:13:06.390 --> 01:13:06.400 align:start position:0%
anything so that means we will not be
 

01:13:06.400 --> 01:13:08.390 align:start position:0%
anything so that means we will not be
adding<01:13:06.920><c> anything</c><01:13:07.280><c> to</c><01:13:07.400><c> the</c><01:13:07.560><c> CTE</c><01:13:08.080><c> that's</c><01:13:08.239><c> why</c>

01:13:08.390 --> 01:13:08.400 align:start position:0%
adding anything to the CTE that's why
 

01:13:08.400 --> 01:13:10.790 align:start position:0%
adding anything to the CTE that's why
SQL<01:13:08.840><c> stops</c><01:13:09.400><c> so</c><01:13:09.560><c> we</c><01:13:09.719><c> have</c><01:13:09.840><c> a</c><01:13:10.000><c> complete</c><01:13:10.360><c> results</c>

01:13:10.790 --> 01:13:10.800 align:start position:0%
SQL stops so we have a complete results
 

01:13:10.800 --> 01:13:13.070 align:start position:0%
SQL stops so we have a complete results
and<01:13:10.920><c> we</c><01:13:11.040><c> have</c><01:13:11.280><c> now</c><01:13:11.480><c> all</c><01:13:11.719><c> the</c><01:13:11.960><c> data</c><01:13:12.600><c> from</c><01:13:12.880><c> the</c>

01:13:13.070 --> 01:13:13.080 align:start position:0%
and we have now all the data from the
 

01:13:13.080 --> 01:13:15.030 align:start position:0%
and we have now all the data from the
employees<01:13:13.560><c> in</c><01:13:13.679><c> the</c><01:13:13.840><c> output</c><01:13:14.360><c> and</c><01:13:14.520><c> this</c><01:13:14.679><c> results</c>

01:13:15.030 --> 01:13:15.040 align:start position:0%
employees in the output and this results
 

01:13:15.040 --> 01:13:17.390 align:start position:0%
employees in the output and this results
going<01:13:15.159><c> to</c><01:13:15.239><c> be</c><01:13:15.440><c> passed</c><01:13:15.840><c> to</c><01:13:16.040><c> the</c><01:13:16.199><c> main</c><01:13:16.480><c> query</c><01:13:17.080><c> so</c>

01:13:17.390 --> 01:13:17.400 align:start position:0%
going to be passed to the main query so
 

01:13:17.400 --> 01:13:19.070 align:start position:0%
going to be passed to the main query so
this<01:13:17.480><c> is</c><01:13:17.760><c> why</c><01:13:17.960><c> we</c><01:13:18.080><c> have</c><01:13:18.239><c> done</c><01:13:18.400><c> it</c><01:13:18.560><c> like</c><01:13:18.760><c> this</c>

01:13:19.070 --> 01:13:19.080 align:start position:0%
this is why we have done it like this
 

01:13:19.080 --> 01:13:20.870 align:start position:0%
this is why we have done it like this
and<01:13:19.280><c> this</c><01:13:19.360><c> is</c><01:13:19.480><c> how</c><01:13:19.639><c> is</c><01:13:20.080><c> executed</c><01:13:20.679><c> this</c>

01:13:20.870 --> 01:13:20.880 align:start position:0%
and this is how is executed this
 

01:13:20.880 --> 01:13:23.030 align:start position:0%
and this is how is executed this
recursive<01:13:21.840><c> query</c><01:13:22.400><c> now</c><01:13:22.520><c> I</c><01:13:22.600><c> would</c><01:13:22.760><c> like</c><01:13:22.880><c> to</c>

01:13:23.030 --> 01:13:23.040 align:start position:0%
recursive query now I would like to
 

01:13:23.040 --> 01:13:25.390 align:start position:0%
recursive query now I would like to
visual<01:13:23.360><c> for</c><01:13:23.560><c> you</c><01:13:23.920><c> what</c><01:13:24.120><c> this</c><01:13:24.239><c> means</c><01:13:24.719><c> the</c><01:13:25.159><c> level</c>

01:13:25.390 --> 01:13:25.400 align:start position:0%
visual for you what this means the level
 

01:13:25.400 --> 01:13:27.590 align:start position:0%
visual for you what this means the level
or<01:13:25.600><c> the</c><01:13:25.760><c> structure</c><01:13:26.159><c> of</c><01:13:26.280><c> the</c><01:13:26.440><c> organization</c><01:13:27.360><c> so</c>

01:13:27.590 --> 01:13:27.600 align:start position:0%
or the structure of the organization so
 

01:13:27.600 --> 01:13:29.790 align:start position:0%
or the structure of the organization so
the<01:13:27.760><c> hierarchy</c><01:13:28.280><c> looks</c><01:13:28.560><c> like</c><01:13:28.800><c> this</c><01:13:29.360><c> the</c><01:13:29.520><c> level</c>

01:13:29.790 --> 01:13:29.800 align:start position:0%
the hierarchy looks like this the level
 

01:13:29.800 --> 01:13:33.270 align:start position:0%
the hierarchy looks like this the level
one<01:13:30.159><c> the</c><01:13:30.400><c> top</c><01:13:30.600><c> manager</c><01:13:31.080><c> is</c><01:13:31.360><c> Frank</c><01:13:32.000><c> so</c><01:13:32.480><c> this</c><01:13:32.679><c> is</c>

01:13:33.270 --> 01:13:33.280 align:start position:0%
one the top manager is Frank so this is
 

01:13:33.280 --> 01:13:35.950 align:start position:0%
one the top manager is Frank so this is
the<01:13:33.560><c> level</c><01:13:34.400><c> number</c><01:13:34.679><c> one</c><01:13:35.199><c> and</c><01:13:35.320><c> then</c><01:13:35.480><c> we</c><01:13:35.639><c> go</c><01:13:35.800><c> to</c>

01:13:35.950 --> 01:13:35.960 align:start position:0%
the level number one and then we go to
 

01:13:35.960 --> 01:13:38.030 align:start position:0%
the level number one and then we go to
the<01:13:36.120><c> level</c><01:13:36.400><c> number</c><01:13:36.639><c> two</c><01:13:36.920><c> so</c><01:13:37.120><c> we</c><01:13:37.280><c> have</c><01:13:37.800><c> those</c>

01:13:38.030 --> 01:13:38.040 align:start position:0%
the level number two so we have those
 

01:13:38.040 --> 01:13:41.430 align:start position:0%
the level number two so we have those
two<01:13:38.600><c> employees</c><01:13:39.600><c> so</c><01:13:39.800><c> we</c><01:13:39.920><c> have</c><01:13:40.159><c> Kevin</c><01:13:40.760><c> so</c><01:13:41.280><c> this</c>

01:13:41.430 --> 01:13:41.440 align:start position:0%
two employees so we have Kevin so this
 

01:13:41.440 --> 01:13:43.870 align:start position:0%
two employees so we have Kevin so this
is<01:13:41.800><c> the</c><01:13:42.000><c> level</c><01:13:42.320><c> number</c><01:13:42.560><c> one</c><01:13:43.120><c> and</c><01:13:43.239><c> then</c><01:13:43.440><c> we</c><01:13:43.600><c> have</c>

01:13:43.870 --> 01:13:43.880 align:start position:0%
is the level number one and then we have
 

01:13:43.880 --> 01:13:46.229 align:start position:0%
is the level number one and then we have
two<01:13:44.120><c> employees</c><01:13:44.800><c> Kevin</c><01:13:45.280><c> and</c><01:13:45.480><c> Mary</c><01:13:45.920><c> at</c><01:13:46.080><c> the</c>

01:13:46.229 --> 01:13:46.239 align:start position:0%
two employees Kevin and Mary at the
 

01:13:46.239 --> 01:13:50.629 align:start position:0%
two employees Kevin and Mary at the
level<01:13:46.480><c> two</c><01:13:47.360><c> so</c><01:13:48.159><c> they</c><01:13:48.360><c> work</c><01:13:49.280><c> together</c><01:13:50.239><c> and</c>

01:13:50.629 --> 01:13:50.639 align:start position:0%
level two so they work together and
 

01:13:50.639 --> 01:13:53.270 align:start position:0%
level two so they work together and
their<01:13:50.880><c> post</c><01:13:51.239><c> is</c><01:13:51.440><c> Frank</c><01:13:52.280><c> so</c><01:13:52.840><c> it's</c><01:13:53.000><c> going</c><01:13:53.120><c> to</c>

01:13:53.270 --> 01:13:53.280 align:start position:0%
their post is Frank so it's going to
 

01:13:53.280 --> 01:13:56.510 align:start position:0%
their post is Frank so it's going to
look<01:13:53.560><c> like</c><01:13:53.880><c> this</c><01:13:54.440><c> and</c><01:13:55.159><c> they</c><01:13:55.280><c> are</c><01:13:55.600><c> at</c><01:13:55.800><c> the</c><01:13:56.000><c> level</c>

01:13:56.510 --> 01:13:56.520 align:start position:0%
look like this and they are at the level
 

01:13:56.520 --> 01:13:59.870 align:start position:0%
look like this and they are at the level
two<01:13:57.120><c> we</c><01:13:57.239><c> have</c><01:13:57.480><c> then</c><01:13:57.719><c> Michael</c><01:13:58.679><c> that</c><01:13:58.960><c> directly</c>

01:13:59.870 --> 01:13:59.880 align:start position:0%
two we have then Michael that directly
 

01:13:59.880 --> 01:14:03.310 align:start position:0%
two we have then Michael that directly
reports<01:14:00.880><c> to</c><01:14:01.600><c> who</c><01:14:01.840><c> to</c><01:14:02.080><c> Kevin</c><01:14:02.679><c> because</c><01:14:02.920><c> here</c><01:14:03.199><c> we</c>

01:14:03.310 --> 01:14:03.320 align:start position:0%
reports to who to Kevin because here we
 

01:14:03.320 --> 01:14:05.590 align:start position:0%
reports to who to Kevin because here we
have<01:14:03.400><c> the</c><01:14:03.520><c> employee</c><01:14:03.880><c> ID</c><01:14:04.120><c> two</c><01:14:04.400><c> and</c><01:14:04.600><c> two</c><01:14:05.080><c> so</c><01:14:05.480><c> we</c>

01:14:05.590 --> 01:14:05.600 align:start position:0%
have the employee ID two and two so we
 

01:14:05.600 --> 01:14:08.390 align:start position:0%
have the employee ID two and two so we
have<01:14:05.760><c> one</c><01:14:06.000><c> employee</c><01:14:06.520><c> here</c><01:14:07.040><c> and</c><01:14:07.320><c> as</c><01:14:07.480><c> well</c><01:14:07.800><c> Carl</c>

01:14:08.390 --> 01:14:08.400 align:start position:0%
have one employee here and as well Carl
 

01:14:08.400 --> 01:14:11.310 align:start position:0%
have one employee here and as well Carl
is<01:14:08.639><c> as</c><01:14:08.800><c> well</c><01:14:09.040><c> at</c><01:14:09.239><c> the</c><01:14:09.400><c> level</c><01:14:09.719><c> three</c><01:14:10.600><c> and</c><01:14:11.080><c> she</c>

01:14:11.310 --> 01:14:11.320 align:start position:0%
is as well at the level three and she
 

01:14:11.320 --> 01:14:14.030 align:start position:0%
is as well at the level three and she
reports<01:14:11.760><c> to</c><01:14:12.000><c> Mari</c><01:14:12.719><c> and</c><01:14:13.080><c> both</c><01:14:13.360><c> Michael</c><01:14:13.800><c> and</c>

01:14:14.030 --> 01:14:14.040 align:start position:0%
reports to Mari and both Michael and
 

01:14:14.040 --> 01:14:16.590 align:start position:0%
reports to Mari and both Michael and
Carl<01:14:14.440><c> are</c><01:14:14.920><c> at</c><01:14:15.080><c> the</c><01:14:15.199><c> level</c><01:14:15.520><c> three</c><01:14:16.080><c> so</c><01:14:16.320><c> this</c><01:14:16.440><c> is</c>

01:14:16.590 --> 01:14:16.600 align:start position:0%
Carl are at the level three so this is
 

01:14:16.600 --> 01:14:18.510 align:start position:0%
Carl are at the level three so this is
what<01:14:16.719><c> we</c><01:14:16.840><c> mean</c><01:14:17.159><c> with</c><01:14:17.320><c> the</c><01:14:17.520><c> level</c><01:14:18.199><c> it's</c><01:14:18.360><c> going</c>

01:14:18.510 --> 01:14:18.520 align:start position:0%
what we mean with the level it's going
 

01:14:18.520 --> 01:14:21.030 align:start position:0%
what we mean with the level it's going
to<01:14:18.679><c> help</c><01:14:18.840><c> us</c><01:14:19.000><c> to</c><01:14:19.199><c> identify</c><01:14:19.960><c> which</c><01:14:20.159><c> employee</c><01:14:20.760><c> at</c>

01:14:21.030 --> 01:14:21.040 align:start position:0%
to help us to identify which employee at
 

01:14:21.040 --> 01:14:23.229 align:start position:0%
to help us to identify which employee at
which<01:14:21.320><c> level</c><01:14:21.639><c> in</c><01:14:21.760><c> the</c><01:14:21.920><c> organization</c><01:14:22.920><c> if</c><01:14:23.040><c> you</c>

01:14:23.229 --> 01:14:23.239 align:start position:0%
which level in the organization if you
 

01:14:23.239 --> 01:14:25.750 align:start position:0%
which level in the organization if you
have<01:14:23.520><c> like</c><01:14:23.800><c> hierarchy</c><01:14:24.320><c> in</c><01:14:24.440><c> your</c><01:14:24.639><c> data</c>

01:14:25.750 --> 01:14:25.760 align:start position:0%
have like hierarchy in your data
 

01:14:25.760 --> 01:14:28.149 align:start position:0%
have like hierarchy in your data
and<01:14:25.920><c> you</c><01:14:26.040><c> can</c><01:14:26.159><c> see</c><01:14:26.400><c> in</c><01:14:26.600><c> one</c><01:14:26.880><c> table</c><01:14:27.639><c> things</c><01:14:27.880><c> are</c>

01:14:28.149 --> 01:14:28.159 align:start position:0%
and you can see in one table things are
 

01:14:28.159 --> 01:14:30.430 align:start position:0%
and you can see in one table things are
referencing<01:14:28.920><c> each</c><01:14:29.080><c> others</c><01:14:29.880><c> like</c><01:14:30.080><c> here</c><01:14:30.280><c> the</c>

01:14:30.430 --> 01:14:30.440 align:start position:0%
referencing each others like here the
 

01:14:30.440 --> 01:14:33.149 align:start position:0%
referencing each others like here the
manager<01:14:30.880><c> ID</c><01:14:31.199><c> is</c><01:14:31.480><c> actually</c><01:14:31.920><c> the</c><01:14:32.080><c> employee</c><01:14:32.600><c> ID</c>

01:14:33.149 --> 01:14:33.159 align:start position:0%
manager ID is actually the employee ID
 

01:14:33.159 --> 01:14:35.830 align:start position:0%
manager ID is actually the employee ID
so<01:14:33.360><c> it's</c><01:14:33.560><c> like</c><01:14:33.760><c> we</c><01:14:33.880><c> are</c><01:14:34.239><c> referencing</c><01:14:35.239><c> those</c><01:14:35.520><c> ID</c>

01:14:35.830 --> 01:14:35.840 align:start position:0%
so it's like we are referencing those ID
 

01:14:35.840 --> 01:14:38.149 align:start position:0%
so it's like we are referencing those ID
to<01:14:36.000><c> each</c><01:14:36.120><c> others</c><01:14:36.840><c> this</c><01:14:37.000><c> means</c><01:14:37.560><c> there</c><01:14:37.760><c> is</c>

01:14:38.149 --> 01:14:38.159 align:start position:0%
to each others this means there is
 

01:14:38.159 --> 01:14:39.910 align:start position:0%
to each others this means there is
hierarchy<01:14:38.719><c> and</c><01:14:38.880><c> there</c><01:14:39.000><c> is</c><01:14:39.120><c> a</c><01:14:39.320><c> structure</c><01:14:39.719><c> in</c>

01:14:39.910 --> 01:14:39.920 align:start position:0%
hierarchy and there is a structure in
 

01:14:39.920 --> 01:14:42.310 align:start position:0%
hierarchy and there is a structure in
this<01:14:40.120><c> table</c><01:14:40.760><c> and</c><01:14:40.920><c> you</c><01:14:41.120><c> can</c><01:14:41.280><c> use</c><01:14:41.600><c> the</c><01:14:41.800><c> recursive</c>

01:14:42.310 --> 01:14:42.320 align:start position:0%
this table and you can use the recursive
 

01:14:42.320 --> 01:14:45.790 align:start position:0%
this table and you can use the recursive
City<01:14:42.760><c> in</c><01:14:43.000><c> order</c><01:14:43.800><c> to</c><01:14:44.080><c> build</c><01:14:44.679><c> those</c><01:14:44.920><c> levels</c><01:14:45.679><c> and</c>

01:14:45.790 --> 01:14:45.800 align:start position:0%
City in order to build those levels and
 

01:14:45.800 --> 01:14:47.709 align:start position:0%
City in order to build those levels and
to<01:14:46.000><c> navigate</c><01:14:46.639><c> as</c><01:14:46.800><c> well</c><01:14:47.280><c> through</c><01:14:47.560><c> the</c>

01:14:47.709 --> 01:14:47.719 align:start position:0%
to navigate as well through the
 

01:14:47.719 --> 01:14:49.550 align:start position:0%
to navigate as well through the
hierarchy<01:14:48.639><c> all</c><01:14:48.760><c> right</c><01:14:48.920><c> so</c><01:14:49.120><c> that's</c><01:14:49.280><c> all</c><01:14:49.400><c> for</c>

01:14:49.550 --> 01:14:49.560 align:start position:0%
hierarchy all right so that's all for
 

01:14:49.560 --> 01:14:51.229 align:start position:0%
hierarchy all right so that's all for
the<01:14:49.719><c> recursive</c><01:14:50.120><c> City</c><01:14:50.520><c> and</c><01:14:50.679><c> with</c><01:14:50.800><c> that</c><01:14:50.960><c> we</c><01:14:51.080><c> have</c>

01:14:51.229 --> 01:14:51.239 align:start position:0%
the recursive City and with that we have
 

01:14:51.239 --> 01:14:53.470 align:start position:0%
the recursive City and with that we have
covered<01:14:51.719><c> all</c><01:14:51.920><c> the</c><01:14:52.159><c> different</c><01:14:52.520><c> types</c><01:14:52.960><c> of</c>

01:14:53.470 --> 01:14:53.480 align:start position:0%
covered all the different types of
 

01:14:53.480 --> 01:14:59.350 align:start position:0%
covered all the different types of
cities<01:14:53.960><c> that</c><01:14:54.120><c> we</c><01:14:54.239><c> have</c><01:14:54.360><c> in</c><01:14:54.480><c> SQL</c>

01:14:59.350 --> 01:14:59.360 align:start position:0%
 
 

01:14:59.360 --> 01:15:01.270 align:start position:0%
 
so<01:14:59.520><c> now</c><01:14:59.679><c> let's</c><01:14:59.920><c> have</c><01:15:00.040><c> a</c><01:15:00.199><c> quick</c><01:15:00.400><c> recap</c><01:15:01.000><c> so</c><01:15:01.159><c> we</c>

01:15:01.270 --> 01:15:01.280 align:start position:0%
so now let's have a quick recap so we
 

01:15:01.280 --> 01:15:02.990 align:start position:0%
so now let's have a quick recap so we
have<01:15:01.400><c> learned</c><01:15:01.719><c> that</c><01:15:01.880><c> the</c><01:15:02.000><c> CTE</c><01:15:02.480><c> the</c><01:15:02.639><c> Common</c>

01:15:02.990 --> 01:15:03.000 align:start position:0%
have learned that the CTE the Common
 

01:15:03.000 --> 01:15:06.110 align:start position:0%
have learned that the CTE the Common
Table<01:15:03.320><c> expression</c><01:15:03.800><c> is</c><01:15:04.400><c> a</c><01:15:04.639><c> temporary</c><01:15:05.600><c> named</c>

01:15:06.110 --> 01:15:06.120 align:start position:0%
Table expression is a temporary named
 

01:15:06.120 --> 01:15:08.390 align:start position:0%
Table expression is a temporary named
result<01:15:06.840><c> like</c><01:15:07.000><c> a</c><01:15:07.159><c> virtual</c><01:15:07.600><c> table</c><01:15:08.080><c> that</c><01:15:08.239><c> could</c>

01:15:08.390 --> 01:15:08.400 align:start position:0%
result like a virtual table that could
 

01:15:08.400 --> 01:15:09.990 align:start position:0%
result like a virtual table that could
be<01:15:08.520><c> used</c><01:15:08.800><c> from</c><01:15:09.040><c> different</c><01:15:09.360><c> places</c><01:15:09.679><c> in</c><01:15:09.840><c> the</c>

01:15:09.990 --> 01:15:10.000 align:start position:0%
be used from different places in the
 

01:15:10.000 --> 01:15:11.950 align:start position:0%
be used from different places in the
query<01:15:10.600><c> and</c><01:15:10.719><c> we</c><01:15:10.840><c> have</c><01:15:11.040><c> a</c><01:15:11.159><c> lot</c><01:15:11.320><c> of</c><01:15:11.480><c> advantages</c>

01:15:11.950 --> 01:15:11.960 align:start position:0%
query and we have a lot of advantages
 

01:15:11.960 --> 01:15:14.669 align:start position:0%
query and we have a lot of advantages
for<01:15:12.159><c> the</c><01:15:12.280><c> CTE</c><01:15:13.040><c> the</c><01:15:13.159><c> main</c><01:15:13.400><c> one</c><01:15:13.679><c> is</c><01:15:13.920><c> it</c><01:15:14.159><c> breaks</c>

01:15:14.669 --> 01:15:14.679 align:start position:0%
for the CTE the main one is it breaks
 

01:15:14.679 --> 01:15:17.310 align:start position:0%
for the CTE the main one is it breaks
the<01:15:14.840><c> complexity</c><01:15:15.440><c> of</c><01:15:15.679><c> query</c><01:15:16.560><c> into</c><01:15:16.920><c> small</c>

01:15:17.310 --> 01:15:17.320 align:start position:0%
the complexity of query into small
 

01:15:17.320 --> 01:15:19.790 align:start position:0%
the complexity of query into small
multiple<01:15:17.800><c> pieces</c><01:15:18.480><c> which</c><01:15:18.639><c> makes</c><01:15:19.040><c> our</c><01:15:19.280><c> query</c>

01:15:19.790 --> 01:15:19.800 align:start position:0%
multiple pieces which makes our query
 

01:15:19.800 --> 01:15:22.030 align:start position:0%
multiple pieces which makes our query
much<01:15:20.040><c> easier</c><01:15:20.440><c> to</c><01:15:20.639><c> read</c><01:15:21.080><c> and</c><01:15:21.239><c> as</c><01:15:21.400><c> well</c><01:15:21.560><c> to</c>

01:15:22.030 --> 01:15:22.040 align:start position:0%
much easier to read and as well to
 

01:15:22.040 --> 01:15:24.270 align:start position:0%
much easier to read and as well to
understand<01:15:22.440><c> so</c><01:15:22.679><c> it</c><01:15:22.840><c> improves</c><01:15:23.360><c> readability</c>

01:15:24.270 --> 01:15:24.280 align:start position:0%
understand so it improves readability
 

01:15:24.280 --> 01:15:26.229 align:start position:0%
understand so it improves readability
another<01:15:24.600><c> advantage</c><01:15:25.040><c> of</c><01:15:25.159><c> the</c><01:15:25.239><c> city</c><01:15:25.520><c> is</c><01:15:25.679><c> that</c>

01:15:26.229 --> 01:15:26.239 align:start position:0%
another advantage of the city is that
 

01:15:26.239 --> 01:15:28.430 align:start position:0%
another advantage of the city is that
those<01:15:26.480><c> small</c><01:15:26.760><c> multiple</c><01:15:27.199><c> pieces</c><01:15:27.960><c> they</c><01:15:28.080><c> are</c>

01:15:28.430 --> 01:15:28.440 align:start position:0%
those small multiple pieces they are
 

01:15:28.440 --> 01:15:31.030 align:start position:0%
those small multiple pieces they are
really<01:15:28.719><c> easy</c><01:15:29.000><c> to</c><01:15:29.239><c> manage</c><01:15:29.760><c> and</c><01:15:29.920><c> to</c><01:15:30.120><c> develop</c><01:15:30.760><c> so</c>

01:15:31.030 --> 01:15:31.040 align:start position:0%
really easy to manage and to develop so
 

01:15:31.040 --> 01:15:33.270 align:start position:0%
really easy to manage and to develop so
those<01:15:31.199><c> pieces</c><01:15:31.520><c> are</c><01:15:31.760><c> like</c><01:15:32.280><c> self-contained</c>

01:15:33.270 --> 01:15:33.280 align:start position:0%
those pieces are like self-contained
 

01:15:33.280 --> 01:15:36.030 align:start position:0%
those pieces are like self-contained
which<01:15:33.480><c> makes</c><01:15:33.800><c> our</c><01:15:34.080><c> queries</c><01:15:34.719><c> more</c><01:15:35.040><c> modular</c><01:15:35.760><c> so</c>

01:15:36.030 --> 01:15:36.040 align:start position:0%
which makes our queries more modular so
 

01:15:36.040 --> 01:15:38.430 align:start position:0%
which makes our queries more modular so
it<01:15:36.199><c> introduces</c><01:15:37.000><c> modularity</c><01:15:37.760><c> inside</c><01:15:38.120><c> our</c>

01:15:38.430 --> 01:15:38.440 align:start position:0%
it introduces modularity inside our
 

01:15:38.440 --> 01:15:40.830 align:start position:0%
it introduces modularity inside our
queries<01:15:39.159><c> and</c><01:15:39.320><c> we</c><01:15:39.440><c> also</c><01:15:39.679><c> learned</c><01:15:40.080><c> that</c><01:15:40.280><c> the</c><01:15:40.400><c> CTE</c>

01:15:40.830 --> 01:15:40.840 align:start position:0%
queries and we also learned that the CTE
 

01:15:40.840 --> 01:15:43.669 align:start position:0%
queries and we also learned that the CTE
help<01:15:41.199><c> us</c><01:15:41.600><c> to</c><01:15:41.800><c> reduce</c><01:15:42.280><c> the</c><01:15:42.520><c> redundancy</c><01:15:43.360><c> inside</c>

01:15:43.669 --> 01:15:43.679 align:start position:0%
help us to reduce the redundancy inside
 

01:15:43.679 --> 01:15:45.950 align:start position:0%
help us to reduce the redundancy inside
our<01:15:43.920><c> queries</c><01:15:44.639><c> where</c><01:15:44.800><c> it</c><01:15:44.960><c> makes</c><01:15:45.360><c> the</c><01:15:45.520><c> results</c>

01:15:45.950 --> 01:15:45.960 align:start position:0%
our queries where it makes the results
 

01:15:45.960 --> 01:15:49.270 align:start position:0%
our queries where it makes the results
of<01:15:46.159><c> one</c><01:15:46.440><c> query</c><01:15:47.239><c> usable</c><01:15:47.920><c> in</c><01:15:48.120><c> multiple</c><01:15:48.639><c> places</c>

01:15:49.270 --> 01:15:49.280 align:start position:0%
of one query usable in multiple places
 

01:15:49.280 --> 01:15:51.790 align:start position:0%
of one query usable in multiple places
inside<01:15:49.600><c> our</c><01:15:49.840><c> query</c><01:15:50.520><c> so</c><01:15:50.800><c> it</c><01:15:50.920><c> makes</c><01:15:51.199><c> our</c><01:15:51.480><c> code</c>

01:15:51.790 --> 01:15:51.800 align:start position:0%
inside our query so it makes our code
 

01:15:51.800 --> 01:15:53.950 align:start position:0%
inside our query so it makes our code
smaller<01:15:52.280><c> and</c><01:15:52.480><c> reduced</c><01:15:52.880><c> redundancy</c><01:15:53.639><c> and</c><01:15:53.800><c> one</c>

01:15:53.950 --> 01:15:53.960 align:start position:0%
smaller and reduced redundancy and one
 

01:15:53.960 --> 01:15:56.189 align:start position:0%
smaller and reduced redundancy and one
more<01:15:54.159><c> advantage</c><01:15:54.560><c> of</c><01:15:54.719><c> this</c><01:15:55.000><c> CTE</c><01:15:55.320><c> is</c><01:15:55.480><c> that</c><01:15:56.000><c> it</c>

01:15:56.189 --> 01:15:56.199 align:start position:0%
more advantage of this CTE is that it
 

01:15:56.199 --> 01:15:59.070 align:start position:0%
more advantage of this CTE is that it
help<01:15:56.520><c> us</c><01:15:56.679><c> to</c><01:15:56.840><c> do</c><01:15:57.040><c> looping</c><01:15:57.679><c> and</c><01:15:57.880><c> iterating</c><01:15:58.880><c> in</c>

01:15:59.070 --> 01:15:59.080 align:start position:0%
help us to do looping and iterating in
 

01:15:59.080 --> 01:16:02.189 align:start position:0%
help us to do looping and iterating in
SQL<01:15:59.840><c> by</c><01:16:00.040><c> using</c><01:16:00.480><c> the</c><01:16:00.719><c> recursive</c><01:16:01.199><c> CTE</c><01:16:01.960><c> and</c><01:16:02.080><c> we</c>

01:16:02.189 --> 01:16:02.199 align:start position:0%
SQL by using the recursive CTE and we
 

01:16:02.199 --> 01:16:03.709 align:start position:0%
SQL by using the recursive CTE and we
have<01:16:02.360><c> understood</c><01:16:02.760><c> as</c><01:16:02.920><c> well</c><01:16:03.199><c> that</c><01:16:03.360><c> we</c><01:16:03.480><c> can</c>

01:16:03.709 --> 01:16:03.719 align:start position:0%
have understood as well that we can
 

01:16:03.719 --> 01:16:06.550 align:start position:0%
have understood as well that we can
treat<01:16:04.199><c> the</c><01:16:04.400><c> CTE</c><01:16:04.920><c> result</c><01:16:05.480><c> as</c><01:16:06.080><c> any</c><01:16:06.320><c> other</c>

01:16:06.550 --> 01:16:06.560 align:start position:0%
treat the CTE result as any other
 

01:16:06.560 --> 01:16:08.790 align:start position:0%
treat the CTE result as any other
physical<01:16:07.000><c> table</c><01:16:07.320><c> inside</c><01:16:07.639><c> our</c><01:16:07.880><c> database</c><01:16:08.520><c> so</c><01:16:08.679><c> we</c>

01:16:08.790 --> 01:16:08.800 align:start position:0%
physical table inside our database so we
 

01:16:08.800 --> 01:16:10.510 align:start position:0%
physical table inside our database so we
can<01:16:09.000><c> treat</c><01:16:09.280><c> it</c><01:16:09.440><c> and</c><01:16:09.639><c> handle</c><01:16:09.960><c> it</c><01:16:10.159><c> like</c><01:16:10.320><c> any</c>

01:16:10.510 --> 01:16:10.520 align:start position:0%
can treat it and handle it like any
 

01:16:10.520 --> 01:16:13.070 align:start position:0%
can treat it and handle it like any
other<01:16:10.719><c> tables</c><01:16:11.400><c> only</c><01:16:11.639><c> one</c><01:16:11.840><c> exception</c><01:16:12.239><c> is</c><01:16:12.480><c> that</c>

01:16:13.070 --> 01:16:13.080 align:start position:0%
other tables only one exception is that
 

01:16:13.080 --> 01:16:15.950 align:start position:0%
other tables only one exception is that
this<01:16:13.280><c> table</c><01:16:13.639><c> lives</c><01:16:14.159><c> only</c><01:16:14.480><c> in</c><01:16:14.760><c> one</c><01:16:15.040><c> query</c><01:16:15.639><c> so</c><01:16:15.800><c> we</c>

01:16:15.950 --> 01:16:15.960 align:start position:0%
this table lives only in one query so we
 

01:16:15.960 --> 01:16:19.149 align:start position:0%
this table lives only in one query so we
cannot<01:16:16.360><c> query</c><01:16:16.760><c> the</c><01:16:16.920><c> CTE</c><01:16:17.520><c> from</c><01:16:17.800><c> an</c><01:16:18.159><c> external</c>

01:16:19.149 --> 01:16:19.159 align:start position:0%
cannot query the CTE from an external
 

01:16:19.159 --> 01:16:20.790 align:start position:0%
cannot query the CTE from an external
query<01:16:19.800><c> now</c><01:16:19.920><c> we</c><01:16:20.040><c> have</c><01:16:20.159><c> learned</c><01:16:20.480><c> that</c><01:16:20.639><c> the</c>

01:16:20.790 --> 01:16:20.800 align:start position:0%
query now we have learned that the
 

01:16:20.800 --> 01:16:23.110 align:start position:0%
query now we have learned that the
result<01:16:21.120><c> of</c><01:16:21.239><c> the</c><01:16:21.360><c> CTE</c><01:16:21.880><c> could</c><01:16:22.080><c> be</c><01:16:22.239><c> used</c><01:16:22.719><c> from</c><01:16:23.000><c> the</c>

01:16:23.110 --> 01:16:23.120 align:start position:0%
result of the CTE could be used from the
 

01:16:23.120 --> 01:16:25.709 align:start position:0%
result of the CTE could be used from the
main<01:16:23.440><c> query</c><01:16:24.159><c> this</c><01:16:24.280><c> is</c><01:16:24.480><c> the</c><01:16:24.639><c> classic</c><01:16:24.920><c> iCal</c><01:16:25.239><c> one</c>

01:16:25.709 --> 01:16:25.719 align:start position:0%
main query this is the classic iCal one
 

01:16:25.719 --> 01:16:27.709 align:start position:0%
main query this is the classic iCal one
but<01:16:25.920><c> not</c><01:16:26.159><c> only</c><01:16:26.480><c> we</c><01:16:26.600><c> can</c><01:16:26.800><c> use</c><01:16:26.960><c> it</c><01:16:27.120><c> in</c><01:16:27.280><c> the</c><01:16:27.400><c> main</c>

01:16:27.709 --> 01:16:27.719 align:start position:0%
but not only we can use it in the main
 

01:16:27.719 --> 01:16:30.669 align:start position:0%
but not only we can use it in the main
query<01:16:28.199><c> but</c><01:16:28.520><c> also</c><01:16:28.920><c> we</c><01:16:29.040><c> can</c><01:16:29.239><c> use</c><01:16:29.480><c> it</c><01:16:29.719><c> in</c><01:16:30.280><c> another</c>

01:16:30.669 --> 01:16:30.679 align:start position:0%
query but also we can use it in another
 

01:16:30.679 --> 01:16:33.669 align:start position:0%
query but also we can use it in another
CTE<01:16:31.159><c> query</c><01:16:31.800><c> which</c><01:16:31.960><c> leads</c><01:16:32.360><c> to</c><01:16:32.679><c> having</c><01:16:33.239><c> nested</c>

01:16:33.669 --> 01:16:33.679 align:start position:0%
CTE query which leads to having nested
 

01:16:33.679 --> 01:16:35.669 align:start position:0%
CTE query which leads to having nested
CTS<01:16:34.480><c> and</c><01:16:34.639><c> of</c><01:16:34.800><c> course</c><01:16:35.000><c> we</c><01:16:35.120><c> have</c><01:16:35.239><c> learned</c><01:16:35.560><c> as</c>

01:16:35.669 --> 01:16:35.679 align:start position:0%
CTS and of course we have learned as
 

01:16:35.679 --> 01:16:38.590 align:start position:0%
CTS and of course we have learned as
well<01:16:36.199><c> we</c><01:16:36.320><c> can</c><01:16:36.520><c> use</c><01:16:36.960><c> the</c><01:16:37.199><c> result</c><01:16:37.600><c> of</c><01:16:37.760><c> the</c><01:16:37.920><c> CTE</c>

01:16:38.590 --> 01:16:38.600 align:start position:0%
well we can use the result of the CTE
 

01:16:38.600 --> 01:16:40.910 align:start position:0%
well we can use the result of the CTE
within<01:16:39.000><c> itself</c><01:16:39.760><c> which</c><01:16:39.920><c> makes</c><01:16:40.320><c> the</c><01:16:40.440><c> CTE</c>

01:16:40.910 --> 01:16:40.920 align:start position:0%
within itself which makes the CTE
 

01:16:40.920 --> 01:16:43.270 align:start position:0%
within itself which makes the CTE
recursive<01:16:41.600><c> and</c><01:16:41.800><c> allows</c><01:16:42.280><c> for</c><01:16:42.560><c> looping</c><01:16:43.080><c> and</c>

01:16:43.270 --> 01:16:43.280 align:start position:0%
recursive and allows for looping and
 

01:16:43.280 --> 01:16:45.149 align:start position:0%
recursive and allows for looping and
iterating<01:16:44.159><c> and</c><01:16:44.360><c> I</c><01:16:44.480><c> can</c><01:16:44.639><c> only</c><01:16:44.920><c> keep</c>

01:16:45.149 --> 01:16:45.159 align:start position:0%
iterating and I can only keep
 

01:16:45.159 --> 01:16:47.750 align:start position:0%
iterating and I can only keep
recommending<01:16:46.000><c> to</c><01:16:46.239><c> not</c><01:16:46.480><c> use</c><01:16:46.800><c> more</c><01:16:47.080><c> than</c><01:16:47.480><c> five</c>

01:16:47.750 --> 01:16:47.760 align:start position:0%
recommending to not use more than five
 

01:16:47.760 --> 01:16:49.910 align:start position:0%
recommending to not use more than five
CTE<01:16:48.360><c> in</c><01:16:48.480><c> one</c><01:16:48.679><c> query</c><01:16:49.360><c> otherwise</c><01:16:49.719><c> you're</c><01:16:49.840><c> going</c>

01:16:49.910 --> 01:16:49.920 align:start position:0%
CTE in one query otherwise you're going
 

01:16:49.920 --> 01:16:52.229 align:start position:0%
CTE in one query otherwise you're going
to<01:16:50.040><c> get</c><01:16:50.239><c> the</c><01:16:50.480><c> exact</c><01:16:50.880><c> opposite</c><01:16:51.320><c> and</c><01:16:51.520><c> benefits</c>

01:16:52.229 --> 01:16:52.239 align:start position:0%
to get the exact opposite and benefits
 

01:16:52.239 --> 01:16:54.390 align:start position:0%
to get the exact opposite and benefits
from<01:16:52.440><c> CES</c><01:16:53.400><c> where</c><01:16:53.600><c> your</c><01:16:53.800><c> code</c><01:16:54.040><c> can</c><01:16:54.159><c> to</c><01:16:54.239><c> be</c>

01:16:54.390 --> 01:16:54.400 align:start position:0%
from CES where your code can to be
 

01:16:54.400 --> 01:16:56.110 align:start position:0%
from CES where your code can to be
really<01:16:54.560><c> hard</c><01:16:54.920><c> to</c><01:16:55.320><c> understand</c><01:16:55.560><c> and</c><01:16:55.679><c> to</c><01:16:55.840><c> read</c>

01:16:56.110 --> 01:16:56.120 align:start position:0%
really hard to understand and to read
 

01:16:56.120 --> 01:16:58.110 align:start position:0%
really hard to understand and to read
and<01:16:56.320><c> even</c><01:16:56.560><c> to</c><01:16:56.760><c> extend</c><01:16:57.440><c> all</c><01:16:57.560><c> right</c><01:16:57.760><c> so</c><01:16:57.960><c> with</c>

01:16:58.110 --> 01:16:58.120 align:start position:0%
and even to extend all right so with
 

01:16:58.120 --> 01:17:00.110 align:start position:0%
and even to extend all right so with
that<01:16:58.239><c> we</c><01:16:58.360><c> have</c><01:16:58.480><c> covered</c><01:16:59.000><c> everything</c><01:16:59.600><c> about</c>

01:17:00.110 --> 01:17:00.120 align:start position:0%
that we have covered everything about
 

01:17:00.120 --> 01:17:01.950 align:start position:0%
that we have covered everything about
the<01:17:00.360><c> amazing</c><01:17:00.920><c> and</c><01:17:01.080><c> the</c><01:17:01.280><c> most</c><01:17:01.560><c> powerful</c>

01:17:01.950 --> 01:17:01.960 align:start position:0%
the amazing and the most powerful
 

01:17:01.960 --> 01:17:04.950 align:start position:0%
the amazing and the most powerful
technique<01:17:02.320><c> in</c><01:17:02.440><c> SQL</c><01:17:03.280><c> the</c><01:17:03.440><c> CTE</c><01:17:04.320><c> and</c><01:17:04.520><c> in</c><01:17:04.639><c> the</c><01:17:04.760><c> next</c>

01:17:04.950 --> 01:17:04.960 align:start position:0%
technique in SQL the CTE and in the next
 

01:17:04.960 --> 01:17:06.070 align:start position:0%
technique in SQL the CTE and in the next
chapter<01:17:05.239><c> we're</c><01:17:05.320><c> going</c><01:17:05.440><c> to</c><01:17:05.560><c> start</c><01:17:05.760><c> talking</c>

01:17:06.070 --> 01:17:06.080 align:start position:0%
chapter we're going to start talking
 

01:17:06.080 --> 01:17:08.229 align:start position:0%
chapter we're going to start talking
about<01:17:06.600><c> the</c><01:17:06.760><c> DL</c><01:17:07.239><c> commands</c><01:17:07.719><c> and</c><01:17:07.840><c> we're</c><01:17:08.000><c> going</c><01:17:08.080><c> to</c>

01:17:08.229 --> 01:17:08.239 align:start position:0%
about the DL commands and we're going to
 

01:17:08.239 --> 01:17:11.270 align:start position:0%
about the DL commands and we're going to
focus<01:17:08.600><c> on</c><01:17:09.000><c> the</c><01:17:09.159><c> SQL</c><01:17:09.639><c> views</c><01:17:10.280><c> views</c><01:17:10.639><c> are</c><01:17:11.080><c> very</c>

01:17:11.270 --> 01:17:11.280 align:start position:0%
focus on the SQL views views are very
 

01:17:11.280 --> 01:17:13.390 align:start position:0%
focus on the SQL views views are very
important<01:17:11.719><c> technique</c><01:17:12.159><c> as</c><01:17:12.320><c> well</c><01:17:12.800><c> for</c><01:17:13.120><c> data</c>

01:17:13.390 --> 01:17:13.400 align:start position:0%
important technique as well for data
 

01:17:13.400 --> 01:17:15.189 align:start position:0%
important technique as well for data
analytics<01:17:14.199><c> if</c><01:17:14.280><c> you</c><01:17:14.400><c> like</c><01:17:14.639><c> this</c><01:17:14.800><c> video</c><01:17:15.040><c> and</c><01:17:15.120><c> you</c>

01:17:15.189 --> 01:17:15.199 align:start position:0%
analytics if you like this video and you
 

01:17:15.199 --> 01:17:17.470 align:start position:0%
analytics if you like this video and you
want<01:17:15.360><c> me</c><01:17:15.480><c> to</c><01:17:15.600><c> create</c><01:17:15.920><c> more</c><01:17:16.239><c> content</c><01:17:16.679><c> like</c><01:17:17.000><c> this</c>

01:17:17.470 --> 01:17:17.480 align:start position:0%
want me to create more content like this
 

01:17:17.480 --> 01:17:19.149 align:start position:0%
want me to create more content like this
I'm<01:17:17.600><c> going</c><01:17:17.719><c> to</c><01:17:17.880><c> really</c><01:17:18.120><c> appreciate</c><01:17:18.600><c> it</c><01:17:18.920><c> if</c><01:17:19.040><c> you</c>

01:17:19.149 --> 01:17:19.159 align:start position:0%
I'm going to really appreciate it if you
 

01:17:19.159 --> 01:17:21.430 align:start position:0%
I'm going to really appreciate it if you
support<01:17:19.480><c> the</c><01:17:19.639><c> channel</c><01:17:20.320><c> by</c><01:17:20.600><c> subscribing</c>

01:17:21.430 --> 01:17:21.440 align:start position:0%
support the channel by subscribing
 

01:17:21.440 --> 01:17:23.790 align:start position:0%
support the channel by subscribing
liking<01:17:21.880><c> sharing</c><01:17:22.440><c> commenting</c><01:17:23.360><c> all</c><01:17:23.600><c> those</c>

01:17:23.790 --> 01:17:23.800 align:start position:0%
liking sharing commenting all those
 

01:17:23.800 --> 01:17:25.470 align:start position:0%
liking sharing commenting all those
stuff<01:17:24.040><c> going</c><01:17:24.159><c> to</c><01:17:24.320><c> help</c><01:17:24.520><c> the</c><01:17:24.639><c> Chann</c><01:17:24.880><c> Channel</c>

01:17:25.470 --> 01:17:25.480 align:start position:0%
stuff going to help the Chann Channel
 

01:17:25.480 --> 01:17:27.270 align:start position:0%
stuff going to help the Chann Channel
with<01:17:25.639><c> the</c><01:17:25.760><c> YouTube</c><01:17:26.080><c> algorithm</c><01:17:26.760><c> and</c><01:17:26.920><c> as</c><01:17:27.080><c> well</c>

01:17:27.270 --> 01:17:27.280 align:start position:0%
with the YouTube algorithm and as well
 

01:17:27.280 --> 01:17:29.510 align:start position:0%
with the YouTube algorithm and as well
my<01:17:27.560><c> content</c><01:17:27.960><c> going</c><01:17:28.080><c> to</c><01:17:28.159><c> reach</c><01:17:28.360><c> to</c><01:17:28.520><c> the</c><01:17:28.679><c> others</c>

01:17:29.510 --> 01:17:29.520 align:start position:0%
my content going to reach to the others
 

01:17:29.520 --> 01:17:32.310 align:start position:0%
my content going to reach to the others
so<01:17:30.280><c> thank</c><01:17:30.480><c> you</c><01:17:30.719><c> so</c><01:17:30.960><c> much</c><01:17:31.199><c> for</c><01:17:31.440><c> watching</c><01:17:32.000><c> and</c><01:17:32.239><c> I</c>

01:17:32.310 --> 01:17:32.320 align:start position:0%
so thank you so much for watching and I
 

01:17:32.320 --> 01:17:37.159 align:start position:0%
so thank you so much for watching and I
will<01:17:32.480><c> see</c><01:17:32.639><c> you</c><01:17:32.760><c> in</c><01:17:32.920><c> the</c><01:17:33.040><c> next</c><01:17:33.199><c> tutorial</c><01:17:34.159><c> bye</c>

